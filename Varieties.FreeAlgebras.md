---
layout: default
title : Varieties.FreeAlgebras module (Agda Universal Algebra Library)
date : 2021-03-01
author: [agda-algebras development team][]
---

## <a id="free-algebras-and-birkhoffs-theorem">Free Algebras and Birkhoff's Theorem</a>

This is the [Varieties.FreeAlgebras.Basic][] module of the [Agda Universal Algebra Library][].

First we will define the relatively free algebra in a variety, which is the "freest" algebra among (universal for) those algebras that model all identities holding in the variety. Then we give a formal proof of Birkhoff's theorem which says that a variety is an equational class. In other terms, a class `𝒦` of algebras is closed under the operators `H`, `S`, and `P` if and only if 𝒦 is the class of algebras that satisfy some set of identities.

<pre class="Agda">

<a id="805" class="Symbol">{-#</a> <a id="809" class="Keyword">OPTIONS</a> <a id="817" class="Pragma">--without-K</a> <a id="829" class="Pragma">--exact-split</a> <a id="843" class="Pragma">--safe</a> <a id="850" class="Symbol">#-}</a>


<a id="856" class="Keyword">open</a> <a id="861" class="Keyword">import</a> <a id="868" href="Level.html" class="Module">Level</a> <a id="874" class="Keyword">renaming</a> <a id="883" class="Symbol">(</a> <a id="885" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="889" class="Symbol">to</a> <a id="892" class="Primitive">lsuc</a> <a id="897" class="Symbol">)</a>
<a id="899" class="Keyword">open</a> <a id="904" class="Keyword">import</a> <a id="911" href="Algebras.Basic.html" class="Module">Algebras.Basic</a> <a id="926" class="Keyword">using</a> <a id="932" class="Symbol">(</a> <a id="934" href="Algebras.Basic.html#1210" class="Generalizable">𝓞</a> <a id="936" class="Symbol">;</a> <a id="938" href="Algebras.Basic.html#1212" class="Generalizable">𝓥</a> <a id="940" class="Symbol">;</a> <a id="942" href="Algebras.Basic.html#3576" class="Function">Signature</a> <a id="952" class="Symbol">)</a>

<a id="955" class="Keyword">module</a> <a id="962" href="Varieties.FreeAlgebras.html" class="Module">Varieties.FreeAlgebras</a> <a id="985" class="Symbol">{</a><a id="986" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a> <a id="988" href="Varieties.FreeAlgebras.html#988" class="Bound">𝓞</a> <a id="990" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="992" class="Symbol">:</a> <a id="994" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="999" class="Symbol">}</a> <a id="1001" class="Symbol">(</a><a id="1002" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a> <a id="1004" class="Symbol">:</a> <a id="1006" href="Algebras.Basic.html#3576" class="Function">Signature</a> <a id="1016" href="Varieties.FreeAlgebras.html#988" class="Bound">𝓞</a> <a id="1018" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a><a id="1019" class="Symbol">)</a> <a id="1021" class="Keyword">where</a>

<a id="1028" class="Comment">-- Imports from Agda and the Agda Standard Library ---------------------</a>
<a id="1101" class="Keyword">open</a> <a id="1106" class="Keyword">import</a> <a id="1113" href="Axiom.Extensionality.Propositional.html" class="Module">Axiom.Extensionality.Propositional</a>
                            <a id="1176" class="Keyword">using</a> <a id="1182" class="Symbol">()</a> <a id="1185" class="Keyword">renaming</a> <a id="1194" class="Symbol">(</a><a id="1195" href="Axiom.Extensionality.Propositional.html#741" class="Function">Extensionality</a> <a id="1210" class="Symbol">to</a> <a id="1213" class="Function">funext</a><a id="1219" class="Symbol">)</a>
<a id="1221" class="Keyword">open</a> <a id="1226" class="Keyword">import</a> <a id="1233" href="Agda.Primitive.html" class="Module">Agda.Primitive</a>  <a id="1249" class="Keyword">using</a> <a id="1255" class="Symbol">(</a> <a id="1257" href="Agda.Primitive.html#810" class="Primitive Operator">_⊔_</a> <a id="1261" class="Symbol">)</a> <a id="1263" class="Keyword">renaming</a> <a id="1272" class="Symbol">(</a> <a id="1274" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1278" class="Symbol">to</a> <a id="1281" class="Primitive">Type</a> <a id="1286" class="Symbol">)</a>
<a id="1288" class="Keyword">open</a> <a id="1293" class="Keyword">import</a> <a id="1300" href="Data.Product.html" class="Module">Data.Product</a>    <a id="1316" class="Keyword">using</a> <a id="1322" class="Symbol">(</a> <a id="1324" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="1328" class="Symbol">;</a> <a id="1330" href="Data.Product.html#916" class="Function">Σ-syntax</a> <a id="1339" class="Symbol">;</a> <a id="1341" href="Data.Product.html#1167" class="Function Operator">_×_</a> <a id="1345" class="Symbol">)</a> <a id="1347" class="Keyword">renaming</a> <a id="1356" class="Symbol">(</a> <a id="1358" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1364" class="Symbol">to</a> <a id="1367" class="Field">fst</a> <a id="1371" class="Symbol">;</a> <a id="1373" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="1379" class="Symbol">to</a> <a id="1382" class="Field">snd</a> <a id="1386" class="Symbol">)</a>
<a id="1388" class="Keyword">open</a> <a id="1393" class="Keyword">import</a> <a id="1400" href="Function.Base.html" class="Module">Function.Base</a>   <a id="1416" class="Keyword">using</a> <a id="1422" class="Symbol">(</a> <a id="1424" href="Function.Base.html#1031" class="Function Operator">_∘_</a> <a id="1428" class="Symbol">)</a>
<a id="1430" class="Keyword">open</a> <a id="1435" class="Keyword">import</a> <a id="1442" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="1458" class="Keyword">using</a> <a id="1464" class="Symbol">(</a> <a id="1466" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="1480" class="Symbol">)</a> <a id="1482" class="Keyword">renaming</a> <a id="1491" class="Symbol">(</a> <a id="1493" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="1497" class="Symbol">to</a> <a id="1500" class="Function">BinRel</a> <a id="1507" class="Symbol">)</a>
<a id="1509" class="Keyword">open</a> <a id="1514" class="Keyword">import</a> <a id="1521" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
                            <a id="1587" class="Keyword">using</a> <a id="1593" class="Symbol">(</a> <a id="1595" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="1599" class="Symbol">;</a> <a id="1601" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1606" class="Symbol">;</a> <a id="1608" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="1613" class="Symbol">;</a> <a id="1615" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="1624" class="Symbol">;</a> <a id="1626" class="Keyword">module</a> <a id="1633" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a> <a id="1645" class="Symbol">)</a>
<a id="1647" class="Keyword">open</a> <a id="1652" class="Keyword">import</a> <a id="1659" href="Relation.Unary.html" class="Module">Relation.Unary</a>  <a id="1675" class="Keyword">using</a>    <a id="1684" class="Symbol">(</a> <a id="1686" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="1691" class="Symbol">;</a> <a id="1693" href="Relation.Unary.html#1523" class="Function Operator">_∈_</a> <a id="1697" class="Symbol">;</a> <a id="1699" href="Relation.Unary.html#1742" class="Function Operator">_⊆_</a> <a id="1703" class="Symbol">;</a> <a id="1705" href="Relation.Unary.html#1335" class="Function Operator">｛_｝</a> <a id="1709" class="Symbol">;</a> <a id="1711" href="Relation.Unary.html#4417" class="Function Operator">_∪_</a> <a id="1715" class="Symbol">)</a>

<a id="1718" class="Comment">-- Imports from the Agda Universal Algebra Library -------------------------------------------</a>
<a id="1813" class="Keyword">open</a> <a id="1818" class="Keyword">import</a> <a id="1825" href="Overture.Preliminaries.html" class="Module">Overture.Preliminaries</a>             <a id="1860" class="Keyword">using</a> <a id="1866" class="Symbol">(</a> <a id="1868" href="Overture.Preliminaries.html#4155" class="Function Operator">∣_∣</a> <a id="1872" class="Symbol">;</a> <a id="1874" href="Overture.Preliminaries.html#4193" class="Function Operator">∥_∥</a> <a id="1878" class="Symbol">;</a> <a id="1880" href="Overture.Preliminaries.html#5185" class="Function Operator">_∙_</a> <a id="1884" class="Symbol">;</a> <a id="1886" href="Overture.Preliminaries.html#4859" class="Function Operator">_⁻¹</a> <a id="1890" class="Symbol">)</a>
<a id="1892" class="Keyword">open</a> <a id="1897" class="Keyword">import</a> <a id="1904" href="Overture.Inverses.html" class="Module">Overture.Inverses</a>                  <a id="1939" class="Keyword">using</a> <a id="1945" class="Symbol">(</a> <a id="1947" href="Overture.Inverses.html#3206" class="Function">IsSurjective</a> <a id="1960" class="Symbol">)</a>
<a id="1962" class="Keyword">open</a> <a id="1967" class="Keyword">import</a> <a id="1974" href="Relations.Discrete.html" class="Module">Relations.Discrete</a>                 <a id="2009" class="Keyword">using</a> <a id="2015" class="Symbol">(</a> <a id="2017" href="Relations.Discrete.html#3791" class="Function">kernel</a> <a id="2024" class="Symbol">)</a>
<a id="2026" class="Keyword">open</a> <a id="2031" class="Keyword">import</a> <a id="2038" href="Relations.Quotients.html" class="Module">Relations.Quotients</a>                <a id="2073" class="Keyword">using</a> <a id="2079" class="Symbol">(</a> <a id="2081" href="Relations.Quotients.html#4803" class="Function Operator">⟪_⟫</a> <a id="2085" class="Symbol">)</a>
<a id="2087" class="Keyword">open</a> <a id="2092" class="Keyword">import</a> <a id="2099" href="Foundations.Truncation.html" class="Module">Foundations.Truncation</a>             <a id="2134" class="Keyword">using</a> <a id="2140" class="Symbol">(</a> <a id="2142" href="Foundations.Truncation.html#6521" class="Function">is-set</a> <a id="2149" class="Symbol">;</a> <a id="2151" href="Foundations.Truncation.html#10715" class="Function">blk-uip</a> <a id="2159" class="Symbol">;</a> <a id="2161" href="Foundations.Truncation.html#3912" class="Function">hfunext</a> <a id="2169" class="Symbol">)</a>
<a id="2171" class="Keyword">open</a> <a id="2176" class="Keyword">import</a> <a id="2183" href="Foundations.Welldefined.html" class="Module">Foundations.Welldefined</a>            <a id="2218" class="Keyword">using</a> <a id="2224" class="Symbol">(</a> <a id="2226" href="Foundations.Welldefined.html#3115" class="Function">SwellDef</a> <a id="2235" class="Symbol">;</a> <a id="2237" href="Foundations.Welldefined.html#2817" class="Function">swelldef</a> <a id="2246" class="Symbol">)</a>
<a id="2248" class="Keyword">open</a> <a id="2253" class="Keyword">import</a> <a id="2260" href="Foundations.Extensionality.html" class="Module">Foundations.Extensionality</a>         <a id="2295" class="Keyword">using</a> <a id="2301" class="Symbol">(</a> <a id="2303" href="Foundations.Extensionality.html#2465" class="Function">DFunExt</a><a id="2310" class="Symbol">;</a> <a id="2312" href="Foundations.Extensionality.html#4239" class="Function">pred-ext</a> <a id="2321" class="Symbol">)</a>
<a id="2323" class="Keyword">open</a> <a id="2328" class="Keyword">import</a> <a id="2335" href="Algebras.Basic.html" class="Module">Algebras.Basic</a>                     <a id="2370" class="Keyword">using</a> <a id="2376" class="Symbol">(</a> <a id="2378" href="Algebras.Basic.html#6389" class="Function">Algebra</a> <a id="2386" class="Symbol">;</a> <a id="2388" href="Algebras.Basic.html#10865" class="Function">Lift-Alg</a> <a id="2397" class="Symbol">;</a> <a id="2399" href="Algebras.Basic.html#12721" class="Function">compatible</a> <a id="2410" class="Symbol">;</a> <a id="2412" href="Algebras.Basic.html#9889" class="Function Operator">_̂_</a> <a id="2416" class="Symbol">)</a>
<a id="2418" class="Keyword">open</a> <a id="2423" class="Keyword">import</a> <a id="2430" href="Algebras.Products.html" class="Module">Algebras.Products</a>          <a id="2457" class="Symbol">{</a><a id="2458" class="Argument">𝑆</a> <a id="2460" class="Symbol">=</a> <a id="2462" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="2463" class="Symbol">}</a> <a id="2465" class="Keyword">using</a> <a id="2471" class="Symbol">(</a> <a id="2473" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="2476" class="Symbol">;</a> <a id="2478" href="Algebras.Products.html#1754" class="Function">⨅</a> <a id="2480" class="Symbol">)</a>
<a id="2482" class="Keyword">open</a> <a id="2487" class="Keyword">import</a> <a id="2494" href="Algebras.Congruences.html" class="Module">Algebras.Congruences</a>       <a id="2521" class="Symbol">{</a><a id="2522" class="Argument">𝑆</a> <a id="2524" class="Symbol">=</a> <a id="2526" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="2527" class="Symbol">}</a> <a id="2529" class="Keyword">using</a> <a id="2535" class="Symbol">(</a> <a id="2537" href="Algebras.Congruences.html#1952" class="Function">Con</a><a id="2540" class="Symbol">;</a> <a id="2542" href="Algebras.Congruences.html#1854" class="InductiveConstructor">mkcon</a> <a id="2548" class="Symbol">;</a> <a id="2550" href="Algebras.Congruences.html#1766" class="Record">IsCongruence</a> <a id="2563" class="Symbol">)</a>
<a id="2565" class="Keyword">open</a> <a id="2570" class="Keyword">import</a> <a id="2577" href="Homomorphisms.Basic.html" class="Module">Homomorphisms.Basic</a>        <a id="2604" class="Symbol">{</a><a id="2605" class="Argument">𝑆</a> <a id="2607" class="Symbol">=</a> <a id="2609" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="2610" class="Symbol">}</a> <a id="2612" class="Keyword">using</a> <a id="2618" class="Symbol">(</a> <a id="2620" href="Homomorphisms.Basic.html#3059" class="Function">hom</a> <a id="2624" class="Symbol">;</a> <a id="2626" href="Homomorphisms.Basic.html#10671" class="Function">⨅-hom-co</a> <a id="2635" class="Symbol">;</a> <a id="2637" href="Homomorphisms.Basic.html#8015" class="Function Operator">ker[_⇒_]_↾_</a> <a id="2649" class="Symbol">;</a> <a id="2651" href="Homomorphisms.Basic.html#5930" class="Function">epi</a>
                                                     <a id="2708" class="Symbol">;</a> <a id="2710" href="Homomorphisms.Basic.html#9474" class="Function">πker</a> <a id="2715" class="Symbol">;</a> <a id="2717" href="Homomorphisms.Basic.html#6397" class="Function">epi-to-hom</a> <a id="2728" class="Symbol">;</a> <a id="2730" href="Homomorphisms.Basic.html#9983" class="Function">ker-in-con</a>
                                                     <a id="2794" class="Symbol">;</a>  <a id="2797" href="Homomorphisms.Basic.html#7607" class="Function">kercon</a> <a id="2804" class="Symbol">;</a> <a id="2806" href="Homomorphisms.Basic.html#3421" class="Function">∘-hom</a> <a id="2812" class="Symbol">)</a>
<a id="2814" class="Keyword">open</a> <a id="2819" class="Keyword">import</a> <a id="2826" href="Homomorphisms.Noether.html" class="Module">Homomorphisms.Noether</a>      <a id="2853" class="Symbol">{</a><a id="2854" class="Argument">𝑆</a> <a id="2856" class="Symbol">=</a> <a id="2858" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="2859" class="Symbol">}</a> <a id="2861" class="Keyword">using</a> <a id="2867" class="Symbol">(</a> <a id="2869" href="Homomorphisms.Noether.html#8545" class="Function">HomFactor</a> <a id="2879" class="Symbol">;</a> <a id="2881" href="Homomorphisms.Noether.html#9819" class="Function">HomFactorEpi</a> <a id="2894" class="Symbol">)</a>
<a id="2896" class="Keyword">open</a> <a id="2901" class="Keyword">import</a> <a id="2908" href="Homomorphisms.Isomorphisms.html" class="Module">Homomorphisms.Isomorphisms</a> <a id="2935" class="Symbol">{</a><a id="2936" class="Argument">𝑆</a> <a id="2938" class="Symbol">=</a> <a id="2940" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="2941" class="Symbol">}</a> <a id="2943" class="Keyword">using</a> <a id="2949" class="Symbol">(</a> <a id="2951" href="Homomorphisms.Isomorphisms.html#2255" class="Record Operator">_≅_</a> <a id="2955" class="Symbol">;</a> <a id="2957" href="Homomorphisms.Isomorphisms.html#2747" class="Function">≅-refl</a> <a id="2964" class="Symbol">;</a> <a id="2966" href="Homomorphisms.Isomorphisms.html#2837" class="Function">≅-sym</a> <a id="2972" class="Symbol">;</a> <a id="2974" href="Homomorphisms.Isomorphisms.html#4265" class="Function">Lift-≅</a> <a id="2981" class="Symbol">)</a>
<a id="2983" class="Keyword">open</a> <a id="2988" class="Keyword">import</a> <a id="2995" href="Terms.Basic.html" class="Module">Terms.Basic</a>                <a id="3022" class="Symbol">{</a><a id="3023" class="Argument">𝑆</a> <a id="3025" class="Symbol">=</a> <a id="3027" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="3028" class="Symbol">}</a> <a id="3030" class="Keyword">using</a> <a id="3036" class="Symbol">(</a> <a id="3038" href="Terms.Basic.html#1823" class="Datatype">Term</a> <a id="3043" class="Symbol">;</a> <a id="3045" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="3047" class="Symbol">)</a>
<a id="3049" class="Keyword">open</a> <a id="3054" class="Keyword">import</a> <a id="3061" href="Terms.Properties.html" class="Module">Terms.Properties</a>           <a id="3088" class="Symbol">{</a><a id="3089" class="Argument">𝑆</a> <a id="3091" class="Symbol">=</a> <a id="3093" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="3094" class="Symbol">}</a> <a id="3096" class="Keyword">using</a> <a id="3102" class="Symbol">(</a> <a id="3104" href="Terms.Properties.html#2369" class="Function">free-lift</a> <a id="3114" class="Symbol">;</a> <a id="3116" href="Terms.Properties.html#3076" class="Function">lift-hom</a>
                                                     <a id="3178" class="Symbol">;</a> <a id="3180" href="Terms.Properties.html#3475" class="Function">free-unique</a> <a id="3192" class="Symbol">;</a> <a id="3194" href="Terms.Properties.html#4681" class="Function">lift-of-epi-is-epi</a> <a id="3213" class="Symbol">)</a>
<a id="3215" class="Keyword">open</a> <a id="3220" class="Keyword">import</a> <a id="3227" href="Terms.Operations.html" class="Module">Terms.Operations</a>           <a id="3254" class="Symbol">{</a><a id="3255" class="Argument">𝑆</a> <a id="3257" class="Symbol">=</a> <a id="3259" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="3260" class="Symbol">}</a> <a id="3262" class="Keyword">using</a> <a id="3268" class="Symbol">(</a> <a id="3270" href="Terms.Operations.html#2529" class="Function Operator">_⟦_⟧</a><a id="3274" class="Symbol">;</a> <a id="3276" href="Terms.Operations.html#7965" class="Function">comm-hom-term</a><a id="3289" class="Symbol">;</a> <a id="3291" href="Terms.Operations.html#2840" class="Function">free-lift-interp</a> <a id="3308" class="Symbol">)</a>
<a id="3310" class="Keyword">open</a> <a id="3315" class="Keyword">import</a> <a id="3322" href="Subalgebras.Subalgebras.html" class="Module">Subalgebras.Subalgebras</a>    <a id="3349" class="Symbol">{</a><a id="3350" class="Argument">𝑆</a> <a id="3352" class="Symbol">=</a> <a id="3354" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="3355" class="Symbol">}</a> <a id="3357" class="Keyword">using</a> <a id="3363" class="Symbol">(</a> <a id="3365" href="Subalgebras.Subalgebras.html#2513" class="Function Operator">_≤_</a> <a id="3369" class="Symbol">;</a> <a id="3371" href="Subalgebras.Subalgebras.html#4345" class="Function">FirstHomCorollary|Set</a> <a id="3393" class="Symbol">)</a>
<a id="3395" class="Keyword">open</a> <a id="3400" class="Keyword">import</a> <a id="3407" href="Varieties.EquationalLogic.html" class="Module">Varieties.EquationalLogic</a>  <a id="3434" class="Symbol">{</a><a id="3435" class="Argument">𝑆</a> <a id="3437" class="Symbol">=</a> <a id="3439" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="3440" class="Symbol">}</a> <a id="3442" class="Keyword">using</a> <a id="3448" class="Symbol">(</a> <a id="3450" href="Varieties.EquationalLogic.html#2558" class="Function Operator">_⊫_≈_</a><a id="3455" class="Symbol">;</a> <a id="3457" href="Varieties.EquationalLogic.html#2480" class="Function Operator">_⊧_≈_</a><a id="3462" class="Symbol">;</a> <a id="3464" href="Varieties.EquationalLogic.html#3240" class="Function">Th</a><a id="3466" class="Symbol">;</a> <a id="3468" href="Varieties.EquationalLogic.html#3815" class="Function">Mod</a> <a id="3472" class="Symbol">)</a>
<a id="3474" class="Keyword">open</a> <a id="3479" class="Keyword">import</a> <a id="3486" href="Varieties.Closure.html" class="Module">Varieties.Closure</a>          <a id="3513" class="Symbol">{</a><a id="3514" class="Argument">𝑆</a> <a id="3516" class="Symbol">=</a> <a id="3518" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="3519" class="Symbol">}</a> <a id="3521" class="Keyword">using</a> <a id="3527" class="Symbol">(</a> <a id="3529" href="Varieties.Closure.html#3819" class="Datatype">S</a> <a id="3531" class="Symbol">;</a> <a id="3533" href="Varieties.Closure.html#4403" class="Datatype">P</a> <a id="3535" class="Symbol">;</a> <a id="3537" href="Varieties.Closure.html#5363" class="Datatype">V</a> <a id="3539" class="Symbol">)</a>
<a id="3541" class="Keyword">open</a> <a id="3546" class="Keyword">import</a> <a id="3553" href="Varieties.Preservation.html" class="Module">Varieties.Preservation</a>     <a id="3580" class="Symbol">{</a><a id="3581" class="Argument">𝑆</a> <a id="3583" class="Symbol">=</a> <a id="3585" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="3586" class="Symbol">}</a> <a id="3588" class="Keyword">using</a> <a id="3594" class="Symbol">(</a> <a id="3596" class="Keyword">module</a> <a id="3603" href="Varieties.Preservation.html#10416" class="Module">class-products-with-maps</a>
                                                     <a id="3681" class="Symbol">;</a> <a id="3683" href="Varieties.Preservation.html#20329" class="Function">class-ids-⇒</a> <a id="3695" class="Symbol">;</a> <a id="3697" href="Varieties.Preservation.html#20442" class="Function">class-ids</a> <a id="3707" class="Symbol">;</a> <a id="3709" href="Varieties.Preservation.html#9266" class="Function">SP⊆V&#39;</a><a id="3714" class="Symbol">)</a>
<a id="3716" class="Keyword">open</a> <a id="3721" href="Terms.Basic.html#1823" class="Module">Term</a>
<a id="3726" class="Keyword">open</a> <a id="3731" href="Varieties.Closure.html#3819" class="Module">S</a>
<a id="3733" class="Keyword">open</a> <a id="3738" href="Varieties.Closure.html#5363" class="Module">V</a>

<a id="𝓕"></a><a id="3741" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a> <a id="𝓕⁺"></a><a id="3743" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a> <a id="3746" class="Symbol">:</a> <a id="3748" href="Agda.Primitive.html#597" class="Postulate">Level</a>
<a id="3754" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a> <a id="3756" class="Symbol">=</a> <a id="3758" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="3761" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a>
<a id="3763" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a> <a id="3766" class="Symbol">=</a> <a id="3768" href="Varieties.FreeAlgebras.html#892" class="Primitive">lsuc</a> <a id="3773" class="Symbol">(</a><a id="3774" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="3777" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="3778" class="Symbol">)</a>    <a id="3783" class="Comment">-- (this will be the level of the relatively free algebra)</a>

</pre>


#### <a id="the-free-algebra-in-theory">The free algebra in theory</a>

Recall, we proved in [the universal property](Terms.Basic.html#the-universal-property) section of the [Terms.Basic][] module that the term algebra `𝑻 X` is the absolutely free algebra in the class of all `𝑆`-structures. In this section, we formalize, for a given class `𝒦` of `𝑆`-algebras, the (relatively) free algebra in `S(P 𝒦)` over `X`.

We use the next definition to take a free algebra *for* a class `𝒦` and produce the free algebra *in* `𝒦`.

`Θ(𝒦, 𝑨) := {θ ∈ Con 𝑨 : 𝑨 / θ ∈ (S 𝒦)}` &nbsp; &nbsp; and &nbsp; &nbsp; `ψ(𝒦, 𝑨) := ⋂ Θ(𝒦, 𝑨)`.

Notice that `Θ(𝒦, 𝑨)` may be empty, in which case `ψ(𝒦, 𝑨) = 1` and then `𝑨 / ψ(𝒦, 𝑨)` is trivial.

The free algebra is constructed by applying the above definitions to the special case in which `𝑨` is the term algebra `𝑻 X` of `𝑆`-terms over `X`.

Since `𝑻 X` is free for (and in) the class of all `𝑆`-algebras, it follows that `𝑻 X` is free for every class `𝒦` of `𝑆`-algebras. Of course, `𝑻 X` is not necessarily a member of `𝒦`, but if we form the quotient of `𝑻 X` modulo the congruence `ψ(𝒦, 𝑻 X)`, which we denote by `𝔉 := (𝑻 X) / ψ(𝒦, 𝑻 X)`, then it's not hard to see that `𝔉` is a subdirect product of the algebras in `{(𝑻 𝑋) / θ}`, where `θ` ranges over `Θ(𝒦, 𝑻 X)`, so `𝔉` belongs to `S(P 𝒦)`, and it follows that `𝔉` satisfies all the identities satisfied by all members of `𝒦`.  Indeed, for each pair `p q : 𝑻 X`, if `𝒦 ⊧ p ≈ q`, then `p` and `q` must belong to the same `ψ(𝒦, 𝑻 X)`-class, so `p` and `q` are identified in the quotient `𝔉`.

The `𝔉` that we have just defined is called the **free algebra over** `𝒦` **generated by** `X` and (because of what we just observed) we may say that `𝔉` is free *in* `S(P 𝒦)`.<sup>[1](Varieties.FreeAlgebras.html#fn1)</sup>

#### <a id="the-free-algebra-in-agda">The free algebra in Agda</a>

Before we attempt to represent the free algebra in Agda we construct the congruence `ψ(𝒦, 𝑻 𝑋)` described above.
First, we represent the congruence relation `ψCon`, modulo which `𝑻 X` yields the relatively free algebra, `𝔉 𝒦 X := 𝑻 X ╱ ψCon`.  We let `ψ` be the collection of identities `(p, q)` satisfied by all subalgebras of algebras in `𝒦`.

<pre class="Agda">

<a id="6085" class="Keyword">module</a> <a id="6092" href="Varieties.FreeAlgebras.html#6092" class="Module">_</a> <a id="6094" class="Symbol">{</a><a id="6095" href="Varieties.FreeAlgebras.html#6095" class="Bound">X</a> <a id="6097" class="Symbol">:</a> <a id="6099" href="Varieties.FreeAlgebras.html#1281" class="Primitive">Type</a> <a id="6104" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="6105" class="Symbol">}(</a><a id="6107" href="Varieties.FreeAlgebras.html#6107" class="Bound">𝒦</a> <a id="6109" class="Symbol">:</a> <a id="6111" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="6116" class="Symbol">(</a><a id="6117" href="Algebras.Basic.html#6389" class="Function">Algebra</a> <a id="6125" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a> <a id="6127" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="6128" class="Symbol">)</a> <a id="6130" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a><a id="6131" class="Symbol">)</a> <a id="6133" class="Keyword">where</a>

 <a id="6141" href="Varieties.FreeAlgebras.html#6141" class="Function">ψ</a> <a id="6143" class="Symbol">:</a> <a id="6145" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="6150" class="Symbol">(</a><a id="6151" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6153" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="6155" href="Varieties.FreeAlgebras.html#6095" class="Bound">X</a> <a id="6157" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6159" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6161" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6163" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="6165" href="Varieties.FreeAlgebras.html#6095" class="Bound">X</a> <a id="6167" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a><a id="6168" class="Symbol">)</a> <a id="6170" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a>
 <a id="6173" href="Varieties.FreeAlgebras.html#6141" class="Function">ψ</a> <a id="6175" class="Symbol">(</a><a id="6176" href="Varieties.FreeAlgebras.html#6176" class="Bound">p</a> <a id="6178" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6180" href="Varieties.FreeAlgebras.html#6180" class="Bound">q</a><a id="6181" class="Symbol">)</a> <a id="6183" class="Symbol">=</a> <a id="6185" class="Symbol">∀(</a><a id="6187" href="Varieties.FreeAlgebras.html#6187" class="Bound">𝑨</a> <a id="6189" class="Symbol">:</a> <a id="6191" href="Algebras.Basic.html#6389" class="Function">Algebra</a> <a id="6199" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a> <a id="6201" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="6202" class="Symbol">)(</a><a id="6204" href="Varieties.FreeAlgebras.html#6204" class="Bound">sA</a> <a id="6207" class="Symbol">:</a> <a id="6209" href="Varieties.FreeAlgebras.html#6187" class="Bound">𝑨</a> <a id="6211" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="6213" href="Varieties.Closure.html#3819" class="Datatype">S</a><a id="6214" class="Symbol">{</a><a id="6215" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="6216" class="Symbol">}{</a><a id="6218" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="6219" class="Symbol">}</a> <a id="6221" href="Varieties.FreeAlgebras.html#6107" class="Bound">𝒦</a><a id="6222" class="Symbol">)(</a><a id="6224" href="Varieties.FreeAlgebras.html#6224" class="Bound">h</a> <a id="6226" class="Symbol">:</a> <a id="6228" href="Varieties.FreeAlgebras.html#6095" class="Bound">X</a> <a id="6230" class="Symbol">→</a> <a id="6232" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6234" href="Varieties.FreeAlgebras.html#6187" class="Bound">𝑨</a> <a id="6236" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6238" class="Symbol">)</a>
                 <a id="6257" class="Symbol">→</a>  <a id="6260" class="Symbol">(</a><a id="6261" href="Terms.Properties.html#2369" class="Function">free-lift</a> <a id="6271" href="Varieties.FreeAlgebras.html#6187" class="Bound">𝑨</a> <a id="6273" href="Varieties.FreeAlgebras.html#6224" class="Bound">h</a><a id="6274" class="Symbol">)</a> <a id="6276" href="Varieties.FreeAlgebras.html#6176" class="Bound">p</a> <a id="6278" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6280" class="Symbol">(</a><a id="6281" href="Terms.Properties.html#2369" class="Function">free-lift</a> <a id="6291" href="Varieties.FreeAlgebras.html#6187" class="Bound">𝑨</a> <a id="6293" href="Varieties.FreeAlgebras.html#6224" class="Bound">h</a><a id="6294" class="Symbol">)</a> <a id="6296" href="Varieties.FreeAlgebras.html#6180" class="Bound">q</a>

</pre>

We convert the predicate ψ into a relation by [currying](https://en.wikipedia.org/wiki/Currying).

<pre class="Agda">

 <a id="6425" href="Varieties.FreeAlgebras.html#6425" class="Function">ψRel</a> <a id="6430" class="Symbol">:</a> <a id="6432" href="Varieties.FreeAlgebras.html#1500" class="Function">BinRel</a> <a id="6439" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6441" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="6443" href="Varieties.FreeAlgebras.html#6095" class="Bound">X</a> <a id="6445" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6447" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a>
 <a id="6450" href="Varieties.FreeAlgebras.html#6425" class="Function">ψRel</a> <a id="6455" href="Varieties.FreeAlgebras.html#6455" class="Bound">p</a> <a id="6457" href="Varieties.FreeAlgebras.html#6457" class="Bound">q</a> <a id="6459" class="Symbol">=</a> <a id="6461" href="Varieties.FreeAlgebras.html#6141" class="Function">ψ</a> <a id="6463" class="Symbol">(</a><a id="6464" href="Varieties.FreeAlgebras.html#6455" class="Bound">p</a> <a id="6466" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6468" href="Varieties.FreeAlgebras.html#6457" class="Bound">q</a><a id="6469" class="Symbol">)</a>

</pre>

To express `ψRel` as a congruence of the term algebra `𝑻 X`, we must prove that

1. `ψRel` is compatible with the operations of `𝑻 X` (which are jsut the terms themselves) and
2. `ψRel` it is an equivalence relation.

<pre class="Agda">

 <a id="6717" class="Keyword">open</a> <a id="6722" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="6736" href="Varieties.FreeAlgebras.html#6736" class="Function">ψcompatible</a> <a id="6748" class="Symbol">:</a> <a id="6750" href="Foundations.Welldefined.html#2817" class="Function">swelldef</a> <a id="6759" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="6761" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a> <a id="6763" class="Symbol">→</a> <a id="6765" href="Algebras.Basic.html#12721" class="Function">compatible</a> <a id="6776" class="Symbol">(</a><a id="6777" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="6779" href="Varieties.FreeAlgebras.html#6095" class="Bound">X</a><a id="6780" class="Symbol">)</a> <a id="6782" href="Varieties.FreeAlgebras.html#6425" class="Function">ψRel</a>
 <a id="6788" href="Varieties.FreeAlgebras.html#6736" class="Function">ψcompatible</a> <a id="6800" href="Varieties.FreeAlgebras.html#6800" class="Bound">wd</a> <a id="6803" href="Varieties.FreeAlgebras.html#6803" class="Bound">𝑓</a> <a id="6805" class="Symbol">{</a><a id="6806" href="Varieties.FreeAlgebras.html#6806" class="Bound">p</a><a id="6807" class="Symbol">}</a> <a id="6809" class="Symbol">{</a><a id="6810" href="Varieties.FreeAlgebras.html#6810" class="Bound">q</a><a id="6811" class="Symbol">}</a> <a id="6813" href="Varieties.FreeAlgebras.html#6813" class="Bound">ψpq</a> <a id="6817" href="Varieties.FreeAlgebras.html#6817" class="Bound">𝑨</a> <a id="6819" href="Varieties.FreeAlgebras.html#6819" class="Bound">sA</a> <a id="6822" href="Varieties.FreeAlgebras.html#6822" class="Bound">h</a> <a id="6824" class="Symbol">=</a> <a id="6826" href="Varieties.FreeAlgebras.html#6876" class="Function">γ</a>
  <a id="6830" class="Keyword">where</a>
  <a id="6838" href="Varieties.FreeAlgebras.html#6838" class="Function">φ</a> <a id="6840" class="Symbol">:</a> <a id="6842" href="Homomorphisms.Basic.html#3059" class="Function">hom</a> <a id="6846" class="Symbol">(</a><a id="6847" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="6849" href="Varieties.FreeAlgebras.html#6095" class="Bound">X</a><a id="6850" class="Symbol">)</a> <a id="6852" href="Varieties.FreeAlgebras.html#6817" class="Bound">𝑨</a>
  <a id="6856" href="Varieties.FreeAlgebras.html#6838" class="Function">φ</a> <a id="6858" class="Symbol">=</a> <a id="6860" href="Terms.Properties.html#3076" class="Function">lift-hom</a> <a id="6869" href="Varieties.FreeAlgebras.html#6817" class="Bound">𝑨</a> <a id="6871" href="Varieties.FreeAlgebras.html#6822" class="Bound">h</a>

  <a id="6876" href="Varieties.FreeAlgebras.html#6876" class="Function">γ</a> <a id="6878" class="Symbol">:</a> <a id="6880" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6882" href="Varieties.FreeAlgebras.html#6838" class="Function">φ</a> <a id="6884" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6886" class="Symbol">((</a><a id="6888" href="Varieties.FreeAlgebras.html#6803" class="Bound">𝑓</a> <a id="6890" href="Algebras.Basic.html#9889" class="Function Operator">̂</a> <a id="6892" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="6894" href="Varieties.FreeAlgebras.html#6095" class="Bound">X</a><a id="6895" class="Symbol">)</a> <a id="6897" href="Varieties.FreeAlgebras.html#6806" class="Bound">p</a><a id="6898" class="Symbol">)</a> <a id="6900" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6902" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6904" href="Varieties.FreeAlgebras.html#6838" class="Function">φ</a> <a id="6906" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6908" class="Symbol">((</a><a id="6910" href="Varieties.FreeAlgebras.html#6803" class="Bound">𝑓</a> <a id="6912" href="Algebras.Basic.html#9889" class="Function Operator">̂</a> <a id="6914" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="6916" href="Varieties.FreeAlgebras.html#6095" class="Bound">X</a><a id="6917" class="Symbol">)</a> <a id="6919" href="Varieties.FreeAlgebras.html#6810" class="Bound">q</a><a id="6920" class="Symbol">)</a>

  <a id="6925" href="Varieties.FreeAlgebras.html#6876" class="Function">γ</a> <a id="6927" class="Symbol">=</a> <a id="6929" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6931" href="Varieties.FreeAlgebras.html#6838" class="Function">φ</a> <a id="6933" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6935" class="Symbol">((</a><a id="6937" href="Varieties.FreeAlgebras.html#6803" class="Bound">𝑓</a> <a id="6939" href="Algebras.Basic.html#9889" class="Function Operator">̂</a> <a id="6941" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="6943" href="Varieties.FreeAlgebras.html#6095" class="Bound">X</a><a id="6944" class="Symbol">)</a> <a id="6946" href="Varieties.FreeAlgebras.html#6806" class="Bound">p</a><a id="6947" class="Symbol">)</a>  <a id="6950" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="6953" href="Overture.Preliminaries.html#4193" class="Function Operator">∥</a> <a id="6955" href="Varieties.FreeAlgebras.html#6838" class="Function">φ</a> <a id="6957" href="Overture.Preliminaries.html#4193" class="Function Operator">∥</a> <a id="6959" href="Varieties.FreeAlgebras.html#6803" class="Bound">𝑓</a> <a id="6961" href="Varieties.FreeAlgebras.html#6806" class="Bound">p</a> <a id="6963" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="6971" class="Symbol">(</a><a id="6972" href="Varieties.FreeAlgebras.html#6803" class="Bound">𝑓</a> <a id="6974" href="Algebras.Basic.html#9889" class="Function Operator">̂</a> <a id="6976" href="Varieties.FreeAlgebras.html#6817" class="Bound">𝑨</a><a id="6977" class="Symbol">)</a> <a id="6979" class="Symbol">(</a><a id="6980" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6982" href="Varieties.FreeAlgebras.html#6838" class="Function">φ</a> <a id="6984" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="6986" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6988" href="Varieties.FreeAlgebras.html#6806" class="Bound">p</a><a id="6989" class="Symbol">)</a>  <a id="6992" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="6995" href="Varieties.FreeAlgebras.html#6800" class="Bound">wd</a> <a id="6998" class="Symbol">(</a><a id="6999" href="Varieties.FreeAlgebras.html#6803" class="Bound">𝑓</a> <a id="7001" href="Algebras.Basic.html#9889" class="Function Operator">̂</a> <a id="7003" href="Varieties.FreeAlgebras.html#6817" class="Bound">𝑨</a><a id="7004" class="Symbol">)(</a><a id="7006" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="7008" href="Varieties.FreeAlgebras.html#6838" class="Function">φ</a> <a id="7010" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="7012" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7014" href="Varieties.FreeAlgebras.html#6806" class="Bound">p</a><a id="7015" class="Symbol">)(</a><a id="7017" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="7019" href="Varieties.FreeAlgebras.html#6838" class="Function">φ</a> <a id="7021" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="7023" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7025" href="Varieties.FreeAlgebras.html#6810" class="Bound">q</a><a id="7026" class="Symbol">)(λ</a> <a id="7030" href="Varieties.FreeAlgebras.html#7030" class="Bound">x</a> <a id="7032" class="Symbol">→</a> <a id="7034" href="Varieties.FreeAlgebras.html#6813" class="Bound">ψpq</a> <a id="7038" href="Varieties.FreeAlgebras.html#7030" class="Bound">x</a> <a id="7040" href="Varieties.FreeAlgebras.html#6817" class="Bound">𝑨</a> <a id="7042" href="Varieties.FreeAlgebras.html#6819" class="Bound">sA</a> <a id="7045" href="Varieties.FreeAlgebras.html#6822" class="Bound">h</a><a id="7046" class="Symbol">)</a> <a id="7048" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7056" class="Symbol">(</a><a id="7057" href="Varieties.FreeAlgebras.html#6803" class="Bound">𝑓</a> <a id="7059" href="Algebras.Basic.html#9889" class="Function Operator">̂</a> <a id="7061" href="Varieties.FreeAlgebras.html#6817" class="Bound">𝑨</a><a id="7062" class="Symbol">)</a> <a id="7064" class="Symbol">(</a><a id="7065" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="7067" href="Varieties.FreeAlgebras.html#6838" class="Function">φ</a> <a id="7069" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="7071" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7073" href="Varieties.FreeAlgebras.html#6810" class="Bound">q</a><a id="7074" class="Symbol">)</a>  <a id="7077" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7080" class="Symbol">(</a><a id="7081" href="Overture.Preliminaries.html#4193" class="Function Operator">∥</a> <a id="7083" href="Varieties.FreeAlgebras.html#6838" class="Function">φ</a> <a id="7085" href="Overture.Preliminaries.html#4193" class="Function Operator">∥</a> <a id="7087" href="Varieties.FreeAlgebras.html#6803" class="Bound">𝑓</a> <a id="7089" href="Varieties.FreeAlgebras.html#6810" class="Bound">q</a><a id="7090" class="Symbol">)</a><a id="7091" href="Overture.Preliminaries.html#4859" class="Function Operator">⁻¹</a> <a id="7094" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7102" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="7104" href="Varieties.FreeAlgebras.html#6838" class="Function">φ</a> <a id="7106" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="7108" class="Symbol">((</a><a id="7110" href="Varieties.FreeAlgebras.html#6803" class="Bound">𝑓</a> <a id="7112" href="Algebras.Basic.html#9889" class="Function Operator">̂</a> <a id="7114" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="7116" href="Varieties.FreeAlgebras.html#6095" class="Bound">X</a><a id="7117" class="Symbol">)</a> <a id="7119" href="Varieties.FreeAlgebras.html#6810" class="Bound">q</a><a id="7120" class="Symbol">)</a>  <a id="7123" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

 <a id="7127" href="Varieties.FreeAlgebras.html#7127" class="Function">ψIsEquivalence</a> <a id="7142" class="Symbol">:</a> <a id="7144" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="7158" href="Varieties.FreeAlgebras.html#6425" class="Function">ψRel</a>
 <a id="7164" href="Varieties.FreeAlgebras.html#7127" class="Function">ψIsEquivalence</a> <a id="7179" class="Symbol">=</a> <a id="7181" class="Keyword">record</a> <a id="7188" class="Symbol">{</a> <a id="7190" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="7195" class="Symbol">=</a> <a id="7197" class="Symbol">λ</a> <a id="7199" href="Varieties.FreeAlgebras.html#7199" class="Bound">𝑨</a> <a id="7201" href="Varieties.FreeAlgebras.html#7201" class="Bound">sA</a> <a id="7204" href="Varieties.FreeAlgebras.html#7204" class="Bound">h</a> <a id="7206" class="Symbol">→</a> <a id="7208" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
                         <a id="7238" class="Symbol">;</a> <a id="7240" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="7244" class="Symbol">=</a> <a id="7246" class="Symbol">λ</a> <a id="7248" href="Varieties.FreeAlgebras.html#7248" class="Bound">x</a> <a id="7250" href="Varieties.FreeAlgebras.html#7250" class="Bound">𝑨</a> <a id="7252" href="Varieties.FreeAlgebras.html#7252" class="Bound">sA</a> <a id="7255" href="Varieties.FreeAlgebras.html#7255" class="Bound">h</a> <a id="7257" class="Symbol">→</a> <a id="7259" class="Symbol">(</a><a id="7260" href="Varieties.FreeAlgebras.html#7248" class="Bound">x</a> <a id="7262" href="Varieties.FreeAlgebras.html#7250" class="Bound">𝑨</a> <a id="7264" href="Varieties.FreeAlgebras.html#7252" class="Bound">sA</a> <a id="7267" href="Varieties.FreeAlgebras.html#7255" class="Bound">h</a><a id="7268" class="Symbol">)</a><a id="7269" href="Overture.Preliminaries.html#4859" class="Function Operator">⁻¹</a>
                         <a id="7297" class="Symbol">;</a> <a id="7299" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="7305" class="Symbol">=</a> <a id="7307" class="Symbol">λ</a> <a id="7309" href="Varieties.FreeAlgebras.html#7309" class="Bound">pψq</a> <a id="7313" href="Varieties.FreeAlgebras.html#7313" class="Bound">qψr</a> <a id="7317" href="Varieties.FreeAlgebras.html#7317" class="Bound">𝑨</a> <a id="7319" href="Varieties.FreeAlgebras.html#7319" class="Bound">sA</a> <a id="7322" href="Varieties.FreeAlgebras.html#7322" class="Bound">h</a> <a id="7324" class="Symbol">→</a> <a id="7326" class="Symbol">(</a><a id="7327" href="Varieties.FreeAlgebras.html#7309" class="Bound">pψq</a> <a id="7331" href="Varieties.FreeAlgebras.html#7317" class="Bound">𝑨</a> <a id="7333" href="Varieties.FreeAlgebras.html#7319" class="Bound">sA</a> <a id="7336" href="Varieties.FreeAlgebras.html#7322" class="Bound">h</a><a id="7337" class="Symbol">)</a> <a id="7339" href="Overture.Preliminaries.html#5185" class="Function Operator">∙</a> <a id="7341" class="Symbol">(</a><a id="7342" href="Varieties.FreeAlgebras.html#7313" class="Bound">qψr</a> <a id="7346" href="Varieties.FreeAlgebras.html#7317" class="Bound">𝑨</a> <a id="7348" href="Varieties.FreeAlgebras.html#7319" class="Bound">sA</a> <a id="7351" href="Varieties.FreeAlgebras.html#7322" class="Bound">h</a><a id="7352" class="Symbol">)</a> <a id="7354" class="Symbol">}</a>
</pre>

We have collected all the pieces necessary to express the collection of identities satisfied by all subalgebras of algebras in the class as a congruence relation of the term algebra. We call this congruence `ψCon` and define it using the Congruence constructor `mkcon`.

<pre class="Agda">

 <a id="7654" href="Varieties.FreeAlgebras.html#7654" class="Function">ψCon</a> <a id="7659" class="Symbol">:</a> <a id="7661" href="Foundations.Welldefined.html#2817" class="Function">swelldef</a> <a id="7670" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="7672" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a> <a id="7674" class="Symbol">→</a> <a id="7676" href="Algebras.Congruences.html#1952" class="Function">Con</a> <a id="7680" class="Symbol">(</a><a id="7681" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="7683" href="Varieties.FreeAlgebras.html#6095" class="Bound">X</a><a id="7684" class="Symbol">)</a>
 <a id="7687" href="Varieties.FreeAlgebras.html#7654" class="Function">ψCon</a> <a id="7692" href="Varieties.FreeAlgebras.html#7692" class="Bound">wd</a> <a id="7695" class="Symbol">=</a> <a id="7697" href="Varieties.FreeAlgebras.html#6425" class="Function">ψRel</a> <a id="7702" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7704" href="Algebras.Congruences.html#1854" class="InductiveConstructor">mkcon</a> <a id="7710" href="Varieties.FreeAlgebras.html#7127" class="Function">ψIsEquivalence</a> <a id="7725" class="Symbol">(</a><a id="7726" href="Varieties.FreeAlgebras.html#6736" class="Function">ψcompatible</a> <a id="7738" href="Varieties.FreeAlgebras.html#7692" class="Bound">wd</a><a id="7740" class="Symbol">)</a>

</pre>





#### <a id="hsp-theorem">HSP Theorem</a>

This section presents a formal proof of the Birkhoff HSP theorem.

To complete the proof of Birkhoff's HSP theorem, it remains to show that `Mod X (Th (V 𝒦))` is contained in `V 𝒦`; that is, every algebra that models the equations in `Th (V 𝒦)` belongs to `V 𝒦`.  This will prove that `V 𝒦` is an equational class.  (The converse, that every equational class is a variety was already proved; see the remarks at the end of this module.)

We accomplish this goal by constructing an algebra `𝔽` with the following properties:

1. `𝔽 ∈ V 𝒦` and

2. Every `𝑨 ∈ Mod X (Th (V 𝒦))` is a homomorphic image of `𝔽`.

We denote by `ℭ` the product of all subalgebras of algebras in `𝒦`, and by `homℭ` the homomorphism from `𝑻 X` to `ℭ` defined as follows: `homℭ := ⨅-hom-co (𝑻 X) 𝔄s hom𝔄`.

Here, `⨅-hom-co` (defined in [Homomorphisms.Basic](Homomorphisms.Basic.html#product-homomorphisms)) takes the term algebra `𝑻 X`, a family `{𝔄s : I → Algebra α 𝑆}` of `𝑆`-algebras, and a family `hom𝔄 : ∀ i → hom (𝑻 X) (𝔄s i)` of homomorphisms and constructs the natural homomorphism `homℭ` from `𝑻 X` to the product `ℭ := ⨅ 𝔄`.  The homomorphism `homℭ : hom (𝑻 X) (⨅ ℭ)` is natural in the sense that the `i`-th component of the image of `𝑡 : Term X` under `homℭ` is the image `∣ hom𝔄 i ∣ 𝑡` of 𝑡 under the i-th homomorphism `hom𝔄 i`.





#### <a id="F-in-classproduct">𝔽 ≤  ⨅ S(𝒦)</a>
Now we come to a step in the Agda formalization of Birkhoff's theorem that is highly nontrivial. We must prove that the free algebra embeds in the product ℭ of all subalgebras of algebras in the class `𝒦`.  This is really the only stage in the proof of Birkhoff's theorem that requires the truncation assumption that `ℭ` be a *set* (that is, `ℭ` has the [UIP][] property).  We will also need to assume several local function extensionality postulates and, as a result, the next submodule will take as given the parameter `fe : (∀ a b → funext a b)`.  This allows us to postulate local function extensionality when and where we need it in the proof. For example, if we want to assume function extensionality at universe levels 𝓥 and α, we simply apply `fe` to those universes: `fe 𝓥 α`. (Earlier versions of the library used just a single *global* function extensionality postulate at the start of most modules, but we have since decided to exchange that elegant but crude option for greater precision and transparency.)

<pre class="Agda">

<a id="10200" class="Keyword">module</a> <a id="10207" href="Varieties.FreeAlgebras.html#10207" class="Module">_</a> <a id="10209" class="Symbol">{</a><a id="10210" href="Varieties.FreeAlgebras.html#10210" class="Bound">fe</a> <a id="10213" class="Symbol">:</a> <a id="10215" href="Foundations.Extensionality.html#2465" class="Function">DFunExt</a><a id="10222" class="Symbol">}{</a><a id="10224" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="10227" class="Symbol">:</a> <a id="10229" href="Foundations.Welldefined.html#3115" class="Function">SwellDef</a><a id="10237" class="Symbol">}{</a><a id="10239" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a> <a id="10241" class="Symbol">:</a> <a id="10243" href="Varieties.FreeAlgebras.html#1281" class="Primitive">Type</a> <a id="10248" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="10249" class="Symbol">}</a> <a id="10251" class="Symbol">{</a><a id="10252" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a> <a id="10254" class="Symbol">:</a> <a id="10256" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="10261" class="Symbol">(</a><a id="10262" href="Algebras.Basic.html#6389" class="Function">Algebra</a> <a id="10270" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a> <a id="10272" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="10273" class="Symbol">)</a> <a id="10275" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a><a id="10276" class="Symbol">}</a> <a id="10278" class="Keyword">where</a>

 <a id="10286" class="Keyword">open</a> <a id="10291" href="Varieties.Preservation.html#10416" class="Module">class-products-with-maps</a> <a id="10316" class="Symbol">{</a><a id="10317" class="Argument">X</a> <a id="10319" class="Symbol">=</a> <a id="10321" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a><a id="10322" class="Symbol">}{</a><a id="10324" href="Varieties.FreeAlgebras.html#10210" class="Bound">fe</a> <a id="10327" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a> <a id="10329" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="10330" class="Symbol">}{</a><a id="10332" href="Varieties.FreeAlgebras.html#10210" class="Bound">fe</a> <a id="10335" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a> <a id="10338" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a><a id="10340" class="Symbol">}{</a><a id="10342" href="Varieties.FreeAlgebras.html#10210" class="Bound">fe</a> <a id="10345" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a> <a id="10347" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a><a id="10348" class="Symbol">}</a> <a id="10350" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a>

</pre>

We begin by constructing `ℭ`, using the techniques described in the section on <a href="https://ualib.gitlab.io/Varieties.Varieties.html#products-of-classes">products of classes</a>.

<pre class="Agda">

  <a id="10565" class="Comment">-- ℭ is the product of all subalgebras of algebras in 𝒦.</a>
 <a id="10623" href="Varieties.FreeAlgebras.html#10623" class="Function">ℭ</a> <a id="10625" class="Symbol">:</a> <a id="10627" href="Algebras.Basic.html#6389" class="Function">Algebra</a> <a id="10635" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a> <a id="10637" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a>
 <a id="10640" href="Varieties.FreeAlgebras.html#10623" class="Function">ℭ</a> <a id="10642" class="Symbol">=</a> <a id="10644" href="Algebras.Products.html#1754" class="Function">⨅</a> <a id="10646" href="Varieties.Preservation.html#11832" class="Function">𝔄&#39;</a>

</pre>

Observe that the inhabitants of `ℭ` are maps from `ℑ` to `{𝔄 i : i ∈ ℑ}`.  A homomorphism from `𝑻 X` to `ℭ` is obtained as follows.

<pre class="Agda">

 <a id="10810" href="Varieties.FreeAlgebras.html#10810" class="Function">homℭ</a> <a id="10815" class="Symbol">:</a> <a id="10817" href="Homomorphisms.Basic.html#3059" class="Function">hom</a> <a id="10821" class="Symbol">(</a><a id="10822" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="10824" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a><a id="10825" class="Symbol">)</a> <a id="10827" href="Varieties.FreeAlgebras.html#10623" class="Function">ℭ</a>
 <a id="10830" href="Varieties.FreeAlgebras.html#10810" class="Function">homℭ</a> <a id="10835" class="Symbol">=</a> <a id="10837" href="Homomorphisms.Basic.html#10671" class="Function">⨅-hom-co</a> <a id="10846" href="Varieties.Preservation.html#11832" class="Function">𝔄&#39;</a> <a id="10849" class="Symbol">(</a><a id="10850" href="Varieties.FreeAlgebras.html#10210" class="Bound">fe</a> <a id="10853" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a> <a id="10855" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="10856" class="Symbol">){</a><a id="10858" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a><a id="10859" class="Symbol">}(</a><a id="10861" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="10863" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a><a id="10864" class="Symbol">)</a> <a id="10866" class="Symbol">λ</a> <a id="10868" href="Varieties.FreeAlgebras.html#10868" class="Bound">i</a> <a id="10870" class="Symbol">→</a> <a id="10872" href="Terms.Properties.html#3076" class="Function">lift-hom</a> <a id="10881" class="Symbol">(</a><a id="10882" href="Varieties.Preservation.html#11832" class="Function">𝔄&#39;</a> <a id="10885" href="Varieties.FreeAlgebras.html#10868" class="Bound">i</a><a id="10886" class="Symbol">)(</a><a id="10888" href="Varieties.FreeAlgebras.html#1382" class="Field">snd</a> <a id="10892" href="Overture.Preliminaries.html#4193" class="Function Operator">∥</a> <a id="10894" href="Varieties.FreeAlgebras.html#10868" class="Bound">i</a> <a id="10896" href="Overture.Preliminaries.html#4193" class="Function Operator">∥</a><a id="10897" class="Symbol">)</a>

</pre>


#### <a id="the-free-algebra">The free algebra</a>

 As mentioned above, the initial version of the [Agda UniversalAlgebra][] used the free algebra `𝔉` developed above.  However, our new, more direct proof uses the algebra `𝔽`, which we now define, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

 We now define the algebra `𝔽`, which plays the role of the free algebra, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

<pre class="Agda">

 <a id="11403" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a> <a id="11405" class="Symbol">:</a> <a id="11407" href="Algebras.Basic.html#6389" class="Function">Algebra</a> <a id="11415" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a> <a id="11418" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a>
 <a id="11421" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a> <a id="11423" class="Symbol">=</a> <a id="11425" href="Homomorphisms.Basic.html#8015" class="Function Operator">ker[</a> <a id="11430" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="11432" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a> <a id="11434" href="Homomorphisms.Basic.html#8015" class="Function Operator">⇒</a> <a id="11436" href="Varieties.FreeAlgebras.html#10623" class="Function">ℭ</a> <a id="11438" href="Homomorphisms.Basic.html#8015" class="Function Operator">]</a> <a id="11440" href="Varieties.FreeAlgebras.html#10810" class="Function">homℭ</a> <a id="11445" href="Homomorphisms.Basic.html#8015" class="Function Operator">↾</a> <a id="11447" class="Symbol">(</a><a id="11448" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="11451" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="11453" class="Symbol">(</a><a id="11454" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="11457" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="11458" class="Symbol">))</a>

 <a id="11463" href="Varieties.FreeAlgebras.html#11463" class="Function">epi𝔽</a> <a id="11468" class="Symbol">:</a> <a id="11470" href="Homomorphisms.Basic.html#5930" class="Function">epi</a> <a id="11474" class="Symbol">(</a><a id="11475" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="11477" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a><a id="11478" class="Symbol">)</a> <a id="11480" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a>
 <a id="11483" href="Varieties.FreeAlgebras.html#11463" class="Function">epi𝔽</a> <a id="11488" class="Symbol">=</a> <a id="11490" href="Homomorphisms.Basic.html#9474" class="Function">πker</a> <a id="11495" class="Symbol">(</a><a id="11496" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="11499" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="11501" class="Symbol">(</a><a id="11502" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="11505" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="11506" class="Symbol">))</a> <a id="11509" class="Symbol">{</a><a id="11510" href="Varieties.FreeAlgebras.html#10623" class="Function">ℭ</a><a id="11511" class="Symbol">}</a> <a id="11513" href="Varieties.FreeAlgebras.html#10810" class="Function">homℭ</a>

 <a id="11520" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="11525" class="Symbol">:</a> <a id="11527" href="Homomorphisms.Basic.html#3059" class="Function">hom</a> <a id="11531" class="Symbol">(</a><a id="11532" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="11534" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a><a id="11535" class="Symbol">)</a> <a id="11537" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a>
 <a id="11540" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="11545" class="Symbol">=</a> <a id="11547" href="Homomorphisms.Basic.html#6397" class="Function">epi-to-hom</a> <a id="11558" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a> <a id="11560" href="Varieties.FreeAlgebras.html#11463" class="Function">epi𝔽</a>

 <a id="11567" href="Varieties.FreeAlgebras.html#11567" class="Function">hom𝔽-is-epic</a> <a id="11580" class="Symbol">:</a> <a id="11582" href="Overture.Inverses.html#3206" class="Function">IsSurjective</a> <a id="11595" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="11597" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="11602" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a>
 <a id="11605" href="Varieties.FreeAlgebras.html#11567" class="Function">hom𝔽-is-epic</a> <a id="11618" class="Symbol">=</a> <a id="11620" href="Varieties.FreeAlgebras.html#1382" class="Field">snd</a> <a id="11624" href="Overture.Preliminaries.html#4193" class="Function Operator">∥</a> <a id="11626" href="Varieties.FreeAlgebras.html#11463" class="Function">epi𝔽</a> <a id="11631" href="Overture.Preliminaries.html#4193" class="Function Operator">∥</a>

</pre>

We will need the following facts relating `homℭ`, `hom𝔽`, `and ψ`.

<pre class="Agda">

 <a id="11729" href="Varieties.FreeAlgebras.html#11729" class="Function">ψlemma0</a> <a id="11737" class="Symbol">:</a> <a id="11739" class="Symbol">∀</a> <a id="11741" href="Varieties.FreeAlgebras.html#11741" class="Bound">p</a> <a id="11743" href="Varieties.FreeAlgebras.html#11743" class="Bound">q</a> <a id="11745" class="Symbol">→</a>  <a id="11748" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="11750" href="Varieties.FreeAlgebras.html#10810" class="Function">homℭ</a> <a id="11755" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="11757" href="Varieties.FreeAlgebras.html#11741" class="Bound">p</a> <a id="11759" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="11761" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="11763" href="Varieties.FreeAlgebras.html#10810" class="Function">homℭ</a> <a id="11768" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="11770" href="Varieties.FreeAlgebras.html#11743" class="Bound">q</a>  <a id="11773" class="Symbol">→</a> <a id="11775" class="Symbol">(</a><a id="11776" href="Varieties.FreeAlgebras.html#11741" class="Bound">p</a> <a id="11778" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11780" href="Varieties.FreeAlgebras.html#11743" class="Bound">q</a><a id="11781" class="Symbol">)</a> <a id="11783" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="11785" href="Varieties.FreeAlgebras.html#6141" class="Function">ψ</a> <a id="11787" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a>
 <a id="11790" href="Varieties.FreeAlgebras.html#11729" class="Function">ψlemma0</a> <a id="11798" href="Varieties.FreeAlgebras.html#11798" class="Bound">p</a> <a id="11800" href="Varieties.FreeAlgebras.html#11800" class="Bound">q</a> <a id="11802" href="Varieties.FreeAlgebras.html#11802" class="Bound">phomℭq</a> <a id="11809" href="Varieties.FreeAlgebras.html#11809" class="Bound">𝑨</a> <a id="11811" href="Varieties.FreeAlgebras.html#11811" class="Bound">sA</a> <a id="11814" href="Varieties.FreeAlgebras.html#11814" class="Bound">h</a> <a id="11816" class="Symbol">=</a> <a id="11818" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="11827" href="Varieties.FreeAlgebras.html#11802" class="Bound">phomℭq</a> <a id="11834" class="Symbol">(</a><a id="11835" href="Varieties.FreeAlgebras.html#11809" class="Bound">𝑨</a> <a id="11837" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11839" href="Varieties.FreeAlgebras.html#11811" class="Bound">sA</a> <a id="11842" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11844" href="Varieties.FreeAlgebras.html#11814" class="Bound">h</a><a id="11845" class="Symbol">)</a>

 <a id="11849" href="Varieties.FreeAlgebras.html#11849" class="Function">ψlemma0-ap</a> <a id="11860" class="Symbol">:</a> <a id="11862" class="Symbol">{</a><a id="11863" href="Varieties.FreeAlgebras.html#11863" class="Bound">𝑨</a> <a id="11865" class="Symbol">:</a> <a id="11867" href="Algebras.Basic.html#6389" class="Function">Algebra</a> <a id="11875" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a> <a id="11877" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="11878" class="Symbol">}{</a><a id="11880" href="Varieties.FreeAlgebras.html#11880" class="Bound">h</a> <a id="11882" class="Symbol">:</a> <a id="11884" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a> <a id="11886" class="Symbol">→</a> <a id="11888" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="11890" href="Varieties.FreeAlgebras.html#11863" class="Bound">𝑨</a> <a id="11892" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a><a id="11893" class="Symbol">}</a> <a id="11895" class="Symbol">→</a> <a id="11897" href="Varieties.FreeAlgebras.html#11863" class="Bound">𝑨</a> <a id="11899" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="11901" href="Varieties.Closure.html#3819" class="Datatype">S</a><a id="11902" class="Symbol">{</a><a id="11903" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="11904" class="Symbol">}{</a><a id="11906" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="11907" class="Symbol">}</a> <a id="11909" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a>
  <a id="11913" class="Symbol">→</a>           <a id="11925" href="Relations.Discrete.html#3791" class="Function">kernel</a> <a id="11932" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="11934" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="11939" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="11941" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="11943" href="Relations.Discrete.html#3791" class="Function">kernel</a> <a id="11950" class="Symbol">(</a><a id="11951" href="Terms.Properties.html#2369" class="Function">free-lift</a> <a id="11961" href="Varieties.FreeAlgebras.html#11863" class="Bound">𝑨</a> <a id="11963" href="Varieties.FreeAlgebras.html#11880" class="Bound">h</a><a id="11964" class="Symbol">)</a>

 <a id="11968" href="Varieties.FreeAlgebras.html#11849" class="Function">ψlemma0-ap</a> <a id="11979" class="Symbol">{</a><a id="11980" href="Varieties.FreeAlgebras.html#11980" class="Bound">𝑨</a><a id="11981" class="Symbol">}{</a><a id="11983" href="Varieties.FreeAlgebras.html#11983" class="Bound">h</a><a id="11984" class="Symbol">}</a> <a id="11986" href="Varieties.FreeAlgebras.html#11986" class="Bound">skA</a> <a id="11990" class="Symbol">{</a><a id="11991" href="Varieties.FreeAlgebras.html#11991" class="Bound">p</a> <a id="11993" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11995" href="Varieties.FreeAlgebras.html#11995" class="Bound">q</a><a id="11996" class="Symbol">}</a> <a id="11998" href="Varieties.FreeAlgebras.html#11998" class="Bound">x</a> <a id="12000" class="Symbol">=</a> <a id="12002" href="Varieties.FreeAlgebras.html#12145" class="Function">γ</a> <a id="12004" class="Keyword">where</a>

  <a id="12013" href="Varieties.FreeAlgebras.html#12013" class="Function">ν</a> <a id="12015" class="Symbol">:</a> <a id="12017" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="12019" href="Varieties.FreeAlgebras.html#10810" class="Function">homℭ</a> <a id="12024" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="12026" href="Varieties.FreeAlgebras.html#11991" class="Bound">p</a> <a id="12028" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12030" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="12032" href="Varieties.FreeAlgebras.html#10810" class="Function">homℭ</a> <a id="12037" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="12039" href="Varieties.FreeAlgebras.html#11995" class="Bound">q</a>
  <a id="12043" href="Varieties.FreeAlgebras.html#12013" class="Function">ν</a> <a id="12045" class="Symbol">=</a> <a id="12047" href="Homomorphisms.Basic.html#9983" class="Function">ker-in-con</a> <a id="12058" class="Symbol">{</a><a id="12059" class="Argument">α</a> <a id="12061" class="Symbol">=</a> <a id="12063" class="Symbol">(</a><a id="12064" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="12067" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="12068" class="Symbol">)}{</a><a id="12071" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="12074" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="12075" class="Symbol">}{</a><a id="12077" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="12079" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a><a id="12080" class="Symbol">}{</a><a id="12082" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="12085" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="12087" class="Symbol">(</a><a id="12088" href="Varieties.FreeAlgebras.html#892" class="Primitive">lsuc</a> <a id="12093" class="Symbol">(</a><a id="12094" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="12097" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="12098" class="Symbol">))}(</a><a id="12102" href="Homomorphisms.Basic.html#7607" class="Function">kercon</a> <a id="12109" class="Symbol">(</a><a id="12110" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="12113" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="12115" class="Symbol">(</a><a id="12116" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="12119" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="12120" class="Symbol">))</a> <a id="12123" class="Symbol">{</a><a id="12124" href="Varieties.FreeAlgebras.html#10623" class="Function">ℭ</a><a id="12125" class="Symbol">}</a> <a id="12127" href="Varieties.FreeAlgebras.html#10810" class="Function">homℭ</a><a id="12131" class="Symbol">)</a> <a id="12133" class="Symbol">{</a><a id="12134" href="Varieties.FreeAlgebras.html#11991" class="Bound">p</a><a id="12135" class="Symbol">}{</a><a id="12137" href="Varieties.FreeAlgebras.html#11995" class="Bound">q</a><a id="12138" class="Symbol">}</a> <a id="12140" href="Varieties.FreeAlgebras.html#11998" class="Bound">x</a>

  <a id="12145" href="Varieties.FreeAlgebras.html#12145" class="Function">γ</a> <a id="12147" class="Symbol">:</a> <a id="12149" class="Symbol">(</a><a id="12150" href="Terms.Properties.html#2369" class="Function">free-lift</a> <a id="12160" href="Varieties.FreeAlgebras.html#11980" class="Bound">𝑨</a> <a id="12162" href="Varieties.FreeAlgebras.html#11983" class="Bound">h</a><a id="12163" class="Symbol">)</a> <a id="12165" href="Varieties.FreeAlgebras.html#11991" class="Bound">p</a> <a id="12167" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12169" class="Symbol">(</a><a id="12170" href="Terms.Properties.html#2369" class="Function">free-lift</a> <a id="12180" href="Varieties.FreeAlgebras.html#11980" class="Bound">𝑨</a> <a id="12182" href="Varieties.FreeAlgebras.html#11983" class="Bound">h</a><a id="12183" class="Symbol">)</a> <a id="12185" href="Varieties.FreeAlgebras.html#11995" class="Bound">q</a>
  <a id="12189" href="Varieties.FreeAlgebras.html#12145" class="Function">γ</a> <a id="12191" class="Symbol">=</a> <a id="12193" class="Symbol">((</a><a id="12195" href="Varieties.FreeAlgebras.html#11729" class="Function">ψlemma0</a> <a id="12203" href="Varieties.FreeAlgebras.html#11991" class="Bound">p</a> <a id="12205" href="Varieties.FreeAlgebras.html#11995" class="Bound">q</a><a id="12206" class="Symbol">)</a> <a id="12208" href="Varieties.FreeAlgebras.html#12013" class="Function">ν</a><a id="12209" class="Symbol">)</a> <a id="12211" href="Varieties.FreeAlgebras.html#11980" class="Bound">𝑨</a> <a id="12213" href="Varieties.FreeAlgebras.html#11986" class="Bound">skA</a> <a id="12217" href="Varieties.FreeAlgebras.html#11983" class="Bound">h</a>


</pre>

We now use `ψlemma0-ap` to prove that every map `h : X → ∣ 𝑨 ∣`, from `X` to a subalgebra `𝑨 ∈ S 𝒦` of `𝒦`, lifts to a homomorphism from `𝔽` to `𝑨`.

<pre class="Agda">

 <a id="12398" href="Varieties.FreeAlgebras.html#12398" class="Function">𝔽-lift-hom</a> <a id="12409" class="Symbol">:</a> <a id="12411" class="Symbol">(</a><a id="12412" href="Varieties.FreeAlgebras.html#12412" class="Bound">𝑨</a> <a id="12414" class="Symbol">:</a> <a id="12416" href="Algebras.Basic.html#6389" class="Function">Algebra</a> <a id="12424" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a> <a id="12426" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="12427" class="Symbol">)</a> <a id="12429" class="Symbol">→</a> <a id="12431" href="Varieties.FreeAlgebras.html#12412" class="Bound">𝑨</a> <a id="12433" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12435" href="Varieties.Closure.html#3819" class="Datatype">S</a><a id="12436" class="Symbol">{</a><a id="12437" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="12438" class="Symbol">}{</a><a id="12440" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="12441" class="Symbol">}</a> <a id="12443" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a> <a id="12445" class="Symbol">→</a> <a id="12447" class="Symbol">(</a><a id="12448" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a> <a id="12450" class="Symbol">→</a> <a id="12452" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="12454" href="Varieties.FreeAlgebras.html#12412" class="Bound">𝑨</a> <a id="12456" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a><a id="12457" class="Symbol">)</a> <a id="12459" class="Symbol">→</a> <a id="12461" href="Homomorphisms.Basic.html#3059" class="Function">hom</a> <a id="12465" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a> <a id="12467" href="Varieties.FreeAlgebras.html#12412" class="Bound">𝑨</a>
 <a id="12470" href="Varieties.FreeAlgebras.html#12398" class="Function">𝔽-lift-hom</a> <a id="12481" href="Varieties.FreeAlgebras.html#12481" class="Bound">𝑨</a> <a id="12483" href="Varieties.FreeAlgebras.html#12483" class="Bound">skA</a> <a id="12487" href="Varieties.FreeAlgebras.html#12487" class="Bound">h</a> <a id="12489" class="Symbol">=</a> <a id="12491" href="Varieties.FreeAlgebras.html#1367" class="Field">fst</a><a id="12494" class="Symbol">(</a><a id="12495" href="Homomorphisms.Noether.html#8545" class="Function">HomFactor</a> <a id="12505" class="Symbol">(</a><a id="12506" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="12509" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="12511" class="Symbol">(</a><a id="12512" href="Varieties.FreeAlgebras.html#892" class="Primitive">lsuc</a> <a id="12517" class="Symbol">(</a><a id="12518" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="12521" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="12522" class="Symbol">)))</a>  <a id="12527" href="Varieties.FreeAlgebras.html#12481" class="Bound">𝑨</a> <a id="12529" class="Symbol">(</a><a id="12530" href="Terms.Properties.html#3076" class="Function">lift-hom</a> <a id="12539" href="Varieties.FreeAlgebras.html#12481" class="Bound">𝑨</a> <a id="12541" href="Varieties.FreeAlgebras.html#12487" class="Bound">h</a><a id="12542" class="Symbol">)</a> <a id="12544" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="12549" class="Symbol">(</a><a id="12550" href="Varieties.FreeAlgebras.html#11849" class="Function">ψlemma0-ap</a> <a id="12561" href="Varieties.FreeAlgebras.html#12483" class="Bound">skA</a><a id="12564" class="Symbol">)</a> <a id="12566" href="Varieties.FreeAlgebras.html#11567" class="Function">hom𝔽-is-epic</a><a id="12578" class="Symbol">)</a>

</pre>


#### <a id="k-models-psi">𝒦 models ψ</a>

The goal of this subsection is to prove that `𝒦` models `ψ 𝒦`. In other terms, for all pairs `(p , q) ∈ Term X × Term X` of terms, if `(p , q) ∈ ψ 𝒦`, then `𝒦 ⊫ p ≈ q`.

Next we define the lift of the natural embedding from `X` into 𝔽. We denote this homomorphism by `𝔑 : hom (𝑻 X) 𝔽` and define it as follows.

<pre class="Agda">

 <a id="12963" class="Keyword">open</a> <a id="12968" href="Algebras.Congruences.html#1766" class="Module">IsCongruence</a>

 <a id="12983" href="Varieties.FreeAlgebras.html#12983" class="Function">X↪𝔽</a> <a id="12987" class="Symbol">:</a> <a id="12989" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a> <a id="12991" class="Symbol">→</a> <a id="12993" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="12995" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a> <a id="12997" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a>
 <a id="13000" href="Varieties.FreeAlgebras.html#12983" class="Function">X↪𝔽</a> <a id="13004" href="Varieties.FreeAlgebras.html#13004" class="Bound">x</a> <a id="13006" class="Symbol">=</a> <a id="13008" href="Relations.Quotients.html#4803" class="Function Operator">⟪</a> <a id="13010" href="Terms.Basic.html#1864" class="InductiveConstructor">ℊ</a> <a id="13012" href="Varieties.FreeAlgebras.html#13004" class="Bound">x</a> <a id="13014" href="Relations.Quotients.html#4803" class="Function Operator">⟫</a> <a id="13016" class="Comment">-- (the implicit relation here is  ⟨ kercon (fe 𝓥 𝓕) ℭ homℭ ⟩ )</a>

 <a id="13082" href="Varieties.FreeAlgebras.html#13082" class="Function">𝔑</a> <a id="13084" class="Symbol">:</a> <a id="13086" href="Homomorphisms.Basic.html#3059" class="Function">hom</a> <a id="13090" class="Symbol">(</a><a id="13091" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="13093" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a><a id="13094" class="Symbol">)</a> <a id="13096" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a>
 <a id="13099" href="Varieties.FreeAlgebras.html#13082" class="Function">𝔑</a> <a id="13101" class="Symbol">=</a> <a id="13103" href="Terms.Properties.html#3076" class="Function">lift-hom</a> <a id="13112" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a> <a id="13114" href="Varieties.FreeAlgebras.html#12983" class="Function">X↪𝔽</a>

</pre>

It turns out that the homomorphism so defined is equivalent to `hom𝔽`.

<pre class="Agda">
 <a id="13217" class="Keyword">open</a> <a id="13222" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="13236" href="Varieties.FreeAlgebras.html#13236" class="Function">hom𝔽-is-lift-hom</a> <a id="13253" class="Symbol">:</a> <a id="13255" class="Symbol">∀</a> <a id="13257" href="Varieties.FreeAlgebras.html#13257" class="Bound">p</a> <a id="13259" class="Symbol">→</a> <a id="13261" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13263" href="Varieties.FreeAlgebras.html#13082" class="Function">𝔑</a> <a id="13265" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13267" href="Varieties.FreeAlgebras.html#13257" class="Bound">p</a> <a id="13269" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13271" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13273" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="13278" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13280" href="Varieties.FreeAlgebras.html#13257" class="Bound">p</a>
 <a id="13283" href="Varieties.FreeAlgebras.html#13236" class="Function">hom𝔽-is-lift-hom</a> <a id="13300" class="Symbol">(</a><a id="13301" href="Terms.Basic.html#1864" class="InductiveConstructor">ℊ</a> <a id="13303" href="Varieties.FreeAlgebras.html#13303" class="Bound">x</a><a id="13304" class="Symbol">)</a> <a id="13306" class="Symbol">=</a> <a id="13308" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
 <a id="13314" href="Varieties.FreeAlgebras.html#13236" class="Function">hom𝔽-is-lift-hom</a> <a id="13331" class="Symbol">(</a><a id="13332" href="Terms.Basic.html#1906" class="InductiveConstructor">node</a> <a id="13337" href="Varieties.FreeAlgebras.html#13337" class="Bound">𝑓</a> <a id="13339" href="Varieties.FreeAlgebras.html#13339" class="Bound">𝒕</a><a id="13340" class="Symbol">)</a> <a id="13342" class="Symbol">=</a>
  <a id="13346" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13348" href="Varieties.FreeAlgebras.html#13082" class="Function">𝔑</a> <a id="13350" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13352" class="Symbol">(</a><a id="13353" href="Terms.Basic.html#1906" class="InductiveConstructor">node</a> <a id="13358" href="Varieties.FreeAlgebras.html#13337" class="Bound">𝑓</a> <a id="13360" href="Varieties.FreeAlgebras.html#13339" class="Bound">𝒕</a><a id="13361" class="Symbol">)</a>              <a id="13376" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13379" href="Overture.Preliminaries.html#4193" class="Function Operator">∥</a> <a id="13381" href="Varieties.FreeAlgebras.html#13082" class="Function">𝔑</a> <a id="13383" href="Overture.Preliminaries.html#4193" class="Function Operator">∥</a> <a id="13385" href="Varieties.FreeAlgebras.html#13337" class="Bound">𝑓</a> <a id="13387" href="Varieties.FreeAlgebras.html#13339" class="Bound">𝒕</a> <a id="13389" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13393" class="Symbol">(</a><a id="13394" href="Varieties.FreeAlgebras.html#13337" class="Bound">𝑓</a> <a id="13396" href="Algebras.Basic.html#9889" class="Function Operator">̂</a> <a id="13398" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a><a id="13399" class="Symbol">)(λ</a> <a id="13403" href="Varieties.FreeAlgebras.html#13403" class="Bound">i</a> <a id="13405" class="Symbol">→</a> <a id="13407" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13409" href="Varieties.FreeAlgebras.html#13082" class="Function">𝔑</a> <a id="13411" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a><a id="13412" class="Symbol">(</a><a id="13413" href="Varieties.FreeAlgebras.html#13339" class="Bound">𝒕</a> <a id="13415" href="Varieties.FreeAlgebras.html#13403" class="Bound">i</a><a id="13416" class="Symbol">))</a>     <a id="13423" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13426" href="Varieties.FreeAlgebras.html#13534" class="Function">wd-proof</a> <a id="13435" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13439" class="Symbol">(</a><a id="13440" href="Varieties.FreeAlgebras.html#13337" class="Bound">𝑓</a> <a id="13442" href="Algebras.Basic.html#9889" class="Function Operator">̂</a> <a id="13444" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a><a id="13445" class="Symbol">)(λ</a> <a id="13449" href="Varieties.FreeAlgebras.html#13449" class="Bound">i</a> <a id="13451" class="Symbol">→</a> <a id="13453" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13455" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="13460" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13462" class="Symbol">(</a><a id="13463" href="Varieties.FreeAlgebras.html#13339" class="Bound">𝒕</a> <a id="13465" href="Varieties.FreeAlgebras.html#13449" class="Bound">i</a><a id="13466" class="Symbol">))</a> <a id="13469" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13472" class="Symbol">(</a><a id="13473" href="Overture.Preliminaries.html#4193" class="Function Operator">∥</a> <a id="13475" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="13480" href="Overture.Preliminaries.html#4193" class="Function Operator">∥</a> <a id="13482" href="Varieties.FreeAlgebras.html#13337" class="Bound">𝑓</a> <a id="13484" href="Varieties.FreeAlgebras.html#13339" class="Bound">𝒕</a><a id="13485" class="Symbol">)</a><a id="13486" href="Overture.Preliminaries.html#4859" class="Function Operator">⁻¹</a> <a id="13489" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13493" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13495" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="13500" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13502" class="Symbol">(</a><a id="13503" href="Terms.Basic.html#1906" class="InductiveConstructor">node</a> <a id="13508" href="Varieties.FreeAlgebras.html#13337" class="Bound">𝑓</a> <a id="13510" href="Varieties.FreeAlgebras.html#13339" class="Bound">𝒕</a><a id="13511" class="Symbol">)</a>           <a id="13523" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>
   <a id="13528" class="Keyword">where</a> <a id="13534" href="Varieties.FreeAlgebras.html#13534" class="Function">wd-proof</a> <a id="13543" class="Symbol">=</a> <a id="13545" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="13548" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="13550" class="Symbol">(</a><a id="13551" href="Varieties.FreeAlgebras.html#892" class="Primitive">lsuc</a> <a id="13556" class="Symbol">(</a><a id="13557" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="13560" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="13561" class="Symbol">))</a>
                    <a id="13584" class="Symbol">(</a><a id="13585" href="Varieties.FreeAlgebras.html#13337" class="Bound">𝑓</a> <a id="13587" href="Algebras.Basic.html#9889" class="Function Operator">̂</a> <a id="13589" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a><a id="13590" class="Symbol">)</a> <a id="13592" class="Symbol">(λ</a> <a id="13595" href="Varieties.FreeAlgebras.html#13595" class="Bound">i</a> <a id="13597" class="Symbol">→</a> <a id="13599" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13601" href="Varieties.FreeAlgebras.html#13082" class="Function">𝔑</a> <a id="13603" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a><a id="13604" class="Symbol">(</a><a id="13605" href="Varieties.FreeAlgebras.html#13339" class="Bound">𝒕</a> <a id="13607" href="Varieties.FreeAlgebras.html#13595" class="Bound">i</a><a id="13608" class="Symbol">))</a> <a id="13611" class="Symbol">(λ</a> <a id="13614" href="Varieties.FreeAlgebras.html#13614" class="Bound">i</a> <a id="13616" class="Symbol">→</a> <a id="13618" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13620" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="13625" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13627" class="Symbol">(</a><a id="13628" href="Varieties.FreeAlgebras.html#13339" class="Bound">𝒕</a> <a id="13630" href="Varieties.FreeAlgebras.html#13614" class="Bound">i</a><a id="13631" class="Symbol">))</a>
                    <a id="13654" class="Symbol">(λ</a> <a id="13657" href="Varieties.FreeAlgebras.html#13657" class="Bound">x</a> <a id="13659" class="Symbol">→</a> <a id="13661" href="Varieties.FreeAlgebras.html#13236" class="Function">hom𝔽-is-lift-hom</a><a id="13677" class="Symbol">(</a><a id="13678" href="Varieties.FreeAlgebras.html#13339" class="Bound">𝒕</a> <a id="13680" href="Varieties.FreeAlgebras.html#13657" class="Bound">x</a><a id="13681" class="Symbol">))</a>
</pre>

We need a three more lemmas before we are ready to tackle our main goal.

<pre class="Agda">

 <a id="13785" href="Varieties.FreeAlgebras.html#13785" class="Function">ψlemma1</a> <a id="13793" class="Symbol">:</a> <a id="13795" href="Relations.Discrete.html#3791" class="Function">kernel</a> <a id="13802" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13804" href="Varieties.FreeAlgebras.html#13082" class="Function">𝔑</a> <a id="13806" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13808" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="13810" href="Varieties.FreeAlgebras.html#6141" class="Function">ψ</a> <a id="13812" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a>
 <a id="13815" href="Varieties.FreeAlgebras.html#13785" class="Function">ψlemma1</a> <a id="13823" class="Symbol">{</a><a id="13824" href="Varieties.FreeAlgebras.html#13824" class="Bound">p</a> <a id="13826" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13828" href="Varieties.FreeAlgebras.html#13828" class="Bound">q</a><a id="13829" class="Symbol">}</a> <a id="13831" href="Varieties.FreeAlgebras.html#13831" class="Bound">𝔑pq</a> <a id="13835" href="Varieties.FreeAlgebras.html#13835" class="Bound">𝑨</a> <a id="13837" href="Varieties.FreeAlgebras.html#13837" class="Bound">sA</a> <a id="13840" href="Varieties.FreeAlgebras.html#13840" class="Bound">h</a> <a id="13842" class="Symbol">=</a> <a id="13844" href="Varieties.FreeAlgebras.html#14065" class="Function">γ</a>
  <a id="13848" class="Keyword">where</a>
   <a id="13857" href="Varieties.FreeAlgebras.html#13857" class="Function">f</a> <a id="13859" class="Symbol">:</a> <a id="13861" href="Homomorphisms.Basic.html#3059" class="Function">hom</a> <a id="13865" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a> <a id="13867" href="Varieties.FreeAlgebras.html#13835" class="Bound">𝑨</a>
   <a id="13872" href="Varieties.FreeAlgebras.html#13857" class="Function">f</a> <a id="13874" class="Symbol">=</a> <a id="13876" href="Varieties.FreeAlgebras.html#12398" class="Function">𝔽-lift-hom</a> <a id="13887" href="Varieties.FreeAlgebras.html#13835" class="Bound">𝑨</a> <a id="13889" href="Varieties.FreeAlgebras.html#13837" class="Bound">sA</a> <a id="13892" href="Varieties.FreeAlgebras.html#13840" class="Bound">h</a>

   <a id="13898" href="Varieties.FreeAlgebras.html#13898" class="Function">h&#39;</a> <a id="13901" href="Varieties.FreeAlgebras.html#13901" class="Function">φ</a> <a id="13903" class="Symbol">:</a> <a id="13905" href="Homomorphisms.Basic.html#3059" class="Function">hom</a> <a id="13909" class="Symbol">(</a><a id="13910" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="13912" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a><a id="13913" class="Symbol">)</a> <a id="13915" href="Varieties.FreeAlgebras.html#13835" class="Bound">𝑨</a>
   <a id="13920" href="Varieties.FreeAlgebras.html#13898" class="Function">h&#39;</a> <a id="13923" class="Symbol">=</a> <a id="13925" href="Homomorphisms.Basic.html#3421" class="Function">∘-hom</a> <a id="13931" class="Symbol">(</a><a id="13932" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="13934" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a><a id="13935" class="Symbol">)</a> <a id="13937" href="Varieties.FreeAlgebras.html#13835" class="Bound">𝑨</a> <a id="13939" href="Varieties.FreeAlgebras.html#13082" class="Function">𝔑</a> <a id="13941" href="Varieties.FreeAlgebras.html#13857" class="Function">f</a>
   <a id="13946" href="Varieties.FreeAlgebras.html#13901" class="Function">φ</a> <a id="13948" class="Symbol">=</a> <a id="13950" href="Terms.Properties.html#3076" class="Function">lift-hom</a> <a id="13959" href="Varieties.FreeAlgebras.html#13835" class="Bound">𝑨</a> <a id="13961" href="Varieties.FreeAlgebras.html#13840" class="Bound">h</a>

   <a id="13967" href="Varieties.FreeAlgebras.html#13967" class="Function">h≡φ</a> <a id="13971" class="Symbol">:</a> <a id="13973" class="Symbol">∀</a> <a id="13975" href="Varieties.FreeAlgebras.html#13975" class="Bound">t</a> <a id="13977" class="Symbol">→</a> <a id="13979" class="Symbol">(</a><a id="13980" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13982" href="Varieties.FreeAlgebras.html#13857" class="Function">f</a> <a id="13984" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13986" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="13988" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="13990" href="Varieties.FreeAlgebras.html#13082" class="Function">𝔑</a> <a id="13992" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a><a id="13993" class="Symbol">)</a> <a id="13995" href="Varieties.FreeAlgebras.html#13975" class="Bound">t</a> <a id="13997" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13999" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14001" href="Varieties.FreeAlgebras.html#13901" class="Function">φ</a> <a id="14003" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14005" href="Varieties.FreeAlgebras.html#13975" class="Bound">t</a>
   <a id="14010" href="Varieties.FreeAlgebras.html#13967" class="Function">h≡φ</a> <a id="14014" href="Varieties.FreeAlgebras.html#14014" class="Bound">t</a> <a id="14016" class="Symbol">=</a> <a id="14018" href="Terms.Properties.html#3475" class="Function">free-unique</a> <a id="14030" class="Symbol">(</a><a id="14031" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="14034" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="14036" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="14037" class="Symbol">)</a> <a id="14039" href="Varieties.FreeAlgebras.html#13835" class="Bound">𝑨</a> <a id="14041" href="Varieties.FreeAlgebras.html#13898" class="Function">h&#39;</a> <a id="14044" href="Varieties.FreeAlgebras.html#13901" class="Function">φ</a> <a id="14046" class="Symbol">(λ</a> <a id="14049" href="Varieties.FreeAlgebras.html#14049" class="Bound">x</a> <a id="14051" class="Symbol">→</a> <a id="14053" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="14057" class="Symbol">)</a> <a id="14059" href="Varieties.FreeAlgebras.html#14014" class="Bound">t</a>

   <a id="14065" href="Varieties.FreeAlgebras.html#14065" class="Function">γ</a> <a id="14067" class="Symbol">:</a> <a id="14069" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14071" href="Varieties.FreeAlgebras.html#13901" class="Function">φ</a> <a id="14073" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14075" href="Varieties.FreeAlgebras.html#13824" class="Bound">p</a> <a id="14077" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14079" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14081" href="Varieties.FreeAlgebras.html#13901" class="Function">φ</a> <a id="14083" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14085" href="Varieties.FreeAlgebras.html#13828" class="Bound">q</a>
   <a id="14090" href="Varieties.FreeAlgebras.html#14065" class="Function">γ</a> <a id="14092" class="Symbol">=</a> <a id="14094" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14096" href="Varieties.FreeAlgebras.html#13901" class="Function">φ</a> <a id="14098" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14100" href="Varieties.FreeAlgebras.html#13824" class="Bound">p</a>             <a id="14114" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14117" class="Symbol">(</a><a id="14118" href="Varieties.FreeAlgebras.html#13967" class="Function">h≡φ</a> <a id="14122" href="Varieties.FreeAlgebras.html#13824" class="Bound">p</a><a id="14123" class="Symbol">)</a><a id="14124" href="Overture.Preliminaries.html#4859" class="Function Operator">⁻¹</a> <a id="14127" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14136" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14138" href="Varieties.FreeAlgebras.html#13857" class="Function">f</a> <a id="14140" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14142" class="Symbol">(</a> <a id="14144" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14146" href="Varieties.FreeAlgebras.html#13082" class="Function">𝔑</a> <a id="14148" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14150" href="Varieties.FreeAlgebras.html#13824" class="Bound">p</a> <a id="14152" class="Symbol">)</a>   <a id="14156" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14159" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="14164" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14166" href="Varieties.FreeAlgebras.html#13857" class="Function">f</a> <a id="14168" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14170" href="Varieties.FreeAlgebras.html#13831" class="Bound">𝔑pq</a> <a id="14174" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14183" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14185" href="Varieties.FreeAlgebras.html#13857" class="Function">f</a> <a id="14187" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14189" class="Symbol">(</a> <a id="14191" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14193" href="Varieties.FreeAlgebras.html#13082" class="Function">𝔑</a> <a id="14195" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14197" href="Varieties.FreeAlgebras.html#13828" class="Bound">q</a> <a id="14199" class="Symbol">)</a>   <a id="14203" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14206" href="Varieties.FreeAlgebras.html#13967" class="Function">h≡φ</a> <a id="14210" href="Varieties.FreeAlgebras.html#13828" class="Bound">q</a> <a id="14212" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14221" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14223" href="Varieties.FreeAlgebras.html#13901" class="Function">φ</a> <a id="14225" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14227" href="Varieties.FreeAlgebras.html#13828" class="Bound">q</a>             <a id="14241" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>


 <a id="14246" href="Varieties.FreeAlgebras.html#14246" class="Function">ψlemma2</a> <a id="14254" class="Symbol">:</a> <a id="14256" href="Relations.Discrete.html#3791" class="Function">kernel</a> <a id="14263" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14265" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="14270" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14272" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="14274" href="Varieties.FreeAlgebras.html#6141" class="Function">ψ</a> <a id="14276" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a>
 <a id="14279" href="Varieties.FreeAlgebras.html#14246" class="Function">ψlemma2</a> <a id="14287" class="Symbol">{</a><a id="14288" href="Varieties.FreeAlgebras.html#14288" class="Bound">p</a> <a id="14290" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14292" href="Varieties.FreeAlgebras.html#14292" class="Bound">q</a><a id="14293" class="Symbol">}</a> <a id="14295" href="Varieties.FreeAlgebras.html#14295" class="Bound">x</a> <a id="14297" class="Symbol">=</a> <a id="14299" href="Varieties.FreeAlgebras.html#13785" class="Function">ψlemma1</a> <a id="14307" class="Symbol">{</a><a id="14308" href="Varieties.FreeAlgebras.html#14288" class="Bound">p</a> <a id="14310" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14312" href="Varieties.FreeAlgebras.html#14292" class="Bound">q</a><a id="14313" class="Symbol">}</a> <a id="14315" href="Varieties.FreeAlgebras.html#14330" class="Function">γ</a>
   <a id="14320" class="Keyword">where</a>
    <a id="14330" href="Varieties.FreeAlgebras.html#14330" class="Function">γ</a> <a id="14332" class="Symbol">:</a> <a id="14334" class="Symbol">(</a><a id="14335" href="Terms.Properties.html#2369" class="Function">free-lift</a> <a id="14345" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a> <a id="14347" href="Varieties.FreeAlgebras.html#12983" class="Function">X↪𝔽</a><a id="14350" class="Symbol">)</a> <a id="14352" href="Varieties.FreeAlgebras.html#14288" class="Bound">p</a> <a id="14354" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14356" class="Symbol">(</a><a id="14357" href="Terms.Properties.html#2369" class="Function">free-lift</a> <a id="14367" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a> <a id="14369" href="Varieties.FreeAlgebras.html#12983" class="Function">X↪𝔽</a><a id="14372" class="Symbol">)</a> <a id="14374" href="Varieties.FreeAlgebras.html#14292" class="Bound">q</a>
    <a id="14380" href="Varieties.FreeAlgebras.html#14330" class="Function">γ</a> <a id="14382" class="Symbol">=</a> <a id="14384" class="Symbol">(</a><a id="14385" href="Varieties.FreeAlgebras.html#13236" class="Function">hom𝔽-is-lift-hom</a> <a id="14402" href="Varieties.FreeAlgebras.html#14288" class="Bound">p</a><a id="14403" class="Symbol">)</a> <a id="14405" href="Overture.Preliminaries.html#5185" class="Function Operator">∙</a> <a id="14407" href="Varieties.FreeAlgebras.html#14295" class="Bound">x</a> <a id="14409" href="Overture.Preliminaries.html#5185" class="Function Operator">∙</a> <a id="14411" class="Symbol">(</a><a id="14412" href="Varieties.FreeAlgebras.html#13236" class="Function">hom𝔽-is-lift-hom</a> <a id="14429" href="Varieties.FreeAlgebras.html#14292" class="Bound">q</a><a id="14430" class="Symbol">)</a><a id="14431" href="Overture.Preliminaries.html#4859" class="Function Operator">⁻¹</a>


 <a id="14437" href="Varieties.FreeAlgebras.html#14437" class="Function">ψlemma3</a> <a id="14445" class="Symbol">:</a> <a id="14447" class="Symbol">∀</a> <a id="14449" href="Varieties.FreeAlgebras.html#14449" class="Bound">p</a> <a id="14451" href="Varieties.FreeAlgebras.html#14451" class="Bound">q</a> <a id="14453" class="Symbol">→</a> <a id="14455" class="Symbol">(</a><a id="14456" href="Varieties.FreeAlgebras.html#14449" class="Bound">p</a> <a id="14458" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14460" href="Varieties.FreeAlgebras.html#14451" class="Bound">q</a><a id="14461" class="Symbol">)</a> <a id="14463" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="14465" href="Varieties.FreeAlgebras.html#6141" class="Function">ψ</a><a id="14466" class="Symbol">{</a><a id="14467" class="Argument">X</a> <a id="14469" class="Symbol">=</a> <a id="14471" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a><a id="14472" class="Symbol">}</a> <a id="14474" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a> <a id="14476" class="Symbol">→</a> <a id="14478" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a> <a id="14480" href="Varieties.EquationalLogic.html#2558" class="Function Operator">⊫</a> <a id="14482" href="Varieties.FreeAlgebras.html#14449" class="Bound">p</a> <a id="14484" href="Varieties.EquationalLogic.html#2558" class="Function Operator">≈</a> <a id="14486" href="Varieties.FreeAlgebras.html#14451" class="Bound">q</a>
 <a id="14489" href="Varieties.FreeAlgebras.html#14437" class="Function">ψlemma3</a> <a id="14497" href="Varieties.FreeAlgebras.html#14497" class="Bound">p</a> <a id="14499" href="Varieties.FreeAlgebras.html#14499" class="Bound">q</a> <a id="14501" href="Varieties.FreeAlgebras.html#14501" class="Bound">pψq</a> <a id="14505" class="Symbol">{</a><a id="14506" href="Varieties.FreeAlgebras.html#14506" class="Bound">𝑨</a><a id="14507" class="Symbol">}</a> <a id="14509" href="Varieties.FreeAlgebras.html#14509" class="Bound">kA</a> <a id="14512" href="Varieties.FreeAlgebras.html#14512" class="Bound">h</a> <a id="14514" class="Symbol">=</a> <a id="14516" href="Varieties.FreeAlgebras.html#14533" class="Function">goal</a>
   <a id="14524" class="Keyword">where</a>
   <a id="14533" href="Varieties.FreeAlgebras.html#14533" class="Function">goal</a> <a id="14538" class="Symbol">:</a> <a id="14540" class="Symbol">(</a><a id="14541" href="Varieties.FreeAlgebras.html#14506" class="Bound">𝑨</a> <a id="14543" href="Terms.Operations.html#2529" class="Function Operator">⟦</a> <a id="14545" href="Varieties.FreeAlgebras.html#14497" class="Bound">p</a> <a id="14547" href="Terms.Operations.html#2529" class="Function Operator">⟧</a><a id="14548" class="Symbol">)</a> <a id="14550" href="Varieties.FreeAlgebras.html#14512" class="Bound">h</a> <a id="14552" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14554" class="Symbol">(</a><a id="14555" href="Varieties.FreeAlgebras.html#14506" class="Bound">𝑨</a> <a id="14557" href="Terms.Operations.html#2529" class="Function Operator">⟦</a> <a id="14559" href="Varieties.FreeAlgebras.html#14499" class="Bound">q</a> <a id="14561" href="Terms.Operations.html#2529" class="Function Operator">⟧</a><a id="14562" class="Symbol">)</a> <a id="14564" href="Varieties.FreeAlgebras.html#14512" class="Bound">h</a>
   <a id="14569" href="Varieties.FreeAlgebras.html#14533" class="Function">goal</a> <a id="14574" class="Symbol">=</a> <a id="14576" class="Symbol">(</a><a id="14577" href="Varieties.FreeAlgebras.html#14506" class="Bound">𝑨</a> <a id="14579" href="Terms.Operations.html#2529" class="Function Operator">⟦</a> <a id="14581" href="Varieties.FreeAlgebras.html#14497" class="Bound">p</a> <a id="14583" href="Terms.Operations.html#2529" class="Function Operator">⟧</a><a id="14584" class="Symbol">)</a> <a id="14586" href="Varieties.FreeAlgebras.html#14512" class="Bound">h</a>       <a id="14594" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14597" href="Terms.Operations.html#2840" class="Function">free-lift-interp</a> <a id="14614" class="Symbol">(</a><a id="14615" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="14618" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="14620" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="14621" class="Symbol">)</a> <a id="14623" href="Varieties.FreeAlgebras.html#14506" class="Bound">𝑨</a> <a id="14625" href="Varieties.FreeAlgebras.html#14512" class="Bound">h</a> <a id="14627" href="Varieties.FreeAlgebras.html#14497" class="Bound">p</a> <a id="14629" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14641" class="Symbol">(</a><a id="14642" href="Terms.Properties.html#2369" class="Function">free-lift</a> <a id="14652" href="Varieties.FreeAlgebras.html#14506" class="Bound">𝑨</a> <a id="14654" href="Varieties.FreeAlgebras.html#14512" class="Bound">h</a><a id="14655" class="Symbol">)</a> <a id="14657" href="Varieties.FreeAlgebras.html#14497" class="Bound">p</a> <a id="14659" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14662" href="Varieties.FreeAlgebras.html#14501" class="Bound">pψq</a> <a id="14666" href="Varieties.FreeAlgebras.html#14506" class="Bound">𝑨</a> <a id="14668" class="Symbol">(</a><a id="14669" href="Varieties.Closure.html#4105" class="InductiveConstructor">siso</a> <a id="14674" class="Symbol">(</a><a id="14675" href="Varieties.Closure.html#3907" class="InductiveConstructor">sbase</a> <a id="14681" href="Varieties.FreeAlgebras.html#14509" class="Bound">kA</a><a id="14683" class="Symbol">)</a> <a id="14685" class="Symbol">(</a><a id="14686" href="Homomorphisms.Isomorphisms.html#2837" class="Function">≅-sym</a> <a id="14692" href="Homomorphisms.Isomorphisms.html#4265" class="Function">Lift-≅</a><a id="14698" class="Symbol">))</a> <a id="14701" href="Varieties.FreeAlgebras.html#14512" class="Bound">h</a> <a id="14703" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14715" class="Symbol">(</a><a id="14716" href="Terms.Properties.html#2369" class="Function">free-lift</a> <a id="14726" href="Varieties.FreeAlgebras.html#14506" class="Bound">𝑨</a> <a id="14728" href="Varieties.FreeAlgebras.html#14512" class="Bound">h</a><a id="14729" class="Symbol">)</a> <a id="14731" href="Varieties.FreeAlgebras.html#14499" class="Bound">q</a> <a id="14733" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14736" class="Symbol">(</a><a id="14737" href="Terms.Operations.html#2840" class="Function">free-lift-interp</a> <a id="14754" class="Symbol">(</a><a id="14755" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="14758" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="14760" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="14761" class="Symbol">)</a> <a id="14763" href="Varieties.FreeAlgebras.html#14506" class="Bound">𝑨</a> <a id="14765" href="Varieties.FreeAlgebras.html#14512" class="Bound">h</a> <a id="14767" href="Varieties.FreeAlgebras.html#14499" class="Bound">q</a><a id="14768" class="Symbol">)</a><a id="14769" href="Overture.Preliminaries.html#4859" class="Function Operator">⁻¹</a>  <a id="14773" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14785" class="Symbol">(</a><a id="14786" href="Varieties.FreeAlgebras.html#14506" class="Bound">𝑨</a> <a id="14788" href="Terms.Operations.html#2529" class="Function Operator">⟦</a> <a id="14790" href="Varieties.FreeAlgebras.html#14499" class="Bound">q</a> <a id="14792" href="Terms.Operations.html#2529" class="Function Operator">⟧</a><a id="14793" class="Symbol">)</a> <a id="14795" href="Varieties.FreeAlgebras.html#14512" class="Bound">h</a>       <a id="14803" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

</pre>

With these results in hand, it is now trivial to prove the main theorem of this subsection.

<pre class="Agda">

 <a id="14926" href="Varieties.FreeAlgebras.html#14926" class="Function">class-models-kernel</a> <a id="14946" class="Symbol">:</a> <a id="14948" class="Symbol">∀</a> <a id="14950" href="Varieties.FreeAlgebras.html#14950" class="Bound">p</a> <a id="14952" href="Varieties.FreeAlgebras.html#14952" class="Bound">q</a> <a id="14954" class="Symbol">→</a> <a id="14956" class="Symbol">(</a><a id="14957" href="Varieties.FreeAlgebras.html#14950" class="Bound">p</a> <a id="14959" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14961" href="Varieties.FreeAlgebras.html#14952" class="Bound">q</a><a id="14962" class="Symbol">)</a> <a id="14964" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="14966" href="Relations.Discrete.html#3791" class="Function">kernel</a> <a id="14973" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14975" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="14980" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="14982" class="Symbol">→</a> <a id="14984" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a> <a id="14986" href="Varieties.EquationalLogic.html#2558" class="Function Operator">⊫</a> <a id="14988" href="Varieties.FreeAlgebras.html#14950" class="Bound">p</a> <a id="14990" href="Varieties.EquationalLogic.html#2558" class="Function Operator">≈</a> <a id="14992" href="Varieties.FreeAlgebras.html#14952" class="Bound">q</a>
 <a id="14995" href="Varieties.FreeAlgebras.html#14926" class="Function">class-models-kernel</a> <a id="15015" href="Varieties.FreeAlgebras.html#15015" class="Bound">p</a> <a id="15017" href="Varieties.FreeAlgebras.html#15017" class="Bound">q</a> <a id="15019" href="Varieties.FreeAlgebras.html#15019" class="Bound">x</a> <a id="15021" class="Symbol">=</a> <a id="15023" href="Varieties.FreeAlgebras.html#14437" class="Function">ψlemma3</a> <a id="15031" href="Varieties.FreeAlgebras.html#15015" class="Bound">p</a> <a id="15033" href="Varieties.FreeAlgebras.html#15017" class="Bound">q</a> <a id="15035" class="Symbol">(</a><a id="15036" href="Varieties.FreeAlgebras.html#14246" class="Function">ψlemma2</a> <a id="15044" href="Varieties.FreeAlgebras.html#15019" class="Bound">x</a><a id="15045" class="Symbol">)</a>

 <a id="15049" href="Varieties.FreeAlgebras.html#15049" class="Function">𝕍𝒦</a> <a id="15052" class="Symbol">:</a> <a id="15054" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="15059" class="Symbol">(</a><a id="15060" href="Algebras.Basic.html#6389" class="Function">Algebra</a> <a id="15068" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a> <a id="15071" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="15072" class="Symbol">)</a> <a id="15074" class="Symbol">(</a><a id="15075" href="Varieties.FreeAlgebras.html#892" class="Primitive">lsuc</a> <a id="15080" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a><a id="15082" class="Symbol">)</a>
 <a id="15085" href="Varieties.FreeAlgebras.html#15049" class="Function">𝕍𝒦</a> <a id="15088" class="Symbol">=</a> <a id="15090" href="Varieties.Closure.html#5363" class="Datatype">V</a><a id="15091" class="Symbol">{</a><a id="15092" class="Argument">α</a> <a id="15094" class="Symbol">=</a> <a id="15096" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="15097" class="Symbol">}{</a><a id="15099" class="Argument">β</a> <a id="15101" class="Symbol">=</a> <a id="15103" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a><a id="15105" class="Symbol">}</a> <a id="15107" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a>

 <a id="15111" href="Varieties.FreeAlgebras.html#15111" class="Function">kernel-in-theory&#39;</a> <a id="15129" class="Symbol">:</a> <a id="15131" href="Relations.Discrete.html#3791" class="Function">kernel</a> <a id="15138" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="15140" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="15145" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="15147" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15149" href="Varieties.EquationalLogic.html#3240" class="Function">Th</a> <a id="15152" class="Symbol">(</a><a id="15153" href="Varieties.Closure.html#5363" class="Datatype">V</a> <a id="15155" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a><a id="15156" class="Symbol">)</a>
 <a id="15159" href="Varieties.FreeAlgebras.html#15111" class="Function">kernel-in-theory&#39;</a> <a id="15177" class="Symbol">{</a><a id="15178" href="Varieties.FreeAlgebras.html#15178" class="Bound">p</a> <a id="15180" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15182" href="Varieties.FreeAlgebras.html#15182" class="Bound">q</a><a id="15183" class="Symbol">}</a> <a id="15185" href="Varieties.FreeAlgebras.html#15185" class="Bound">pKq</a> <a id="15189" class="Symbol">=</a> <a id="15191" class="Symbol">(</a><a id="15192" href="Varieties.Preservation.html#20329" class="Function">class-ids-⇒</a> <a id="15204" href="Varieties.FreeAlgebras.html#10210" class="Bound">fe</a> <a id="15207" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="15210" href="Varieties.FreeAlgebras.html#15178" class="Bound">p</a> <a id="15212" href="Varieties.FreeAlgebras.html#15182" class="Bound">q</a> <a id="15214" class="Symbol">(</a><a id="15215" href="Varieties.FreeAlgebras.html#14926" class="Function">class-models-kernel</a> <a id="15235" href="Varieties.FreeAlgebras.html#15178" class="Bound">p</a> <a id="15237" href="Varieties.FreeAlgebras.html#15182" class="Bound">q</a> <a id="15239" href="Varieties.FreeAlgebras.html#15185" class="Bound">pKq</a><a id="15242" class="Symbol">))</a>

 <a id="15247" href="Varieties.FreeAlgebras.html#15247" class="Function">kernel-in-theory</a> <a id="15264" class="Symbol">:</a> <a id="15266" href="Relations.Discrete.html#3791" class="Function">kernel</a> <a id="15273" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="15275" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="15280" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="15282" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15284" href="Varieties.EquationalLogic.html#3240" class="Function">Th</a> <a id="15287" href="Varieties.FreeAlgebras.html#15049" class="Function">𝕍𝒦</a>
 <a id="15291" href="Varieties.FreeAlgebras.html#15247" class="Function">kernel-in-theory</a> <a id="15308" class="Symbol">{</a><a id="15309" href="Varieties.FreeAlgebras.html#15309" class="Bound">p</a> <a id="15311" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15313" href="Varieties.FreeAlgebras.html#15313" class="Bound">q</a><a id="15314" class="Symbol">}</a> <a id="15316" href="Varieties.FreeAlgebras.html#15316" class="Bound">pKq</a> <a id="15320" href="Varieties.FreeAlgebras.html#15320" class="Bound">vkA</a> <a id="15324" href="Varieties.FreeAlgebras.html#15324" class="Bound">x</a> <a id="15326" class="Symbol">=</a> <a id="15328" href="Varieties.Preservation.html#20442" class="Function">class-ids</a> <a id="15338" href="Varieties.FreeAlgebras.html#10210" class="Bound">fe</a> <a id="15341" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="15344" href="Varieties.FreeAlgebras.html#15309" class="Bound">p</a> <a id="15346" href="Varieties.FreeAlgebras.html#15313" class="Bound">q</a> <a id="15348" class="Symbol">(</a><a id="15349" href="Varieties.FreeAlgebras.html#14926" class="Function">class-models-kernel</a> <a id="15369" href="Varieties.FreeAlgebras.html#15309" class="Bound">p</a> <a id="15371" href="Varieties.FreeAlgebras.html#15313" class="Bound">q</a> <a id="15373" href="Varieties.FreeAlgebras.html#15316" class="Bound">pKq</a><a id="15376" class="Symbol">)</a> <a id="15378" href="Varieties.FreeAlgebras.html#15320" class="Bound">vkA</a> <a id="15382" href="Varieties.FreeAlgebras.html#15324" class="Bound">x</a>

 <a id="15386" href="Varieties.FreeAlgebras.html#15386" class="Function Operator">_↠_</a> <a id="15390" class="Symbol">:</a> <a id="15392" href="Varieties.FreeAlgebras.html#1281" class="Primitive">Type</a> <a id="15397" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a> <a id="15399" class="Symbol">→</a> <a id="15401" href="Algebras.Basic.html#6389" class="Function">Algebra</a> <a id="15409" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a> <a id="15412" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a> <a id="15414" class="Symbol">→</a> <a id="15416" href="Varieties.FreeAlgebras.html#1281" class="Primitive">Type</a> <a id="15421" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a>
 <a id="15425" href="Varieties.FreeAlgebras.html#15425" class="Bound">X</a> <a id="15427" href="Varieties.FreeAlgebras.html#15386" class="Function Operator">↠</a> <a id="15429" href="Varieties.FreeAlgebras.html#15429" class="Bound">𝑨</a> <a id="15431" class="Symbol">=</a> <a id="15433" href="Data.Product.html#916" class="Function">Σ[</a> <a id="15436" href="Varieties.FreeAlgebras.html#15436" class="Bound">h</a> <a id="15438" href="Data.Product.html#916" class="Function">∈</a> <a id="15440" class="Symbol">(</a><a id="15441" href="Varieties.FreeAlgebras.html#15425" class="Bound">X</a> <a id="15443" class="Symbol">→</a> <a id="15445" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="15447" href="Varieties.FreeAlgebras.html#15429" class="Bound">𝑨</a> <a id="15449" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a><a id="15450" class="Symbol">)</a> <a id="15452" href="Data.Product.html#916" class="Function">]</a> <a id="15454" href="Overture.Inverses.html#3206" class="Function">IsSurjective</a> <a id="15467" href="Varieties.FreeAlgebras.html#15436" class="Bound">h</a>

 <a id="15471" href="Varieties.FreeAlgebras.html#15471" class="Function">𝔽-ModTh-epi</a> <a id="15483" class="Symbol">:</a> <a id="15485" class="Symbol">(</a><a id="15486" href="Varieties.FreeAlgebras.html#15486" class="Bound">𝑨</a> <a id="15488" class="Symbol">:</a> <a id="15490" href="Algebras.Basic.html#6389" class="Function">Algebra</a> <a id="15498" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a> <a id="15501" href="Varieties.FreeAlgebras.html#1002" class="Bound">𝑆</a><a id="15502" class="Symbol">)</a> <a id="15504" class="Symbol">→</a> <a id="15506" class="Symbol">(</a><a id="15507" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a> <a id="15509" href="Varieties.FreeAlgebras.html#15386" class="Function Operator">↠</a> <a id="15511" href="Varieties.FreeAlgebras.html#15486" class="Bound">𝑨</a><a id="15512" class="Symbol">)</a> <a id="15514" class="Symbol">→</a> <a id="15516" href="Varieties.FreeAlgebras.html#15486" class="Bound">𝑨</a> <a id="15518" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15520" href="Varieties.EquationalLogic.html#3815" class="Function">Mod</a> <a id="15524" class="Symbol">(</a><a id="15525" href="Varieties.EquationalLogic.html#3240" class="Function">Th</a> <a id="15528" href="Varieties.FreeAlgebras.html#15049" class="Function">𝕍𝒦</a><a id="15530" class="Symbol">)</a> <a id="15532" class="Symbol">→</a> <a id="15534" href="Homomorphisms.Basic.html#5930" class="Function">epi</a> <a id="15538" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a> <a id="15540" href="Varieties.FreeAlgebras.html#15486" class="Bound">𝑨</a>
 <a id="15543" href="Varieties.FreeAlgebras.html#15471" class="Function">𝔽-ModTh-epi</a> <a id="15555" href="Varieties.FreeAlgebras.html#15555" class="Bound">𝑨</a> <a id="15557" class="Symbol">(</a><a id="15558" href="Varieties.FreeAlgebras.html#15558" class="Bound">η</a> <a id="15560" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15562" href="Varieties.FreeAlgebras.html#15562" class="Bound">ηE</a><a id="15564" class="Symbol">)</a> <a id="15566" href="Varieties.FreeAlgebras.html#15566" class="Bound">AinMTV</a> <a id="15573" class="Symbol">=</a> <a id="15575" href="Varieties.FreeAlgebras.html#16087" class="Function">goal</a>
  <a id="15582" class="Keyword">where</a>
  <a id="15590" href="Varieties.FreeAlgebras.html#15590" class="Function">φ</a> <a id="15592" class="Symbol">:</a> <a id="15594" href="Homomorphisms.Basic.html#3059" class="Function">hom</a> <a id="15598" class="Symbol">(</a><a id="15599" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="15601" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a><a id="15602" class="Symbol">)</a> <a id="15604" href="Varieties.FreeAlgebras.html#15555" class="Bound">𝑨</a>
  <a id="15608" href="Varieties.FreeAlgebras.html#15590" class="Function">φ</a> <a id="15610" class="Symbol">=</a> <a id="15612" href="Terms.Properties.html#3076" class="Function">lift-hom</a> <a id="15621" href="Varieties.FreeAlgebras.html#15555" class="Bound">𝑨</a> <a id="15623" href="Varieties.FreeAlgebras.html#15558" class="Bound">η</a>

  <a id="15628" href="Varieties.FreeAlgebras.html#15628" class="Function">φE</a> <a id="15631" class="Symbol">:</a> <a id="15633" href="Overture.Inverses.html#3206" class="Function">IsSurjective</a> <a id="15646" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="15648" href="Varieties.FreeAlgebras.html#15590" class="Function">φ</a> <a id="15650" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a>
  <a id="15654" href="Varieties.FreeAlgebras.html#15628" class="Function">φE</a> <a id="15657" class="Symbol">=</a> <a id="15659" href="Terms.Properties.html#4681" class="Function">lift-of-epi-is-epi</a> <a id="15678" href="Varieties.FreeAlgebras.html#15555" class="Bound">𝑨</a> <a id="15680" href="Varieties.FreeAlgebras.html#15562" class="Bound">ηE</a>

  <a id="15686" href="Varieties.FreeAlgebras.html#15686" class="Function">pqlem2</a> <a id="15693" class="Symbol">:</a> <a id="15695" class="Symbol">∀</a> <a id="15697" href="Varieties.FreeAlgebras.html#15697" class="Bound">p</a> <a id="15699" href="Varieties.FreeAlgebras.html#15699" class="Bound">q</a> <a id="15701" class="Symbol">→</a> <a id="15703" class="Symbol">(</a><a id="15704" href="Varieties.FreeAlgebras.html#15697" class="Bound">p</a> <a id="15706" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15708" href="Varieties.FreeAlgebras.html#15699" class="Bound">q</a><a id="15709" class="Symbol">)</a> <a id="15711" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15713" href="Relations.Discrete.html#3791" class="Function">kernel</a> <a id="15720" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="15722" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="15727" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="15729" class="Symbol">→</a> <a id="15731" href="Varieties.FreeAlgebras.html#15555" class="Bound">𝑨</a> <a id="15733" href="Varieties.EquationalLogic.html#2480" class="Function Operator">⊧</a> <a id="15735" href="Varieties.FreeAlgebras.html#15697" class="Bound">p</a> <a id="15737" href="Varieties.EquationalLogic.html#2480" class="Function Operator">≈</a> <a id="15739" href="Varieties.FreeAlgebras.html#15699" class="Bound">q</a>
  <a id="15743" href="Varieties.FreeAlgebras.html#15686" class="Function">pqlem2</a> <a id="15750" href="Varieties.FreeAlgebras.html#15750" class="Bound">p</a> <a id="15752" href="Varieties.FreeAlgebras.html#15752" class="Bound">q</a> <a id="15754" href="Varieties.FreeAlgebras.html#15754" class="Bound">z</a> <a id="15756" class="Symbol">=</a> <a id="15758" class="Symbol">λ</a> <a id="15760" href="Varieties.FreeAlgebras.html#15760" class="Bound">x</a> <a id="15762" class="Symbol">→</a> <a id="15764" href="Varieties.FreeAlgebras.html#15566" class="Bound">AinMTV</a> <a id="15771" href="Varieties.FreeAlgebras.html#15750" class="Bound">p</a> <a id="15773" href="Varieties.FreeAlgebras.html#15752" class="Bound">q</a> <a id="15775" class="Symbol">(</a><a id="15776" href="Varieties.FreeAlgebras.html#15247" class="Function">kernel-in-theory</a> <a id="15793" href="Varieties.FreeAlgebras.html#15754" class="Bound">z</a><a id="15794" class="Symbol">)</a> <a id="15796" href="Varieties.FreeAlgebras.html#15760" class="Bound">x</a>

  <a id="15801" href="Varieties.FreeAlgebras.html#15801" class="Function">kerincl</a> <a id="15809" class="Symbol">:</a> <a id="15811" href="Relations.Discrete.html#3791" class="Function">kernel</a> <a id="15818" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="15820" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="15825" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="15827" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15829" href="Relations.Discrete.html#3791" class="Function">kernel</a> <a id="15836" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="15838" href="Varieties.FreeAlgebras.html#15590" class="Function">φ</a> <a id="15840" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a>
  <a id="15844" href="Varieties.FreeAlgebras.html#15801" class="Function">kerincl</a> <a id="15852" class="Symbol">{</a><a id="15853" href="Varieties.FreeAlgebras.html#15853" class="Bound">p</a> <a id="15855" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15857" href="Varieties.FreeAlgebras.html#15857" class="Bound">q</a><a id="15858" class="Symbol">}</a> <a id="15860" href="Varieties.FreeAlgebras.html#15860" class="Bound">x</a> <a id="15862" class="Symbol">=</a> <a id="15864" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="15866" href="Varieties.FreeAlgebras.html#15590" class="Function">φ</a> <a id="15868" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="15870" href="Varieties.FreeAlgebras.html#15853" class="Bound">p</a>      <a id="15877" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="15880" class="Symbol">(</a><a id="15881" href="Terms.Operations.html#2840" class="Function">free-lift-interp</a> <a id="15898" class="Symbol">(</a><a id="15899" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="15902" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="15904" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a><a id="15906" class="Symbol">)</a> <a id="15908" href="Varieties.FreeAlgebras.html#15555" class="Bound">𝑨</a> <a id="15910" href="Varieties.FreeAlgebras.html#15558" class="Bound">η</a> <a id="15912" href="Varieties.FreeAlgebras.html#15853" class="Bound">p</a><a id="15913" class="Symbol">)</a><a id="15914" href="Overture.Preliminaries.html#4859" class="Function Operator">⁻¹</a> <a id="15917" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="15941" class="Symbol">(</a><a id="15942" href="Varieties.FreeAlgebras.html#15555" class="Bound">𝑨</a> <a id="15944" href="Terms.Operations.html#2529" class="Function Operator">⟦</a> <a id="15946" href="Varieties.FreeAlgebras.html#15853" class="Bound">p</a> <a id="15948" href="Terms.Operations.html#2529" class="Function Operator">⟧</a><a id="15949" class="Symbol">)</a> <a id="15951" href="Varieties.FreeAlgebras.html#15558" class="Bound">η</a>  <a id="15954" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="15957" href="Varieties.FreeAlgebras.html#15686" class="Function">pqlem2</a> <a id="15964" href="Varieties.FreeAlgebras.html#15853" class="Bound">p</a> <a id="15966" href="Varieties.FreeAlgebras.html#15857" class="Bound">q</a> <a id="15968" href="Varieties.FreeAlgebras.html#15860" class="Bound">x</a> <a id="15970" href="Varieties.FreeAlgebras.html#15558" class="Bound">η</a> <a id="15972" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="15996" class="Symbol">(</a><a id="15997" href="Varieties.FreeAlgebras.html#15555" class="Bound">𝑨</a> <a id="15999" href="Terms.Operations.html#2529" class="Function Operator">⟦</a> <a id="16001" href="Varieties.FreeAlgebras.html#15857" class="Bound">q</a> <a id="16003" href="Terms.Operations.html#2529" class="Function Operator">⟧</a><a id="16004" class="Symbol">)</a> <a id="16006" href="Varieties.FreeAlgebras.html#15558" class="Bound">η</a>  <a id="16009" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16012" href="Terms.Operations.html#2840" class="Function">free-lift-interp</a> <a id="16029" class="Symbol">(</a><a id="16030" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="16033" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="16035" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a><a id="16037" class="Symbol">)</a> <a id="16039" href="Varieties.FreeAlgebras.html#15555" class="Bound">𝑨</a> <a id="16041" href="Varieties.FreeAlgebras.html#15558" class="Bound">η</a> <a id="16043" href="Varieties.FreeAlgebras.html#15857" class="Bound">q</a> <a id="16045" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16069" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="16071" href="Varieties.FreeAlgebras.html#15590" class="Function">φ</a> <a id="16073" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="16075" href="Varieties.FreeAlgebras.html#15857" class="Bound">q</a>      <a id="16082" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

  <a id="16087" href="Varieties.FreeAlgebras.html#16087" class="Function">goal</a> <a id="16092" class="Symbol">:</a> <a id="16094" href="Homomorphisms.Basic.html#5930" class="Function">epi</a> <a id="16098" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a> <a id="16100" href="Varieties.FreeAlgebras.html#15555" class="Bound">𝑨</a>
  <a id="16104" href="Varieties.FreeAlgebras.html#16087" class="Function">goal</a> <a id="16109" class="Symbol">=</a> <a id="16111" href="Varieties.FreeAlgebras.html#1367" class="Field">fst</a> <a id="16115" class="Symbol">(</a><a id="16116" href="Homomorphisms.Noether.html#9819" class="Function">HomFactorEpi</a> <a id="16129" class="Symbol">(</a><a id="16130" href="Varieties.FreeAlgebras.html#10224" class="Bound">wd</a> <a id="16133" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="16135" class="Symbol">(</a><a id="16136" href="Varieties.FreeAlgebras.html#892" class="Primitive">lsuc</a> <a id="16141" class="Symbol">(</a><a id="16142" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="16145" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="16146" class="Symbol">)))</a> <a id="16150" href="Varieties.FreeAlgebras.html#15555" class="Bound">𝑨</a> <a id="16152" href="Varieties.FreeAlgebras.html#15590" class="Function">φ</a> <a id="16154" href="Varieties.FreeAlgebras.html#11520" class="Function">hom𝔽</a> <a id="16159" href="Varieties.FreeAlgebras.html#15801" class="Function">kerincl</a> <a id="16167" href="Varieties.FreeAlgebras.html#11567" class="Function">hom𝔽-is-epic</a> <a id="16180" href="Varieties.FreeAlgebras.html#15628" class="Function">φE</a><a id="16182" class="Symbol">)</a>

</pre>





#### <a id="the-homomorphic-images-of-F">The homomorphic images of 𝔽</a>

Finally we come to one of the main theorems of this module; it asserts that every algebra in `Mod X (Th 𝕍𝒦)` is a homomorphic image of 𝔽.  We prove this below as the function (or proof object) `𝔽-ModTh-epi`.  Before that, we prove two auxiliary lemmas.

<pre class="Agda">

 <a id="16544" class="Keyword">module</a> <a id="16551" href="Varieties.FreeAlgebras.html#16551" class="Module">_</a> <a id="16553" class="Symbol">(</a><a id="16554" href="Varieties.FreeAlgebras.html#16554" class="Bound">pe</a> <a id="16557" class="Symbol">:</a> <a id="16559" href="Foundations.Extensionality.html#4239" class="Function">pred-ext</a> <a id="16568" class="Symbol">(</a><a id="16569" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="16572" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="16573" class="Symbol">)(</a><a id="16575" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="16578" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="16579" class="Symbol">))(</a><a id="16582" href="Varieties.FreeAlgebras.html#16582" class="Bound">wd</a> <a id="16585" class="Symbol">:</a> <a id="16587" href="Foundations.Welldefined.html#3115" class="Function">SwellDef</a><a id="16595" class="Symbol">)</a> <a id="16597" class="Comment">-- extensionality assumptions</a>
          <a id="16637" class="Symbol">(</a><a id="16638" href="Varieties.FreeAlgebras.html#16638" class="Bound">Cset</a> <a id="16643" class="Symbol">:</a> <a id="16645" href="Foundations.Truncation.html#6521" class="Function">is-set</a> <a id="16652" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="16654" href="Varieties.FreeAlgebras.html#10623" class="Function">ℭ</a> <a id="16656" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a><a id="16657" class="Symbol">)</a>                       <a id="16681" class="Comment">-- truncation assumptions</a>
          <a id="16717" class="Symbol">(</a><a id="16718" href="Varieties.FreeAlgebras.html#16718" class="Bound">kuip</a> <a id="16723" class="Symbol">:</a> <a id="16725" href="Foundations.Truncation.html#10715" class="Function">blk-uip</a><a id="16732" class="Symbol">(</a><a id="16733" href="Terms.Basic.html#1823" class="Datatype">Term</a> <a id="16738" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a><a id="16739" class="Symbol">)</a><a id="16740" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a> <a id="16742" href="Homomorphisms.Basic.html#7607" class="Function">kercon</a> <a id="16749" class="Symbol">(</a><a id="16750" href="Varieties.FreeAlgebras.html#16582" class="Bound">wd</a> <a id="16753" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="16755" class="Symbol">(</a><a id="16756" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="16759" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="16760" class="Symbol">)){</a><a id="16763" href="Varieties.FreeAlgebras.html#10623" class="Function">ℭ</a><a id="16764" class="Symbol">}</a><a id="16765" href="Varieties.FreeAlgebras.html#10810" class="Function">homℭ</a> <a id="16770" href="Overture.Preliminaries.html#4155" class="Function Operator">∣</a><a id="16771" class="Symbol">)</a>
  <a id="16775" class="Keyword">where</a>

  <a id="16784" href="Varieties.FreeAlgebras.html#16784" class="Function">𝔽≤ℭ</a> <a id="16788" class="Symbol">:</a> <a id="16790" class="Symbol">(</a><a id="16791" href="Homomorphisms.Basic.html#8015" class="Function Operator">ker[</a> <a id="16796" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="16798" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a> <a id="16800" href="Homomorphisms.Basic.html#8015" class="Function Operator">⇒</a> <a id="16802" href="Varieties.FreeAlgebras.html#10623" class="Function">ℭ</a> <a id="16804" href="Homomorphisms.Basic.html#8015" class="Function Operator">]</a> <a id="16806" href="Varieties.FreeAlgebras.html#10810" class="Function">homℭ</a> <a id="16811" href="Homomorphisms.Basic.html#8015" class="Function Operator">↾</a> <a id="16813" class="Symbol">(</a><a id="16814" href="Varieties.FreeAlgebras.html#16582" class="Bound">wd</a> <a id="16817" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="16819" class="Symbol">(</a><a id="16820" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="16823" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="16824" class="Symbol">)))</a> <a id="16828" href="Subalgebras.Subalgebras.html#2513" class="Function Operator">≤</a> <a id="16830" href="Varieties.FreeAlgebras.html#10623" class="Function">ℭ</a>
  <a id="16834" href="Varieties.FreeAlgebras.html#16784" class="Function">𝔽≤ℭ</a> <a id="16838" class="Symbol">=</a> <a id="16840" href="Subalgebras.Subalgebras.html#4345" class="Function">FirstHomCorollary|Set</a> <a id="16862" class="Symbol">(</a><a id="16863" href="Terms.Basic.html#3067" class="Function">𝑻</a> <a id="16865" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a><a id="16866" class="Symbol">)</a> <a id="16868" href="Varieties.FreeAlgebras.html#10623" class="Function">ℭ</a> <a id="16870" href="Varieties.FreeAlgebras.html#10810" class="Function">homℭ</a> <a id="16875" href="Varieties.FreeAlgebras.html#16554" class="Bound">pe</a> <a id="16878" class="Symbol">(</a><a id="16879" href="Varieties.FreeAlgebras.html#16582" class="Bound">wd</a> <a id="16882" href="Varieties.FreeAlgebras.html#990" class="Bound">𝓥</a> <a id="16884" class="Symbol">(</a><a id="16885" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="16888" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="16889" class="Symbol">))</a> <a id="16892" href="Varieties.FreeAlgebras.html#16638" class="Bound">Cset</a> <a id="16897" href="Varieties.FreeAlgebras.html#16718" class="Bound">kuip</a>

</pre>

The last piece we need to prove that every model of `Th 𝕍𝒦` is a homomorphic image of `𝔽` is a crucial assumption that is taken for granted throughout informal universal algebra---namely, that our collection `X` of variable symbols is arbitrarily large and that we have an *environment* which interprets the variable symbols in every algebra under consideration. In other terms, an environment provides, for every algebra `𝑨`, a surjective mapping `η : X → ∣ 𝑨 ∣` from `X` onto the domain of `𝑨`.

We do *not* assert that for an arbitrary type `X` such surjective maps exist.  Indeed, our `X` must is quite special to have this property.  Later, we will construct such an `X`, but for now we simply postulate its existence. Note that this assumption that an environment exists is only required in the proof of the theorem `𝔽-ModTh-epi`.

<pre class="Agda">


</pre>

#### <a id="F-in-VK">𝔽 ∈ V(𝒦)</a>

With this result in hand, along with what we proved earlier---namely, `PS(𝒦) ⊆ SP(𝒦) ⊆ HSP(𝒦) ≡ V 𝒦`---it is not hard to show that `𝔽` belongs to `V 𝒦`.

<pre class="Agda">

  <a id="17985" href="Varieties.FreeAlgebras.html#17985" class="Function">𝔽∈SP</a> <a id="17990" class="Symbol">:</a> <a id="17992" href="Foundations.Truncation.html#3912" class="Function">hfunext</a> <a id="18000" class="Symbol">(</a><a id="18001" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="18004" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="18005" class="Symbol">)(</a><a id="18007" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="18010" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="18011" class="Symbol">)</a> <a id="18013" class="Symbol">→</a> <a id="18015" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a> <a id="18017" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="18019" class="Symbol">(</a><a id="18020" href="Varieties.Closure.html#3819" class="Datatype">S</a><a id="18021" class="Symbol">{</a><a id="18022" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a><a id="18023" class="Symbol">}{</a><a id="18025" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a><a id="18027" class="Symbol">}</a> <a id="18029" class="Symbol">(</a><a id="18030" href="Varieties.Closure.html#4403" class="Datatype">P</a><a id="18031" class="Symbol">{</a><a id="18032" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="18033" class="Symbol">}{</a><a id="18035" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a><a id="18036" class="Symbol">}</a> <a id="18038" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a><a id="18039" class="Symbol">))</a>
  <a id="18044" href="Varieties.FreeAlgebras.html#17985" class="Function">𝔽∈SP</a> <a id="18049" href="Varieties.FreeAlgebras.html#18049" class="Bound">hfe</a> <a id="18053" class="Symbol">=</a> <a id="18055" href="Varieties.Closure.html#4027" class="InductiveConstructor">ssub</a> <a id="18060" class="Symbol">(</a><a id="18061" href="Varieties.Preservation.html#12937" class="Function">class-prod-s-∈-sp</a> <a id="18079" href="Varieties.FreeAlgebras.html#18049" class="Bound">hfe</a><a id="18082" class="Symbol">)</a> <a id="18084" href="Varieties.FreeAlgebras.html#16784" class="Function">𝔽≤ℭ</a>

  <a id="18091" href="Varieties.FreeAlgebras.html#18091" class="Function">𝔽∈𝕍</a> <a id="18095" class="Symbol">:</a> <a id="18097" href="Foundations.Truncation.html#3912" class="Function">hfunext</a> <a id="18105" class="Symbol">(</a><a id="18106" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="18109" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="18110" class="Symbol">)(</a><a id="18112" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="18115" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="18116" class="Symbol">)</a> <a id="18118" class="Symbol">→</a> <a id="18120" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a> <a id="18122" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="18124" href="Varieties.Closure.html#5363" class="Datatype">V</a> <a id="18126" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a>
  <a id="18130" href="Varieties.FreeAlgebras.html#18091" class="Function">𝔽∈𝕍</a> <a id="18134" href="Varieties.FreeAlgebras.html#18134" class="Bound">hfe</a> <a id="18138" class="Symbol">=</a> <a id="18140" href="Varieties.Preservation.html#9266" class="Function">SP⊆V&#39;</a> <a id="18146" class="Symbol">{</a><a id="18147" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="18148" class="Symbol">}{</a><a id="18150" href="Varieties.FreeAlgebras.html#10210" class="Bound">fe</a> <a id="18153" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a> <a id="18155" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="18156" class="Symbol">}{</a><a id="18158" href="Varieties.FreeAlgebras.html#10210" class="Bound">fe</a> <a id="18161" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a> <a id="18164" href="Varieties.FreeAlgebras.html#3743" class="Function">𝓕⁺</a><a id="18166" class="Symbol">}{</a><a id="18168" href="Varieties.FreeAlgebras.html#10210" class="Bound">fe</a> <a id="18171" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a> <a id="18173" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a><a id="18174" class="Symbol">}{</a><a id="18176" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a><a id="18177" class="Symbol">}</a> <a id="18179" class="Symbol">(</a><a id="18180" href="Varieties.FreeAlgebras.html#17985" class="Function">𝔽∈SP</a> <a id="18185" href="Varieties.FreeAlgebras.html#18134" class="Bound">hfe</a><a id="18188" class="Symbol">)</a>

</pre>

#### The HSP Theorem
Now that we have all of the necessary ingredients, it is all but trivial to
combine them to prove Birkhoff's HSP theorem. (Note that since the proof enlists
the help of the `𝔽-ModTh-epi` theorem, we must assume an environment exists,
which is manifested in the premise `∀ 𝑨 → X ↠ 𝑨`.

<pre class="Agda">

  <a id="18525" href="Varieties.FreeAlgebras.html#18525" class="Function">Birkhoff</a> <a id="18534" class="Symbol">:</a> <a id="18536" href="Foundations.Truncation.html#3912" class="Function">hfunext</a> <a id="18544" class="Symbol">(</a><a id="18545" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="18548" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="18549" class="Symbol">)(</a><a id="18551" href="Algebras.Products.html#2950" class="Function">ov</a> <a id="18554" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="18555" class="Symbol">)</a> <a id="18557" class="Symbol">→</a> <a id="18559" class="Symbol">(∀</a> <a id="18562" href="Varieties.FreeAlgebras.html#18562" class="Bound">𝑨</a> <a id="18564" class="Symbol">→</a> <a id="18566" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a> <a id="18568" href="Varieties.FreeAlgebras.html#15386" class="Function Operator">↠</a> <a id="18570" href="Varieties.FreeAlgebras.html#18562" class="Bound">𝑨</a><a id="18571" class="Symbol">)</a> <a id="18573" class="Symbol">→</a> <a id="18575" href="Varieties.EquationalLogic.html#3815" class="Function">Mod</a> <a id="18579" class="Symbol">(</a><a id="18580" href="Varieties.EquationalLogic.html#3240" class="Function">Th</a> <a id="18583" class="Symbol">(</a><a id="18584" href="Varieties.Closure.html#5363" class="Datatype">V</a> <a id="18586" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a><a id="18587" class="Symbol">))</a> <a id="18590" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="18592" href="Varieties.Closure.html#5363" class="Datatype">V</a> <a id="18594" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a>
  <a id="18598" href="Varieties.FreeAlgebras.html#18525" class="Function">Birkhoff</a> <a id="18607" href="Varieties.FreeAlgebras.html#18607" class="Bound">hfe</a> <a id="18611" href="Varieties.FreeAlgebras.html#18611" class="Bound">𝕏</a> <a id="18613" class="Symbol">{</a><a id="18614" href="Varieties.FreeAlgebras.html#18614" class="Bound">𝑨</a><a id="18615" class="Symbol">}</a> <a id="18617" href="Varieties.FreeAlgebras.html#18617" class="Bound">α</a> <a id="18619" class="Symbol">=</a> <a id="18621" href="Varieties.Closure.html#5644" class="InductiveConstructor">vhimg</a><a id="18626" class="Symbol">{</a><a id="18627" class="Argument">𝑩</a> <a id="18629" class="Symbol">=</a> <a id="18631" href="Varieties.FreeAlgebras.html#18614" class="Bound">𝑨</a><a id="18632" class="Symbol">}</a> <a id="18634" class="Symbol">(</a><a id="18635" href="Varieties.FreeAlgebras.html#18091" class="Function">𝔽∈𝕍</a> <a id="18639" href="Varieties.FreeAlgebras.html#18607" class="Bound">hfe</a><a id="18642" class="Symbol">)</a> <a id="18644" class="Symbol">(</a><a id="18645" href="Varieties.FreeAlgebras.html#18614" class="Bound">𝑨</a> <a id="18647" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18649" href="Homomorphisms.Basic.html#6397" class="Function">epi-to-hom</a> <a id="18660" href="Varieties.FreeAlgebras.html#18614" class="Bound">𝑨</a> <a id="18662" href="Varieties.FreeAlgebras.html#18691" class="Function">φE</a> <a id="18665" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18667" href="Varieties.FreeAlgebras.html#1382" class="Field">snd</a> <a id="18671" href="Overture.Preliminaries.html#4193" class="Function Operator">∥</a> <a id="18673" href="Varieties.FreeAlgebras.html#18691" class="Function">φE</a> <a id="18676" href="Overture.Preliminaries.html#4193" class="Function Operator">∥</a><a id="18677" class="Symbol">)</a>
   <a id="18682" class="Keyword">where</a>
   <a id="18691" href="Varieties.FreeAlgebras.html#18691" class="Function">φE</a> <a id="18694" class="Symbol">:</a> <a id="18696" href="Homomorphisms.Basic.html#5930" class="Function">epi</a> <a id="18700" href="Varieties.FreeAlgebras.html#11403" class="Function">𝔽</a> <a id="18702" href="Varieties.FreeAlgebras.html#18614" class="Bound">𝑨</a>
   <a id="18707" href="Varieties.FreeAlgebras.html#18691" class="Function">φE</a> <a id="18710" class="Symbol">=</a> <a id="18712" href="Varieties.FreeAlgebras.html#15471" class="Function">𝔽-ModTh-epi</a> <a id="18724" href="Varieties.FreeAlgebras.html#18614" class="Bound">𝑨</a> <a id="18726" class="Symbol">(</a><a id="18727" href="Varieties.FreeAlgebras.html#18611" class="Bound">𝕏</a> <a id="18729" href="Varieties.FreeAlgebras.html#18614" class="Bound">𝑨</a><a id="18730" class="Symbol">)</a> <a id="18732" href="Varieties.FreeAlgebras.html#18617" class="Bound">α</a>

</pre>

The converse inclusion, `V 𝒦 ⊆ Mod X (Th (V 𝒦))`, is a simple consequence of the
fact that `Mod Th` is a closure operator. Nonetheless, completeness demands
that we formalize this inclusion as well, however trivial the proof.

<pre class="Agda">

  <a id="18990" href="Varieties.FreeAlgebras.html#18990" class="Function">Birkhoff-converse</a> <a id="19008" class="Symbol">:</a> <a id="19010" href="Varieties.Closure.html#5363" class="Datatype">V</a><a id="19011" class="Symbol">{</a><a id="19012" href="Varieties.FreeAlgebras.html#986" class="Bound">α</a><a id="19013" class="Symbol">}{</a><a id="19015" href="Varieties.FreeAlgebras.html#3741" class="Function">𝓕</a><a id="19016" class="Symbol">}</a> <a id="19018" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a> <a id="19020" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="19022" href="Varieties.EquationalLogic.html#3815" class="Function">Mod</a><a id="19025" class="Symbol">{</a><a id="19026" class="Argument">X</a> <a id="19028" class="Symbol">=</a> <a id="19030" href="Varieties.FreeAlgebras.html#10239" class="Bound">X</a><a id="19031" class="Symbol">}</a> <a id="19033" class="Symbol">(</a><a id="19034" href="Varieties.EquationalLogic.html#3240" class="Function">Th</a> <a id="19037" class="Symbol">(</a><a id="19038" href="Varieties.Closure.html#5363" class="Datatype">V</a> <a id="19040" href="Varieties.FreeAlgebras.html#10252" class="Bound">𝒦</a><a id="19041" class="Symbol">))</a>
  <a id="19046" href="Varieties.FreeAlgebras.html#18990" class="Function">Birkhoff-converse</a> <a id="19064" href="Varieties.FreeAlgebras.html#19064" class="Bound">α</a> <a id="19066" href="Varieties.FreeAlgebras.html#19066" class="Bound">p</a> <a id="19068" href="Varieties.FreeAlgebras.html#19068" class="Bound">q</a> <a id="19070" href="Varieties.FreeAlgebras.html#19070" class="Bound">pThq</a> <a id="19075" class="Symbol">=</a> <a id="19077" href="Varieties.FreeAlgebras.html#19070" class="Bound">pThq</a> <a id="19082" href="Varieties.FreeAlgebras.html#19064" class="Bound">α</a>

</pre>

We have thus proved that every variety is an equational class.  Readers familiar
with the classical formulation of the Birkhoff HSP theorem, as an "if and only
if" result, might worry that we haven't completed the proof.  But recall that
in the [Varieties.Preservation][] module we proved the following identity
preservation lemmas:

* `𝒦 ⊫ p ≈ q → H 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → S 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → P 𝒦 ⊫ p ≈ q`

From these it follows that every equational class is a variety. Thus, our formal
proof of Birkhoff's theorem is complete.




----------------------------


<sup>1</sup><span class="footnote" id="fn1"> Since `X` is not a subset of `𝔉`, technically it doesn't make sense to say "`X` generates `𝔉`." But as long as 𝒦 contains a nontrivial algebra, we will have `ψ(𝒦, 𝑻 𝑋) ∩ X² ≠ ∅`, and we can identify `X` with `X / ψ(𝒦, 𝑻 X)` which does belong to 𝔉.</span>

<br>
<br>


[← Varieties.Preservation](Varieties.Preservation.html)
<span style="float:right;">[Varieties ↑](Varieties.html)</span>

{% include UALib.Links.md %}


--------------------------------

[agda-algebras development team]: https://github.com/ualib/agda-algebras#the-agda-algebras-development-team
