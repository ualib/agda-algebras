% Workflow for TYPES 2021 paper:
% 1. Edit/improve the literate Agda file `src/Demos/HSP.lagda`.
% 2. Invoke `agda --latex --latex-dir=doc/TYPES2021 src/Demos/HSP.lagda` from the main `agda-algebras` directory.
% 3. Invoke `pdflatex agda-hsp` from within the `doc/TYPES2021` directory.

\section{Introduction}
The Agda Universal Algebra Library (\agdaalgebras) \cite{ualib_v2.0.1} formalizes the foundations of universal algebra
in intensional Martin-LÃ¶f type theory (\mltt) using \agda~\cite{Norell:2007,agdaref}.
The library includes a collection of definitions and verified theorems originated in classical
(set-theory based) universal algebra and equational logic, but adapted to \mltt.

The first major milestone of the project is a complete formalization of \emph{Birkhoff's
variety theorem} (also known as the \emph{HSP theorem})~\cite{Birkhoff:1935}.
To the best of our knowledge, this is the first time Birkhoff's celebrated 1935 result
has been formalized in \mltt.\footnote{An alternative formalization based on classical
set-theory was achieved in~\cite{birkhoff-in-mizar:1999}.}
%; see \href{http://www.mizar.org/JFM/Vol9/birkhoff.html\#BIB21}{mizar.org/JFM/Vol9/birkhoff.html}.}

Our first attempt to formalize Birkhoff's theorem
suffered from two flaws.\footnote{See the
 \href{https://github.com/ualib/ualib.github.io/blob/71f173858701398d56224dd79d152c380c0c2b5e/src/lagda/UALib/Birkhoff.lagda}{\textsf{Birkhoff.lagda}} file
 in the \href{https://github.com/ualib/ualib.github.io}{\textsf{ualib/ualib.gitlab.io}}
 repository (\href{https://github.com/ualib/ualib.github.io/commit/71f173858701398d56224dd79d152c380c0c2b5e}{15
 Jan 2021 commit 71f1738})~\cite{ualib_v1.0.0}.}
First, we assumed function extensionality in \mltt; consequently, it was unclear whether the formalization was fully constructive.  Second, an inconsistency could be
contrived by taking the type \ab{X}, representing an arbitrary collection of
variable symbols, to be the two element type (see Â§\ref{sec:discuss} for details).  To resolve these issues, we developed a new formalization of the HSP theorem based on \textit{setoids} and rewrote much of the \agdaalgebras library to support this approach.  This enabled us to avoid function extensionality altogether.  Moreover, the type \ab{X} of variable symbols was treated with more care using the \textit{context} and \textit{environment} types that Andreas Abel uses in~\cite{Abel:2021} to formalize Birkhoff's completeness theorem. These design choices are discussed further in Â§\ref{setoids}--\ref{setoid-functions}.

What follows is a self-contained formal proof of the HSP theorem in \agda.
%\footnote{The proof presented here is based on \agdaalgebras, ver.~2.0.1~\cite{ualib_v2.0.1}, \agda ver.2.6.2 a%nd \agdastdlib ver.1.7.}
%is constructive and correct.
This is achieved by
extracting a subset of the \agdaalgebras library, including only the
pieces needed for the proof, into a single literate \agda file.\footnote{\HSPlagda in the \agdaalgebras repository: \agdaalgebrasrepo}
\ifshort %%% BEGIN SHORT VERSION ONLY
For spaces reasons, we elide some inessential parts,
but strive to preserve the essential content and character of the development.
Specifically, routine or overly technical components, as well as anything that does not
seem to offer insight into the central ideas of the proof are omitted. (The file \HSPlagda mentioned above includes the full proof.)
%can be found in the file \HSPlagda in the \agdaalgebras repository.}
%or in the unabridged version of the present paper~\cite{DeMeo:2021}.}
       %%% END SHORT VERSION ONLY
\else  %%% BEGIN LONG VERSION ONLY
We include here every line of code of our new proof of Birkhoff's theorem
in a single \agda module, presented as a literate \agda document,\footnote{See
\HSPlagda in the \agdaalgebras repository: \agdaalgebrasrepo .}.  Apart from a few dozen
imports from the \agdastdlib, the module is self-contained.
\fi

In this paper, we highlight some of the more challenging aspects of formalizing universal algebra in type theory.  To some extent, this is a sobering glimpse of the significant technical hurdles that must be overcome to do mathematics in dependent type theory. Nonetheless, we hope to demonstrate that \mltt is a relatively natural language for formalizing universal algebra.  Indeed, we believe that researchers with sufficient patience and resolve can reap the substantial rewards of deeper insight and greater confidence in their results by using type theory and a proof assistant like \agda.
On the other hand, this paper is probably not the best place to learn about the latter, since we assume the reader is already familiar with \mltt and \agda.
In summary, our main contribution is to show that a straightforward but very general representation of algebraic structures in dependent type theory is quite practical, as we demonstrate by formalizing a major seminal result of universal algebra.

\section{Preliminaries}

\subsection{Logical foundations}

To best emulate \mltt, we use
<pre class="Agda">
<a id="5050" class="Symbol">{-#</a> <a id="5054" class="Keyword">OPTIONS</a> <a id="5062" class="Pragma">--without-K</a> <a id="5074" class="Pragma">--exact-split</a> <a id="5088" class="Pragma">--safe</a> <a id="5095" class="Symbol">#-}</a>
</pre>
;
\ifshort  %%% BEGIN SHORT VERSION ONLY
  \AgdaPragma{without-K} disables
  \href{https://ncatlab.org/nlab/show/axiom+K+%28type+theory%29}{Streicher's K axiom};
  \AgdaPragma{exact-split} directs \agda to accept only definitions behaving like
  {\it judgmental} equalities;
  \AgdaPragma{safe} ensures that nothing is postulated outright.
  (See~\cite{agdaref-axiomk,agdaref-safeagda,agdatools-patternmatching}.)
       %%% END SHORT VERSION ONLY
\else  %%% BEGIN LONG VERSION ONLY

  Here are brief descriptions of these options, accompanied by links to related documentation.
  \begin{itemize}
  \item
  \AgdaPragma{without-K} disables \href{https://ncatlab.org/nlab/show/axiom+K+%28type+theory%29}{Streicher's K axiom}.
  See the \href{https://agda.readthedocs.io/en/v2.6.1/language/without-k.html}{section on axiom K} in
  the \href{https://agda.readthedocs.io/en/v2.6.1.3/language}{Agda Language Reference Manual}~\cite{agdaref-axiomk}.
  \item
  \AgdaPragma{exact-split} makes \agda accept only those definitions that behave like so-called {\it judgmental} equalities.
  See the \href{https://agda.readthedocs.io/en/v2.6.1/tools/command-line-options.html#pattern-matching-and-equality}%
  {Pattern matching and equality} section of
  the \href{https://agda.readthedocs.io/en/v2.6.1.3/tools/}{Agda Tools} documentation~\cite{agdatools-patternmatching}.
  \item
  \AgdaPragma{safe} ensures that nothing is postulated outright---every non-\mltt axiom has to be an explicit assumption (e.g., an argument to a function or module).
  See the \href{https://agda.readthedocs.io/en/v2.6.1/tools/command-line-options.html#cmdoption-safe}{cmdoption-safe} section of~\cite{agdaref-safeagda}.
  \end{itemize}
\fi    %%% END LONG VERSION ONLY
We also make use of the following definitions from \agda's standard library (ver.~1.7).
<pre class="Agda">
<a id="6953" class="Symbol">{-#</a> <a id="6957" class="Keyword">OPTIONS</a> <a id="6965" class="Pragma">--without-K</a> <a id="6977" class="Pragma">--exact-split</a> <a id="6991" class="Pragma">--safe</a> <a id="6998" class="Symbol">#-}</a>
</pre>
\ifshort
\else  %%% BEGIN LONG VERSION ONLY
<pre class="Agda">
<a id="7070" class="Comment">-- Import universe levels and Signature type (described below) from the agda-algebras library.</a>
<a id="7165" class="Keyword">open</a> <a id="7170" class="Keyword">import</a> <a id="7177" href="Base.Algebras.Basic.html" class="Module">Base.Algebras.Basic</a> <a id="7197" class="Keyword">using</a> <a id="7203" class="Symbol">(</a> <a id="7205" href="Base.Algebras.Basic.html#1162" class="Generalizable">ğ“</a> <a id="7207" class="Symbol">;</a> <a id="7209" href="Base.Algebras.Basic.html#1164" class="Generalizable">ğ“¥</a> <a id="7211" class="Symbol">;</a> <a id="7213" href="Base.Algebras.Basic.html#3890" class="Function">Signature</a> <a id="7223" class="Symbol">)</a>
<a id="7225" class="Keyword">module</a> <a id="7232" href="Demos.HSP.html" class="Module">Demos.HSP</a> <a id="7242" class="Symbol">{</a><a id="7243" href="Demos.HSP.html#7243" class="Bound">ğ‘†</a> <a id="7245" class="Symbol">:</a> <a id="7247" href="Base.Algebras.Basic.html#3890" class="Function">Signature</a> <a id="7257" href="Base.Algebras.Basic.html#1162" class="Generalizable">ğ“</a> <a id="7259" href="Base.Algebras.Basic.html#1164" class="Generalizable">ğ“¥</a><a id="7260" class="Symbol">}</a> <a id="7262" class="Keyword">where</a>
</pre>
\fi    %%% END LONG VERSION ONLY
{\small
<pre class="Agda">

<a id="7334" class="Comment">-- Import 16 definitions from the Agda Standard Library.</a>
<a id="7391" class="Keyword">open</a> <a id="7396" class="Keyword">import</a>  <a id="7404" href="Data.Unit.Polymorphic.html" class="Module">Data.Unit.Polymorphic</a>        <a id="7433" class="Keyword">using</a> <a id="7439" class="Symbol">(</a> <a id="7441" href="Data.Unit.Polymorphic.Base.html#480" class="Function">âŠ¤</a> <a id="7443" class="Symbol">;</a> <a id="7445" href="Data.Unit.Polymorphic.Base.html#524" class="Function">tt</a>                                            <a id="7491" class="Symbol">)</a>
<a id="7493" class="Keyword">open</a> <a id="7498" class="Keyword">import</a>  <a id="7506" href="Function.html" class="Module">Function</a>                     <a id="7535" class="Keyword">using</a> <a id="7541" class="Symbol">(</a> <a id="7543" href="Function.Base.html#615" class="Function">id</a> <a id="7546" class="Symbol">;</a> <a id="7548" href="Function.Base.html#1031" class="Function Operator">_âˆ˜_</a> <a id="7552" class="Symbol">;</a> <a id="7554" href="Function.Base.html#1554" class="Function">flip</a>                                   <a id="7593" class="Symbol">)</a>
<a id="7595" class="Keyword">open</a> <a id="7600" class="Keyword">import</a>  <a id="7608" href="Level.html" class="Module">Level</a>                        <a id="7637" class="Keyword">using</a> <a id="7643" class="Symbol">(</a> <a id="7645" href="Agda.Primitive.html#597" class="Postulate">Level</a>                                             <a id="7695" class="Symbol">)</a>
<a id="7697" class="Keyword">open</a> <a id="7702" class="Keyword">import</a>  <a id="7710" href="Relation.Binary.html" class="Module">Relation.Binary</a>              <a id="7739" class="Keyword">using</a> <a id="7745" class="Symbol">(</a> <a id="7747" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="7751" class="Symbol">;</a> <a id="7753" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="7760" class="Symbol">;</a> <a id="7762" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a>                      <a id="7797" class="Symbol">)</a>
<a id="7799" class="Keyword">open</a> <a id="7804" class="Keyword">import</a>  <a id="7812" href="Relation.Binary.Definitions.html" class="Module">Relation.Binary.Definitions</a>  <a id="7841" class="Keyword">using</a> <a id="7847" class="Symbol">(</a> <a id="7849" href="Relation.Binary.Definitions.html#1339" class="Function">Reflexive</a> <a id="7859" class="Symbol">;</a> <a id="7861" href="Relation.Binary.Definitions.html#1498" class="Function">Symmetric</a> <a id="7871" class="Symbol">;</a> <a id="7873" href="Relation.Binary.Definitions.html#1978" class="Function">Transitive</a> <a id="7884" class="Symbol">;</a> <a id="7886" href="Relation.Binary.Definitions.html#1424" class="Function">Sym</a> <a id="7890" class="Symbol">;</a> <a id="7892" href="Relation.Binary.Definitions.html#1585" class="Function">Trans</a>  <a id="7899" class="Symbol">)</a>
<a id="7901" class="Keyword">open</a> <a id="7906" class="Keyword">import</a>  <a id="7914" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>  <a id="7953" class="Keyword">using</a> <a id="7959" class="Symbol">(</a> <a id="7961" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_â‰¡_</a>                                     <a id="8001" class="Symbol">)</a>
<a id="8003" class="Keyword">open</a> <a id="8008" class="Keyword">import</a>  <a id="8016" href="Relation.Unary.html" class="Module">Relation.Unary</a>               <a id="8045" class="Keyword">using</a> <a id="8051" class="Symbol">(</a> <a id="8053" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="8058" class="Symbol">;</a> <a id="8060" href="Relation.Unary.html#1742" class="Function Operator">_âŠ†_</a> <a id="8064" class="Symbol">;</a> <a id="8066" href="Relation.Unary.html#1523" class="Function Operator">_âˆˆ_</a>                                  <a id="8103" class="Symbol">)</a>

<a id="8106" class="Comment">-- -- Import 23 definitions from the Agda Standard Library and rename 12 of them.</a>
<a id="8188" class="Keyword">open</a> <a id="8193" class="Keyword">import</a>  <a id="8201" href="Agda.Primitive.html" class="Module">Agda.Primitive</a>  <a id="8217" class="Keyword">renaming</a>  <a id="8227" class="Symbol">(</a> <a id="8229" href="Agda.Primitive.html#326" class="Primitive">Set</a>    <a id="8236" class="Symbol">to</a> <a id="8239" class="Primitive">Type</a>    <a id="8247" class="Symbol">)</a>  <a id="8250" class="Keyword">using</a>  <a id="8257" class="Symbol">(</a> <a id="8259" href="Agda.Primitive.html#810" class="Primitive Operator">_âŠ”_</a> <a id="8263" class="Symbol">;</a> <a id="8265" href="Agda.Primitive.html#780" class="Primitive">lsuc</a>                   <a id="8288" class="Symbol">)</a>
<a id="8290" class="Keyword">open</a> <a id="8295" class="Keyword">import</a>  <a id="8303" href="Data.Product.html" class="Module">Data.Product</a>    <a id="8319" class="Keyword">renaming</a>  <a id="8329" class="Symbol">(</a> <a id="8331" href="Agda.Builtin.Sigma.html#252" class="Field">projâ‚</a>  <a id="8338" class="Symbol">to</a> <a id="8341" class="Field">fst</a>     <a id="8349" class="Symbol">)</a>  <a id="8352" class="Keyword">using</a>  <a id="8359" class="Symbol">(</a> <a id="8361" href="Data.Product.html#1167" class="Function Operator">_Ã—_</a> <a id="8365" class="Symbol">;</a> <a id="8367" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="8371" class="Symbol">;</a> <a id="8373" href="Agda.Builtin.Sigma.html#166" class="Record">Î£</a> <a id="8375" class="Symbol">;</a> <a id="8377" href="Data.Product.html#916" class="Function">Î£-syntax</a>     <a id="8390" class="Symbol">)</a>
                             <a id="8421" class="Keyword">renaming</a>  <a id="8431" class="Symbol">(</a> <a id="8433" href="Agda.Builtin.Sigma.html#264" class="Field">projâ‚‚</a>  <a id="8440" class="Symbol">to</a> <a id="8443" class="Field">snd</a>     <a id="8451" class="Symbol">)</a>
<a id="8453" class="Keyword">open</a> <a id="8458" class="Keyword">import</a>  <a id="8466" href="Function.html" class="Module">Function</a>        <a id="8482" class="Keyword">renaming</a>  <a id="8492" class="Symbol">(</a> <a id="8494" href="Function.Bundles.html#1868" class="Record">Func</a>   <a id="8501" class="Symbol">to</a> <a id="8504" class="Record">_âŸ¶_</a>     <a id="8512" class="Symbol">)</a>  <a id="8515" class="Keyword">using</a>  <a id="8522" class="Symbol">(</a>                              <a id="8553" class="Symbol">)</a>
<a id="8555" class="Keyword">open</a>         <a id="8568" href="Demos.HSP.html#8504" class="Module">_âŸ¶_</a>             <a id="8584" class="Keyword">renaming</a>  <a id="8594" class="Symbol">(</a> <a id="8596" href="Function.Bundles.html#1919" class="Field">f</a>      <a id="8603" class="Symbol">to</a> <a id="8606" class="Field">_âŸ¨$âŸ©_</a>   <a id="8614" class="Symbol">)</a>  <a id="8617" class="Keyword">using</a>  <a id="8624" class="Symbol">(</a> <a id="8626" href="Function.Bundles.html#1938" class="Field">cong</a>                         <a id="8655" class="Symbol">)</a>
<a id="8657" class="Keyword">open</a>         <a id="8670" href="Relation.Binary.Structures.html#1522" class="Module">IsEquivalence</a>   <a id="8686" class="Keyword">renaming</a>  <a id="8696" class="Symbol">(</a> <a id="8698" href="Relation.Binary.Structures.html#1568" class="Field">refl</a>   <a id="8705" class="Symbol">to</a> <a id="8708" class="Field">refláµ‰</a>   <a id="8716" class="Symbol">)</a>
                             <a id="8747" class="Keyword">renaming</a>  <a id="8757" class="Symbol">(</a> <a id="8759" href="Relation.Binary.Structures.html#1594" class="Field">sym</a>    <a id="8766" class="Symbol">to</a> <a id="8769" class="Field">symáµ‰</a>    <a id="8777" class="Symbol">)</a>
                             <a id="8808" class="Keyword">renaming</a>  <a id="8818" class="Symbol">(</a> <a id="8820" href="Relation.Binary.Structures.html#1620" class="Field">trans</a>  <a id="8827" class="Symbol">to</a> <a id="8830" class="Field">transáµ‰</a>  <a id="8838" class="Symbol">)</a>  <a id="8841" class="Keyword">using</a>  <a id="8848" class="Symbol">(</a>                              <a id="8879" class="Symbol">)</a>
<a id="8881" class="Keyword">open</a>         <a id="8894" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a>          <a id="8910" class="Keyword">renaming</a>  <a id="8920" class="Symbol">(</a> <a id="8922" href="Relation.Binary.Structures.html#1568" class="Function">refl</a>   <a id="8929" class="Symbol">to</a> <a id="8932" class="Function">reflË¢</a>   <a id="8940" class="Symbol">)</a>
                             <a id="8971" class="Keyword">renaming</a>  <a id="8981" class="Symbol">(</a> <a id="8983" href="Relation.Binary.Structures.html#1594" class="Function">sym</a>    <a id="8990" class="Symbol">to</a> <a id="8993" class="Function">symË¢</a>    <a id="9001" class="Symbol">)</a>
                             <a id="9032" class="Keyword">renaming</a>  <a id="9042" class="Symbol">(</a> <a id="9044" href="Relation.Binary.Structures.html#1620" class="Function">trans</a>  <a id="9051" class="Symbol">to</a> <a id="9054" class="Function">transË¢</a>  <a id="9062" class="Symbol">)</a>
                             <a id="9093" class="Keyword">renaming</a>  <a id="9103" class="Symbol">(</a> <a id="9105" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="9109" class="Symbol">to</a> <a id="9112" class="Field Operator">_â‰ˆË¢_</a>       <a id="9123" class="Symbol">)</a>  <a id="9126" class="Keyword">using</a>  <a id="9133" class="Symbol">(</a> <a id="9135" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a>  <a id="9144" class="Symbol">;</a> <a id="9146" href="Relation.Binary.Bundles.html#1132" class="Field">isEquivalence</a>     <a id="9164" class="Symbol">)</a>

<a id="9167" class="Comment">-- Assign handles to 3 modules of the Agda Standard Library.</a>
<a id="9228" class="Keyword">import</a>       <a id="9241" href="Function.Definitions.html" class="Module">Function.Definitions</a>                   <a id="9280" class="Symbol">as</a>   <a id="9285" class="Module">FD</a>
<a id="9288" class="Keyword">import</a>       <a id="9301" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>  <a id="9340" class="Symbol">as</a>   <a id="9345" class="Module">â‰¡</a>
<a id="9347" class="Keyword">import</a>       <a id="9360" href="Relation.Binary.Reasoning.Setoid.html" class="Module">Relation.Binary.Reasoning.Setoid</a>       <a id="9399" class="Symbol">as</a>   <a id="9404" class="Module">SetoidReasoning</a>

<a id="9421" class="Keyword">private</a> <a id="9429" class="Keyword">variable</a> <a id="9438" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="9440" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="9443" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="9445" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a> <a id="9448" href="Demos.HSP.html#9448" class="Generalizable">Î³</a> <a id="9450" href="Demos.HSP.html#9450" class="Generalizable">Ïá¶œ</a> <a id="9453" href="Demos.HSP.html#9453" class="Generalizable">Î´</a> <a id="9455" href="Demos.HSP.html#9455" class="Generalizable">Ïáµˆ</a> <a id="9458" href="Demos.HSP.html#9458" class="Generalizable">Ï</a> <a id="9460" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a> <a id="9462" href="Demos.HSP.html#9462" class="Generalizable">â„“</a> <a id="9464" class="Symbol">:</a> <a id="9466" href="Agda.Primitive.html#597" class="Postulate">Level</a> <a id="9472" class="Symbol">;</a>       <a id="9480" href="Demos.HSP.html#9480" class="Generalizable">Î“</a> <a id="9482" href="Demos.HSP.html#9482" class="Generalizable">Î”</a> <a id="9484" class="Symbol">:</a> <a id="9486" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="9491" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a>

</pre>
}
\noindent The above imports include some adjustments to ``standard'' \agda syntax; in particular,
we use \AgdaPrimitive{Type} in place of \AgdaPrimitive{Set}, the infix long arrow symbol,
\AgdaRecord{\AgdaUnderscore{}âŸ¶\AgdaUnderscore{}}, in place of \AgdaRecord{Func} (the type of ``setoid functions,'' discussed in Â§\ref{setoid-functions} below), and the symbol \aofld{\au{}âŸ¨\$âŸ©\au{}} in place of \afld{f} (application of the map of a setoid function); we use
\AgdaField{fst} and \AgdaField{snd}, and sometimes \AgdaOperator{\AgdaFunction{âˆ£\AgdaUnderscore{}âˆ£}} and
\AgdaOperator{\AgdaFunction{âˆ¥\AgdaUnderscore{}âˆ¥}}, to denote the first and second
projections out of the product type
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}Ã—\AgdaUnderscore{}}}.
\ifshort
\else  %%% BEGIN LONG VERSION ONLY

<pre class="Agda">
<a id="10316" class="Keyword">module</a> <a id="10323" href="Demos.HSP.html#10323" class="Module">_</a> <a id="10325" class="Symbol">{</a><a id="10326" href="Demos.HSP.html#10326" class="Bound">A</a> <a id="10328" class="Symbol">:</a> <a id="10330" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="10335" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="10337" class="Symbol">}{</a><a id="10339" href="Demos.HSP.html#10339" class="Bound">B</a> <a id="10341" class="Symbol">:</a> <a id="10343" href="Demos.HSP.html#10326" class="Bound">A</a> <a id="10345" class="Symbol">â†’</a> <a id="10347" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="10352" href="Demos.HSP.html#9443" class="Generalizable">Î²</a><a id="10353" class="Symbol">}</a> <a id="10355" class="Keyword">where</a>
 <a id="10362" href="Demos.HSP.html#10362" class="Function Operator">âˆ£_âˆ£</a> <a id="10366" class="Symbol">:</a> <a id="10368" href="Data.Product.html#916" class="Function">Î£[</a> <a id="10371" href="Demos.HSP.html#10371" class="Bound">x</a> <a id="10373" href="Data.Product.html#916" class="Function">âˆˆ</a> <a id="10375" href="Demos.HSP.html#10326" class="Bound">A</a> <a id="10377" href="Data.Product.html#916" class="Function">]</a> <a id="10379" href="Demos.HSP.html#10339" class="Bound">B</a> <a id="10381" href="Demos.HSP.html#10371" class="Bound">x</a> <a id="10383" class="Symbol">â†’</a> <a id="10385" href="Demos.HSP.html#10326" class="Bound">A</a>
 <a id="10388" href="Demos.HSP.html#10362" class="Function Operator">âˆ£_âˆ£</a> <a id="10392" class="Symbol">=</a> <a id="10394" href="Demos.HSP.html#8341" class="Field">fst</a>
 <a id="10399" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥_âˆ¥</a> <a id="10403" class="Symbol">:</a> <a id="10405" class="Symbol">(</a><a id="10406" href="Demos.HSP.html#10406" class="Bound">z</a> <a id="10408" class="Symbol">:</a> <a id="10410" href="Data.Product.html#916" class="Function">Î£[</a> <a id="10413" href="Demos.HSP.html#10413" class="Bound">a</a> <a id="10415" href="Data.Product.html#916" class="Function">âˆˆ</a> <a id="10417" href="Demos.HSP.html#10326" class="Bound">A</a> <a id="10419" href="Data.Product.html#916" class="Function">]</a> <a id="10421" href="Demos.HSP.html#10339" class="Bound">B</a> <a id="10423" href="Demos.HSP.html#10413" class="Bound">a</a><a id="10424" class="Symbol">)</a> <a id="10426" class="Symbol">â†’</a> <a id="10428" href="Demos.HSP.html#10339" class="Bound">B</a> <a id="10430" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="10432" href="Demos.HSP.html#10406" class="Bound">z</a> <a id="10434" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>
 <a id="10437" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥_âˆ¥</a> <a id="10441" class="Symbol">=</a> <a id="10443" href="Demos.HSP.html#8443" class="Field">snd</a>
</pre>
\fi       %%% END LONG VERSION ONLY


%% -----------------------------------------------------------------------------
\subsection{Setoids}\label{setoids}
A \defn{setoid} is a pair consisting of a type and
an equivalence relation on that type.  Setoids are useful for representing a
set with an explicit, ``local'' notion of equivalence, instead of relying on
an implicit, ``global'' one as is more common in set theory. In reality,
informal mathematical practice relies on equivalence relations quite pervasively,
taking great care to define only functions that preserve equivalences, while eliding the
details. To be properly formal, such details must be made explicit.
While there are many different workable approaches, the one that requires
no additional meta-theory is based on setoids, which is why we adopt it here.
While in some settings setoids are found by others to be burdensome, we have not
found them to be so for universal algebra.

The \agdaalgebras library was first developed without setoids, relying on
propositional equality %\ad{\au{}â‰¡\au{}}
instead,
along with some experimental, domain-specific types for equivalence classes, quotients, etc.
This required postulating function extensionality,%
\footnote{the axiom asserting that two point-wise equal functions are equal} which is
known to be independent from \mltt~\cite{MHE, MHE:2019}; this was unsatisfactory as %we were curious to see if
we aimed to show that the theorems hold directly in \mltt without extra axioms.
The present work makes no appeal to functional extensionality or classical axioms like Choice or Excluded Middle.\footnote{All submodules of the \am{Setoid} module in the \agdaalgebras library are also fully constructive in this sense.}


%% -----------------------------------------------------------------------------
\subsection{Setoid functions}
\label{setoid-functions}
A \textit{setoid function} is a function from
one setoid to another that respects the underlying equivalences.
If \ab{ğ‘¨} and \ab{ğ‘©} are setoids, we use \ab{ğ‘¨}~\AgdaRecord{âŸ¶}~\ab{ğ‘©}
to denote the type of setoid functions from \ab{ğ‘¨} to \ab{ğ‘©}.
\ifshort
\else %%% BEGIN LONG VERSION ONLY

An example of a setoid function is the identity function from a setoid to itself.
We define it, along with a binary composition operation for setoid functions,
\AgdaOperator{\AgdaFunction{âŸ¨âˆ˜âŸ©}}, as follows.

<pre class="Agda">

<a id="ğ‘–ğ‘‘"></a><a id="12837" href="Demos.HSP.html#12837" class="Function">ğ‘–ğ‘‘</a> <a id="12840" class="Symbol">:</a> <a id="12842" class="Symbol">{</a><a id="12843" href="Demos.HSP.html#12843" class="Bound">A</a> <a id="12845" class="Symbol">:</a> <a id="12847" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="12854" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="12856" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="12858" class="Symbol">}</a> <a id="12860" class="Symbol">â†’</a> <a id="12862" href="Demos.HSP.html#12843" class="Bound">A</a> <a id="12864" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="12866" href="Demos.HSP.html#12843" class="Bound">A</a>
<a id="12868" href="Demos.HSP.html#12837" class="Function">ğ‘–ğ‘‘</a> <a id="12871" class="Symbol">{</a><a id="12872" href="Demos.HSP.html#12872" class="Bound">A</a><a id="12873" class="Symbol">}</a> <a id="12875" class="Symbol">=</a> <a id="12877" class="Keyword">record</a> <a id="12884" class="Symbol">{</a> <a id="12886" href="Function.Bundles.html#1919" class="Field">f</a> <a id="12888" class="Symbol">=</a> <a id="12890" href="Function.Base.html#615" class="Function">id</a> <a id="12893" class="Symbol">;</a> <a id="12895" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="12900" class="Symbol">=</a> <a id="12902" href="Function.Base.html#615" class="Function">id</a> <a id="12905" class="Symbol">}</a>

<a id="_âŸ¨âˆ˜âŸ©_"></a><a id="12908" href="Demos.HSP.html#12908" class="Function Operator">_âŸ¨âˆ˜âŸ©_</a> <a id="12914" class="Symbol">:</a>  <a id="12917" class="Symbol">{</a><a id="12918" href="Demos.HSP.html#12918" class="Bound">A</a> <a id="12920" class="Symbol">:</a> <a id="12922" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="12929" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="12931" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="12933" class="Symbol">}</a> <a id="12935" class="Symbol">{</a><a id="12936" href="Demos.HSP.html#12936" class="Bound">B</a> <a id="12938" class="Symbol">:</a> <a id="12940" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="12947" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="12949" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="12951" class="Symbol">}</a> <a id="12953" class="Symbol">{</a><a id="12954" href="Demos.HSP.html#12954" class="Bound">C</a> <a id="12956" class="Symbol">:</a> <a id="12958" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="12965" href="Demos.HSP.html#9448" class="Generalizable">Î³</a> <a id="12967" href="Demos.HSP.html#9450" class="Generalizable">Ïá¶œ</a><a id="12969" class="Symbol">}</a>
 <a id="12972" class="Symbol">â†’</a>       <a id="12980" href="Demos.HSP.html#12936" class="Bound">B</a> <a id="12982" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="12984" href="Demos.HSP.html#12954" class="Bound">C</a>  <a id="12987" class="Symbol">â†’</a>  <a id="12990" href="Demos.HSP.html#12918" class="Bound">A</a> <a id="12992" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="12994" href="Demos.HSP.html#12936" class="Bound">B</a>  <a id="12997" class="Symbol">â†’</a>  <a id="13000" href="Demos.HSP.html#12918" class="Bound">A</a> <a id="13002" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="13004" href="Demos.HSP.html#12954" class="Bound">C</a>

<a id="13007" href="Demos.HSP.html#13007" class="Bound">f</a> <a id="13009" href="Demos.HSP.html#12908" class="Function Operator">âŸ¨âˆ˜âŸ©</a> <a id="13013" href="Demos.HSP.html#13013" class="Bound">g</a> <a id="13015" class="Symbol">=</a> <a id="13017" class="Keyword">record</a>  <a id="13025" class="Symbol">{</a> <a id="13027" href="Function.Bundles.html#1919" class="Field">f</a> <a id="13029" class="Symbol">=</a> <a id="13031" class="Symbol">(</a><a id="13032" href="Demos.HSP.html#8606" class="Field Operator">_âŸ¨$âŸ©_</a> <a id="13038" href="Demos.HSP.html#13007" class="Bound">f</a><a id="13039" class="Symbol">)</a> <a id="13041" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="13043" class="Symbol">(</a><a id="13044" href="Demos.HSP.html#8606" class="Field Operator">_âŸ¨$âŸ©_</a> <a id="13050" href="Demos.HSP.html#13013" class="Bound">g</a><a id="13051" class="Symbol">)</a>
                  <a id="13071" class="Symbol">;</a> <a id="13073" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="13078" class="Symbol">=</a> <a id="13080" class="Symbol">(</a><a id="13081" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="13086" href="Demos.HSP.html#13007" class="Bound">f</a><a id="13087" class="Symbol">)</a> <a id="13089" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="13091" class="Symbol">(</a><a id="13092" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="13097" href="Demos.HSP.html#13013" class="Bound">g</a><a id="13098" class="Symbol">)</a> <a id="13100" class="Symbol">}</a>
</pre>
\paragraph*{Inverses}
\fi %%% END LONG VERSION ONLY
We define the \defn{inverse} of such a function in terms of the image of the function's domain, as follows.

<pre class="Agda">

<a id="13288" class="Keyword">module</a> <a id="13295" href="Demos.HSP.html#13295" class="Module">_</a> <a id="13297" class="Symbol">{</a><a id="13298" href="Demos.HSP.html#13298" class="Bound">ğ‘¨</a> <a id="13300" class="Symbol">:</a> <a id="13302" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="13309" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="13311" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="13313" class="Symbol">}{</a><a id="13315" href="Demos.HSP.html#13315" class="Bound">ğ‘©</a> <a id="13317" class="Symbol">:</a> <a id="13319" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="13326" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="13328" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="13330" class="Symbol">}</a> <a id="13332" class="Keyword">where</a>
 <a id="13339" class="Keyword">open</a> <a id="13344" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="13351" href="Demos.HSP.html#13315" class="Bound">ğ‘©</a> <a id="13353" class="Keyword">using</a> <a id="13359" class="Symbol">(</a> <a id="13361" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="13365" class="Symbol">;</a> <a id="13367" href="Relation.Binary.Structures.html#1594" class="Function">sym</a> <a id="13371" class="Symbol">)</a> <a id="13373" class="Keyword">renaming</a> <a id="13382" class="Symbol">(</a> <a id="13384" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a> <a id="13392" class="Symbol">to</a> <a id="13395" class="Field">B</a> <a id="13397" class="Symbol">)</a>

 <a id="13401" class="Keyword">data</a> <a id="13406" href="Demos.HSP.html#13406" class="Datatype Operator">Image_âˆ‹_</a> <a id="13415" class="Symbol">(</a><a id="13416" href="Demos.HSP.html#13416" class="Bound">f</a> <a id="13418" class="Symbol">:</a> <a id="13420" href="Demos.HSP.html#13298" class="Bound">ğ‘¨</a> <a id="13422" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="13424" href="Demos.HSP.html#13315" class="Bound">ğ‘©</a><a id="13425" class="Symbol">)</a> <a id="13427" class="Symbol">:</a> <a id="13429" href="Demos.HSP.html#13395" class="Field">B</a> <a id="13431" class="Symbol">â†’</a> <a id="13433" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="13438" class="Symbol">(</a><a id="13439" href="Demos.HSP.html#13309" class="Bound">Î±</a> <a id="13441" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="13443" href="Demos.HSP.html#13326" class="Bound">Î²</a> <a id="13445" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="13447" href="Demos.HSP.html#13328" class="Bound">Ïáµ‡</a><a id="13449" class="Symbol">)</a> <a id="13451" class="Keyword">where</a>
  <a id="13459" href="Demos.HSP.html#13459" class="InductiveConstructor">eq</a> <a id="13462" class="Symbol">:</a> <a id="13464" class="Symbol">{</a><a id="13465" href="Demos.HSP.html#13465" class="Bound">b</a> <a id="13467" class="Symbol">:</a> <a id="13469" href="Demos.HSP.html#13395" class="Field">B</a><a id="13470" class="Symbol">}</a> <a id="13472" class="Symbol">â†’</a> <a id="13474" class="Symbol">âˆ€</a> <a id="13476" href="Demos.HSP.html#13476" class="Bound">a</a> <a id="13478" class="Symbol">â†’</a> <a id="13480" href="Demos.HSP.html#13465" class="Bound">b</a> <a id="13482" href="Relation.Binary.Bundles.html#1098" class="Field Operator">â‰ˆ</a> <a id="13484" href="Demos.HSP.html#13416" class="Bound">f</a> <a id="13486" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="13490" href="Demos.HSP.html#13476" class="Bound">a</a> <a id="13492" class="Symbol">â†’</a> <a id="13494" href="Demos.HSP.html#13406" class="Datatype Operator">Image</a> <a id="13500" href="Demos.HSP.html#13416" class="Bound">f</a> <a id="13502" href="Demos.HSP.html#13406" class="Datatype Operator">âˆ‹</a> <a id="13504" href="Demos.HSP.html#13465" class="Bound">b</a>

</pre>

An inhabitant of the \aod{Image} \ab f \aod{âˆ‹} \ab b type is a point \ab a~\as :~\afld{Carrier}\ab{ğ‘¨},
along with a proof \ab p~\as :~\ab b~\af{â‰ˆ}~\ab f~\ab a, that \ab f maps \ab a to \ab b.
Since a proof of \aod{Image} \ab f \aod{âˆ‹} \ab b must include a concrete witness \ab a~\as :~\afld{Carrier}~\ab{ğ‘¨}, we can actually \emph{compute} a range-restricted right-inverse of \ab f.
Here is the definition of \af{Inv} which, for extra certainty, is accompanied by a proof that it gives a right-inverse.

<pre class="Agda">

 <a id="14037" href="Demos.HSP.html#14037" class="Function">Inv</a> <a id="14041" class="Symbol">:</a> <a id="14043" class="Symbol">(</a><a id="14044" href="Demos.HSP.html#14044" class="Bound">f</a> <a id="14046" class="Symbol">:</a> <a id="14048" href="Demos.HSP.html#13298" class="Bound">ğ‘¨</a> <a id="14050" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="14052" href="Demos.HSP.html#13315" class="Bound">ğ‘©</a><a id="14053" class="Symbol">){</a><a id="14055" href="Demos.HSP.html#14055" class="Bound">b</a> <a id="14057" class="Symbol">:</a> <a id="14059" href="Demos.HSP.html#13395" class="Field">B</a><a id="14060" class="Symbol">}</a> <a id="14062" class="Symbol">â†’</a> <a id="14064" href="Demos.HSP.html#13406" class="Datatype Operator">Image</a> <a id="14070" href="Demos.HSP.html#14044" class="Bound">f</a> <a id="14072" href="Demos.HSP.html#13406" class="Datatype Operator">âˆ‹</a> <a id="14074" href="Demos.HSP.html#14055" class="Bound">b</a> <a id="14076" class="Symbol">â†’</a> <a id="14078" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a> <a id="14086" href="Demos.HSP.html#13298" class="Bound">ğ‘¨</a>
 <a id="14089" href="Demos.HSP.html#14037" class="Function">Inv</a> <a id="14093" class="Symbol">_</a> <a id="14095" class="Symbol">(</a><a id="14096" href="Demos.HSP.html#13459" class="InductiveConstructor">eq</a> <a id="14099" href="Demos.HSP.html#14099" class="Bound">a</a> <a id="14101" class="Symbol">_)</a> <a id="14104" class="Symbol">=</a> <a id="14106" href="Demos.HSP.html#14099" class="Bound">a</a>

 <a id="14110" href="Demos.HSP.html#14110" class="Function">InvIsInverseÊ³</a> <a id="14124" class="Symbol">:</a> <a id="14126" class="Symbol">{</a><a id="14127" href="Demos.HSP.html#14127" class="Bound">f</a> <a id="14129" class="Symbol">:</a> <a id="14131" href="Demos.HSP.html#13298" class="Bound">ğ‘¨</a> <a id="14133" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="14135" href="Demos.HSP.html#13315" class="Bound">ğ‘©</a><a id="14136" class="Symbol">}{</a><a id="14138" href="Demos.HSP.html#14138" class="Bound">b</a> <a id="14140" class="Symbol">:</a> <a id="14142" href="Demos.HSP.html#13395" class="Field">B</a><a id="14143" class="Symbol">}(</a><a id="14145" href="Demos.HSP.html#14145" class="Bound">q</a> <a id="14147" class="Symbol">:</a> <a id="14149" href="Demos.HSP.html#13406" class="Datatype Operator">Image</a> <a id="14155" href="Demos.HSP.html#14127" class="Bound">f</a> <a id="14157" href="Demos.HSP.html#13406" class="Datatype Operator">âˆ‹</a> <a id="14159" href="Demos.HSP.html#14138" class="Bound">b</a><a id="14160" class="Symbol">)</a> <a id="14162" class="Symbol">â†’</a> <a id="14164" href="Demos.HSP.html#14127" class="Bound">f</a> <a id="14166" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="14170" class="Symbol">(</a><a id="14171" href="Demos.HSP.html#14037" class="Function">Inv</a> <a id="14175" href="Demos.HSP.html#14127" class="Bound">f</a> <a id="14177" href="Demos.HSP.html#14145" class="Bound">q</a><a id="14178" class="Symbol">)</a> <a id="14180" href="Relation.Binary.Bundles.html#1098" class="Field Operator">â‰ˆ</a> <a id="14182" href="Demos.HSP.html#14138" class="Bound">b</a>
 <a id="14185" href="Demos.HSP.html#14110" class="Function">InvIsInverseÊ³</a> <a id="14199" class="Symbol">(</a><a id="14200" href="Demos.HSP.html#13459" class="InductiveConstructor">eq</a> <a id="14203" class="Symbol">_</a> <a id="14205" href="Demos.HSP.html#14205" class="Bound">p</a><a id="14206" class="Symbol">)</a> <a id="14208" class="Symbol">=</a> <a id="14210" href="Relation.Binary.Structures.html#1594" class="Function">sym</a> <a id="14214" href="Demos.HSP.html#14205" class="Bound">p</a>
</pre>
%
\ifshort\else
\paragraph*{Injective and surjective setoid functions}
\fi

If \ab{f} : \ab{ğ‘¨} \aor{âŸ¶} \ab{ğ‘©}
then we call \ab f \defn{injective} provided
\as{âˆ€}(\ab{aâ‚€} \ab{aâ‚} \as : \ab{A}), \ab{f}~\aofld{âŸ¨\$âŸ©}~\ab{aâ‚€}~\af{â‰ˆá´®}~\ab{f}~\aofld{âŸ¨\$âŸ©}~\ab{aâ‚}
implies \ab{aâ‚€}~\af{â‰ˆá´¬}~\ab{aâ‚}; we call \ab{f} \defn{surjective} provided
\as{âˆ€}(\AgdaTyped{b}{B})~\as{âˆƒ}(\AgdaTyped{a}{A}) such that \ab{f} \aofld{âŸ¨\$âŸ©} \ab{a} \af{â‰ˆá´®} \ab{b}.
\ifshort
We omit the straightforward \agda definitions.
\else

We represent injective functions on bare types by the
type \af{Injective}, and uses this to define the \af{IsInjective} type to represent
the property of being an injective setoid function. Similarly, the type \af{IsSurjective}
represents the property of being a surjective setoid function. \af{SurjInv} represents the \emph{right-inverse} of a surjective function.

We reproduce the definitions and prove some of their properties
inside the next submodule where we first set the stage by declaring two
setoids \ab{ğ‘¨} and \ab{ğ‘©}, naming their equality relations, and making some
definitions from the standard library available.

<pre class="Agda">

<a id="15368" class="Keyword">module</a> <a id="15375" href="Demos.HSP.html#15375" class="Module">_</a> <a id="15377" class="Symbol">{</a><a id="15378" href="Demos.HSP.html#15378" class="Bound">ğ‘¨</a> <a id="15380" class="Symbol">:</a> <a id="15382" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="15389" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="15391" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="15393" class="Symbol">}{</a><a id="15395" href="Demos.HSP.html#15395" class="Bound">ğ‘©</a> <a id="15397" class="Symbol">:</a> <a id="15399" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="15406" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="15408" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="15410" class="Symbol">}</a> <a id="15412" class="Keyword">where</a>
 <a id="15419" class="Keyword">open</a> <a id="15424" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="15431" href="Demos.HSP.html#15378" class="Bound">ğ‘¨</a> <a id="15433" class="Keyword">using</a> <a id="15439" class="Symbol">()</a> <a id="15442" class="Keyword">renaming</a> <a id="15451" class="Symbol">(</a> <a id="15453" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="15457" class="Symbol">to</a> <a id="15460" class="Field Operator">_â‰ˆá´¬_</a> <a id="15465" class="Symbol">)</a>
 <a id="15468" class="Keyword">open</a> <a id="15473" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="15480" href="Demos.HSP.html#15395" class="Bound">ğ‘©</a> <a id="15482" class="Keyword">using</a> <a id="15488" class="Symbol">()</a> <a id="15491" class="Keyword">renaming</a> <a id="15500" class="Symbol">(</a> <a id="15502" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="15506" class="Symbol">to</a> <a id="15509" class="Field Operator">_â‰ˆá´®_</a> <a id="15514" class="Symbol">)</a>
 <a id="15517" class="Keyword">open</a> <a id="15522" href="Function.Definitions.html" class="Module">FD</a> <a id="15525" href="Demos.HSP.html#15460" class="Function Operator">_â‰ˆá´¬_</a> <a id="15530" href="Demos.HSP.html#15509" class="Field Operator">_â‰ˆá´®_</a>

 <a id="15537" href="Demos.HSP.html#15537" class="Function">IsInjective</a> <a id="15549" class="Symbol">:</a> <a id="15551" class="Symbol">(</a><a id="15552" href="Demos.HSP.html#15378" class="Bound">ğ‘¨</a> <a id="15554" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="15556" href="Demos.HSP.html#15395" class="Bound">ğ‘©</a><a id="15557" class="Symbol">)</a> <a id="15559" class="Symbol">â†’</a>  <a id="15562" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="15567" class="Symbol">(</a><a id="15568" href="Demos.HSP.html#15389" class="Bound">Î±</a> <a id="15570" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="15572" href="Demos.HSP.html#15391" class="Bound">Ïáµƒ</a> <a id="15575" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="15577" href="Demos.HSP.html#15408" class="Bound">Ïáµ‡</a><a id="15579" class="Symbol">)</a>
 <a id="15582" href="Demos.HSP.html#15537" class="Function">IsInjective</a> <a id="15594" href="Demos.HSP.html#15594" class="Bound">f</a> <a id="15596" class="Symbol">=</a> <a id="15598" href="Function.Definitions.html#889" class="Function">Injective</a> <a id="15608" class="Symbol">(</a><a id="15609" href="Demos.HSP.html#8606" class="Field Operator">_âŸ¨$âŸ©_</a> <a id="15615" href="Demos.HSP.html#15594" class="Bound">f</a><a id="15616" class="Symbol">)</a>

 <a id="15620" href="Demos.HSP.html#15620" class="Function">IsSurjective</a> <a id="15633" class="Symbol">:</a> <a id="15635" class="Symbol">(</a><a id="15636" href="Demos.HSP.html#15378" class="Bound">ğ‘¨</a> <a id="15638" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="15640" href="Demos.HSP.html#15395" class="Bound">ğ‘©</a><a id="15641" class="Symbol">)</a> <a id="15643" class="Symbol">â†’</a>  <a id="15646" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="15651" class="Symbol">(</a><a id="15652" href="Demos.HSP.html#15389" class="Bound">Î±</a> <a id="15654" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="15656" href="Demos.HSP.html#15406" class="Bound">Î²</a> <a id="15658" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="15660" href="Demos.HSP.html#15408" class="Bound">Ïáµ‡</a><a id="15662" class="Symbol">)</a>
 <a id="15665" href="Demos.HSP.html#15620" class="Function">IsSurjective</a> <a id="15678" href="Demos.HSP.html#15678" class="Bound">F</a> <a id="15680" class="Symbol">=</a> <a id="15682" class="Symbol">âˆ€</a> <a id="15684" class="Symbol">{</a><a id="15685" href="Demos.HSP.html#15685" class="Bound">y</a><a id="15686" class="Symbol">}</a> <a id="15688" class="Symbol">â†’</a> <a id="15690" href="Demos.HSP.html#13406" class="Datatype Operator">Image</a> <a id="15696" href="Demos.HSP.html#15678" class="Bound">F</a> <a id="15698" href="Demos.HSP.html#13406" class="Datatype Operator">âˆ‹</a> <a id="15700" href="Demos.HSP.html#15685" class="Bound">y</a>

 <a id="15704" href="Demos.HSP.html#15704" class="Function">SurjInv</a> <a id="15712" class="Symbol">:</a> <a id="15714" class="Symbol">(</a><a id="15715" href="Demos.HSP.html#15715" class="Bound">f</a> <a id="15717" class="Symbol">:</a> <a id="15719" href="Demos.HSP.html#15378" class="Bound">ğ‘¨</a> <a id="15721" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="15723" href="Demos.HSP.html#15395" class="Bound">ğ‘©</a><a id="15724" class="Symbol">)</a> <a id="15726" class="Symbol">â†’</a> <a id="15728" href="Demos.HSP.html#15620" class="Function">IsSurjective</a> <a id="15741" href="Demos.HSP.html#15715" class="Bound">f</a> <a id="15743" class="Symbol">â†’</a> <a id="15745" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a> <a id="15753" href="Demos.HSP.html#15395" class="Bound">ğ‘©</a> <a id="15755" class="Symbol">â†’</a> <a id="15757" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a> <a id="15765" href="Demos.HSP.html#15378" class="Bound">ğ‘¨</a>
 <a id="15768" href="Demos.HSP.html#15704" class="Function">SurjInv</a> <a id="15776" href="Demos.HSP.html#15776" class="Bound">f</a> <a id="15778" href="Demos.HSP.html#15778" class="Bound">fonto</a> <a id="15784" href="Demos.HSP.html#15784" class="Bound">b</a> <a id="15786" class="Symbol">=</a> <a id="15788" href="Demos.HSP.html#14037" class="Function">Inv</a> <a id="15792" href="Demos.HSP.html#15776" class="Bound">f</a> <a id="15794" class="Symbol">(</a><a id="15795" href="Demos.HSP.html#15778" class="Bound">fonto</a> <a id="15801" class="Symbol">{</a><a id="15802" href="Demos.HSP.html#15784" class="Bound">b</a><a id="15803" class="Symbol">})</a>

</pre>

Proving that the composition of injective setoid functions is again injective
is simply a matter of composing the two assumed witnesses to injectivity.
Proving that surjectivity is preserved under composition is only slightly more involved.

<pre class="Agda">

<a id="16075" class="Keyword">module</a> <a id="16082" href="Demos.HSP.html#16082" class="Module">_</a>  <a id="16085" class="Symbol">{</a><a id="16086" href="Demos.HSP.html#16086" class="Bound">ğ‘¨</a> <a id="16088" class="Symbol">:</a> <a id="16090" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="16097" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="16099" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="16101" class="Symbol">}{</a><a id="16103" href="Demos.HSP.html#16103" class="Bound">ğ‘©</a> <a id="16105" class="Symbol">:</a> <a id="16107" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="16114" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="16116" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="16118" class="Symbol">}{</a><a id="16120" href="Demos.HSP.html#16120" class="Bound">ğ‘ª</a> <a id="16122" class="Symbol">:</a> <a id="16124" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="16131" href="Demos.HSP.html#9448" class="Generalizable">Î³</a> <a id="16133" href="Demos.HSP.html#9450" class="Generalizable">Ïá¶œ</a><a id="16135" class="Symbol">}</a>
          <a id="16147" class="Symbol">(</a><a id="16148" href="Demos.HSP.html#16148" class="Bound">f</a> <a id="16150" class="Symbol">:</a> <a id="16152" href="Demos.HSP.html#16086" class="Bound">ğ‘¨</a> <a id="16154" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="16156" href="Demos.HSP.html#16103" class="Bound">ğ‘©</a><a id="16157" class="Symbol">)(</a><a id="16159" href="Demos.HSP.html#16159" class="Bound">g</a> <a id="16161" class="Symbol">:</a> <a id="16163" href="Demos.HSP.html#16103" class="Bound">ğ‘©</a> <a id="16165" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="16167" href="Demos.HSP.html#16120" class="Bound">ğ‘ª</a><a id="16168" class="Symbol">)</a> <a id="16170" class="Keyword">where</a>

 <a id="16178" href="Demos.HSP.html#16178" class="Function">âˆ˜-IsInjective</a> <a id="16192" class="Symbol">:</a> <a id="16194" href="Demos.HSP.html#15537" class="Function">IsInjective</a> <a id="16206" href="Demos.HSP.html#16148" class="Bound">f</a> <a id="16208" class="Symbol">â†’</a> <a id="16210" href="Demos.HSP.html#15537" class="Function">IsInjective</a> <a id="16222" href="Demos.HSP.html#16159" class="Bound">g</a> <a id="16224" class="Symbol">â†’</a> <a id="16226" href="Demos.HSP.html#15537" class="Function">IsInjective</a> <a id="16238" class="Symbol">(</a><a id="16239" href="Demos.HSP.html#16159" class="Bound">g</a> <a id="16241" href="Demos.HSP.html#12908" class="Function Operator">âŸ¨âˆ˜âŸ©</a> <a id="16245" href="Demos.HSP.html#16148" class="Bound">f</a><a id="16246" class="Symbol">)</a>
 <a id="16249" href="Demos.HSP.html#16178" class="Function">âˆ˜-IsInjective</a> <a id="16263" href="Demos.HSP.html#16263" class="Bound">finj</a> <a id="16268" href="Demos.HSP.html#16268" class="Bound">ginj</a> <a id="16273" class="Symbol">=</a> <a id="16275" href="Demos.HSP.html#16263" class="Bound">finj</a> <a id="16280" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="16282" href="Demos.HSP.html#16268" class="Bound">ginj</a>

 <a id="16289" href="Demos.HSP.html#16289" class="Function">âˆ˜-IsSurjective</a> <a id="16304" class="Symbol">:</a> <a id="16306" href="Demos.HSP.html#15620" class="Function">IsSurjective</a> <a id="16319" href="Demos.HSP.html#16148" class="Bound">f</a> <a id="16321" class="Symbol">â†’</a> <a id="16323" href="Demos.HSP.html#15620" class="Function">IsSurjective</a> <a id="16336" href="Demos.HSP.html#16159" class="Bound">g</a> <a id="16338" class="Symbol">â†’</a> <a id="16340" href="Demos.HSP.html#15620" class="Function">IsSurjective</a> <a id="16353" class="Symbol">(</a><a id="16354" href="Demos.HSP.html#16159" class="Bound">g</a> <a id="16356" href="Demos.HSP.html#12908" class="Function Operator">âŸ¨âˆ˜âŸ©</a> <a id="16360" href="Demos.HSP.html#16148" class="Bound">f</a><a id="16361" class="Symbol">)</a>
 <a id="16364" href="Demos.HSP.html#16289" class="Function">âˆ˜-IsSurjective</a> <a id="16379" href="Demos.HSP.html#16379" class="Bound">fonto</a> <a id="16385" href="Demos.HSP.html#16385" class="Bound">gonto</a> <a id="16391" class="Symbol">{</a><a id="16392" href="Demos.HSP.html#16392" class="Bound">y</a><a id="16393" class="Symbol">}</a> <a id="16395" class="Symbol">=</a> <a id="16397" href="Demos.HSP.html#16594" class="Function">Goal</a> <a id="16402" class="Keyword">where</a>
  <a id="16410" href="Demos.HSP.html#16410" class="Function">mp</a> <a id="16413" class="Symbol">:</a> <a id="16415" href="Demos.HSP.html#13406" class="Datatype Operator">Image</a> <a id="16421" href="Demos.HSP.html#16159" class="Bound">g</a> <a id="16423" href="Demos.HSP.html#13406" class="Datatype Operator">âˆ‹</a> <a id="16425" href="Demos.HSP.html#16392" class="Bound">y</a> <a id="16427" class="Symbol">â†’</a> <a id="16429" href="Demos.HSP.html#13406" class="Datatype Operator">Image</a> <a id="16435" href="Demos.HSP.html#16159" class="Bound">g</a> <a id="16437" href="Demos.HSP.html#12908" class="Function Operator">âŸ¨âˆ˜âŸ©</a> <a id="16441" href="Demos.HSP.html#16148" class="Bound">f</a> <a id="16443" href="Demos.HSP.html#13406" class="Datatype Operator">âˆ‹</a> <a id="16445" href="Demos.HSP.html#16392" class="Bound">y</a>
  <a id="16449" href="Demos.HSP.html#16410" class="Function">mp</a> <a id="16452" class="Symbol">(</a><a id="16453" href="Demos.HSP.html#13459" class="InductiveConstructor">eq</a> <a id="16456" href="Demos.HSP.html#16456" class="Bound">c</a> <a id="16458" href="Demos.HSP.html#16458" class="Bound">p</a><a id="16459" class="Symbol">)</a> <a id="16461" class="Symbol">=</a> <a id="16463" href="Demos.HSP.html#16513" class="Function">Î·</a> <a id="16465" href="Demos.HSP.html#16379" class="Bound">fonto</a> <a id="16471" class="Keyword">where</a>
   <a id="16480" class="Keyword">open</a> <a id="16485" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="16492" href="Demos.HSP.html#16120" class="Bound">ğ‘ª</a> <a id="16494" class="Keyword">using</a> <a id="16500" class="Symbol">(</a> <a id="16502" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="16508" class="Symbol">)</a>
   <a id="16513" href="Demos.HSP.html#16513" class="Function">Î·</a> <a id="16515" class="Symbol">:</a> <a id="16517" href="Demos.HSP.html#13406" class="Datatype Operator">Image</a> <a id="16523" href="Demos.HSP.html#16148" class="Bound">f</a> <a id="16525" href="Demos.HSP.html#13406" class="Datatype Operator">âˆ‹</a> <a id="16527" href="Demos.HSP.html#16456" class="Bound">c</a> <a id="16529" class="Symbol">â†’</a> <a id="16531" href="Demos.HSP.html#13406" class="Datatype Operator">Image</a> <a id="16537" href="Demos.HSP.html#16159" class="Bound">g</a> <a id="16539" href="Demos.HSP.html#12908" class="Function Operator">âŸ¨âˆ˜âŸ©</a> <a id="16543" href="Demos.HSP.html#16148" class="Bound">f</a> <a id="16545" href="Demos.HSP.html#13406" class="Datatype Operator">âˆ‹</a> <a id="16547" href="Demos.HSP.html#16392" class="Bound">y</a>
   <a id="16552" href="Demos.HSP.html#16513" class="Function">Î·</a> <a id="16554" class="Symbol">(</a><a id="16555" href="Demos.HSP.html#13459" class="InductiveConstructor">eq</a> <a id="16558" href="Demos.HSP.html#16558" class="Bound">a</a> <a id="16560" href="Demos.HSP.html#16560" class="Bound">q</a><a id="16561" class="Symbol">)</a> <a id="16563" class="Symbol">=</a> <a id="16565" href="Demos.HSP.html#13459" class="InductiveConstructor">eq</a> <a id="16568" href="Demos.HSP.html#16558" class="Bound">a</a> <a id="16570" class="Symbol">(</a><a id="16571" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="16577" href="Demos.HSP.html#16458" class="Bound">p</a> <a id="16579" class="Symbol">(</a><a id="16580" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="16585" href="Demos.HSP.html#16159" class="Bound">g</a> <a id="16587" href="Demos.HSP.html#16560" class="Bound">q</a><a id="16588" class="Symbol">))</a>

  <a id="16594" href="Demos.HSP.html#16594" class="Function">Goal</a> <a id="16599" class="Symbol">:</a> <a id="16601" href="Demos.HSP.html#13406" class="Datatype Operator">Image</a> <a id="16607" href="Demos.HSP.html#16159" class="Bound">g</a> <a id="16609" href="Demos.HSP.html#12908" class="Function Operator">âŸ¨âˆ˜âŸ©</a> <a id="16613" href="Demos.HSP.html#16148" class="Bound">f</a> <a id="16615" href="Demos.HSP.html#13406" class="Datatype Operator">âˆ‹</a> <a id="16617" href="Demos.HSP.html#16392" class="Bound">y</a>
  <a id="16621" href="Demos.HSP.html#16594" class="Function">Goal</a> <a id="16626" class="Symbol">=</a> <a id="16628" href="Demos.HSP.html#16410" class="Function">mp</a> <a id="16631" href="Demos.HSP.html#16385" class="Bound">gonto</a>
</pre>

\fi

\paragraph*{Factorization of setoid functions\protect\footnote{The code in this paragraph was suggested by an anonymous referee.}}

Any (setoid) function \ab f : \ab A \aor{âŸ¶} \ab B factors as a surjective map
\ab{toIm} : \ab A \aor{âŸ¶} \ab{Im} \ab f followed by an injective map \ab{fromIm} : \ab{Im} \ab f \aor{âŸ¶} \ab B.

<pre class="Agda">

<a id="16991" class="Keyword">module</a> <a id="16998" href="Demos.HSP.html#16998" class="Module">_</a> <a id="17000" class="Symbol">{</a><a id="17001" href="Demos.HSP.html#17001" class="Bound">ğ‘¨</a> <a id="17003" class="Symbol">:</a> <a id="17005" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="17012" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="17014" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="17016" class="Symbol">}{</a><a id="17018" href="Demos.HSP.html#17018" class="Bound">ğ‘©</a> <a id="17020" class="Symbol">:</a> <a id="17022" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="17029" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="17031" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="17033" class="Symbol">}</a> <a id="17035" class="Keyword">where</a>

 <a id="17043" href="Demos.HSP.html#17043" class="Function">Im</a> <a id="17046" class="Symbol">:</a> <a id="17048" class="Symbol">(</a><a id="17049" href="Demos.HSP.html#17049" class="Bound">f</a> <a id="17051" class="Symbol">:</a> <a id="17053" href="Demos.HSP.html#17001" class="Bound">ğ‘¨</a> <a id="17055" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="17057" href="Demos.HSP.html#17018" class="Bound">ğ‘©</a><a id="17058" class="Symbol">)</a> <a id="17060" class="Symbol">â†’</a> <a id="17062" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="17069" class="Symbol">_</a> <a id="17071" class="Symbol">_</a>
 <a id="17074" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a> <a id="17082" class="Symbol">(</a><a id="17083" href="Demos.HSP.html#17043" class="Function">Im</a> <a id="17086" href="Demos.HSP.html#17086" class="Bound">f</a><a id="17087" class="Symbol">)</a> <a id="17089" class="Symbol">=</a> <a id="17091" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a> <a id="17099" href="Demos.HSP.html#17001" class="Bound">ğ‘¨</a>
 <a id="17102" href="Demos.HSP.html#9112" class="Field Operator">_â‰ˆË¢_</a> <a id="17107" class="Symbol">(</a><a id="17108" href="Demos.HSP.html#17043" class="Function">Im</a> <a id="17111" href="Demos.HSP.html#17111" class="Bound">f</a><a id="17112" class="Symbol">)</a> <a id="17114" href="Demos.HSP.html#17114" class="Bound">b1</a> <a id="17117" href="Demos.HSP.html#17117" class="Bound">b2</a> <a id="17120" class="Symbol">=</a> <a id="17122" href="Demos.HSP.html#17111" class="Bound">f</a> <a id="17124" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="17128" href="Demos.HSP.html#17114" class="Bound">b1</a> <a id="17131" href="Relation.Binary.Bundles.html#1098" class="Function Operator">â‰ˆ</a> <a id="17133" href="Demos.HSP.html#17111" class="Bound">f</a> <a id="17135" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="17139" href="Demos.HSP.html#17117" class="Bound">b2</a> <a id="17142" class="Keyword">where</a> <a id="17148" class="Keyword">open</a> <a id="17153" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="17160" href="Demos.HSP.html#17018" class="Bound">ğ‘©</a>

 <a id="17164" href="Relation.Binary.Bundles.html#1132" class="Field">isEquivalence</a> <a id="17178" class="Symbol">(</a><a id="17179" href="Demos.HSP.html#17043" class="Function">Im</a> <a id="17182" href="Demos.HSP.html#17182" class="Bound">f</a><a id="17183" class="Symbol">)</a> <a id="17185" class="Symbol">=</a> <a id="17187" class="Keyword">record</a> <a id="17194" class="Symbol">{</a> <a id="17196" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="17201" class="Symbol">=</a> <a id="17203" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="17208" class="Symbol">;</a> <a id="17210" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="17214" class="Symbol">=</a> <a id="17216" href="Relation.Binary.Structures.html#1594" class="Function">sym</a><a id="17219" class="Symbol">;</a> <a id="17221" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="17227" class="Symbol">=</a> <a id="17229" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="17235" class="Symbol">}</a>
  <a id="17239" class="Keyword">where</a> <a id="17245" class="Keyword">open</a> <a id="17250" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="17257" href="Demos.HSP.html#17018" class="Bound">ğ‘©</a>

 <a id="17261" href="Demos.HSP.html#17261" class="Function">toIm</a> <a id="17266" class="Symbol">:</a> <a id="17268" class="Symbol">(</a><a id="17269" href="Demos.HSP.html#17269" class="Bound">f</a> <a id="17271" class="Symbol">:</a> <a id="17273" href="Demos.HSP.html#17001" class="Bound">ğ‘¨</a> <a id="17275" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="17277" href="Demos.HSP.html#17018" class="Bound">ğ‘©</a><a id="17278" class="Symbol">)</a> <a id="17280" class="Symbol">â†’</a> <a id="17282" href="Demos.HSP.html#17001" class="Bound">ğ‘¨</a> <a id="17284" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="17286" href="Demos.HSP.html#17043" class="Function">Im</a> <a id="17289" href="Demos.HSP.html#17269" class="Bound">f</a>
 <a id="17292" href="Demos.HSP.html#17261" class="Function">toIm</a> <a id="17297" href="Demos.HSP.html#17297" class="Bound">f</a> <a id="17299" class="Symbol">=</a> <a id="17301" class="Keyword">record</a> <a id="17308" class="Symbol">{</a> <a id="17310" href="Function.Bundles.html#1919" class="Field">f</a> <a id="17312" class="Symbol">=</a> <a id="17314" href="Function.Base.html#615" class="Function">id</a> <a id="17317" class="Symbol">;</a> <a id="17319" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="17324" class="Symbol">=</a> <a id="17326" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="17331" href="Demos.HSP.html#17297" class="Bound">f</a> <a id="17333" class="Symbol">}</a>

 <a id="17337" href="Demos.HSP.html#17337" class="Function">fromIm</a> <a id="17344" class="Symbol">:</a> <a id="17346" class="Symbol">(</a><a id="17347" href="Demos.HSP.html#17347" class="Bound">f</a> <a id="17349" class="Symbol">:</a> <a id="17351" href="Demos.HSP.html#17001" class="Bound">ğ‘¨</a> <a id="17353" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="17355" href="Demos.HSP.html#17018" class="Bound">ğ‘©</a><a id="17356" class="Symbol">)</a> <a id="17358" class="Symbol">â†’</a> <a id="17360" href="Demos.HSP.html#17043" class="Function">Im</a> <a id="17363" href="Demos.HSP.html#17347" class="Bound">f</a> <a id="17365" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="17367" href="Demos.HSP.html#17018" class="Bound">ğ‘©</a>
 <a id="17370" href="Demos.HSP.html#17337" class="Function">fromIm</a> <a id="17377" href="Demos.HSP.html#17377" class="Bound">f</a> <a id="17379" class="Symbol">=</a> <a id="17381" class="Keyword">record</a> <a id="17388" class="Symbol">{</a> <a id="17390" href="Function.Bundles.html#1919" class="Field">f</a> <a id="17392" class="Symbol">=</a> <a id="17394" class="Symbol">Î»</a> <a id="17396" href="Demos.HSP.html#17396" class="Bound">x</a> <a id="17398" class="Symbol">â†’</a> <a id="17400" href="Demos.HSP.html#17377" class="Bound">f</a> <a id="17402" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="17406" href="Demos.HSP.html#17396" class="Bound">x</a> <a id="17408" class="Symbol">;</a> <a id="17410" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="17415" class="Symbol">=</a> <a id="17417" href="Function.Base.html#615" class="Function">id</a> <a id="17420" class="Symbol">}</a>

 <a id="17424" href="Demos.HSP.html#17424" class="Function">fromIm-inj</a> <a id="17435" class="Symbol">:</a> <a id="17437" class="Symbol">(</a><a id="17438" href="Demos.HSP.html#17438" class="Bound">f</a> <a id="17440" class="Symbol">:</a> <a id="17442" href="Demos.HSP.html#17001" class="Bound">ğ‘¨</a> <a id="17444" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="17446" href="Demos.HSP.html#17018" class="Bound">ğ‘©</a><a id="17447" class="Symbol">)</a> <a id="17449" class="Symbol">â†’</a> <a id="17451" href="Demos.HSP.html#15537" class="Function">IsInjective</a> <a id="17463" class="Symbol">(</a><a id="17464" href="Demos.HSP.html#17337" class="Function">fromIm</a> <a id="17471" href="Demos.HSP.html#17438" class="Bound">f</a><a id="17472" class="Symbol">)</a>
 <a id="17475" href="Demos.HSP.html#17424" class="Function">fromIm-inj</a> <a id="17486" class="Symbol">_</a> <a id="17488" class="Symbol">=</a> <a id="17490" href="Function.Base.html#615" class="Function">id</a>

 <a id="17495" href="Demos.HSP.html#17495" class="Function">toIm-surj</a> <a id="17505" class="Symbol">:</a> <a id="17507" class="Symbol">(</a><a id="17508" href="Demos.HSP.html#17508" class="Bound">f</a> <a id="17510" class="Symbol">:</a> <a id="17512" href="Demos.HSP.html#17001" class="Bound">ğ‘¨</a> <a id="17514" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="17516" href="Demos.HSP.html#17018" class="Bound">ğ‘©</a><a id="17517" class="Symbol">)</a> <a id="17519" class="Symbol">â†’</a> <a id="17521" href="Demos.HSP.html#15620" class="Function">IsSurjective</a> <a id="17534" class="Symbol">(</a><a id="17535" href="Demos.HSP.html#17261" class="Function">toIm</a> <a id="17540" href="Demos.HSP.html#17508" class="Bound">f</a><a id="17541" class="Symbol">)</a>
 <a id="17544" href="Demos.HSP.html#17495" class="Function">toIm-surj</a> <a id="17554" class="Symbol">_</a> <a id="17556" class="Symbol">=</a> <a id="17558" href="Demos.HSP.html#13459" class="InductiveConstructor">eq</a> <a id="17561" class="Symbol">_</a> <a id="17563" class="Symbol">(</a><a id="17564" href="Demos.HSP.html#8932" class="Function">reflË¢</a> <a id="17570" href="Demos.HSP.html#17018" class="Bound">ğ‘©</a><a id="17571" class="Symbol">)</a>

</pre>

%\paragraph*{Kernels of setoid functions}
%The \defn{kernel} of a function \ab f~\as :~\ab A~\as{â†’}~\ab B is defined informally by \{\AgdaPair{x}{y} \aod{âˆˆ} \ab A \aof{Ã—} \ab A \as : \ab f \ab x \as{=} \ab f \ab y\}. This can be represented in a number of ways, but for our purposes it is convenient to define the kernel as an inhabitant of a (unary) predicate over \ab A \aof{Ã—} \ab A.

%% -------------------------------------------------------------------------------------

\section{Basic Universal Algebra}
\label{basic-universal-algebra}
We now develop a working vocabulary in \mltt corresponding to classical,
single-sorted, set-based universal algebra.
We cover a number of important concepts, but limit ourselves to those
required to prove Birkhoff's HSP theorem.
%\footnote{The concepts we formalize here are just a fraction of those formalized in the \agdaalgebras library.}
In each case, we give a type-theoretic version of the informal definition,
followed by its \agda implementation.

This section is organized into the following subsections:
Â§\ref{signatures} defines a general type of \emph{signatures} of algebraic structures;
Â§\ref{algebras} does the same for structures and their products;
Â§\ref{homomorphisms} defines \emph{homomorphisms}, \emph{monomorphisms}, and \emph{epimorphisms},
presents types that codify these concepts, and formally verifies some of their basic properties;
Â§\ref{subalgebras}--\ref{terms} do the same for \emph{subalgebras} and \emph{terms}, respectively.

%% -----------------------------------------------------------------------------
\subsection{Signatures}
\label{signatures}

\ifshort
An (algebraic) \defn{signature}
\else
In model theory, the \defn{signature} of a structure is a quadruple \ab{ğ‘†} = (\ab{C},
\ab{F}, \ab{R}, \ab{Ï}) consisting of three (possibly empty) sets \ab{C}, \ab{F}, and
\ab{R}---called \emph{constant}, \emph{function}, and \emph{relation} symbols,
respectively---along with a function \ab{Ï} : \ab{C} \as{+} \ab{F} \as{+} \ab{R}
\as{â†’} \ab{N} that assigns an \emph{arity} to each symbol. Often, but not always, \ab{N}
is taken to be the set of natural numbers.

As our focus here is universal algebra, we consider the restricted notion of an
\emph{algebraic signature}, that is, a signature for ``purely algebraic'' structures. Such
a signature
\fi
is a pair \ab{ğ‘†} = \AgdaPair{F}{Ï} where \ab{F} is a collection of
\defn{operation symbols} and \ab{Ï} : \ab{F} \as{â†’} \ab{N} is an \defn{arity function}
which maps each operation symbol to its arity. Here, \ab{N} denotes the \emph{arity type}.
Heuristically, the arity \ab{Ï} \ab{f} of an operation symbol \ab{f} \aof{âˆˆ} \ab{F} may be
thought of as the number of arguments that \ab{f} takes as ``input.''
%Here (and in the \agdaalgebras library) w
We represent signatures as inhabitants of the following dependent pair type.

\begin{center}

\AgdaFunction{Signature}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“}\AgdaSpace{}%
\AgdaBound{ğ“¥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Level}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{lsuc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¥}\AgdaSymbol{))}\\[4pt]
\AgdaFunction{Signature}\AgdaSpace{}%
\AgdaBound{ğ“}\AgdaSpace{}%
\AgdaBound{ğ“¥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Î£[}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaFunction{âˆˆ}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaBound{ğ“}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{F}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaBound{ğ“¥}\AgdaSymbol{)}

\end{center}
Recalling our syntax for the first and second
projections, if \ab{ğ‘†} %\as{:} \af{Signature} \ab{ğ“} \ab{ğ“¥}
is a signature, then
\aof{âˆ£} \ab{ğ‘†} \aof{âˆ£} denotes the set of operation symbols and \aof{âˆ¥} \ab{ğ‘†} \aof{âˆ¥} denotes the arity function.
Thus, if \ab{f} \as{:} \aof{âˆ£} \ab{ğ‘†} \aof{âˆ£} is an operation symbol in the
signature \ab{ğ‘†}, then \aof{âˆ¥} \ab{ğ‘†} \aof{âˆ¥} \ab{f} is the arity of \ab{f}.

We need to augment our \af{Signature} type so that it supports algebras over setoid domains.
To do so, following Abel~\cite{Abel:2021}, we
define an operator that translates an ordinary signature into a \defn{setoid signature},
that is, a signature over a setoid domain.
This raises a minor technical issue:
given operations \ab{f} and \ab{g}, with arguments
\ab{u}~\as{:}~\aof{âˆ¥}~\ab{ğ‘†}~\aof{âˆ¥}~\ab{f}~\as{â†’}~\ab{A} and \ab{v}~\as{:}~\aof{âˆ¥}~\ab{ğ‘†}~\aof{âˆ¥}~\ab{g}~\as{â†’}~\ab{A}, respectively, and a proof of \ab{f}~\aod{â‰¡}~\ab{g} (\textit{intensional} equality), we ought to be able to check whether \ab u and \ab v are pointwise
equal. Technically, \ab{u} and \ab{v} appear to inhabit different types; of course, this is reconciled by the hypothesis \ab f \aod{â‰¡} \ab g, as we see in the next definition (borrowed
from~\cite{Abel:2021}).

<pre class="Agda">

<a id="EqArgs"></a><a id="22597" href="Demos.HSP.html#22597" class="Function">EqArgs</a> <a id="22604" class="Symbol">:</a>  <a id="22607" class="Symbol">{</a><a id="22608" href="Demos.HSP.html#22608" class="Bound">ğ‘†</a> <a id="22610" class="Symbol">:</a> <a id="22612" href="Base.Algebras.Basic.html#3890" class="Function">Signature</a> <a id="22622" href="Demos.HSP.html#7257" class="Bound">ğ“</a> <a id="22624" href="Demos.HSP.html#7259" class="Bound">ğ“¥</a><a id="22625" class="Symbol">}{</a><a id="22627" href="Demos.HSP.html#22627" class="Bound">Î¾</a> <a id="22629" class="Symbol">:</a> <a id="22631" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="22638" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="22640" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="22642" class="Symbol">}</a>
 <a id="22645" class="Symbol">â†’</a>        <a id="22654" class="Symbol">âˆ€</a> <a id="22656" class="Symbol">{</a><a id="22657" href="Demos.HSP.html#22657" class="Bound">f</a> <a id="22659" href="Demos.HSP.html#22659" class="Bound">g</a><a id="22660" class="Symbol">}</a> <a id="22662" class="Symbol">â†’</a> <a id="22664" href="Demos.HSP.html#22657" class="Bound">f</a> <a id="22666" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="22668" href="Demos.HSP.html#22659" class="Bound">g</a> <a id="22670" class="Symbol">â†’</a> <a id="22672" class="Symbol">(</a><a id="22673" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="22675" href="Demos.HSP.html#22608" class="Bound">ğ‘†</a> <a id="22677" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="22679" href="Demos.HSP.html#22657" class="Bound">f</a> <a id="22681" class="Symbol">â†’</a> <a id="22683" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a> <a id="22691" href="Demos.HSP.html#22627" class="Bound">Î¾</a><a id="22692" class="Symbol">)</a> <a id="22694" class="Symbol">â†’</a> <a id="22696" class="Symbol">(</a><a id="22697" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="22699" href="Demos.HSP.html#22608" class="Bound">ğ‘†</a> <a id="22701" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="22703" href="Demos.HSP.html#22659" class="Bound">g</a> <a id="22705" class="Symbol">â†’</a> <a id="22707" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a> <a id="22715" href="Demos.HSP.html#22627" class="Bound">Î¾</a><a id="22716" class="Symbol">)</a> <a id="22718" class="Symbol">â†’</a> <a id="22720" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="22725" class="Symbol">(</a><a id="22726" href="Demos.HSP.html#7259" class="Bound">ğ“¥</a> <a id="22728" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="22730" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="22732" class="Symbol">)</a>
<a id="22734" href="Demos.HSP.html#22597" class="Function">EqArgs</a> <a id="22741" class="Symbol">{</a><a id="22742" class="Argument">Î¾</a> <a id="22744" class="Symbol">=</a> <a id="22746" href="Demos.HSP.html#22746" class="Bound">Î¾</a><a id="22747" class="Symbol">}</a> <a id="22749" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="22756" href="Demos.HSP.html#22756" class="Bound">u</a> <a id="22758" href="Demos.HSP.html#22758" class="Bound">v</a> <a id="22760" class="Symbol">=</a> <a id="22762" class="Symbol">âˆ€</a> <a id="22764" href="Demos.HSP.html#22764" class="Bound">i</a> <a id="22766" class="Symbol">â†’</a> <a id="22768" href="Demos.HSP.html#22756" class="Bound">u</a> <a id="22770" href="Demos.HSP.html#22764" class="Bound">i</a> <a id="22772" href="Relation.Binary.Bundles.html#1098" class="Function Operator">â‰ˆ</a> <a id="22774" href="Demos.HSP.html#22758" class="Bound">v</a> <a id="22776" href="Demos.HSP.html#22764" class="Bound">i</a> <a id="22778" class="Keyword">where</a> <a id="22784" class="Keyword">open</a> <a id="22789" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="22796" href="Demos.HSP.html#22746" class="Bound">Î¾</a> <a id="22798" class="Keyword">using</a> <a id="22804" class="Symbol">(</a> <a id="22806" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="22810" class="Symbol">)</a>

</pre>
\noindent
This makes it possible to define an operator which translates a signature for algebras over bare types into a signature for algebras over setoids.
We denote this operator by \aof{âŸ¨\AgdaUnderscore{}âŸ©}%
\ifshort
.
\else
 and define it as follows.
\fi

<pre class="Agda">

<a id="âŸ¨_âŸ©"></a><a id="23098" href="Demos.HSP.html#23098" class="Function Operator">âŸ¨_âŸ©</a> <a id="23102" class="Symbol">:</a> <a id="23104" href="Base.Algebras.Basic.html#3890" class="Function">Signature</a> <a id="23114" href="Demos.HSP.html#7257" class="Bound">ğ“</a> <a id="23116" href="Demos.HSP.html#7259" class="Bound">ğ“¥</a> <a id="23118" class="Symbol">â†’</a> <a id="23120" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="23127" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="23129" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="23132" class="Symbol">â†’</a> <a id="23134" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="23141" class="Symbol">_</a> <a id="23143" class="Symbol">_</a>

<a id="23146" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a>  <a id="23155" class="Symbol">(</a><a id="23156" href="Demos.HSP.html#23098" class="Function Operator">âŸ¨</a> <a id="23158" href="Demos.HSP.html#23158" class="Bound">ğ‘†</a> <a id="23160" href="Demos.HSP.html#23098" class="Function Operator">âŸ©</a> <a id="23162" href="Demos.HSP.html#23162" class="Bound">Î¾</a><a id="23163" class="Symbol">)</a>                <a id="23180" class="Symbol">=</a> <a id="23182" href="Data.Product.html#916" class="Function">Î£[</a> <a id="23185" href="Demos.HSP.html#23185" class="Bound">f</a> <a id="23187" href="Data.Product.html#916" class="Function">âˆˆ</a> <a id="23189" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="23191" href="Demos.HSP.html#23158" class="Bound">ğ‘†</a> <a id="23193" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="23195" href="Data.Product.html#916" class="Function">]</a> <a id="23197" class="Symbol">(</a><a id="23198" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="23200" href="Demos.HSP.html#23158" class="Bound">ğ‘†</a> <a id="23202" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="23204" href="Demos.HSP.html#23185" class="Bound">f</a> <a id="23206" class="Symbol">â†’</a> <a id="23208" href="Demos.HSP.html#23162" class="Bound">Î¾</a> <a id="23210" class="Symbol">.</a><a id="23211" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a><a id="23218" class="Symbol">)</a>
<a id="23220" href="Demos.HSP.html#9112" class="Field Operator">_â‰ˆË¢_</a>     <a id="23229" class="Symbol">(</a><a id="23230" href="Demos.HSP.html#23098" class="Function Operator">âŸ¨</a> <a id="23232" href="Demos.HSP.html#23232" class="Bound">ğ‘†</a> <a id="23234" href="Demos.HSP.html#23098" class="Function Operator">âŸ©</a> <a id="23236" href="Demos.HSP.html#23236" class="Bound">Î¾</a><a id="23237" class="Symbol">)(</a><a id="23239" href="Demos.HSP.html#23239" class="Bound">f</a> <a id="23241" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="23243" href="Demos.HSP.html#23243" class="Bound">u</a><a id="23244" class="Symbol">)(</a><a id="23246" href="Demos.HSP.html#23246" class="Bound">g</a> <a id="23248" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="23250" href="Demos.HSP.html#23250" class="Bound">v</a><a id="23251" class="Symbol">)</a>  <a id="23254" class="Symbol">=</a> <a id="23256" href="Data.Product.html#916" class="Function">Î£[</a> <a id="23259" href="Demos.HSP.html#23259" class="Bound">eqv</a> <a id="23263" href="Data.Product.html#916" class="Function">âˆˆ</a> <a id="23265" href="Demos.HSP.html#23239" class="Bound">f</a> <a id="23267" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="23269" href="Demos.HSP.html#23246" class="Bound">g</a> <a id="23271" href="Data.Product.html#916" class="Function">]</a> <a id="23273" href="Demos.HSP.html#22597" class="Function">EqArgs</a><a id="23279" class="Symbol">{</a><a id="23280" class="Argument">Î¾</a> <a id="23282" class="Symbol">=</a> <a id="23284" href="Demos.HSP.html#23236" class="Bound">Î¾</a><a id="23285" class="Symbol">}</a> <a id="23287" href="Demos.HSP.html#23259" class="Bound">eqv</a> <a id="23291" href="Demos.HSP.html#23243" class="Bound">u</a> <a id="23293" href="Demos.HSP.html#23250" class="Bound">v</a>

<a id="23296" href="Demos.HSP.html#8708" class="Field">refláµ‰</a>   <a id="23304" class="Symbol">(</a><a id="23305" href="Relation.Binary.Bundles.html#1132" class="Field">isEquivalence</a> <a id="23319" class="Symbol">(</a><a id="23320" href="Demos.HSP.html#23098" class="Function Operator">âŸ¨</a> <a id="23322" href="Demos.HSP.html#23322" class="Bound">ğ‘†</a> <a id="23324" href="Demos.HSP.html#23098" class="Function Operator">âŸ©</a> <a id="23326" href="Demos.HSP.html#23326" class="Bound">Î¾</a><a id="23327" class="Symbol">))</a>                           <a id="23356" class="Symbol">=</a> <a id="23358" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="23365" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="23367" class="Symbol">Î»</a> <a id="23369" href="Demos.HSP.html#23369" class="Bound">i</a> <a id="23371" class="Symbol">â†’</a> <a id="23373" href="Demos.HSP.html#8932" class="Function">reflË¢</a>   <a id="23381" href="Demos.HSP.html#23326" class="Bound">Î¾</a>
<a id="23383" href="Demos.HSP.html#8769" class="Field">symáµ‰</a>    <a id="23391" class="Symbol">(</a><a id="23392" href="Relation.Binary.Bundles.html#1132" class="Field">isEquivalence</a> <a id="23406" class="Symbol">(</a><a id="23407" href="Demos.HSP.html#23098" class="Function Operator">âŸ¨</a> <a id="23409" href="Demos.HSP.html#23409" class="Bound">ğ‘†</a> <a id="23411" href="Demos.HSP.html#23098" class="Function Operator">âŸ©</a> <a id="23413" href="Demos.HSP.html#23413" class="Bound">Î¾</a><a id="23414" class="Symbol">))</a> <a id="23417" class="Symbol">(</a><a id="23418" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="23425" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="23427" href="Demos.HSP.html#23427" class="Bound">g</a><a id="23428" class="Symbol">)</a>              <a id="23443" class="Symbol">=</a> <a id="23445" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="23452" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="23454" class="Symbol">Î»</a> <a id="23456" href="Demos.HSP.html#23456" class="Bound">i</a> <a id="23458" class="Symbol">â†’</a> <a id="23460" href="Demos.HSP.html#8993" class="Function">symË¢</a>    <a id="23468" href="Demos.HSP.html#23413" class="Bound">Î¾</a> <a id="23470" class="Symbol">(</a><a id="23471" href="Demos.HSP.html#23427" class="Bound">g</a> <a id="23473" href="Demos.HSP.html#23456" class="Bound">i</a><a id="23474" class="Symbol">)</a>
<a id="23476" href="Demos.HSP.html#8830" class="Field">transáµ‰</a>  <a id="23484" class="Symbol">(</a><a id="23485" href="Relation.Binary.Bundles.html#1132" class="Field">isEquivalence</a> <a id="23499" class="Symbol">(</a><a id="23500" href="Demos.HSP.html#23098" class="Function Operator">âŸ¨</a> <a id="23502" href="Demos.HSP.html#23502" class="Bound">ğ‘†</a> <a id="23504" href="Demos.HSP.html#23098" class="Function Operator">âŸ©</a> <a id="23506" href="Demos.HSP.html#23506" class="Bound">Î¾</a><a id="23507" class="Symbol">))</a> <a id="23510" class="Symbol">(</a><a id="23511" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="23518" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="23520" href="Demos.HSP.html#23520" class="Bound">g</a><a id="23521" class="Symbol">)(</a><a id="23523" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="23530" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="23532" href="Demos.HSP.html#23532" class="Bound">h</a><a id="23533" class="Symbol">)</a>  <a id="23536" class="Symbol">=</a> <a id="23538" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="23545" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="23547" class="Symbol">Î»</a> <a id="23549" href="Demos.HSP.html#23549" class="Bound">i</a> <a id="23551" class="Symbol">â†’</a> <a id="23553" href="Demos.HSP.html#9054" class="Function">transË¢</a>  <a id="23561" href="Demos.HSP.html#23506" class="Bound">Î¾</a> <a id="23563" class="Symbol">(</a><a id="23564" href="Demos.HSP.html#23520" class="Bound">g</a> <a id="23566" href="Demos.HSP.html#23549" class="Bound">i</a><a id="23567" class="Symbol">)</a> <a id="23569" class="Symbol">(</a><a id="23570" href="Demos.HSP.html#23532" class="Bound">h</a> <a id="23572" href="Demos.HSP.html#23549" class="Bound">i</a><a id="23573" class="Symbol">)</a>
</pre>

%% -----------------------------------------------------------------------------
\subsection{Algebras}\label{algebras}
An \defn{algebraic structure} \ab{ğ‘¨} = (\ab{A}, \ab{Fá´¬}) \defn{in the signature}
\ab{ğ‘†} = (\ab{F}, \ab{Ï}), or \ab{ğ‘†}-\defn{algebra}, consists of
\begin{itemize}
\item a type \ab A, called the \defn{domain} of the algebra;
\item a collection \ab{Fá´¬} :=
  \{ \ab{fá´¬} \as{âˆ£} \ab f \aof{âˆˆ} \ab F, \ab{fá´¬} \as :
    (\ab{Ï} \ab f \as{â†’} \ab A) \as{â†’} \ab A \} of \defn{operations} on \ab{A};
\item a (potentially empty) collection of \defn{identities} satisfied by elements and
operations of \ab{ğ‘¨}.
\end{itemize}
Our \agda implementation represents algebras as inhabitants of a record type with two
fields---a \afld{Domain} setoid denoting the domain of the algebra, and an \afld{Interp} function denoting the interpretation in the algebra of each operation symbol in \ab{ğ‘†}. We postpone introducing identities until~Â§\ref{equational-logic}.

<pre class="Agda">

<a id="24560" class="Keyword">record</a> <a id="Algebra"></a><a id="24567" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="24575" href="Demos.HSP.html#24575" class="Bound">Î±</a> <a id="24577" href="Demos.HSP.html#24577" class="Bound">Ï</a> <a id="24579" class="Symbol">:</a> <a id="24581" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="24586" class="Symbol">(</a><a id="24587" href="Demos.HSP.html#7257" class="Bound">ğ“</a> <a id="24589" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="24591" href="Demos.HSP.html#7259" class="Bound">ğ“¥</a> <a id="24593" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="24595" href="Agda.Primitive.html#780" class="Primitive">lsuc</a> <a id="24600" class="Symbol">(</a><a id="24601" href="Demos.HSP.html#24575" class="Bound">Î±</a> <a id="24603" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="24605" href="Demos.HSP.html#24577" class="Bound">Ï</a><a id="24606" class="Symbol">))</a> <a id="24609" class="Keyword">where</a>
 <a id="24616" class="Keyword">field</a>  <a id="Algebra.Domain"></a><a id="24623" href="Demos.HSP.html#24623" class="Field">Domain</a>  <a id="24631" class="Symbol">:</a> <a id="24633" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="24640" href="Demos.HSP.html#24575" class="Bound">Î±</a> <a id="24642" href="Demos.HSP.html#24577" class="Bound">Ï</a>
        <a id="Algebra.Interp"></a><a id="24652" href="Demos.HSP.html#24652" class="Field">Interp</a>  <a id="24660" class="Symbol">:</a> <a id="24662" href="Demos.HSP.html#23098" class="Function Operator">âŸ¨</a> <a id="24664" href="Demos.HSP.html#7243" class="Bound">ğ‘†</a> <a id="24666" href="Demos.HSP.html#23098" class="Function Operator">âŸ©</a> <a id="24668" href="Demos.HSP.html#24623" class="Field">Domain</a> <a id="24675" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="24677" href="Demos.HSP.html#24623" class="Field">Domain</a>

</pre>
Thus, for each operation symbol in \ab{ğ‘†} we have a setoid function
\ab f whose domain is a power of \afld{Domain} and whose codomain is \afld{Domain}.
Further, we define some syntactic sugar to make our formalizations easier to read and reason about. Specifically, if \ab{ğ‘¨} is an algebra, then
\begin{itemize}
\item \aof{ğ”»[ \ab{ğ‘¨} ]} denotes the \afld{Domain} setoid of \ab{ğ‘¨},
\item \aof{ğ•Œ[ \ab{ğ‘¨} ]} is the underlying carrier of (the \afld{Domain} setoid of) \ab{ğ‘¨}, and
\item \ab f \aof{Ì‚} \ab{ğ‘¨} denotes the interpretation of the operation symbol \ab f in the algebra \ab{ğ‘¨}.
\end{itemize}
\ifshort %%% BEGIN SHORT VERSION ONLY
 We omit the straightforward formal definitions (\seemedium).
\else    %%% END SHORT VERSION ONLY
         %%% BEGIN LONG VERSION ONLY SECTION
<pre class="Agda">
<a id="25486" class="Keyword">open</a> <a id="25491" href="Demos.HSP.html#24567" class="Module">Algebra</a>
<a id="ğ”»[_]"></a><a id="25499" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[_]</a> <a id="25504" class="Symbol">:</a> <a id="25506" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="25514" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="25516" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="25519" class="Symbol">â†’</a>  <a id="25522" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="25529" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="25531" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a>
<a id="25534" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="25537" href="Demos.HSP.html#25537" class="Bound">ğ‘¨</a> <a id="25539" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="25541" class="Symbol">=</a> <a id="25543" href="Demos.HSP.html#24623" class="Field">Domain</a> <a id="25550" href="Demos.HSP.html#25537" class="Bound">ğ‘¨</a>
<a id="ğ•Œ[_]"></a><a id="25552" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[_]</a> <a id="25557" class="Symbol">:</a> <a id="25559" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="25567" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="25569" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="25572" class="Symbol">â†’</a>  <a id="25575" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="25580" href="Demos.HSP.html#9438" class="Generalizable">Î±</a>
<a id="25582" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="25585" href="Demos.HSP.html#25585" class="Bound">ğ‘¨</a> <a id="25587" href="Demos.HSP.html#25552" class="Function Operator">]</a> <a id="25589" class="Symbol">=</a> <a id="25591" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a> <a id="25599" class="Symbol">(</a><a id="25600" href="Demos.HSP.html#24623" class="Field">Domain</a> <a id="25607" href="Demos.HSP.html#25585" class="Bound">ğ‘¨</a><a id="25608" class="Symbol">)</a>
<a id="_Ì‚_"></a><a id="25610" href="Demos.HSP.html#25610" class="Function Operator">_Ì‚_</a> <a id="25614" class="Symbol">:</a> <a id="25616" class="Symbol">(</a><a id="25617" href="Demos.HSP.html#25617" class="Bound">f</a> <a id="25619" class="Symbol">:</a> <a id="25621" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="25623" href="Demos.HSP.html#7243" class="Bound">ğ‘†</a> <a id="25625" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a><a id="25626" class="Symbol">)(</a><a id="25628" href="Demos.HSP.html#25628" class="Bound">ğ‘¨</a> <a id="25630" class="Symbol">:</a> <a id="25632" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="25640" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="25642" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="25644" class="Symbol">)</a> <a id="25646" class="Symbol">â†’</a> <a id="25648" class="Symbol">(</a><a id="25649" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="25651" href="Demos.HSP.html#7243" class="Bound">ğ‘†</a> <a id="25653" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="25655" href="Demos.HSP.html#25617" class="Bound">f</a>  <a id="25658" class="Symbol">â†’</a>  <a id="25661" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="25664" href="Demos.HSP.html#25628" class="Bound">ğ‘¨</a> <a id="25666" href="Demos.HSP.html#25552" class="Function Operator">]</a><a id="25667" class="Symbol">)</a> <a id="25669" class="Symbol">â†’</a> <a id="25671" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="25674" href="Demos.HSP.html#25628" class="Bound">ğ‘¨</a> <a id="25676" href="Demos.HSP.html#25552" class="Function Operator">]</a>
<a id="25678" href="Demos.HSP.html#25678" class="Bound">f</a> <a id="25680" href="Demos.HSP.html#25610" class="Function Operator">Ì‚</a> <a id="25682" href="Demos.HSP.html#25682" class="Bound">ğ‘¨</a> <a id="25684" class="Symbol">=</a> <a id="25686" class="Symbol">Î»</a> <a id="25688" href="Demos.HSP.html#25688" class="Bound">a</a> <a id="25690" class="Symbol">â†’</a> <a id="25692" class="Symbol">(</a><a id="25693" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="25700" href="Demos.HSP.html#25682" class="Bound">ğ‘¨</a><a id="25701" class="Symbol">)</a> <a id="25703" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="25707" class="Symbol">(</a><a id="25708" href="Demos.HSP.html#25678" class="Bound">f</a> <a id="25710" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="25712" href="Demos.HSP.html#25688" class="Bound">a</a><a id="25713" class="Symbol">)</a>
</pre>
\fi
%
%% -----------------------------------------------------------------------------
\paragraph*{Universe levels of algebra types}
Types belong to \emph{universes}, which are structured in \agda as
follows:
\ap{Type} \ab{â„“} : \ap{Type} (\ap{suc} \ab{â„“}), \ap{Type} (\ap{suc} \ab{â„“}) : \ap{Type}
(\ap{suc} (\ap{suc} \ab{â„“})), â€¦.\footnote{\ap{suc} \ab{â„“} denotes the successor of \ab{â„“} in the universe hierarchy.} While this means that \ap{Type} \ab{â„“} has type \ap{Type}
(\ap{suc} \ab{â„“}), it does \emph{not} imply that \ap{Type} \ab{â„“} has type
\ap{Type} (\ap{suc} (\ap{suc} \ab{â„“})). In other words, \agda's universes are
\emph{non-cumulative}.
This can be advantageous as it becomes possible to treat size issues
more generally and precisely.  However, dealing with explicit
universe levels can be daunting, and the standard literature
(in which uniform smallness is typically assumed) offers little guidance.
\ifshort\else
This aspect of the language was one of the few stumbling
blocks we encountered while learning how to use \agda for formalizing universal algebra in
type theory. Although some may consider this to be one of the least interesting and most
technical aspects of this paper, others might find the presentation more helpful if we
resist the urge to gloss over these technicalities.
\fi
While in some settings, such as category theory, formalizing in \agda
works smoothly with respect to universe levels (see~\cite{agda-categories}), in universal algebra the
terrain is bumpier.
Thus, it seems worthwhile to explain how we make use
of universe lifting and lowering functions, available in the \agdastdlib, to
develop domain-specific tools for dealing with \agda's non-cumulative universe hierarchy.

\ifshort\else
Let us be more concrete about what is at issue by considering a typical example. \agda
frequently encounters problems during the type-checking process and responds by printing a
message like the following.
{\color{red}{\small
\begin{verbatim}
  HSP.lagda:498,20-23
  Î± != ğ“ âŠ” ğ“¥ âŠ” (lsuc Î±) when checking that... has type...
\end{verbatim}}}
\noindent Here \agda informs us that it encountered universe level \ab{Î±} on line 498 of
the HSP module, where it was expecting level \ab{ğ“}~\aop{âŠ”}~\ab{ğ“¥}~\aop{âŠ”}~(\ap{lsuc}
\ab{Î±}). In this case, we tried to use an algebra inhabiting the type \ar{Algebra}
\ab{Î±} \ab{Ïáµƒ} whereas \agda expected an inhabitant of the type \ar{Algebra} (\ab{ğ“}
\aop{âŠ”} \ab{ğ“¥} \aop{âŠ”} (\ap{lsuc} \ab{Î±})) \ab{Ïáµƒ}.
\fi
The \ar{Lift} operation of the standard library embeds a type into a higher universe.
Specializing \ar{Lift} to our situation, we
define a function \af{Lift-Alg}%
\ifshort
~with the following interface.
\vskip-2mm
\else
.

<pre class="Agda">

<a id="28438" class="Keyword">module</a> <a id="28445" href="Demos.HSP.html#28445" class="Module">_</a> <a id="28447" class="Symbol">(</a><a id="28448" href="Demos.HSP.html#28448" class="Bound">ğ‘¨</a> <a id="28450" class="Symbol">:</a> <a id="28452" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="28460" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="28462" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="28464" class="Symbol">)</a> <a id="28466" class="Keyword">where</a>
 <a id="28473" class="Keyword">open</a> <a id="28478" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="28485" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="28488" href="Demos.HSP.html#28448" class="Bound">ğ‘¨</a> <a id="28490" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="28492" class="Keyword">using</a> <a id="28498" class="Symbol">(</a> <a id="28500" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="28504" class="Symbol">;</a> <a id="28506" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="28511" class="Symbol">;</a> <a id="28513" href="Relation.Binary.Structures.html#1594" class="Function">sym</a> <a id="28517" class="Symbol">;</a> <a id="28519" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="28525" class="Symbol">)</a> <a id="28527" class="Symbol">;</a> <a id="28529" class="Keyword">open</a> <a id="28534" href="Level.html" class="Module">Level</a>
 <a id="28541" href="Demos.HSP.html#28541" class="Function">Lift-AlgË¡</a> <a id="28551" class="Symbol">:</a> <a id="28553" class="Symbol">(</a><a id="28554" href="Demos.HSP.html#28554" class="Bound">â„“</a> <a id="28556" class="Symbol">:</a> <a id="28558" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="28563" class="Symbol">)</a> <a id="28565" class="Symbol">â†’</a> <a id="28567" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="28575" class="Symbol">(</a><a id="28576" href="Demos.HSP.html#28460" class="Bound">Î±</a> <a id="28578" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="28580" href="Demos.HSP.html#28554" class="Bound">â„“</a><a id="28581" class="Symbol">)</a> <a id="28583" href="Demos.HSP.html#28462" class="Bound">Ïáµƒ</a>
 <a id="28587" href="Demos.HSP.html#24623" class="Field">Domain</a> <a id="28594" class="Symbol">(</a><a id="28595" href="Demos.HSP.html#28541" class="Function">Lift-AlgË¡</a> <a id="28605" href="Demos.HSP.html#28605" class="Bound">â„“</a><a id="28606" class="Symbol">)</a> <a id="28608" class="Symbol">=</a>
  <a id="28612" class="Keyword">record</a>  <a id="28620" class="Symbol">{</a> <a id="28622" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a>        <a id="28637" class="Symbol">=</a> <a id="28639" href="Level.html#400" class="Record">Lift</a> <a id="28644" href="Demos.HSP.html#28605" class="Bound">â„“</a> <a id="28646" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="28649" href="Demos.HSP.html#28448" class="Bound">ğ‘¨</a> <a id="28651" href="Demos.HSP.html#25552" class="Function Operator">]</a>
          <a id="28663" class="Symbol">;</a> <a id="28665" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a>            <a id="28680" class="Symbol">=</a> <a id="28682" class="Symbol">Î»</a> <a id="28684" href="Demos.HSP.html#28684" class="Bound">x</a> <a id="28686" href="Demos.HSP.html#28686" class="Bound">y</a> <a id="28688" class="Symbol">â†’</a> <a id="28690" href="Level.html#470" class="Field">lower</a> <a id="28696" href="Demos.HSP.html#28684" class="Bound">x</a> <a id="28698" href="Relation.Binary.Bundles.html#1098" class="Function Operator">â‰ˆ</a> <a id="28700" href="Level.html#470" class="Field">lower</a> <a id="28706" href="Demos.HSP.html#28686" class="Bound">y</a>
          <a id="28718" class="Symbol">;</a> <a id="28720" href="Relation.Binary.Bundles.html#1132" class="Field">isEquivalence</a>  <a id="28735" class="Symbol">=</a> <a id="28737" class="Keyword">record</a> <a id="28744" class="Symbol">{</a> <a id="28746" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="28751" class="Symbol">=</a> <a id="28753" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="28758" class="Symbol">;</a> <a id="28760" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="28764" class="Symbol">=</a> <a id="28766" href="Relation.Binary.Structures.html#1594" class="Function">sym</a> <a id="28770" class="Symbol">;</a> <a id="28772" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="28778" class="Symbol">=</a> <a id="28780" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="28786" class="Symbol">}}</a>

 <a id="28791" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="28798" class="Symbol">(</a><a id="28799" href="Demos.HSP.html#28541" class="Function">Lift-AlgË¡</a> <a id="28809" href="Demos.HSP.html#28809" class="Bound">â„“</a><a id="28810" class="Symbol">)</a> <a id="28812" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="28816" class="Symbol">(</a><a id="28817" href="Demos.HSP.html#28817" class="Bound">f</a> <a id="28819" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="28821" href="Demos.HSP.html#28821" class="Bound">la</a><a id="28823" class="Symbol">)</a> <a id="28825" class="Symbol">=</a> <a id="28827" href="Level.html#457" class="InductiveConstructor">lift</a> <a id="28832" class="Symbol">((</a><a id="28834" href="Demos.HSP.html#28817" class="Bound">f</a> <a id="28836" href="Demos.HSP.html#25610" class="Function Operator">Ì‚</a> <a id="28838" href="Demos.HSP.html#28448" class="Bound">ğ‘¨</a><a id="28839" class="Symbol">)</a> <a id="28841" class="Symbol">(</a><a id="28842" href="Level.html#470" class="Field">lower</a> <a id="28848" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="28850" href="Demos.HSP.html#28821" class="Bound">la</a><a id="28852" class="Symbol">))</a>
 <a id="28856" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="28861" class="Symbol">(</a><a id="28862" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="28869" class="Symbol">(</a><a id="28870" href="Demos.HSP.html#28541" class="Function">Lift-AlgË¡</a> <a id="28880" href="Demos.HSP.html#28880" class="Bound">â„“</a><a id="28881" class="Symbol">))</a> <a id="28884" class="Symbol">(</a><a id="28885" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="28892" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="28894" href="Demos.HSP.html#28894" class="Bound">lab</a><a id="28897" class="Symbol">)</a> <a id="28899" class="Symbol">=</a> <a id="28901" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="28906" class="Symbol">(</a><a id="28907" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="28914" href="Demos.HSP.html#28448" class="Bound">ğ‘¨</a><a id="28915" class="Symbol">)</a> <a id="28917" class="Symbol">((</a><a id="28919" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="28926" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="28928" href="Demos.HSP.html#28894" class="Bound">lab</a><a id="28931" class="Symbol">))</a>

 <a id="28936" href="Demos.HSP.html#28936" class="Function">Lift-AlgÊ³</a> <a id="28946" class="Symbol">:</a> <a id="28948" class="Symbol">(</a><a id="28949" href="Demos.HSP.html#28949" class="Bound">â„“</a> <a id="28951" class="Symbol">:</a> <a id="28953" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="28958" class="Symbol">)</a> <a id="28960" class="Symbol">â†’</a> <a id="28962" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="28970" href="Demos.HSP.html#28460" class="Bound">Î±</a> <a id="28972" class="Symbol">(</a><a id="28973" href="Demos.HSP.html#28462" class="Bound">Ïáµƒ</a> <a id="28976" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="28978" href="Demos.HSP.html#28949" class="Bound">â„“</a><a id="28979" class="Symbol">)</a>
 <a id="28982" href="Demos.HSP.html#24623" class="Field">Domain</a> <a id="28989" class="Symbol">(</a><a id="28990" href="Demos.HSP.html#28936" class="Function">Lift-AlgÊ³</a> <a id="29000" href="Demos.HSP.html#29000" class="Bound">â„“</a><a id="29001" class="Symbol">)</a> <a id="29003" class="Symbol">=</a>
  <a id="29007" class="Keyword">record</a>  <a id="29015" class="Symbol">{</a> <a id="29017" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a>        <a id="29032" class="Symbol">=</a> <a id="29034" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="29037" href="Demos.HSP.html#28448" class="Bound">ğ‘¨</a> <a id="29039" href="Demos.HSP.html#25552" class="Function Operator">]</a>
          <a id="29051" class="Symbol">;</a> <a id="29053" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a>            <a id="29068" class="Symbol">=</a> <a id="29070" class="Symbol">Î»</a> <a id="29072" href="Demos.HSP.html#29072" class="Bound">x</a> <a id="29074" href="Demos.HSP.html#29074" class="Bound">y</a> <a id="29076" class="Symbol">â†’</a> <a id="29078" href="Level.html#400" class="Record">Lift</a> <a id="29083" href="Demos.HSP.html#29000" class="Bound">â„“</a> <a id="29085" class="Symbol">(</a><a id="29086" href="Demos.HSP.html#29072" class="Bound">x</a> <a id="29088" href="Relation.Binary.Bundles.html#1098" class="Function Operator">â‰ˆ</a> <a id="29090" href="Demos.HSP.html#29074" class="Bound">y</a><a id="29091" class="Symbol">)</a>
          <a id="29103" class="Symbol">;</a> <a id="29105" href="Relation.Binary.Bundles.html#1132" class="Field">isEquivalence</a>  <a id="29120" class="Symbol">=</a> <a id="29122" class="Keyword">record</a>  <a id="29130" class="Symbol">{</a> <a id="29132" href="Relation.Binary.Structures.html#1568" class="Field">refl</a>  <a id="29138" class="Symbol">=</a> <a id="29140" href="Level.html#457" class="InductiveConstructor">lift</a> <a id="29145" href="Relation.Binary.Structures.html#1568" class="Function">refl</a>
                                     <a id="29187" class="Symbol">;</a> <a id="29189" href="Relation.Binary.Structures.html#1594" class="Field">sym</a>   <a id="29195" class="Symbol">=</a> <a id="29197" href="Level.html#457" class="InductiveConstructor">lift</a> <a id="29202" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="29204" href="Relation.Binary.Structures.html#1594" class="Function">sym</a> <a id="29208" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="29210" href="Level.html#470" class="Field">lower</a>
                                     <a id="29253" class="Symbol">;</a> <a id="29255" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="29261" class="Symbol">=</a> <a id="29263" class="Symbol">Î»</a> <a id="29265" href="Demos.HSP.html#29265" class="Bound">x</a> <a id="29267" href="Demos.HSP.html#29267" class="Bound">y</a> <a id="29269" class="Symbol">â†’</a> <a id="29271" href="Level.html#457" class="InductiveConstructor">lift</a> <a id="29276" class="Symbol">(</a><a id="29277" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="29283" class="Symbol">(</a><a id="29284" href="Level.html#470" class="Field">lower</a> <a id="29290" href="Demos.HSP.html#29265" class="Bound">x</a><a id="29291" class="Symbol">)(</a><a id="29293" href="Level.html#470" class="Field">lower</a> <a id="29299" href="Demos.HSP.html#29267" class="Bound">y</a><a id="29300" class="Symbol">))</a> <a id="29303" class="Symbol">}}</a>

 <a id="29308" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="29315" class="Symbol">(</a><a id="29316" href="Demos.HSP.html#28936" class="Function">Lift-AlgÊ³</a> <a id="29326" href="Demos.HSP.html#29326" class="Bound">â„“</a> <a id="29328" class="Symbol">)</a> <a id="29330" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="29334" class="Symbol">(</a><a id="29335" href="Demos.HSP.html#29335" class="Bound">f</a> <a id="29337" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="29339" href="Demos.HSP.html#29339" class="Bound">la</a><a id="29341" class="Symbol">)</a> <a id="29343" class="Symbol">=</a> <a id="29345" class="Symbol">(</a><a id="29346" href="Demos.HSP.html#29335" class="Bound">f</a> <a id="29348" href="Demos.HSP.html#25610" class="Function Operator">Ì‚</a> <a id="29350" href="Demos.HSP.html#28448" class="Bound">ğ‘¨</a><a id="29351" class="Symbol">)</a> <a id="29353" href="Demos.HSP.html#29339" class="Bound">la</a>
 <a id="29357" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="29362" class="Symbol">(</a><a id="29363" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="29370" class="Symbol">(</a><a id="29371" href="Demos.HSP.html#28936" class="Function">Lift-AlgÊ³</a> <a id="29381" href="Demos.HSP.html#29381" class="Bound">â„“</a><a id="29382" class="Symbol">))(</a><a id="29385" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="29392" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="29394" href="Demos.HSP.html#29394" class="Bound">lab</a><a id="29397" class="Symbol">)</a> <a id="29399" class="Symbol">=</a> <a id="29401" href="Level.html#457" class="InductiveConstructor">lift</a><a id="29405" class="Symbol">(</a><a id="29406" href="Function.Bundles.html#1938" class="Field">cong</a><a id="29410" class="Symbol">(</a><a id="29411" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="29418" href="Demos.HSP.html#28448" class="Bound">ğ‘¨</a><a id="29419" class="Symbol">)(</a><a id="29421" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="29428" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="29430" class="Symbol">Î»</a> <a id="29432" href="Demos.HSP.html#29432" class="Bound">i</a> <a id="29434" class="Symbol">â†’</a> <a id="29436" href="Level.html#470" class="Field">lower</a> <a id="29442" class="Symbol">(</a><a id="29443" href="Demos.HSP.html#29394" class="Bound">lab</a> <a id="29447" href="Demos.HSP.html#29432" class="Bound">i</a><a id="29448" class="Symbol">)))</a>
</pre>
\fi

<pre class="Agda">

<a id="Lift-Alg"></a><a id="29482" href="Demos.HSP.html#29482" class="Function">Lift-Alg</a> <a id="29491" class="Symbol">:</a> <a id="29493" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="29501" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="29503" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="29506" class="Symbol">â†’</a> <a id="29508" class="Symbol">(</a><a id="29509" href="Demos.HSP.html#29509" class="Bound">â„“â‚€</a> <a id="29512" href="Demos.HSP.html#29512" class="Bound">â„“â‚</a> <a id="29515" class="Symbol">:</a> <a id="29517" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="29522" class="Symbol">)</a> <a id="29524" class="Symbol">â†’</a> <a id="29526" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="29534" class="Symbol">(</a><a id="29535" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="29537" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="29539" href="Demos.HSP.html#29509" class="Bound">â„“â‚€</a><a id="29541" class="Symbol">)</a> <a id="29543" class="Symbol">(</a><a id="29544" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="29547" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="29549" href="Demos.HSP.html#29512" class="Bound">â„“â‚</a><a id="29551" class="Symbol">)</a>
</pre>
\ifshort
\vskip2mm
\else
<pre class="Agda">
<a id="29602" href="Demos.HSP.html#29482" class="Function">Lift-Alg</a> <a id="29611" href="Demos.HSP.html#29611" class="Bound">ğ‘¨</a> <a id="29613" href="Demos.HSP.html#29613" class="Bound">â„“â‚€</a> <a id="29616" href="Demos.HSP.html#29616" class="Bound">â„“â‚</a> <a id="29619" class="Symbol">=</a> <a id="29621" href="Demos.HSP.html#28936" class="Function">Lift-AlgÊ³</a> <a id="29631" class="Symbol">(</a><a id="29632" href="Demos.HSP.html#28541" class="Function">Lift-AlgË¡</a> <a id="29642" href="Demos.HSP.html#29611" class="Bound">ğ‘¨</a> <a id="29644" href="Demos.HSP.html#29613" class="Bound">â„“â‚€</a><a id="29646" class="Symbol">)</a> <a id="29648" href="Demos.HSP.html#29616" class="Bound">â„“â‚</a>

</pre>
\noindent Recall that our \ar{Algebra} type has two universe level parameters, corresponding
to those of the domain setoid.
Concretely, an algebra of type \ar{Algebra} \ab{Î±} \ab{Ïáµƒ} has a
\afld{Domain} of type \ar{Setoid} \ab{Î±} \ab{Ïáµƒ}. This packages a ``carrier set''
(\afld{Carrier}), inhabiting \ap{Type} \ab{Î±}, with an equality on \afld{Carrier} of type
\af{Rel} \afld{Carrier} \ab{Ïáµƒ}.
\fi
\noindent \af{Lift-Alg} takes an algebra parametrized by levels \ab{a} and \ab{Ïáµƒ}
and constructs a new algebra whose carrier inhabits \ap{Type} (\ab{Î±} \ap{âŠ”} \ab{â„“â‚€}) and
whose equivalence inhabits \af{Rel}~\afld{Carrier}~(\ab{Ïáµƒ}~\ap{âŠ”}~\ab{â„“â‚}).
To be useful, this lifting operation should result in an algebra with the same semantic properties
as the one we started with. We will see in Â§\ref{sec:lift-alg} that this is indeed the case.

%% -----------------------------------------------------------------------------
\paragraph*{Product Algebras}
We define the \defn{product} of a family of algebras as follows.
Let \ab{Î¹} be a universe and \ab I~:~\ap{Type}~\ab{Î¹} a type (the ``indexing type'').
Then \ab{ğ’œ}~:~\ab I~\as{â†’}~\ab{Algebra}~\ab{Î±}~\ab{Ïáµƒ} represents
an \defn{indexed family of algebras}.
Denote by \af{â¨…}~\ab{ğ’œ} the \defn{product of algebras} in \ab{ğ’œ} (or \defn{product
algebra}), by which we mean the algebra whose domain is the Cartesian product \af{Î }~\ab
i~ê‰~\ab I~\af{,}~\aof{ğ”»[~\ab{ğ’œ}~\ab i~]} of the domains of the algebras in \ab{ğ’œ}, and
whose operations are those arising from pointwise interpretation in the obvious way: if
\ab{f} is a \ab J-ary operation symbol and if
\ab a~:~\af{Î }~\ab i~ê‰~\ab I~\af{,}~\ab J~\as{â†’}~\aof{ğ”»[~\ab{ğ’œ}~\ab i~]} is, for each
\ab i~:~\ab I, a \ab J-tuple of elements of the domain \aof{ğ”»[~\ab{ğ’œ}~\ab i~]}, then
we define the interpretation of \ab f in \af{â¨…}~\ab{ğ’œ} by\\[-2mm]

(\ab{f}~\af{Ì‚}~\af{â¨…}~\ab{ğ’œ}) \ab a := \as{Î»}~(\ab i~:~\ab I)~\as{â†’}
(\ab{f}~\af{Ì‚}~\ab{ğ’œ}~\ab i)(\ab{a}~\ab i).\\[8pt]
Here is the formal definition of the product algebra type in \agda.

<pre class="Agda">

<a id="31704" class="Keyword">module</a> <a id="31711" href="Demos.HSP.html#31711" class="Module">_</a> <a id="31713" class="Symbol">{</a><a id="31714" href="Demos.HSP.html#31714" class="Bound">Î¹</a> <a id="31716" class="Symbol">:</a> <a id="31718" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="31723" class="Symbol">}{</a><a id="31725" href="Demos.HSP.html#31725" class="Bound">I</a> <a id="31727" class="Symbol">:</a> <a id="31729" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="31734" href="Demos.HSP.html#31714" class="Bound">Î¹</a> <a id="31736" class="Symbol">}</a> <a id="31738" class="Keyword">where</a>

 <a id="31746" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="31748" class="Symbol">:</a> <a id="31750" class="Symbol">(</a><a id="31751" href="Demos.HSP.html#31751" class="Bound">ğ’œ</a> <a id="31753" class="Symbol">:</a> <a id="31755" href="Demos.HSP.html#31725" class="Bound">I</a> <a id="31757" class="Symbol">â†’</a> <a id="31759" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="31767" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="31769" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="31771" class="Symbol">)</a> <a id="31773" class="Symbol">â†’</a> <a id="31775" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="31783" class="Symbol">(</a><a id="31784" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="31786" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="31788" href="Demos.HSP.html#31714" class="Bound">Î¹</a><a id="31789" class="Symbol">)</a> <a id="31791" class="Symbol">(</a><a id="31792" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="31795" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="31797" href="Demos.HSP.html#31714" class="Bound">Î¹</a><a id="31798" class="Symbol">)</a>

 <a id="31802" href="Demos.HSP.html#24623" class="Field">Domain</a> <a id="31809" class="Symbol">(</a><a id="31810" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="31812" href="Demos.HSP.html#31812" class="Bound">ğ’œ</a><a id="31813" class="Symbol">)</a> <a id="31815" class="Symbol">=</a> <a id="31817" class="Keyword">record</a>  <a id="31825" class="Symbol">{</a> <a id="31827" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a> <a id="31835" class="Symbol">=</a> <a id="31837" class="Symbol">âˆ€</a> <a id="31839" href="Demos.HSP.html#31839" class="Bound">i</a> <a id="31841" class="Symbol">â†’</a> <a id="31843" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="31846" href="Demos.HSP.html#31812" class="Bound">ğ’œ</a> <a id="31848" href="Demos.HSP.html#31839" class="Bound">i</a> <a id="31850" href="Demos.HSP.html#25552" class="Function Operator">]</a>
                        <a id="31876" class="Symbol">;</a> <a id="31878" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="31882" class="Symbol">=</a> <a id="31884" class="Symbol">Î»</a> <a id="31886" href="Demos.HSP.html#31886" class="Bound">a</a> <a id="31888" href="Demos.HSP.html#31888" class="Bound">b</a> <a id="31890" class="Symbol">â†’</a> <a id="31892" class="Symbol">âˆ€</a> <a id="31894" href="Demos.HSP.html#31894" class="Bound">i</a> <a id="31896" class="Symbol">â†’</a> <a id="31898" class="Symbol">(</a><a id="31899" href="Demos.HSP.html#9112" class="Field Operator">_â‰ˆË¢_</a> <a id="31904" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="31907" href="Demos.HSP.html#31812" class="Bound">ğ’œ</a> <a id="31909" href="Demos.HSP.html#31894" class="Bound">i</a> <a id="31911" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="31912" class="Symbol">)</a> <a id="31914" class="Symbol">(</a><a id="31915" href="Demos.HSP.html#31886" class="Bound">a</a> <a id="31917" href="Demos.HSP.html#31894" class="Bound">i</a><a id="31918" class="Symbol">)(</a><a id="31920" href="Demos.HSP.html#31888" class="Bound">b</a> <a id="31922" href="Demos.HSP.html#31894" class="Bound">i</a><a id="31923" class="Symbol">)</a>
                        <a id="31949" class="Symbol">;</a> <a id="31951" href="Relation.Binary.Bundles.html#1132" class="Field">isEquivalence</a> <a id="31965" class="Symbol">=</a>
                           <a id="31994" class="Keyword">record</a>  <a id="32002" class="Symbol">{</a> <a id="32004" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="32009" class="Symbol">=</a> <a id="32011" class="Symbol">Î»</a> <a id="32013" href="Demos.HSP.html#32013" class="Bound">i</a> <a id="32015" class="Symbol">â†’</a> <a id="32017" href="Demos.HSP.html#8708" class="Field">refláµ‰</a> <a id="32023" class="Symbol">(</a><a id="32024" href="Relation.Binary.Bundles.html#1132" class="Field">isEquivalence</a> <a id="32038" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="32041" href="Demos.HSP.html#31812" class="Bound">ğ’œ</a> <a id="32043" href="Demos.HSP.html#32013" class="Bound">i</a> <a id="32045" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="32046" class="Symbol">)</a>
                                   <a id="32083" class="Symbol">;</a> <a id="32085" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="32089" class="Symbol">=</a> <a id="32091" class="Symbol">Î»</a> <a id="32093" href="Demos.HSP.html#32093" class="Bound">x</a> <a id="32095" href="Demos.HSP.html#32095" class="Bound">i</a> <a id="32097" class="Symbol">â†’</a> <a id="32099" href="Demos.HSP.html#8769" class="Field">symáµ‰</a> <a id="32104" class="Symbol">(</a><a id="32105" href="Relation.Binary.Bundles.html#1132" class="Field">isEquivalence</a> <a id="32119" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="32122" href="Demos.HSP.html#31812" class="Bound">ğ’œ</a> <a id="32124" href="Demos.HSP.html#32095" class="Bound">i</a> <a id="32126" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="32127" class="Symbol">)(</a><a id="32129" href="Demos.HSP.html#32093" class="Bound">x</a> <a id="32131" href="Demos.HSP.html#32095" class="Bound">i</a><a id="32132" class="Symbol">)</a>
                                   <a id="32169" class="Symbol">;</a> <a id="32171" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="32177" class="Symbol">=</a> <a id="32179" class="Symbol">Î»</a> <a id="32181" href="Demos.HSP.html#32181" class="Bound">x</a> <a id="32183" href="Demos.HSP.html#32183" class="Bound">y</a> <a id="32185" href="Demos.HSP.html#32185" class="Bound">i</a> <a id="32187" class="Symbol">â†’</a> <a id="32189" href="Demos.HSP.html#8830" class="Field">transáµ‰</a> <a id="32196" class="Symbol">(</a><a id="32197" href="Relation.Binary.Bundles.html#1132" class="Field">isEquivalence</a> <a id="32211" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="32214" href="Demos.HSP.html#31812" class="Bound">ğ’œ</a> <a id="32216" href="Demos.HSP.html#32185" class="Bound">i</a> <a id="32218" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="32219" class="Symbol">)(</a><a id="32221" href="Demos.HSP.html#32181" class="Bound">x</a> <a id="32223" href="Demos.HSP.html#32185" class="Bound">i</a><a id="32224" class="Symbol">)(</a><a id="32226" href="Demos.HSP.html#32183" class="Bound">y</a> <a id="32228" href="Demos.HSP.html#32185" class="Bound">i</a><a id="32229" class="Symbol">)</a> <a id="32231" class="Symbol">}}</a>

 <a id="32236" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="32243" class="Symbol">(</a><a id="32244" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="32246" href="Demos.HSP.html#32246" class="Bound">ğ’œ</a><a id="32247" class="Symbol">)</a> <a id="32249" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="32253" class="Symbol">(</a><a id="32254" href="Demos.HSP.html#32254" class="Bound">f</a> <a id="32256" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="32258" href="Demos.HSP.html#32258" class="Bound">a</a><a id="32259" class="Symbol">)</a> <a id="32261" class="Symbol">=</a> <a id="32263" class="Symbol">Î»</a> <a id="32265" href="Demos.HSP.html#32265" class="Bound">i</a> <a id="32267" class="Symbol">â†’</a> <a id="32269" class="Symbol">(</a><a id="32270" href="Demos.HSP.html#32254" class="Bound">f</a> <a id="32272" href="Demos.HSP.html#25610" class="Function Operator">Ì‚</a> <a id="32274" class="Symbol">(</a><a id="32275" href="Demos.HSP.html#32246" class="Bound">ğ’œ</a> <a id="32277" href="Demos.HSP.html#32265" class="Bound">i</a><a id="32278" class="Symbol">))</a> <a id="32281" class="Symbol">(</a><a id="32282" href="Function.Base.html#1554" class="Function">flip</a> <a id="32287" href="Demos.HSP.html#32258" class="Bound">a</a> <a id="32289" href="Demos.HSP.html#32265" class="Bound">i</a><a id="32290" class="Symbol">)</a>
 <a id="32293" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="32298" class="Symbol">(</a><a id="32299" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="32306" class="Symbol">(</a><a id="32307" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="32309" href="Demos.HSP.html#32309" class="Bound">ğ’œ</a><a id="32310" class="Symbol">))</a> <a id="32313" class="Symbol">(</a><a id="32314" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="32321" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="32323" href="Demos.HSP.html#32323" class="Bound">f=g</a> <a id="32327" class="Symbol">)</a> <a id="32329" class="Symbol">=</a> <a id="32331" class="Symbol">Î»</a> <a id="32333" href="Demos.HSP.html#32333" class="Bound">i</a> <a id="32335" class="Symbol">â†’</a> <a id="32337" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="32342" class="Symbol">(</a><a id="32343" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="32350" class="Symbol">(</a><a id="32351" href="Demos.HSP.html#32309" class="Bound">ğ’œ</a> <a id="32353" href="Demos.HSP.html#32333" class="Bound">i</a><a id="32354" class="Symbol">))</a> <a id="32357" class="Symbol">(</a><a id="32358" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="32365" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="32367" href="Function.Base.html#1554" class="Function">flip</a> <a id="32372" href="Demos.HSP.html#32323" class="Bound">f=g</a> <a id="32376" href="Demos.HSP.html#32333" class="Bound">i</a> <a id="32378" class="Symbol">)</a>

</pre>
\noindent Evidently, the carrier of the product algebra type is indeed the (dependent)
product of the carriers in the indexed family. The rest of the definitions are the ``pointwise''
versions of the underlying ones.

%% -------------------------------------------------------------------------------------
%\subsection{Homomorphisms}\label{homomorphisms}
\subsection{Structure preserving maps and isomorphism}\label{homomorphisms}
Throughout the rest of the paper, unless stated otherwise, \ab{ğ‘¨} and \ab{ğ‘©}
will denote \ab{ğ‘†}-algebras inhabiting the types \af{Algebra} \ab{Î±} \ab{Ïáµƒ} and
\af{Algebra} \ab{Î²} \ab{Ïáµ‡}, respectively.

A \defn{homomorphism} (or ``hom'') from
\ab{ğ‘¨} to \ab{ğ‘©} is a setoid function \ab{h}~:~\aof{ğ”»[~\ab{ğ‘¨}~]} \aor{âŸ¶} \aof{ğ”»[~\ab{ğ‘©}~]}
that is \defn{compatible} with all basic operations; that is, for
every operation symbol \ab{f} : \af{âˆ£~\ab{ğ‘†}~âˆ£} and all tuples
\ab{a} : \af{âˆ¥~\ab{ğ‘†}~âˆ¥}~\ab{f} \as{â†’} \aof{ğ•Œ[~\ab{ğ‘¨}~]}, we have \ab{h} \aofld{âŸ¨\$âŸ©}
(\ab{f}~\af{Ì‚}~\ab{ğ‘¨}) \ab{a} \af{â‰ˆ}
(\ab{f}~\af{Ì‚}~\ab{ğ‘©}) \as{Î»} \ab x \as{â†’} \ab h \AgdaOperator{\AgdaField{âŸ¨\$âŸ©}} (\ab a \ab x).

It is convenient to first formalize ``compatible'' (\af{compatible-map-op}),
representing the assertion that a given setoid function
\ab{h}~:~\aof{ğ”»[~\ab{ğ‘¨}~]} \aor{âŸ¶} \aof{ğ”»[~\ab{ğ‘©}~]} commutes with a given
operation symbol \ab{f}, and then generalize over operation symbols
to yield the type (\af{compatible-map}) of compatible maps from (the domain of)
\ab{ğ‘¨} to (the domain of) \ab{ğ‘©}.

<pre class="Agda">

<a id="33911" class="Keyword">module</a> <a id="33918" href="Demos.HSP.html#33918" class="Module">_</a> <a id="33920" class="Symbol">(</a><a id="33921" href="Demos.HSP.html#33921" class="Bound">ğ‘¨</a> <a id="33923" class="Symbol">:</a> <a id="33925" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="33933" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="33935" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="33937" class="Symbol">)(</a><a id="33939" href="Demos.HSP.html#33939" class="Bound">ğ‘©</a> <a id="33941" class="Symbol">:</a> <a id="33943" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="33951" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="33953" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="33955" class="Symbol">)</a> <a id="33957" class="Keyword">where</a>

 <a id="33965" href="Demos.HSP.html#33965" class="Function">compatible-map-op</a> <a id="33983" class="Symbol">:</a> <a id="33985" class="Symbol">(</a><a id="33986" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="33989" href="Demos.HSP.html#33921" class="Bound">ğ‘¨</a> <a id="33991" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="33993" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="33995" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="33998" href="Demos.HSP.html#33939" class="Bound">ğ‘©</a> <a id="34000" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="34001" class="Symbol">)</a> <a id="34003" class="Symbol">â†’</a> <a id="34005" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="34007" href="Demos.HSP.html#7243" class="Bound">ğ‘†</a> <a id="34009" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="34011" class="Symbol">â†’</a> <a id="34013" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="34018" class="Symbol">_</a>
 <a id="34021" href="Demos.HSP.html#33965" class="Function">compatible-map-op</a> <a id="34039" href="Demos.HSP.html#34039" class="Bound">h</a> <a id="34041" href="Demos.HSP.html#34041" class="Bound">f</a> <a id="34043" class="Symbol">=</a> <a id="34045" class="Symbol">âˆ€</a> <a id="34047" class="Symbol">{</a><a id="34048" href="Demos.HSP.html#34048" class="Bound">a</a><a id="34049" class="Symbol">}</a> <a id="34051" class="Symbol">â†’</a> <a id="34053" href="Demos.HSP.html#34039" class="Bound">h</a> <a id="34055" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="34059" class="Symbol">(</a><a id="34060" href="Demos.HSP.html#34041" class="Bound">f</a> <a id="34062" href="Demos.HSP.html#25610" class="Function Operator">Ì‚</a> <a id="34064" href="Demos.HSP.html#33921" class="Bound">ğ‘¨</a><a id="34065" class="Symbol">)</a> <a id="34067" href="Demos.HSP.html#34048" class="Bound">a</a> <a id="34069" href="Relation.Binary.Bundles.html#1098" class="Function Operator">â‰ˆ</a> <a id="34071" class="Symbol">(</a><a id="34072" href="Demos.HSP.html#34041" class="Bound">f</a> <a id="34074" href="Demos.HSP.html#25610" class="Function Operator">Ì‚</a> <a id="34076" href="Demos.HSP.html#33939" class="Bound">ğ‘©</a><a id="34077" class="Symbol">)</a> <a id="34079" class="Symbol">Î»</a> <a id="34081" href="Demos.HSP.html#34081" class="Bound">x</a> <a id="34083" class="Symbol">â†’</a> <a id="34085" href="Demos.HSP.html#34039" class="Bound">h</a> <a id="34087" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="34091" class="Symbol">(</a><a id="34092" href="Demos.HSP.html#34048" class="Bound">a</a> <a id="34094" href="Demos.HSP.html#34081" class="Bound">x</a><a id="34095" class="Symbol">)</a>
  <a id="34099" class="Keyword">where</a> <a id="34105" class="Keyword">open</a> <a id="34110" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="34117" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="34120" href="Demos.HSP.html#33939" class="Bound">ğ‘©</a> <a id="34122" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="34124" class="Keyword">using</a> <a id="34130" class="Symbol">(</a> <a id="34132" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="34136" class="Symbol">)</a>

 <a id="34140" href="Demos.HSP.html#34140" class="Function">compatible-map</a> <a id="34155" class="Symbol">:</a> <a id="34157" class="Symbol">(</a><a id="34158" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="34161" href="Demos.HSP.html#33921" class="Bound">ğ‘¨</a> <a id="34163" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="34165" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="34167" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="34170" href="Demos.HSP.html#33939" class="Bound">ğ‘©</a> <a id="34172" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="34173" class="Symbol">)</a> <a id="34175" class="Symbol">â†’</a> <a id="34177" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="34182" class="Symbol">_</a>
 <a id="34185" href="Demos.HSP.html#34140" class="Function">compatible-map</a> <a id="34200" href="Demos.HSP.html#34200" class="Bound">h</a> <a id="34202" class="Symbol">=</a> <a id="34204" class="Symbol">âˆ€</a> <a id="34206" class="Symbol">{</a><a id="34207" href="Demos.HSP.html#34207" class="Bound">f</a><a id="34208" class="Symbol">}</a> <a id="34210" class="Symbol">â†’</a> <a id="34212" href="Demos.HSP.html#33965" class="Function">compatible-map-op</a> <a id="34230" href="Demos.HSP.html#34200" class="Bound">h</a> <a id="34232" href="Demos.HSP.html#34207" class="Bound">f</a>

</pre>
Using these we define the property (\ar{IsHom}) of being a homomorphism, and
finally the type (\af{hom}) of homomorphisms from \ab{ğ‘¨} to \ab{ğ‘©}.

<pre class="Agda">

 <a id="34407" class="Keyword">record</a> <a id="34414" href="Demos.HSP.html#34414" class="Record">IsHom</a> <a id="34420" class="Symbol">(</a><a id="34421" href="Demos.HSP.html#34421" class="Bound">h</a> <a id="34423" class="Symbol">:</a> <a id="34425" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="34428" href="Demos.HSP.html#33921" class="Bound">ğ‘¨</a> <a id="34430" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="34432" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="34434" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="34437" href="Demos.HSP.html#33939" class="Bound">ğ‘©</a> <a id="34439" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="34440" class="Symbol">)</a> <a id="34442" class="Symbol">:</a> <a id="34444" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="34449" class="Symbol">(</a><a id="34450" href="Demos.HSP.html#7257" class="Bound">ğ“</a> <a id="34452" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="34454" href="Demos.HSP.html#7259" class="Bound">ğ“¥</a> <a id="34456" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="34458" href="Demos.HSP.html#33933" class="Bound">Î±</a> <a id="34460" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="34462" href="Demos.HSP.html#33953" class="Bound">Ïáµ‡</a><a id="34464" class="Symbol">)</a> <a id="34466" class="Keyword">where</a>
  <a id="34474" class="Keyword">constructor</a>  <a id="34487" href="Demos.HSP.html#34487" class="InductiveConstructor">mkhom</a>
  <a id="34495" class="Keyword">field</a>        <a id="34508" href="Demos.HSP.html#34508" class="Field">compatible</a> <a id="34519" class="Symbol">:</a> <a id="34521" href="Demos.HSP.html#34140" class="Function">compatible-map</a> <a id="34536" href="Demos.HSP.html#34421" class="Bound">h</a>

 <a id="34540" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="34544" class="Symbol">:</a> <a id="34546" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="34551" class="Symbol">_</a>
 <a id="34554" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="34558" class="Symbol">=</a> <a id="34560" href="Agda.Builtin.Sigma.html#166" class="Record">Î£</a> <a id="34562" class="Symbol">(</a><a id="34563" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a>Â <a id="34566" href="Demos.HSP.html#33921" class="Bound">ğ‘¨</a> <a id="34568" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="34570" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="34572" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="34575" href="Demos.HSP.html#33939" class="Bound">ğ‘©</a> <a id="34577" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="34578" class="Symbol">)</a> <a id="34580" href="Demos.HSP.html#34414" class="Record">IsHom</a>

</pre>
Thus, an inhabitant of \af{hom} is a pair (\ab h , \ab p) consisting of
a setoid function \ab h, from the domain of \ab{ğ‘¨} to that of \ab{ğ‘©}, along with
a proof \ab p that \ab h is a homomorphism.

A \defn{monomorphism} (resp. \defn{epimorphism}) is an injective (resp. surjective)
homomorphism. The \agdaalgebras library defines predicates \ar{IsMon} and \ar{IsEpi} for these,
as well as \af{mon} and \af{epi} for the corresponding types.

<pre class="Agda">

 <a id="35054" class="Keyword">record</a> <a id="35061" href="Demos.HSP.html#35061" class="Record">IsMon</a> <a id="35067" class="Symbol">(</a><a id="35068" href="Demos.HSP.html#35068" class="Bound">h</a> <a id="35070" class="Symbol">:</a> <a id="35072" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="35075" href="Demos.HSP.html#33921" class="Bound">ğ‘¨</a> <a id="35077" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="35079" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="35081" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="35084" href="Demos.HSP.html#33939" class="Bound">ğ‘©</a> <a id="35086" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="35087" class="Symbol">)</a> <a id="35089" class="Symbol">:</a> <a id="35091" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="35096" class="Symbol">(</a><a id="35097" href="Demos.HSP.html#7257" class="Bound">ğ“</a> <a id="35099" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="35101" href="Demos.HSP.html#7259" class="Bound">ğ“¥</a> <a id="35103" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="35105" href="Demos.HSP.html#33933" class="Bound">Î±</a> <a id="35107" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="35109" href="Demos.HSP.html#33935" class="Bound">Ïáµƒ</a> <a id="35112" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="35114" href="Demos.HSP.html#33953" class="Bound">Ïáµ‡</a><a id="35116" class="Symbol">)</a> <a id="35118" class="Keyword">where</a>
  <a id="35126" class="Keyword">field</a>  <a id="35133" href="Demos.HSP.html#35133" class="Field">isHom</a> <a id="35139" class="Symbol">:</a> <a id="35141" href="Demos.HSP.html#34414" class="Record">IsHom</a> <a id="35147" href="Demos.HSP.html#35068" class="Bound">h</a>
         <a id="35158" href="Demos.HSP.html#35158" class="Field">isInjective</a> <a id="35170" class="Symbol">:</a> <a id="35172" href="Demos.HSP.html#15537" class="Function">IsInjective</a> <a id="35184" href="Demos.HSP.html#35068" class="Bound">h</a>
  <a id="35188" href="Demos.HSP.html#35188" class="Function">HomReduct</a> <a id="35198" class="Symbol">:</a> <a id="35200" href="Demos.HSP.html#34540" class="Function">hom</a>
  <a id="35206" href="Demos.HSP.html#35188" class="Function">HomReduct</a> <a id="35216" class="Symbol">=</a> <a id="35218" href="Demos.HSP.html#35068" class="Bound">h</a> <a id="35220" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="35222" href="Demos.HSP.html#35133" class="Field">isHom</a>

 <a id="35230" href="Demos.HSP.html#35230" class="Function">mon</a> <a id="35234" class="Symbol">:</a> <a id="35236" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="35241" class="Symbol">_</a>
 <a id="35244" href="Demos.HSP.html#35230" class="Function">mon</a> <a id="35248" class="Symbol">=</a> <a id="35250" href="Agda.Builtin.Sigma.html#166" class="Record">Î£</a> <a id="35252" class="Symbol">(</a><a id="35253" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="35256" href="Demos.HSP.html#33921" class="Bound">ğ‘¨</a> <a id="35258" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="35260" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="35262" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="35265" href="Demos.HSP.html#33939" class="Bound">ğ‘©</a> <a id="35267" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="35268" class="Symbol">)</a> <a id="35270" href="Demos.HSP.html#35061" class="Record">IsMon</a>

</pre>
\noindent As with \af{hom}, the type \af{mon} is a dependent product type; each inhabitant is a pair
consisting of a setoid function, say, \ab h, along with a proof that \ab h is a monomorphism.

<pre class="Agda">

 <a id="35499" class="Keyword">record</a> <a id="35506" href="Demos.HSP.html#35506" class="Record">IsEpi</a> <a id="35512" class="Symbol">(</a><a id="35513" href="Demos.HSP.html#35513" class="Bound">h</a> <a id="35515" class="Symbol">:</a> <a id="35517" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="35520" href="Demos.HSP.html#33921" class="Bound">ğ‘¨</a> <a id="35522" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="35524" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="35526" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="35529" href="Demos.HSP.html#33939" class="Bound">ğ‘©</a> <a id="35531" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="35532" class="Symbol">)</a> <a id="35534" class="Symbol">:</a> <a id="35536" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="35541" class="Symbol">(</a><a id="35542" href="Demos.HSP.html#7257" class="Bound">ğ“</a> <a id="35544" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="35546" href="Demos.HSP.html#7259" class="Bound">ğ“¥</a> <a id="35548" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="35550" href="Demos.HSP.html#33933" class="Bound">Î±</a> <a id="35552" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="35554" href="Demos.HSP.html#33951" class="Bound">Î²</a> <a id="35556" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="35558" href="Demos.HSP.html#33953" class="Bound">Ïáµ‡</a><a id="35560" class="Symbol">)</a> <a id="35562" class="Keyword">where</a>
  <a id="35570" class="Keyword">field</a>  <a id="35577" href="Demos.HSP.html#35577" class="Field">isHom</a> <a id="35583" class="Symbol">:</a> <a id="35585" href="Demos.HSP.html#34414" class="Record">IsHom</a> <a id="35591" href="Demos.HSP.html#35513" class="Bound">h</a>
         <a id="35602" href="Demos.HSP.html#35602" class="Field">isSurjective</a> <a id="35615" class="Symbol">:</a> <a id="35617" href="Demos.HSP.html#15620" class="Function">IsSurjective</a> <a id="35630" href="Demos.HSP.html#35513" class="Bound">h</a>
  <a id="35634" href="Demos.HSP.html#35634" class="Function">HomReduct</a> <a id="35644" class="Symbol">:</a> <a id="35646" href="Demos.HSP.html#34540" class="Function">hom</a>
  <a id="35652" href="Demos.HSP.html#35634" class="Function">HomReduct</a> <a id="35662" class="Symbol">=</a> <a id="35664" href="Demos.HSP.html#35513" class="Bound">h</a> <a id="35666" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="35668" href="Demos.HSP.html#35577" class="Field">isHom</a>

 <a id="35676" href="Demos.HSP.html#35676" class="Function">epi</a> <a id="35680" class="Symbol">:</a> <a id="35682" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="35687" class="Symbol">_</a>
 <a id="35690" href="Demos.HSP.html#35676" class="Function">epi</a> <a id="35694" class="Symbol">=</a> <a id="35696" href="Agda.Builtin.Sigma.html#166" class="Record">Î£</a> <a id="35698" class="Symbol">(</a><a id="35699" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="35702" href="Demos.HSP.html#33921" class="Bound">ğ‘¨</a> <a id="35704" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="35706" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="35708" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="35711" href="Demos.HSP.html#33939" class="Bound">ğ‘©</a> <a id="35713" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="35714" class="Symbol">)</a> <a id="35716" href="Demos.HSP.html#35506" class="Record">IsEpi</a>
</pre>

\ifshort\else
Here are two utilities that are useful for translating between types.

<pre class="Agda">
<a id="35832" class="Keyword">open</a> <a id="35837" href="Demos.HSP.html#34414" class="Module">IsHom</a> <a id="35843" class="Symbol">;</a> <a id="35845" class="Keyword">open</a> <a id="35850" href="Demos.HSP.html#35061" class="Module">IsMon</a> <a id="35856" class="Symbol">;</a> <a id="35858" class="Keyword">open</a> <a id="35863" href="Demos.HSP.html#35506" class="Module">IsEpi</a>
<a id="35869" class="Keyword">module</a> <a id="35876" href="Demos.HSP.html#35876" class="Module">_</a> <a id="35878" class="Symbol">(</a><a id="35879" href="Demos.HSP.html#35879" class="Bound">ğ‘¨</a> <a id="35881" class="Symbol">:</a> <a id="35883" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="35891" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="35893" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="35895" class="Symbol">)(</a><a id="35897" href="Demos.HSP.html#35897" class="Bound">ğ‘©</a> <a id="35899" class="Symbol">:</a> <a id="35901" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="35909" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="35911" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="35913" class="Symbol">)</a> <a id="35915" class="Keyword">where</a>
 <a id="35922" href="Demos.HSP.html#35922" class="Function">monâ†’intohom</a> <a id="35934" class="Symbol">:</a> <a id="35936" href="Demos.HSP.html#35230" class="Function">mon</a> <a id="35940" href="Demos.HSP.html#35879" class="Bound">ğ‘¨</a> <a id="35942" href="Demos.HSP.html#35897" class="Bound">ğ‘©</a> <a id="35944" class="Symbol">â†’</a> <a id="35946" href="Data.Product.html#916" class="Function">Î£[</a> <a id="35949" href="Demos.HSP.html#35949" class="Bound">h</a> <a id="35951" href="Data.Product.html#916" class="Function">âˆˆ</a> <a id="35953" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="35957" href="Demos.HSP.html#35879" class="Bound">ğ‘¨</a> <a id="35959" href="Demos.HSP.html#35897" class="Bound">ğ‘©</a> <a id="35961" href="Data.Product.html#916" class="Function">]</a> <a id="35963" href="Demos.HSP.html#15537" class="Function">IsInjective</a> <a id="35975" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="35977" href="Demos.HSP.html#35949" class="Bound">h</a> <a id="35979" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>
 <a id="35982" href="Demos.HSP.html#35922" class="Function">monâ†’intohom</a> <a id="35994" class="Symbol">(</a><a id="35995" href="Demos.HSP.html#35995" class="Bound">hh</a> <a id="35998" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="36000" href="Demos.HSP.html#36000" class="Bound">hhM</a><a id="36003" class="Symbol">)</a> <a id="36005" class="Symbol">=</a> <a id="36007" class="Symbol">(</a><a id="36008" href="Demos.HSP.html#35995" class="Bound">hh</a> <a id="36011" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="36013" href="Demos.HSP.html#35133" class="Field">isHom</a> <a id="36019" href="Demos.HSP.html#36000" class="Bound">hhM</a><a id="36022" class="Symbol">)</a> <a id="36024" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="36026" href="Demos.HSP.html#35158" class="Field">isInjective</a> <a id="36038" href="Demos.HSP.html#36000" class="Bound">hhM</a>

 <a id="36044" href="Demos.HSP.html#36044" class="Function">epiâ†’ontohom</a> <a id="36056" class="Symbol">:</a> <a id="36058" href="Demos.HSP.html#35676" class="Function">epi</a> <a id="36062" href="Demos.HSP.html#35879" class="Bound">ğ‘¨</a> <a id="36064" href="Demos.HSP.html#35897" class="Bound">ğ‘©</a> <a id="36066" class="Symbol">â†’</a> <a id="36068" href="Data.Product.html#916" class="Function">Î£[</a> <a id="36071" href="Demos.HSP.html#36071" class="Bound">h</a> <a id="36073" href="Data.Product.html#916" class="Function">âˆˆ</a> <a id="36075" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="36079" href="Demos.HSP.html#35879" class="Bound">ğ‘¨</a> <a id="36081" href="Demos.HSP.html#35897" class="Bound">ğ‘©</a> <a id="36083" href="Data.Product.html#916" class="Function">]</a> <a id="36085" href="Demos.HSP.html#15620" class="Function">IsSurjective</a> <a id="36098" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="36100" href="Demos.HSP.html#36071" class="Bound">h</a> <a id="36102" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>
 <a id="36105" href="Demos.HSP.html#36044" class="Function">epiâ†’ontohom</a> <a id="36117" class="Symbol">(</a><a id="36118" href="Demos.HSP.html#36118" class="Bound">hh</a> <a id="36121" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="36123" href="Demos.HSP.html#36123" class="Bound">hhE</a><a id="36126" class="Symbol">)</a> <a id="36128" class="Symbol">=</a> <a id="36130" class="Symbol">(</a><a id="36131" href="Demos.HSP.html#36118" class="Bound">hh</a> <a id="36134" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="36136" href="Demos.HSP.html#35577" class="Field">isHom</a> <a id="36142" href="Demos.HSP.html#36123" class="Bound">hhE</a><a id="36145" class="Symbol">)</a> <a id="36147" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="36149" href="Demos.HSP.html#35602" class="Field">isSurjective</a> <a id="36162" href="Demos.HSP.html#36123" class="Bound">hhE</a>
</pre>
%% -----------------------------------------------------------------------------
\fi

\paragraph*{Composition of homomorphisms}
The composition of homomorphisms is again a homomorphism, and similarly for epimorphisms and monomorphisms.
\ifshort
The proofs of these facts are straightforward so we omit them, but give them the names
\af{âˆ˜-hom} and \af{âˆ˜-epi} so we can refer to them below.
\else

<pre class="Agda">

<a id="36587" class="Keyword">module</a> <a id="36594" href="Demos.HSP.html#36594" class="Module">_</a>  <a id="36597" class="Symbol">{</a><a id="36598" href="Demos.HSP.html#36598" class="Bound">ğ‘¨</a> <a id="36600" class="Symbol">:</a> <a id="36602" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="36610" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="36612" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="36614" class="Symbol">}</a> <a id="36616" class="Symbol">{</a><a id="36617" href="Demos.HSP.html#36617" class="Bound">ğ‘©</a> <a id="36619" class="Symbol">:</a> <a id="36621" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="36629" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="36631" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="36633" class="Symbol">}</a> <a id="36635" class="Symbol">{</a><a id="36636" href="Demos.HSP.html#36636" class="Bound">ğ‘ª</a> <a id="36638" class="Symbol">:</a> <a id="36640" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="36648" href="Demos.HSP.html#9448" class="Generalizable">Î³</a> <a id="36650" href="Demos.HSP.html#9450" class="Generalizable">Ïá¶œ</a><a id="36652" class="Symbol">}</a>
          <a id="36664" class="Symbol">{</a><a id="36665" href="Demos.HSP.html#36665" class="Bound">g</a> <a id="36667" class="Symbol">:</a> <a id="36669" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="36672" href="Demos.HSP.html#36598" class="Bound">ğ‘¨</a> <a id="36674" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="36676" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="36678" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="36681" href="Demos.HSP.html#36617" class="Bound">ğ‘©</a> <a id="36683" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="36684" class="Symbol">}{</a><a id="36686" href="Demos.HSP.html#36686" class="Bound">h</a> <a id="36688" class="Symbol">:</a> <a id="36690" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="36693" href="Demos.HSP.html#36617" class="Bound">ğ‘©</a> <a id="36695" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="36697" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="36699" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="36702" href="Demos.HSP.html#36636" class="Bound">ğ‘ª</a> <a id="36704" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="36705" class="Symbol">}</a> <a id="36707" class="Keyword">where</a>
  <a id="36715" class="Keyword">open</a> <a id="36720" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="36727" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="36730" href="Demos.HSP.html#36636" class="Bound">ğ‘ª</a> <a id="36732" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="36734" class="Keyword">using</a> <a id="36740" class="Symbol">(</a> <a id="36742" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="36748" class="Symbol">)</a>
  <a id="36752" href="Demos.HSP.html#36752" class="Function">âˆ˜-is-hom</a> <a id="36761" class="Symbol">:</a> <a id="36763" href="Demos.HSP.html#34414" class="Record">IsHom</a> <a id="36769" href="Demos.HSP.html#36598" class="Bound">ğ‘¨</a> <a id="36771" href="Demos.HSP.html#36617" class="Bound">ğ‘©</a> <a id="36773" href="Demos.HSP.html#36665" class="Bound">g</a> <a id="36775" class="Symbol">â†’</a> <a id="36777" href="Demos.HSP.html#34414" class="Record">IsHom</a> <a id="36783" href="Demos.HSP.html#36617" class="Bound">ğ‘©</a> <a id="36785" href="Demos.HSP.html#36636" class="Bound">ğ‘ª</a> <a id="36787" href="Demos.HSP.html#36686" class="Bound">h</a> <a id="36789" class="Symbol">â†’</a> <a id="36791" href="Demos.HSP.html#34414" class="Record">IsHom</a> <a id="36797" href="Demos.HSP.html#36598" class="Bound">ğ‘¨</a> <a id="36799" href="Demos.HSP.html#36636" class="Bound">ğ‘ª</a> <a id="36801" class="Symbol">(</a><a id="36802" href="Demos.HSP.html#36686" class="Bound">h</a> <a id="36804" href="Demos.HSP.html#12908" class="Function Operator">âŸ¨âˆ˜âŸ©</a> <a id="36808" href="Demos.HSP.html#36665" class="Bound">g</a><a id="36809" class="Symbol">)</a>
  <a id="36813" href="Demos.HSP.html#36752" class="Function">âˆ˜-is-hom</a> <a id="36822" href="Demos.HSP.html#36822" class="Bound">ghom</a> <a id="36827" href="Demos.HSP.html#36827" class="Bound">hhom</a> <a id="36832" class="Symbol">=</a> <a id="36834" href="Demos.HSP.html#34487" class="InductiveConstructor">mkhom</a> <a id="36840" href="Demos.HSP.html#36851" class="Function">c</a> <a id="36842" class="Keyword">where</a>
   <a id="36851" href="Demos.HSP.html#36851" class="Function">c</a> <a id="36853" class="Symbol">:</a> <a id="36855" href="Demos.HSP.html#34140" class="Function">compatible-map</a> <a id="36870" href="Demos.HSP.html#36598" class="Bound">ğ‘¨</a> <a id="36872" href="Demos.HSP.html#36636" class="Bound">ğ‘ª</a> <a id="36874" class="Symbol">(</a><a id="36875" href="Demos.HSP.html#36686" class="Bound">h</a> <a id="36877" href="Demos.HSP.html#12908" class="Function Operator">âŸ¨âˆ˜âŸ©</a> <a id="36881" href="Demos.HSP.html#36665" class="Bound">g</a><a id="36882" class="Symbol">)</a>
   <a id="36887" href="Demos.HSP.html#36851" class="Function">c</a> <a id="36889" class="Symbol">=</a> <a id="36891" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="36897" class="Symbol">(</a><a id="36898" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="36903" href="Demos.HSP.html#36686" class="Bound">h</a> <a id="36905" class="Symbol">(</a><a id="36906" href="Demos.HSP.html#34508" class="Field">compatible</a> <a id="36917" href="Demos.HSP.html#36822" class="Bound">ghom</a><a id="36921" class="Symbol">))</a> <a id="36924" class="Symbol">(</a><a id="36925" href="Demos.HSP.html#34508" class="Field">compatible</a> <a id="36936" href="Demos.HSP.html#36827" class="Bound">hhom</a><a id="36940" class="Symbol">)</a>

  <a id="36945" href="Demos.HSP.html#36945" class="Function">âˆ˜-is-epi</a> <a id="36954" class="Symbol">:</a> <a id="36956" href="Demos.HSP.html#35506" class="Record">IsEpi</a> <a id="36962" href="Demos.HSP.html#36598" class="Bound">ğ‘¨</a> <a id="36964" href="Demos.HSP.html#36617" class="Bound">ğ‘©</a> <a id="36966" href="Demos.HSP.html#36665" class="Bound">g</a> <a id="36968" class="Symbol">â†’</a> <a id="36970" href="Demos.HSP.html#35506" class="Record">IsEpi</a> <a id="36976" href="Demos.HSP.html#36617" class="Bound">ğ‘©</a> <a id="36978" href="Demos.HSP.html#36636" class="Bound">ğ‘ª</a> <a id="36980" href="Demos.HSP.html#36686" class="Bound">h</a> <a id="36982" class="Symbol">â†’</a> <a id="36984" href="Demos.HSP.html#35506" class="Record">IsEpi</a> <a id="36990" href="Demos.HSP.html#36598" class="Bound">ğ‘¨</a> <a id="36992" href="Demos.HSP.html#36636" class="Bound">ğ‘ª</a> <a id="36994" class="Symbol">(</a><a id="36995" href="Demos.HSP.html#36686" class="Bound">h</a> <a id="36997" href="Demos.HSP.html#12908" class="Function Operator">âŸ¨âˆ˜âŸ©</a> <a id="37001" href="Demos.HSP.html#36665" class="Bound">g</a><a id="37002" class="Symbol">)</a>
  <a id="37006" href="Demos.HSP.html#36945" class="Function">âˆ˜-is-epi</a> <a id="37015" href="Demos.HSP.html#37015" class="Bound">gE</a> <a id="37018" href="Demos.HSP.html#37018" class="Bound">hE</a> <a id="37021" class="Symbol">=</a> <a id="37023" class="Keyword">record</a>  <a id="37031" class="Symbol">{</a> <a id="37033" href="Demos.HSP.html#35577" class="Field">isHom</a> <a id="37039" class="Symbol">=</a> <a id="37041" href="Demos.HSP.html#36752" class="Function">âˆ˜-is-hom</a> <a id="37050" class="Symbol">(</a><a id="37051" href="Demos.HSP.html#35577" class="Field">isHom</a> <a id="37057" href="Demos.HSP.html#37015" class="Bound">gE</a><a id="37059" class="Symbol">)</a> <a id="37061" class="Symbol">(</a><a id="37062" href="Demos.HSP.html#35577" class="Field">isHom</a> <a id="37068" href="Demos.HSP.html#37018" class="Bound">hE</a><a id="37070" class="Symbol">)</a>
                           <a id="37099" class="Symbol">;</a> <a id="37101" href="Demos.HSP.html#35602" class="Field">isSurjective</a> <a id="37114" class="Symbol">=</a> <a id="37116" href="Demos.HSP.html#16289" class="Function">âˆ˜-IsSurjective</a> <a id="37131" href="Demos.HSP.html#36665" class="Bound">g</a> <a id="37133" href="Demos.HSP.html#36686" class="Bound">h</a> <a id="37135" class="Symbol">(</a><a id="37136" href="Demos.HSP.html#35602" class="Field">isSurjective</a> <a id="37149" href="Demos.HSP.html#37015" class="Bound">gE</a><a id="37151" class="Symbol">)</a> <a id="37153" class="Symbol">(</a><a id="37154" href="Demos.HSP.html#35602" class="Field">isSurjective</a> <a id="37167" href="Demos.HSP.html#37018" class="Bound">hE</a><a id="37169" class="Symbol">)</a> <a id="37171" class="Symbol">}</a>

<a id="37174" class="Keyword">module</a> <a id="37181" href="Demos.HSP.html#37181" class="Module">_</a> <a id="37183" class="Symbol">{</a><a id="37184" href="Demos.HSP.html#37184" class="Bound">ğ‘¨</a> <a id="37186" class="Symbol">:</a> <a id="37188" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="37196" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="37198" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="37200" class="Symbol">}</a> <a id="37202" class="Symbol">{</a><a id="37203" href="Demos.HSP.html#37203" class="Bound">ğ‘©</a> <a id="37205" class="Symbol">:</a> <a id="37207" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="37215" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="37217" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="37219" class="Symbol">}</a> <a id="37221" class="Symbol">{</a><a id="37222" href="Demos.HSP.html#37222" class="Bound">ğ‘ª</a> <a id="37224" class="Symbol">:</a> <a id="37226" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="37234" href="Demos.HSP.html#9448" class="Generalizable">Î³</a> <a id="37236" href="Demos.HSP.html#9450" class="Generalizable">Ïá¶œ</a><a id="37238" class="Symbol">}</a> <a id="37240" class="Keyword">where</a>
  <a id="37248" href="Demos.HSP.html#37248" class="Function">âˆ˜-hom</a> <a id="37254" class="Symbol">:</a> <a id="37256" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="37260" href="Demos.HSP.html#37184" class="Bound">ğ‘¨</a> <a id="37262" href="Demos.HSP.html#37203" class="Bound">ğ‘©</a> <a id="37264" class="Symbol">â†’</a> <a id="37266" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="37270" href="Demos.HSP.html#37203" class="Bound">ğ‘©</a> <a id="37272" href="Demos.HSP.html#37222" class="Bound">ğ‘ª</a>  <a id="37275" class="Symbol">â†’</a> <a id="37277" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="37281" href="Demos.HSP.html#37184" class="Bound">ğ‘¨</a> <a id="37283" href="Demos.HSP.html#37222" class="Bound">ğ‘ª</a>
  <a id="37287" href="Demos.HSP.html#37248" class="Function">âˆ˜-hom</a> <a id="37293" class="Symbol">(</a><a id="37294" href="Demos.HSP.html#37294" class="Bound">h</a> <a id="37296" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="37298" href="Demos.HSP.html#37298" class="Bound">hhom</a><a id="37302" class="Symbol">)</a> <a id="37304" class="Symbol">(</a><a id="37305" href="Demos.HSP.html#37305" class="Bound">g</a> <a id="37307" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="37309" href="Demos.HSP.html#37309" class="Bound">ghom</a><a id="37313" class="Symbol">)</a> <a id="37315" class="Symbol">=</a> <a id="37317" class="Symbol">(</a><a id="37318" href="Demos.HSP.html#37305" class="Bound">g</a> <a id="37320" href="Demos.HSP.html#12908" class="Function Operator">âŸ¨âˆ˜âŸ©</a> <a id="37324" href="Demos.HSP.html#37294" class="Bound">h</a><a id="37325" class="Symbol">)</a> <a id="37327" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="37329" href="Demos.HSP.html#36752" class="Function">âˆ˜-is-hom</a> <a id="37338" href="Demos.HSP.html#37298" class="Bound">hhom</a> <a id="37343" href="Demos.HSP.html#37309" class="Bound">ghom</a>

  <a id="37351" href="Demos.HSP.html#37351" class="Function">âˆ˜-epi</a> <a id="37357" class="Symbol">:</a> <a id="37359" href="Demos.HSP.html#35676" class="Function">epi</a> <a id="37363" href="Demos.HSP.html#37184" class="Bound">ğ‘¨</a> <a id="37365" href="Demos.HSP.html#37203" class="Bound">ğ‘©</a> <a id="37367" class="Symbol">â†’</a> <a id="37369" href="Demos.HSP.html#35676" class="Function">epi</a> <a id="37373" href="Demos.HSP.html#37203" class="Bound">ğ‘©</a> <a id="37375" href="Demos.HSP.html#37222" class="Bound">ğ‘ª</a>  <a id="37378" class="Symbol">â†’</a> <a id="37380" href="Demos.HSP.html#35676" class="Function">epi</a> <a id="37384" href="Demos.HSP.html#37184" class="Bound">ğ‘¨</a> <a id="37386" href="Demos.HSP.html#37222" class="Bound">ğ‘ª</a>
  <a id="37390" href="Demos.HSP.html#37351" class="Function">âˆ˜-epi</a> <a id="37396" class="Symbol">(</a><a id="37397" href="Demos.HSP.html#37397" class="Bound">h</a> <a id="37399" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="37401" href="Demos.HSP.html#37401" class="Bound">hepi</a><a id="37405" class="Symbol">)</a> <a id="37407" class="Symbol">(</a><a id="37408" href="Demos.HSP.html#37408" class="Bound">g</a> <a id="37410" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="37412" href="Demos.HSP.html#37412" class="Bound">gepi</a><a id="37416" class="Symbol">)</a> <a id="37418" class="Symbol">=</a> <a id="37420" class="Symbol">(</a><a id="37421" href="Demos.HSP.html#37408" class="Bound">g</a> <a id="37423" href="Demos.HSP.html#12908" class="Function Operator">âŸ¨âˆ˜âŸ©</a> <a id="37427" href="Demos.HSP.html#37397" class="Bound">h</a><a id="37428" class="Symbol">)</a> <a id="37430" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="37432" href="Demos.HSP.html#36945" class="Function">âˆ˜-is-epi</a> <a id="37441" href="Demos.HSP.html#37401" class="Bound">hepi</a> <a id="37446" href="Demos.HSP.html#37412" class="Bound">gepi</a>
</pre>
%% -----------------------------------------------------------------------------
\paragraph*{Universe lifting of homomorphisms}
Here we define the identity homomorphism for setoid algebras. Then we prove that the
operations of lifting and lowering of a setoid algebra are homomorphisms.

<pre class="Agda">

<a id="ğ’¾ğ’¹"></a><a id="37764" href="Demos.HSP.html#37764" class="Function">ğ’¾ğ’¹</a> <a id="37767" class="Symbol">:</a> <a id="37769" class="Symbol">{</a><a id="37770" href="Demos.HSP.html#37770" class="Bound">ğ‘¨</a> <a id="37772" class="Symbol">:</a> <a id="37774" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="37782" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="37784" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="37786" class="Symbol">}</a> <a id="37788" class="Symbol">â†’</a> <a id="37790" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="37794" href="Demos.HSP.html#37770" class="Bound">ğ‘¨</a> <a id="37796" href="Demos.HSP.html#37770" class="Bound">ğ‘¨</a>
<a id="37798" href="Demos.HSP.html#37764" class="Function">ğ’¾ğ’¹</a> <a id="37801" class="Symbol">{</a><a id="37802" class="Argument">ğ‘¨</a> <a id="37804" class="Symbol">=</a> <a id="37806" href="Demos.HSP.html#37806" class="Bound">ğ‘¨</a><a id="37807" class="Symbol">}</a> <a id="37809" class="Symbol">=</a> <a id="37811" href="Demos.HSP.html#12837" class="Function">ğ‘–ğ‘‘</a> <a id="37814" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="37816" href="Demos.HSP.html#34487" class="InductiveConstructor">mkhom</a> <a id="37822" class="Symbol">(</a><a id="37823" href="Relation.Binary.Structures.html#1646" class="Function">reflexive</a> <a id="37833" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a><a id="37839" class="Symbol">)</a> <a id="37841" class="Keyword">where</a> <a id="37847" class="Keyword">open</a> <a id="37852" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="37859" class="Symbol">(</a> <a id="37861" href="Demos.HSP.html#24623" class="Field">Domain</a> <a id="37868" href="Demos.HSP.html#37806" class="Bound">ğ‘¨</a> <a id="37870" class="Symbol">)</a> <a id="37872" class="Keyword">using</a> <a id="37878" class="Symbol">(</a> <a id="37880" href="Relation.Binary.Structures.html#1646" class="Function">reflexive</a> <a id="37890" class="Symbol">)</a>

<a id="37893" class="Keyword">module</a> <a id="37900" href="Demos.HSP.html#37900" class="Module">_</a> <a id="37902" class="Symbol">{</a><a id="37903" href="Demos.HSP.html#37903" class="Bound">ğ‘¨</a> <a id="37905" class="Symbol">:</a> <a id="37907" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="37915" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="37917" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="37919" class="Symbol">}{</a><a id="37921" href="Demos.HSP.html#37921" class="Bound">â„“</a> <a id="37923" class="Symbol">:</a> <a id="37925" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="37930" class="Symbol">}</a> <a id="37932" class="Keyword">where</a>
 <a id="37939" class="Keyword">open</a> <a id="37944" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="37951" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="37954" href="Demos.HSP.html#37903" class="Bound">ğ‘¨</a> <a id="37956" href="Demos.HSP.html#25499" class="Function Operator">]</a>              <a id="37971" class="Keyword">using</a> <a id="37977" class="Symbol">(</a> <a id="37979" href="Relation.Binary.Structures.html#1646" class="Function">reflexive</a> <a id="37989" class="Symbol">)</a>  <a id="37992" class="Keyword">renaming</a> <a id="38001" class="Symbol">(</a> <a id="38003" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="38007" class="Symbol">to</a> <a id="38010" class="Field Operator">_â‰ˆâ‚_</a> <a id="38015" class="Symbol">;</a> <a id="38017" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="38022" class="Symbol">to</a> <a id="38025" class="Function">reflâ‚</a> <a id="38031" class="Symbol">)</a>
 <a id="38034" class="Keyword">open</a> <a id="38039" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="38046" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="38049" href="Demos.HSP.html#28541" class="Function">Lift-AlgË¡</a> <a id="38059" href="Demos.HSP.html#37903" class="Bound">ğ‘¨</a> <a id="38061" href="Demos.HSP.html#37921" class="Bound">â„“</a> <a id="38063" href="Demos.HSP.html#25499" class="Function Operator">]</a>  <a id="38066" class="Keyword">using</a> <a id="38072" class="Symbol">()</a>             <a id="38087" class="Keyword">renaming</a> <a id="38096" class="Symbol">(</a> <a id="38098" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="38102" class="Symbol">to</a> <a id="38105" class="Field Operator">_â‰ˆË¡_</a> <a id="38110" class="Symbol">;</a> <a id="38112" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="38117" class="Symbol">to</a> <a id="38120" class="Function">reflË¡</a><a id="38125" class="Symbol">)</a>
 <a id="38128" class="Keyword">open</a> <a id="38133" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="38140" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="38143" href="Demos.HSP.html#28936" class="Function">Lift-AlgÊ³</a> <a id="38153" href="Demos.HSP.html#37903" class="Bound">ğ‘¨</a> <a id="38155" href="Demos.HSP.html#37921" class="Bound">â„“</a> <a id="38157" href="Demos.HSP.html#25499" class="Function Operator">]</a>  <a id="38160" class="Keyword">using</a> <a id="38166" class="Symbol">()</a>             <a id="38181" class="Keyword">renaming</a> <a id="38190" class="Symbol">(</a> <a id="38192" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="38196" class="Symbol">to</a> <a id="38199" class="Field Operator">_â‰ˆÊ³_</a> <a id="38204" class="Symbol">;</a> <a id="38206" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="38211" class="Symbol">to</a> <a id="38214" class="Function">reflÊ³</a><a id="38219" class="Symbol">)</a>
 <a id="38222" class="Keyword">open</a> <a id="38227" href="Level.html" class="Module">Level</a>

 <a id="38235" href="Demos.HSP.html#38235" class="Function">ToLiftË¡</a> <a id="38243" class="Symbol">:</a> <a id="38245" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="38249" href="Demos.HSP.html#37903" class="Bound">ğ‘¨</a> <a id="38251" class="Symbol">(</a><a id="38252" href="Demos.HSP.html#28541" class="Function">Lift-AlgË¡</a> <a id="38262" href="Demos.HSP.html#37903" class="Bound">ğ‘¨</a> <a id="38264" href="Demos.HSP.html#37921" class="Bound">â„“</a><a id="38265" class="Symbol">)</a>
 <a id="38268" href="Demos.HSP.html#38235" class="Function">ToLiftË¡</a> <a id="38276" class="Symbol">=</a> <a id="38278" class="Keyword">record</a> <a id="38285" class="Symbol">{</a> <a id="38287" href="Function.Bundles.html#1919" class="Field">f</a> <a id="38289" class="Symbol">=</a> <a id="38291" href="Level.html#457" class="InductiveConstructor">lift</a> <a id="38296" class="Symbol">;</a> <a id="38298" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="38303" class="Symbol">=</a> <a id="38305" href="Function.Base.html#615" class="Function">id</a> <a id="38308" class="Symbol">}</a> <a id="38310" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="38312" href="Demos.HSP.html#34487" class="InductiveConstructor">mkhom</a> <a id="38318" class="Symbol">(</a><a id="38319" href="Relation.Binary.Structures.html#1646" class="Function">reflexive</a> <a id="38329" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a><a id="38335" class="Symbol">)</a>

 <a id="38339" href="Demos.HSP.html#38339" class="Function">FromLiftË¡</a> <a id="38349" class="Symbol">:</a> <a id="38351" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="38355" class="Symbol">(</a><a id="38356" href="Demos.HSP.html#28541" class="Function">Lift-AlgË¡</a> <a id="38366" href="Demos.HSP.html#37903" class="Bound">ğ‘¨</a> <a id="38368" href="Demos.HSP.html#37921" class="Bound">â„“</a><a id="38369" class="Symbol">)</a> <a id="38371" href="Demos.HSP.html#37903" class="Bound">ğ‘¨</a>
 <a id="38374" href="Demos.HSP.html#38339" class="Function">FromLiftË¡</a> <a id="38384" class="Symbol">=</a> <a id="38386" class="Keyword">record</a> <a id="38393" class="Symbol">{</a> <a id="38395" href="Function.Bundles.html#1919" class="Field">f</a> <a id="38397" class="Symbol">=</a> <a id="38399" href="Level.html#470" class="Field">lower</a> <a id="38405" class="Symbol">;</a> <a id="38407" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="38412" class="Symbol">=</a> <a id="38414" href="Function.Base.html#615" class="Function">id</a> <a id="38417" class="Symbol">}</a> <a id="38419" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="38421" href="Demos.HSP.html#34487" class="InductiveConstructor">mkhom</a> <a id="38427" href="Demos.HSP.html#38120" class="Function">reflË¡</a>

 <a id="38435" href="Demos.HSP.html#38435" class="Function">ToFromLiftË¡</a> <a id="38447" class="Symbol">:</a> <a id="38449" class="Symbol">âˆ€</a> <a id="38451" href="Demos.HSP.html#38451" class="Bound">b</a> <a id="38453" class="Symbol">â†’</a>  <a id="38456" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38458" href="Demos.HSP.html#38235" class="Function">ToLiftË¡</a> <a id="38466" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38468" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="38472" class="Symbol">(</a><a id="38473" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38475" href="Demos.HSP.html#38339" class="Function">FromLiftË¡</a> <a id="38485" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38487" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="38491" href="Demos.HSP.html#38451" class="Bound">b</a><a id="38492" class="Symbol">)</a> <a id="38494" href="Demos.HSP.html#38105" class="Function Operator">â‰ˆË¡</a> <a id="38497" href="Demos.HSP.html#38451" class="Bound">b</a>
 <a id="38500" href="Demos.HSP.html#38435" class="Function">ToFromLiftË¡</a> <a id="38512" href="Demos.HSP.html#38512" class="Bound">b</a> <a id="38514" class="Symbol">=</a> <a id="38516" href="Demos.HSP.html#38025" class="Function">reflâ‚</a>

 <a id="38524" href="Demos.HSP.html#38524" class="Function">FromToLiftË¡</a> <a id="38536" class="Symbol">:</a> <a id="38538" class="Symbol">âˆ€</a> <a id="38540" href="Demos.HSP.html#38540" class="Bound">a</a> <a id="38542" class="Symbol">â†’</a> <a id="38544" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38546" href="Demos.HSP.html#38339" class="Function">FromLiftË¡</a> <a id="38556" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38558" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="38562" class="Symbol">(</a><a id="38563" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38565" href="Demos.HSP.html#38235" class="Function">ToLiftË¡</a> <a id="38573" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38575" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="38579" href="Demos.HSP.html#38540" class="Bound">a</a><a id="38580" class="Symbol">)</a> <a id="38582" href="Demos.HSP.html#38010" class="Function Operator">â‰ˆâ‚</a> <a id="38585" href="Demos.HSP.html#38540" class="Bound">a</a>
 <a id="38588" href="Demos.HSP.html#38524" class="Function">FromToLiftË¡</a> <a id="38600" href="Demos.HSP.html#38600" class="Bound">a</a> <a id="38602" class="Symbol">=</a> <a id="38604" href="Demos.HSP.html#38025" class="Function">reflâ‚</a>

 <a id="38612" href="Demos.HSP.html#38612" class="Function">ToLiftÊ³</a> <a id="38620" class="Symbol">:</a> <a id="38622" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="38626" href="Demos.HSP.html#37903" class="Bound">ğ‘¨</a> <a id="38628" class="Symbol">(</a><a id="38629" href="Demos.HSP.html#28936" class="Function">Lift-AlgÊ³</a> <a id="38639" href="Demos.HSP.html#37903" class="Bound">ğ‘¨</a> <a id="38641" href="Demos.HSP.html#37921" class="Bound">â„“</a><a id="38642" class="Symbol">)</a>
 <a id="38645" href="Demos.HSP.html#38612" class="Function">ToLiftÊ³</a> <a id="38653" class="Symbol">=</a> <a id="38655" class="Keyword">record</a> <a id="38662" class="Symbol">{</a> <a id="38664" href="Function.Bundles.html#1919" class="Field">f</a> <a id="38666" class="Symbol">=</a> <a id="38668" href="Function.Base.html#615" class="Function">id</a> <a id="38671" class="Symbol">;</a> <a id="38673" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="38678" class="Symbol">=</a> <a id="38680" href="Level.html#457" class="InductiveConstructor">lift</a> <a id="38685" class="Symbol">}</a> <a id="38687" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="38689" href="Demos.HSP.html#34487" class="InductiveConstructor">mkhom</a> <a id="38695" class="Symbol">(</a><a id="38696" href="Level.html#457" class="InductiveConstructor">lift</a> <a id="38701" class="Symbol">(</a><a id="38702" href="Relation.Binary.Structures.html#1646" class="Function">reflexive</a> <a id="38712" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a><a id="38718" class="Symbol">))</a>

 <a id="38723" href="Demos.HSP.html#38723" class="Function">FromLiftÊ³</a> <a id="38733" class="Symbol">:</a> <a id="38735" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="38739" class="Symbol">(</a><a id="38740" href="Demos.HSP.html#28936" class="Function">Lift-AlgÊ³</a> <a id="38750" href="Demos.HSP.html#37903" class="Bound">ğ‘¨</a> <a id="38752" href="Demos.HSP.html#37921" class="Bound">â„“</a><a id="38753" class="Symbol">)</a> <a id="38755" href="Demos.HSP.html#37903" class="Bound">ğ‘¨</a>
 <a id="38758" href="Demos.HSP.html#38723" class="Function">FromLiftÊ³</a> <a id="38768" class="Symbol">=</a> <a id="38770" class="Keyword">record</a> <a id="38777" class="Symbol">{</a> <a id="38779" href="Function.Bundles.html#1919" class="Field">f</a> <a id="38781" class="Symbol">=</a> <a id="38783" href="Function.Base.html#615" class="Function">id</a> <a id="38786" class="Symbol">;</a> <a id="38788" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="38793" class="Symbol">=</a> <a id="38795" href="Level.html#470" class="Field">lower</a> <a id="38801" class="Symbol">}</a> <a id="38803" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="38805" href="Demos.HSP.html#34487" class="InductiveConstructor">mkhom</a> <a id="38811" href="Demos.HSP.html#38120" class="Function">reflË¡</a>

 <a id="38819" href="Demos.HSP.html#38819" class="Function">ToFromLiftÊ³</a> <a id="38831" class="Symbol">:</a> <a id="38833" class="Symbol">âˆ€</a> <a id="38835" href="Demos.HSP.html#38835" class="Bound">b</a> <a id="38837" class="Symbol">â†’</a> <a id="38839" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38841" href="Demos.HSP.html#38612" class="Function">ToLiftÊ³</a> <a id="38849" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38851" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="38855" class="Symbol">(</a><a id="38856" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38858" href="Demos.HSP.html#38723" class="Function">FromLiftÊ³</a> <a id="38868" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38870" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="38874" href="Demos.HSP.html#38835" class="Bound">b</a><a id="38875" class="Symbol">)</a> <a id="38877" href="Demos.HSP.html#38199" class="Function Operator">â‰ˆÊ³</a> <a id="38880" href="Demos.HSP.html#38835" class="Bound">b</a>
 <a id="38883" href="Demos.HSP.html#38819" class="Function">ToFromLiftÊ³</a> <a id="38895" href="Demos.HSP.html#38895" class="Bound">b</a> <a id="38897" class="Symbol">=</a> <a id="38899" href="Level.html#457" class="InductiveConstructor">lift</a> <a id="38904" href="Demos.HSP.html#38025" class="Function">reflâ‚</a>

 <a id="38912" href="Demos.HSP.html#38912" class="Function">FromToLiftÊ³</a> <a id="38924" class="Symbol">:</a> <a id="38926" class="Symbol">âˆ€</a> <a id="38928" href="Demos.HSP.html#38928" class="Bound">a</a> <a id="38930" class="Symbol">â†’</a> <a id="38932" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38934" href="Demos.HSP.html#38723" class="Function">FromLiftÊ³</a> <a id="38944" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38946" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="38950" class="Symbol">(</a><a id="38951" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38953" href="Demos.HSP.html#38612" class="Function">ToLiftÊ³</a> <a id="38961" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="38963" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="38967" href="Demos.HSP.html#38928" class="Bound">a</a><a id="38968" class="Symbol">)</a> <a id="38970" href="Demos.HSP.html#38010" class="Function Operator">â‰ˆâ‚</a> <a id="38973" href="Demos.HSP.html#38928" class="Bound">a</a>
 <a id="38976" href="Demos.HSP.html#38912" class="Function">FromToLiftÊ³</a> <a id="38988" href="Demos.HSP.html#38988" class="Bound">a</a> <a id="38990" class="Symbol">=</a> <a id="38992" href="Demos.HSP.html#38025" class="Function">reflâ‚</a>


<a id="39000" class="Keyword">module</a> <a id="39007" href="Demos.HSP.html#39007" class="Module">_</a> <a id="39009" class="Symbol">{</a><a id="39010" href="Demos.HSP.html#39010" class="Bound">ğ‘¨</a> <a id="39012" class="Symbol">:</a> <a id="39014" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="39022" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="39024" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="39026" class="Symbol">}{</a><a id="39028" href="Demos.HSP.html#39028" class="Bound">â„“</a> <a id="39030" href="Demos.HSP.html#39030" class="Bound">r</a> <a id="39032" class="Symbol">:</a> <a id="39034" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="39039" class="Symbol">}</a> <a id="39041" class="Keyword">where</a>
 <a id="39048" class="Keyword">open</a>  <a id="39054" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="39061" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="39064" href="Demos.HSP.html#39010" class="Bound">ğ‘¨</a> <a id="39066" href="Demos.HSP.html#25499" class="Function Operator">]</a>               <a id="39082" class="Keyword">using</a> <a id="39088" class="Symbol">(</a> <a id="39090" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="39095" class="Symbol">)</a>
 <a id="39098" class="Keyword">open</a>  <a id="39104" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="39111" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="39114" href="Demos.HSP.html#29482" class="Function">Lift-Alg</a> <a id="39123" href="Demos.HSP.html#39010" class="Bound">ğ‘¨</a> <a id="39125" href="Demos.HSP.html#39028" class="Bound">â„“</a> <a id="39127" href="Demos.HSP.html#39030" class="Bound">r</a> <a id="39129" href="Demos.HSP.html#25499" class="Function Operator">]</a>  <a id="39132" class="Keyword">using</a> <a id="39138" class="Symbol">(</a> <a id="39140" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="39144" class="Symbol">)</a>
 <a id="39147" class="Keyword">open</a>  <a id="39153" href="Level.html" class="Module">Level</a>
 <a id="39160" href="Demos.HSP.html#39160" class="Function">ToLift</a> <a id="39167" class="Symbol">:</a> <a id="39169" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="39173" href="Demos.HSP.html#39010" class="Bound">ğ‘¨</a> <a id="39175" class="Symbol">(</a><a id="39176" href="Demos.HSP.html#29482" class="Function">Lift-Alg</a> <a id="39185" href="Demos.HSP.html#39010" class="Bound">ğ‘¨</a> <a id="39187" href="Demos.HSP.html#39028" class="Bound">â„“</a> <a id="39189" href="Demos.HSP.html#39030" class="Bound">r</a><a id="39190" class="Symbol">)</a>
 <a id="39193" href="Demos.HSP.html#39160" class="Function">ToLift</a> <a id="39200" class="Symbol">=</a> <a id="39202" href="Demos.HSP.html#37248" class="Function">âˆ˜-hom</a> <a id="39208" href="Demos.HSP.html#38235" class="Function">ToLiftË¡</a> <a id="39216" href="Demos.HSP.html#38612" class="Function">ToLiftÊ³</a>

 <a id="39226" href="Demos.HSP.html#39226" class="Function">FromLift</a> <a id="39235" class="Symbol">:</a> <a id="39237" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="39241" class="Symbol">(</a><a id="39242" href="Demos.HSP.html#29482" class="Function">Lift-Alg</a> <a id="39251" href="Demos.HSP.html#39010" class="Bound">ğ‘¨</a> <a id="39253" href="Demos.HSP.html#39028" class="Bound">â„“</a> <a id="39255" href="Demos.HSP.html#39030" class="Bound">r</a><a id="39256" class="Symbol">)</a> <a id="39258" href="Demos.HSP.html#39010" class="Bound">ğ‘¨</a>
 <a id="39261" href="Demos.HSP.html#39226" class="Function">FromLift</a> <a id="39270" class="Symbol">=</a> <a id="39272" href="Demos.HSP.html#37248" class="Function">âˆ˜-hom</a> <a id="39278" href="Demos.HSP.html#38723" class="Function">FromLiftÊ³</a> <a id="39288" href="Demos.HSP.html#38339" class="Function">FromLiftË¡</a>

 <a id="39300" href="Demos.HSP.html#39300" class="Function">ToFromLift</a> <a id="39311" class="Symbol">:</a> <a id="39313" class="Symbol">âˆ€</a> <a id="39315" href="Demos.HSP.html#39315" class="Bound">b</a> <a id="39317" class="Symbol">â†’</a> <a id="39319" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="39321" href="Demos.HSP.html#39160" class="Function">ToLift</a> <a id="39328" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="39330" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="39334" class="Symbol">(</a><a id="39335" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="39337" href="Demos.HSP.html#39226" class="Function">FromLift</a> <a id="39346" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="39348" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="39352" href="Demos.HSP.html#39315" class="Bound">b</a><a id="39353" class="Symbol">)</a> <a id="39355" href="Relation.Binary.Bundles.html#1098" class="Function Operator">â‰ˆ</a> <a id="39357" href="Demos.HSP.html#39315" class="Bound">b</a>
 <a id="39360" href="Demos.HSP.html#39300" class="Function">ToFromLift</a> <a id="39371" href="Demos.HSP.html#39371" class="Bound">b</a> <a id="39373" class="Symbol">=</a> <a id="39375" href="Level.html#457" class="InductiveConstructor">lift</a> <a id="39380" href="Relation.Binary.Structures.html#1568" class="Function">refl</a>

 <a id="39387" href="Demos.HSP.html#39387" class="Function">ToLift-epi</a> <a id="39398" class="Symbol">:</a> <a id="39400" href="Demos.HSP.html#35676" class="Function">epi</a> <a id="39404" href="Demos.HSP.html#39010" class="Bound">ğ‘¨</a> <a id="39406" class="Symbol">(</a><a id="39407" href="Demos.HSP.html#29482" class="Function">Lift-Alg</a> <a id="39416" href="Demos.HSP.html#39010" class="Bound">ğ‘¨</a> <a id="39418" href="Demos.HSP.html#39028" class="Bound">â„“</a> <a id="39420" href="Demos.HSP.html#39030" class="Bound">r</a><a id="39421" class="Symbol">)</a>
 <a id="39424" href="Demos.HSP.html#39387" class="Function">ToLift-epi</a> <a id="39435" class="Symbol">=</a> <a id="39437" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="39439" href="Demos.HSP.html#39160" class="Function">ToLift</a> <a id="39446" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="39448" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a>  <a id="39451" class="Keyword">record</a> <a id="39458" class="Symbol">{</a> <a id="39460" href="Demos.HSP.html#35577" class="Field">isHom</a> <a id="39466" class="Symbol">=</a> <a id="39468" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="39470" href="Demos.HSP.html#39160" class="Function">ToLift</a> <a id="39477" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a>
                            <a id="39507" class="Symbol">;</a> <a id="39509" href="Demos.HSP.html#35602" class="Field">isSurjective</a> <a id="39522" class="Symbol">=</a> <a id="39524" class="Symbol">Î»</a> <a id="39526" class="Symbol">{</a><a id="39527" href="Demos.HSP.html#39527" class="Bound">y</a><a id="39528" class="Symbol">}</a> <a id="39530" class="Symbol">â†’</a> <a id="39532" href="Demos.HSP.html#13459" class="InductiveConstructor">eq</a> <a id="39535" class="Symbol">(</a><a id="39536" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="39538" href="Demos.HSP.html#39226" class="Function">FromLift</a> <a id="39547" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="39549" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="39553" href="Demos.HSP.html#39527" class="Bound">y</a><a id="39554" class="Symbol">)</a> <a id="39556" class="Symbol">(</a><a id="39557" href="Demos.HSP.html#39300" class="Function">ToFromLift</a> <a id="39568" href="Demos.HSP.html#39527" class="Bound">y</a><a id="39569" class="Symbol">)</a> <a id="39571" class="Symbol">}</a>
</pre>
%% -----------------------------------------------------------------------------
\paragraph*{Homomorphisms of product algebras}
Suppose we have an algebra \ab{ğ‘¨}, a type \ab I : \ap{Type} \ab{ğ“˜}, and a family \ab{â„¬} :
\ab I \as{â†’} \ar{Algebra} \ab{Î²} \ab{Ïáµ‡} of algebras.
We sometimes refer to the inhabitants of \ab{I} as \emph{indices}, and call \ab{â„¬} an
\defn{indexed family of algebras}. If in addition we have a family \ab{ğ’½} : (\ab i : \ab
I) â†’ \af{hom} \ab{ğ‘¨} (\ab{â„¬} \ab i) of homomorphisms, then we can construct a homomorphism
from \ab{ğ‘¨} to the product \af{â¨…} \ab{â„¬} in the natural way.  We codify the latter in
dependent type theory as follows.

<pre class="Agda">

<a id="40257" class="Keyword">module</a> <a id="40264" href="Demos.HSP.html#40264" class="Module">_</a> <a id="40266" class="Symbol">{</a><a id="40267" href="Demos.HSP.html#40267" class="Bound">Î¹</a> <a id="40269" class="Symbol">:</a> <a id="40271" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="40276" class="Symbol">}{</a><a id="40278" href="Demos.HSP.html#40278" class="Bound">I</a> <a id="40280" class="Symbol">:</a> <a id="40282" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="40287" href="Demos.HSP.html#40267" class="Bound">Î¹</a><a id="40288" class="Symbol">}{</a><a id="40290" href="Demos.HSP.html#40290" class="Bound">ğ‘¨</a> <a id="40292" class="Symbol">:</a> <a id="40294" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="40302" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="40304" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="40306" class="Symbol">}(</a><a id="40308" href="Demos.HSP.html#40308" class="Bound">â„¬</a> <a id="40310" class="Symbol">:</a> <a id="40312" href="Demos.HSP.html#40278" class="Bound">I</a> <a id="40314" class="Symbol">â†’</a> <a id="40316" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="40324" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="40326" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="40328" class="Symbol">)</a> <a id="40330" class="Keyword">where</a>
 <a id="40337" href="Demos.HSP.html#40337" class="Function">â¨…-hom-co</a> <a id="40346" class="Symbol">:</a> <a id="40348" class="Symbol">(âˆ€(</a><a id="40351" href="Demos.HSP.html#40351" class="Bound">i</a> <a id="40353" class="Symbol">:</a> <a id="40355" href="Demos.HSP.html#40278" class="Bound">I</a><a id="40356" class="Symbol">)</a> <a id="40358" class="Symbol">â†’</a> <a id="40360" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="40364" href="Demos.HSP.html#40290" class="Bound">ğ‘¨</a> <a id="40366" class="Symbol">(</a><a id="40367" href="Demos.HSP.html#40308" class="Bound">â„¬</a> <a id="40369" href="Demos.HSP.html#40351" class="Bound">i</a><a id="40370" class="Symbol">))</a> <a id="40373" class="Symbol">â†’</a> <a id="40375" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="40379" href="Demos.HSP.html#40290" class="Bound">ğ‘¨</a> <a id="40381" class="Symbol">(</a><a id="40382" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="40384" href="Demos.HSP.html#40308" class="Bound">â„¬</a><a id="40385" class="Symbol">)</a>
 <a id="40388" href="Demos.HSP.html#40337" class="Function">â¨…-hom-co</a> <a id="40397" href="Demos.HSP.html#40397" class="Bound">ğ’½</a> <a id="40399" class="Symbol">=</a> <a id="40401" href="Demos.HSP.html#40417" class="Function">h</a> <a id="40403" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="40405" href="Demos.HSP.html#40589" class="Function">hhom</a> <a id="40410" class="Keyword">where</a>  <a id="40417" href="Demos.HSP.html#40417" class="Function">h</a> <a id="40419" class="Symbol">:</a> <a id="40421" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="40424" href="Demos.HSP.html#40290" class="Bound">ğ‘¨</a> <a id="40426" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="40428" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="40430" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="40433" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="40435" href="Demos.HSP.html#40308" class="Bound">â„¬</a> <a id="40437" href="Demos.HSP.html#25499" class="Function Operator">]</a>
                              <a id="40469" href="Demos.HSP.html#40417" class="Function">h</a> <a id="40471" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="40475" href="Demos.HSP.html#40475" class="Bound">a</a> <a id="40477" class="Symbol">=</a> <a id="40479" class="Symbol">Î»</a> <a id="40481" href="Demos.HSP.html#40481" class="Bound">i</a> <a id="40483" class="Symbol">â†’</a> <a id="40485" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="40487" href="Demos.HSP.html#40397" class="Bound">ğ’½</a> <a id="40489" href="Demos.HSP.html#40481" class="Bound">i</a> <a id="40491" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="40493" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="40497" href="Demos.HSP.html#40475" class="Bound">a</a>
                              <a id="40529" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="40534" href="Demos.HSP.html#40417" class="Function">h</a> <a id="40536" href="Demos.HSP.html#40536" class="Bound">xy</a> <a id="40539" href="Demos.HSP.html#40539" class="Bound">i</a> <a id="40541" class="Symbol">=</a> <a id="40543" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="40548" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="40550" href="Demos.HSP.html#40397" class="Bound">ğ’½</a> <a id="40552" href="Demos.HSP.html#40539" class="Bound">i</a> <a id="40554" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="40556" href="Demos.HSP.html#40536" class="Bound">xy</a>
                              <a id="40589" href="Demos.HSP.html#40589" class="Function">hhom</a> <a id="40594" class="Symbol">:</a> <a id="40596" href="Demos.HSP.html#34414" class="Record">IsHom</a> <a id="40602" href="Demos.HSP.html#40290" class="Bound">ğ‘¨</a> <a id="40604" class="Symbol">(</a><a id="40605" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="40607" href="Demos.HSP.html#40308" class="Bound">â„¬</a><a id="40608" class="Symbol">)</a> <a id="40610" href="Demos.HSP.html#40417" class="Function">h</a>
                              <a id="40642" href="Demos.HSP.html#34508" class="Field">compatible</a> <a id="40653" href="Demos.HSP.html#40589" class="Function">hhom</a> <a id="40658" class="Symbol">=</a> <a id="40660" class="Symbol">Î»</a> <a id="40662" href="Demos.HSP.html#40662" class="Bound">i</a> <a id="40664" class="Symbol">â†’</a> <a id="40666" href="Demos.HSP.html#34508" class="Field">compatible</a> <a id="40677" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="40679" href="Demos.HSP.html#40397" class="Bound">ğ’½</a> <a id="40681" href="Demos.HSP.html#40662" class="Bound">i</a> <a id="40683" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a>
</pre>
\fi

Two structures are \defn{isomorphic} provided there are homomorphisms from each to the
other that compose to the identity. We define the following record type to represent this concept.
%We represent this notion by the type \ar{\au{}â‰…\au{}}.
\ifshort
\else
Note that the definition, shown below, includes a proof of the fact that the maps \afld{to} and
\afld{from} are bijective, which makes this fact more accessible.
\fi

<pre class="Agda">

<a id="41139" class="Keyword">module</a> <a id="41146" href="Demos.HSP.html#41146" class="Module">_</a> <a id="41148" class="Symbol">(</a><a id="41149" href="Demos.HSP.html#41149" class="Bound">ğ‘¨</a> <a id="41151" class="Symbol">:</a> <a id="41153" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="41161" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="41163" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="41165" class="Symbol">)</a> <a id="41167" class="Symbol">(</a><a id="41168" href="Demos.HSP.html#41168" class="Bound">ğ‘©</a> <a id="41170" class="Symbol">:</a> <a id="41172" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="41180" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="41182" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="41184" class="Symbol">)</a> <a id="41186" class="Keyword">where</a>
 <a id="41193" class="Keyword">open</a> <a id="41198" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="41205" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="41208" href="Demos.HSP.html#41149" class="Bound">ğ‘¨</a> <a id="41210" href="Demos.HSP.html#25499" class="Function Operator">]</a>  <a id="41213" class="Keyword">using</a> <a id="41219" class="Symbol">()</a>  <a id="41223" class="Keyword">renaming</a> <a id="41232" class="Symbol">(</a> <a id="41234" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="41238" class="Symbol">to</a> <a id="41241" class="Field Operator">_â‰ˆá´¬_</a> <a id="41246" class="Symbol">)</a>
 <a id="41249" class="Keyword">open</a> <a id="41254" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="41261" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="41264" href="Demos.HSP.html#41168" class="Bound">ğ‘©</a> <a id="41266" href="Demos.HSP.html#25499" class="Function Operator">]</a>  <a id="41269" class="Keyword">using</a> <a id="41275" class="Symbol">()</a>  <a id="41279" class="Keyword">renaming</a> <a id="41288" class="Symbol">(</a> <a id="41290" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="41294" class="Symbol">to</a> <a id="41297" class="Field Operator">_â‰ˆá´®_</a> <a id="41302" class="Symbol">)</a>

 <a id="41306" class="Keyword">record</a> <a id="41313" href="Demos.HSP.html#41313" class="Record Operator">_â‰…_</a> <a id="41317" class="Symbol">:</a> <a id="41319" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="41324" class="Symbol">(</a><a id="41325" href="Demos.HSP.html#7257" class="Bound">ğ“</a> <a id="41327" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="41329" href="Demos.HSP.html#7259" class="Bound">ğ“¥</a> <a id="41331" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="41333" href="Demos.HSP.html#41161" class="Bound">Î±</a> <a id="41335" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="41337" href="Demos.HSP.html#41163" class="Bound">Ïáµƒ</a> <a id="41340" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="41342" href="Demos.HSP.html#41180" class="Bound">Î²</a> <a id="41344" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="41346" href="Demos.HSP.html#41182" class="Bound">Ïáµ‡</a> <a id="41349" class="Symbol">)</a> <a id="41351" class="Keyword">where</a>
  <a id="41359" class="Keyword">constructor</a>  <a id="41372" href="Demos.HSP.html#41372" class="InductiveConstructor">mkiso</a>
  <a id="41380" class="Keyword">field</a>        <a id="41393" href="Demos.HSP.html#41393" class="Field">to</a>    <a id="41399" class="Symbol">:</a> <a id="41401" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="41405" href="Demos.HSP.html#41149" class="Bound">ğ‘¨</a> <a id="41407" href="Demos.HSP.html#41168" class="Bound">ğ‘©</a>
               <a id="41424" href="Demos.HSP.html#41424" class="Field">from</a>  <a id="41430" class="Symbol">:</a> <a id="41432" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="41436" href="Demos.HSP.html#41168" class="Bound">ğ‘©</a> <a id="41438" href="Demos.HSP.html#41149" class="Bound">ğ‘¨</a>
               <a id="41455" href="Demos.HSP.html#41455" class="Field">toâˆ¼from</a> <a id="41463" class="Symbol">:</a> <a id="41465" class="Symbol">âˆ€</a> <a id="41467" href="Demos.HSP.html#41467" class="Bound">b</a> <a id="41469" class="Symbol">â†’</a> <a id="41471" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="41473" href="Demos.HSP.html#41393" class="Field">to</a> <a id="41476" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>    <a id="41481" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="41485" class="Symbol">(</a><a id="41486" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="41488" href="Demos.HSP.html#41424" class="Field">from</a> <a id="41493" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>  <a id="41496" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="41500" href="Demos.HSP.html#41467" class="Bound">b</a><a id="41501" class="Symbol">)</a>  <a id="41504" href="Demos.HSP.html#41297" class="Function Operator">â‰ˆá´®</a> <a id="41507" href="Demos.HSP.html#41467" class="Bound">b</a>
               <a id="41524" href="Demos.HSP.html#41524" class="Field">fromâˆ¼to</a> <a id="41532" class="Symbol">:</a> <a id="41534" class="Symbol">âˆ€</a> <a id="41536" href="Demos.HSP.html#41536" class="Bound">a</a> <a id="41538" class="Symbol">â†’</a> <a id="41540" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="41542" href="Demos.HSP.html#41424" class="Field">from</a> <a id="41547" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>  <a id="41550" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="41554" class="Symbol">(</a><a id="41555" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="41557" href="Demos.HSP.html#41393" class="Field">to</a> <a id="41560" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>    <a id="41565" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="41569" href="Demos.HSP.html#41536" class="Bound">a</a><a id="41570" class="Symbol">)</a>  <a id="41573" href="Demos.HSP.html#41241" class="Function Operator">â‰ˆá´¬</a> <a id="41576" href="Demos.HSP.html#41536" class="Bound">a</a>

</pre>
\ifshort
The \agdaalgebras library also includes formal proof that the \afld{to} and \afld{from} maps are bijections and that \ar{\au{}â‰…\au{}} is an equivalence relation, but we suppress these details.
\else
<pre class="Agda">

  <a id="41814" href="Demos.HSP.html#41814" class="Function">toIsInjective</a> <a id="41828" class="Symbol">:</a> <a id="41830" href="Demos.HSP.html#15537" class="Function">IsInjective</a> <a id="41842" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="41844" href="Demos.HSP.html#41393" class="Field">to</a> <a id="41847" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>
  <a id="41851" href="Demos.HSP.html#41814" class="Function">toIsInjective</a> <a id="41865" class="Symbol">{</a><a id="41866" href="Demos.HSP.html#41866" class="Bound">x</a><a id="41867" class="Symbol">}{</a><a id="41869" href="Demos.HSP.html#41869" class="Bound">y</a><a id="41870" class="Symbol">}</a> <a id="41872" href="Demos.HSP.html#41872" class="Bound">xy</a> <a id="41875" class="Symbol">=</a> <a id="41877" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="41883" class="Symbol">(</a><a id="41884" href="Relation.Binary.Structures.html#1594" class="Function">sym</a> <a id="41888" class="Symbol">(</a><a id="41889" href="Demos.HSP.html#41524" class="Field">fromâˆ¼to</a> <a id="41897" href="Demos.HSP.html#41866" class="Bound">x</a><a id="41898" class="Symbol">))</a> <a id="41901" class="Symbol">(</a><a id="41902" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="41908" href="Demos.HSP.html#41984" class="Function">Î¾</a> <a id="41910" class="Symbol">(</a><a id="41911" href="Demos.HSP.html#41524" class="Field">fromâˆ¼to</a> <a id="41919" href="Demos.HSP.html#41869" class="Bound">y</a><a id="41920" class="Symbol">))</a>
   <a id="41926" class="Keyword">where</a>  <a id="41933" class="Keyword">open</a> <a id="41938" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="41945" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="41948" href="Demos.HSP.html#41149" class="Bound">ğ‘¨</a> <a id="41950" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="41952" class="Keyword">using</a> <a id="41958" class="Symbol">(</a> <a id="41960" href="Relation.Binary.Structures.html#1594" class="Function">sym</a> <a id="41964" class="Symbol">;</a> <a id="41966" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="41972" class="Symbol">)</a>
          <a id="41984" href="Demos.HSP.html#41984" class="Function">Î¾</a> <a id="41986" class="Symbol">:</a> <a id="41988" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="41990" href="Demos.HSP.html#41424" class="Field">from</a> <a id="41995" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="41997" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="42001" class="Symbol">(</a><a id="42002" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42004" href="Demos.HSP.html#41393" class="Field">to</a> <a id="42007" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42009" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="42013" href="Demos.HSP.html#41866" class="Bound">x</a><a id="42014" class="Symbol">)</a> <a id="42016" href="Demos.HSP.html#41241" class="Function Operator">â‰ˆá´¬</a> <a id="42019" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42021" href="Demos.HSP.html#41424" class="Field">from</a> <a id="42026" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42028" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="42032" class="Symbol">(</a><a id="42033" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42035" href="Demos.HSP.html#41393" class="Field">to</a> <a id="42038" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42040" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="42044" href="Demos.HSP.html#41869" class="Bound">y</a><a id="42045" class="Symbol">)</a>
          <a id="42057" href="Demos.HSP.html#41984" class="Function">Î¾</a> <a id="42059" class="Symbol">=</a> <a id="42061" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="42066" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42068" href="Demos.HSP.html#41424" class="Field">from</a> <a id="42073" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42075" href="Demos.HSP.html#41872" class="Bound">xy</a>

  <a id="42081" href="Demos.HSP.html#42081" class="Function">fromIsSurjective</a> <a id="42098" class="Symbol">:</a> <a id="42100" href="Demos.HSP.html#15620" class="Function">IsSurjective</a> <a id="42113" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42115" href="Demos.HSP.html#41424" class="Field">from</a> <a id="42120" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>
  <a id="42124" href="Demos.HSP.html#42081" class="Function">fromIsSurjective</a> <a id="42141" class="Symbol">{</a><a id="42142" href="Demos.HSP.html#42142" class="Bound">x</a><a id="42143" class="Symbol">}</a> <a id="42145" class="Symbol">=</a> <a id="42147" href="Demos.HSP.html#13459" class="InductiveConstructor">eq</a> <a id="42150" class="Symbol">(</a><a id="42151" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42153" href="Demos.HSP.html#41393" class="Field">to</a> <a id="42156" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42158" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="42162" href="Demos.HSP.html#42142" class="Bound">x</a><a id="42163" class="Symbol">)</a> <a id="42165" class="Symbol">(</a><a id="42166" href="Relation.Binary.Structures.html#1594" class="Function">sym</a> <a id="42170" class="Symbol">(</a><a id="42171" href="Demos.HSP.html#41524" class="Field">fromâˆ¼to</a> <a id="42179" href="Demos.HSP.html#42142" class="Bound">x</a><a id="42180" class="Symbol">))</a>
   <a id="42186" class="Keyword">where</a> <a id="42192" class="Keyword">open</a> <a id="42197" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="42204" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="42207" href="Demos.HSP.html#41149" class="Bound">ğ‘¨</a> <a id="42209" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="42211" class="Keyword">using</a> <a id="42217" class="Symbol">(</a> <a id="42219" href="Relation.Binary.Structures.html#1594" class="Function">sym</a> <a id="42223" class="Symbol">)</a>

<a id="42226" class="Keyword">open</a> <a id="42231" href="Demos.HSP.html#41313" class="Module Operator">_â‰…_</a>

</pre>

It is easy to prove that \ar{\au{}â‰…\au{}} is an equivalence relation, as follows.

<pre class="Agda">

<a id="â‰…-refl"></a><a id="42345" href="Demos.HSP.html#42345" class="Function">â‰…-refl</a> <a id="42352" class="Symbol">:</a> <a id="42354" href="Relation.Binary.Definitions.html#1339" class="Function">Reflexive</a> <a id="42364" class="Symbol">(</a><a id="42365" href="Demos.HSP.html#41313" class="Record Operator">_â‰…_</a> <a id="42369" class="Symbol">{</a><a id="42370" href="Demos.HSP.html#9438" class="Generalizable">Î±</a><a id="42371" class="Symbol">}{</a><a id="42373" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="42375" class="Symbol">})</a>
<a id="42378" href="Demos.HSP.html#42345" class="Function">â‰…-refl</a> <a id="42385" class="Symbol">{</a><a id="42386" href="Demos.HSP.html#42386" class="Bound">Î±</a><a id="42387" class="Symbol">}{</a><a id="42389" href="Demos.HSP.html#42389" class="Bound">Ïáµƒ</a><a id="42391" class="Symbol">}{</a><a id="42393" href="Demos.HSP.html#42393" class="Bound">ğ‘¨</a><a id="42394" class="Symbol">}</a> <a id="42396" class="Symbol">=</a> <a id="42398" href="Demos.HSP.html#41372" class="InductiveConstructor">mkiso</a> <a id="42404" href="Demos.HSP.html#37764" class="Function">ğ’¾ğ’¹</a> <a id="42407" href="Demos.HSP.html#37764" class="Function">ğ’¾ğ’¹</a> <a id="42410" class="Symbol">(Î»</a> <a id="42413" href="Demos.HSP.html#42413" class="Bound">b</a> <a id="42415" class="Symbol">â†’</a> <a id="42417" href="Relation.Binary.Structures.html#1568" class="Function">refl</a><a id="42421" class="Symbol">)</a> <a id="42423" class="Symbol">Î»</a> <a id="42425" href="Demos.HSP.html#42425" class="Bound">a</a> <a id="42427" class="Symbol">â†’</a> <a id="42429" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="42434" class="Keyword">where</a> <a id="42440" class="Keyword">open</a> <a id="42445" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="42452" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="42455" href="Demos.HSP.html#42393" class="Bound">ğ‘¨</a> <a id="42457" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="42459" class="Keyword">using</a> <a id="42465" class="Symbol">(</a> <a id="42467" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="42472" class="Symbol">)</a>
<a id="â‰…-sym"></a><a id="42474" href="Demos.HSP.html#42474" class="Function">â‰…-sym</a> <a id="42480" class="Symbol">:</a> <a id="42482" href="Relation.Binary.Definitions.html#1424" class="Function">Sym</a> <a id="42486" class="Symbol">(</a><a id="42487" href="Demos.HSP.html#41313" class="Record Operator">_â‰…_</a><a id="42490" class="Symbol">{</a><a id="42491" href="Demos.HSP.html#9443" class="Generalizable">Î²</a><a id="42492" class="Symbol">}{</a><a id="42494" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="42496" class="Symbol">})</a> <a id="42499" class="Symbol">(</a><a id="42500" href="Demos.HSP.html#41313" class="Record Operator">_â‰…_</a><a id="42503" class="Symbol">{</a><a id="42504" href="Demos.HSP.html#9438" class="Generalizable">Î±</a><a id="42505" class="Symbol">}{</a><a id="42507" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="42509" class="Symbol">})</a>
<a id="42512" href="Demos.HSP.html#42474" class="Function">â‰…-sym</a> <a id="42518" href="Demos.HSP.html#42518" class="Bound">Ï†</a> <a id="42520" class="Symbol">=</a> <a id="42522" href="Demos.HSP.html#41372" class="InductiveConstructor">mkiso</a> <a id="42528" class="Symbol">(</a><a id="42529" href="Demos.HSP.html#41424" class="Field">from</a> <a id="42534" href="Demos.HSP.html#42518" class="Bound">Ï†</a><a id="42535" class="Symbol">)</a> <a id="42537" class="Symbol">(</a><a id="42538" href="Demos.HSP.html#41393" class="Field">to</a> <a id="42541" href="Demos.HSP.html#42518" class="Bound">Ï†</a><a id="42542" class="Symbol">)</a> <a id="42544" class="Symbol">(</a><a id="42545" href="Demos.HSP.html#41524" class="Field">fromâˆ¼to</a> <a id="42553" href="Demos.HSP.html#42518" class="Bound">Ï†</a><a id="42554" class="Symbol">)</a> <a id="42556" class="Symbol">(</a><a id="42557" href="Demos.HSP.html#41455" class="Field">toâˆ¼from</a> <a id="42565" href="Demos.HSP.html#42518" class="Bound">Ï†</a><a id="42566" class="Symbol">)</a>

<a id="â‰…-trans"></a><a id="42569" href="Demos.HSP.html#42569" class="Function">â‰…-trans</a> <a id="42577" class="Symbol">:</a> <a id="42579" href="Relation.Binary.Definitions.html#1585" class="Function">Trans</a> <a id="42585" class="Symbol">(</a><a id="42586" href="Demos.HSP.html#41313" class="Record Operator">_â‰…_</a> <a id="42590" class="Symbol">{</a><a id="42591" href="Demos.HSP.html#9438" class="Generalizable">Î±</a><a id="42592" class="Symbol">}{</a><a id="42594" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="42596" class="Symbol">})</a> <a id="42599" class="Symbol">(</a><a id="42600" href="Demos.HSP.html#41313" class="Record Operator">_â‰…_</a><a id="42603" class="Symbol">{</a><a id="42604" href="Demos.HSP.html#9443" class="Generalizable">Î²</a><a id="42605" class="Symbol">}{</a><a id="42607" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="42609" class="Symbol">})</a> <a id="42612" class="Symbol">(</a><a id="42613" href="Demos.HSP.html#41313" class="Record Operator">_â‰…_</a><a id="42616" class="Symbol">{</a><a id="42617" href="Demos.HSP.html#9438" class="Generalizable">Î±</a><a id="42618" class="Symbol">}{</a><a id="42620" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="42622" class="Symbol">}{</a><a id="42624" href="Demos.HSP.html#9448" class="Generalizable">Î³</a><a id="42625" class="Symbol">}{</a><a id="42627" href="Demos.HSP.html#9450" class="Generalizable">Ïá¶œ</a><a id="42629" class="Symbol">})</a>
<a id="42632" href="Demos.HSP.html#42569" class="Function">â‰…-trans</a> <a id="42640" class="Symbol">{</a><a id="42641" class="Argument">Ïá¶œ</a> <a id="42644" class="Symbol">=</a> <a id="42646" href="Demos.HSP.html#42646" class="Bound">Ïá¶œ</a><a id="42648" class="Symbol">}{</a><a id="42650" href="Demos.HSP.html#42650" class="Bound">ğ‘¨</a><a id="42651" class="Symbol">}{</a><a id="42653" href="Demos.HSP.html#42653" class="Bound">ğ‘©</a><a id="42654" class="Symbol">}{</a><a id="42656" href="Demos.HSP.html#42656" class="Bound">ğ‘ª</a><a id="42657" class="Symbol">}</a> <a id="42659" href="Demos.HSP.html#42659" class="Bound">ab</a> <a id="42662" href="Demos.HSP.html#42662" class="Bound">bc</a> <a id="42665" class="Symbol">=</a> <a id="42667" href="Demos.HSP.html#41372" class="InductiveConstructor">mkiso</a> <a id="42673" href="Demos.HSP.html#42689" class="Function">f</a> <a id="42675" href="Demos.HSP.html#42719" class="Function">g</a> <a id="42677" href="Demos.HSP.html#42912" class="Function">Ï„</a> <a id="42679" href="Demos.HSP.html#43034" class="Function">Î½</a> <a id="42681" class="Keyword">where</a>
  <a id="42689" href="Demos.HSP.html#42689" class="Function">f</a> <a id="42691" class="Symbol">:</a> <a id="42693" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="42697" href="Demos.HSP.html#42650" class="Bound">ğ‘¨</a> <a id="42699" href="Demos.HSP.html#42656" class="Bound">ğ‘ª</a>                <a id="42716" class="Symbol">;</a>  <a id="42719" href="Demos.HSP.html#42719" class="Function">g</a> <a id="42721" class="Symbol">:</a> <a id="42723" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="42727" href="Demos.HSP.html#42656" class="Bound">ğ‘ª</a> <a id="42729" href="Demos.HSP.html#42650" class="Bound">ğ‘¨</a>
  <a id="42733" href="Demos.HSP.html#42689" class="Function">f</a> <a id="42735" class="Symbol">=</a> <a id="42737" href="Demos.HSP.html#37248" class="Function">âˆ˜-hom</a> <a id="42743" class="Symbol">(</a><a id="42744" href="Demos.HSP.html#41393" class="Field">to</a> <a id="42747" href="Demos.HSP.html#42659" class="Bound">ab</a><a id="42749" class="Symbol">)</a> <a id="42751" class="Symbol">(</a><a id="42752" href="Demos.HSP.html#41393" class="Field">to</a> <a id="42755" href="Demos.HSP.html#42662" class="Bound">bc</a><a id="42757" class="Symbol">)</a>  <a id="42760" class="Symbol">;</a>  <a id="42763" href="Demos.HSP.html#42719" class="Function">g</a> <a id="42765" class="Symbol">=</a> <a id="42767" href="Demos.HSP.html#37248" class="Function">âˆ˜-hom</a> <a id="42773" class="Symbol">(</a><a id="42774" href="Demos.HSP.html#41424" class="Field">from</a> <a id="42779" href="Demos.HSP.html#42662" class="Bound">bc</a><a id="42781" class="Symbol">)</a> <a id="42783" class="Symbol">(</a><a id="42784" href="Demos.HSP.html#41424" class="Field">from</a> <a id="42789" href="Demos.HSP.html#42659" class="Bound">ab</a><a id="42791" class="Symbol">)</a>

  <a id="42796" class="Keyword">open</a> <a id="42801" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="42808" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="42811" href="Demos.HSP.html#42650" class="Bound">ğ‘¨</a> <a id="42813" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="42815" class="Keyword">using</a> <a id="42821" class="Symbol">(</a> <a id="42823" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="42827" class="Symbol">;</a> <a id="42829" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="42835" class="Symbol">)</a>
  <a id="42839" class="Keyword">open</a> <a id="42844" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="42851" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="42854" href="Demos.HSP.html#42656" class="Bound">ğ‘ª</a> <a id="42856" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="42858" class="Keyword">using</a> <a id="42864" class="Symbol">()</a> <a id="42867" class="Keyword">renaming</a> <a id="42876" class="Symbol">(</a> <a id="42878" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="42882" class="Symbol">to</a> <a id="42885" class="Field Operator">_â‰ˆá¶œ_</a> <a id="42890" class="Symbol">;</a> <a id="42892" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="42898" class="Symbol">to</a> <a id="42901" class="Function">transá¶œ</a> <a id="42908" class="Symbol">)</a>
  <a id="42912" href="Demos.HSP.html#42912" class="Function">Ï„</a> <a id="42914" class="Symbol">:</a> <a id="42916" class="Symbol">âˆ€</a> <a id="42918" href="Demos.HSP.html#42918" class="Bound">b</a> <a id="42920" class="Symbol">â†’</a> <a id="42922" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42924" href="Demos.HSP.html#42689" class="Function">f</a> <a id="42926" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42928" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="42932" class="Symbol">(</a><a id="42933" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42935" href="Demos.HSP.html#42719" class="Function">g</a> <a id="42937" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42939" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="42943" href="Demos.HSP.html#42918" class="Bound">b</a><a id="42944" class="Symbol">)</a> <a id="42946" href="Demos.HSP.html#42885" class="Function Operator">â‰ˆá¶œ</a> <a id="42949" href="Demos.HSP.html#42918" class="Bound">b</a>
  <a id="42953" href="Demos.HSP.html#42912" class="Function">Ï„</a> <a id="42955" href="Demos.HSP.html#42955" class="Bound">b</a> <a id="42957" class="Symbol">=</a> <a id="42959" href="Demos.HSP.html#42901" class="Function">transá¶œ</a> <a id="42966" class="Symbol">(</a><a id="42967" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="42972" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42974" href="Demos.HSP.html#41393" class="Field">to</a> <a id="42977" href="Demos.HSP.html#42662" class="Bound">bc</a> <a id="42980" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42982" class="Symbol">(</a><a id="42983" href="Demos.HSP.html#41455" class="Field">toâˆ¼from</a> <a id="42991" href="Demos.HSP.html#42659" class="Bound">ab</a> <a id="42994" class="Symbol">(</a><a id="42995" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="42997" href="Demos.HSP.html#41424" class="Field">from</a> <a id="43002" href="Demos.HSP.html#42662" class="Bound">bc</a> <a id="43005" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="43007" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="43011" href="Demos.HSP.html#42955" class="Bound">b</a><a id="43012" class="Symbol">)))</a> <a id="43016" class="Symbol">(</a><a id="43017" href="Demos.HSP.html#41455" class="Field">toâˆ¼from</a> <a id="43025" href="Demos.HSP.html#42662" class="Bound">bc</a> <a id="43028" href="Demos.HSP.html#42955" class="Bound">b</a><a id="43029" class="Symbol">)</a>

  <a id="43034" href="Demos.HSP.html#43034" class="Function">Î½</a> <a id="43036" class="Symbol">:</a> <a id="43038" class="Symbol">âˆ€</a> <a id="43040" href="Demos.HSP.html#43040" class="Bound">a</a> <a id="43042" class="Symbol">â†’</a> <a id="43044" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="43046" href="Demos.HSP.html#42719" class="Function">g</a> <a id="43048" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="43050" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="43054" class="Symbol">(</a><a id="43055" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="43057" href="Demos.HSP.html#42689" class="Function">f</a> <a id="43059" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="43061" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="43065" href="Demos.HSP.html#43040" class="Bound">a</a><a id="43066" class="Symbol">)</a> <a id="43068" href="Relation.Binary.Bundles.html#1098" class="Function Operator">â‰ˆ</a> <a id="43070" href="Demos.HSP.html#43040" class="Bound">a</a>
  <a id="43074" href="Demos.HSP.html#43034" class="Function">Î½</a> <a id="43076" href="Demos.HSP.html#43076" class="Bound">a</a> <a id="43078" class="Symbol">=</a> <a id="43080" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="43086" class="Symbol">(</a><a id="43087" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="43092" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="43094" href="Demos.HSP.html#41424" class="Field">from</a> <a id="43099" href="Demos.HSP.html#42659" class="Bound">ab</a> <a id="43102" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="43104" class="Symbol">(</a><a id="43105" href="Demos.HSP.html#41524" class="Field">fromâˆ¼to</a> <a id="43113" href="Demos.HSP.html#42662" class="Bound">bc</a> <a id="43116" class="Symbol">(</a><a id="43117" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="43119" href="Demos.HSP.html#41393" class="Field">to</a> <a id="43122" href="Demos.HSP.html#42659" class="Bound">ab</a> <a id="43125" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="43127" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="43131" href="Demos.HSP.html#43076" class="Bound">a</a><a id="43132" class="Symbol">)))</a> <a id="43136" class="Symbol">(</a><a id="43137" href="Demos.HSP.html#41524" class="Field">fromâˆ¼to</a> <a id="43145" href="Demos.HSP.html#42659" class="Bound">ab</a> <a id="43148" href="Demos.HSP.html#43076" class="Bound">a</a><a id="43149" class="Symbol">)</a>
</pre>
\fi
%% -----------------------------------------------------------------------------
\paragraph*{Homomorphic images}
We have found that a useful way to encode the concept of \emph{homomorphic image}
is to produce a witness, that is, a surjective hom.  Thus we define the type of surjective homs
and also record the fact that an algebra is its own homomorphic image via the identity
hom.\footnote{Here and elsewhere we use the shorthand \af{ov}~\ab{Î±} := \ab{ğ’ª}
\ap{âŠ”} \ab{ğ’±} \ap{âŠ”} \ab{Î±}, for any level \ab{Î±}.}

\ifshort\else
<pre class="Agda">

<a id="ov"></a><a id="43704" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="43707" class="Symbol">:</a> <a id="43709" href="Agda.Primitive.html#597" class="Postulate">Level</a> <a id="43715" class="Symbol">â†’</a> <a id="43717" href="Agda.Primitive.html#597" class="Postulate">Level</a>
<a id="43723" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="43726" href="Demos.HSP.html#43726" class="Bound">Î±</a> <a id="43728" class="Symbol">=</a> <a id="43730" href="Demos.HSP.html#7257" class="Bound">ğ“</a> <a id="43732" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="43734" href="Demos.HSP.html#7259" class="Bound">ğ“¥</a> <a id="43736" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="43738" href="Agda.Primitive.html#780" class="Primitive">lsuc</a> <a id="43743" href="Demos.HSP.html#43726" class="Bound">Î±</a>
</pre>
\fi
<pre class="Agda">

<a id="_IsHomImageOf_"></a><a id="43774" href="Demos.HSP.html#43774" class="Function Operator">_IsHomImageOf_</a> <a id="43789" class="Symbol">:</a> <a id="43791" class="Symbol">(</a><a id="43792" href="Demos.HSP.html#43792" class="Bound">ğ‘©</a> <a id="43794" class="Symbol">:</a> <a id="43796" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="43804" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="43806" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="43808" class="Symbol">)(</a><a id="43810" href="Demos.HSP.html#43810" class="Bound">ğ‘¨</a> <a id="43812" class="Symbol">:</a> <a id="43814" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="43822" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="43824" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="43826" class="Symbol">)</a> <a id="43828" class="Symbol">â†’</a> <a id="43830" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="43835" class="Symbol">_</a>
<a id="43837" href="Demos.HSP.html#43837" class="Bound">ğ‘©</a> <a id="43839" href="Demos.HSP.html#43774" class="Function Operator">IsHomImageOf</a> <a id="43852" href="Demos.HSP.html#43852" class="Bound">ğ‘¨</a> <a id="43854" class="Symbol">=</a> <a id="43856" href="Data.Product.html#916" class="Function">Î£[</a> <a id="43859" href="Demos.HSP.html#43859" class="Bound">Ï†</a> <a id="43861" href="Data.Product.html#916" class="Function">âˆˆ</a> <a id="43863" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="43867" href="Demos.HSP.html#43852" class="Bound">ğ‘¨</a> <a id="43869" href="Demos.HSP.html#43837" class="Bound">ğ‘©</a> <a id="43871" href="Data.Product.html#916" class="Function">]</a> <a id="43873" href="Demos.HSP.html#15620" class="Function">IsSurjective</a> <a id="43886" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="43888" href="Demos.HSP.html#43859" class="Bound">Ï†</a> <a id="43890" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>

<a id="IdHomImage"></a><a id="43893" href="Demos.HSP.html#43893" class="Function">IdHomImage</a> <a id="43904" class="Symbol">:</a> <a id="43906" class="Symbol">{</a><a id="43907" href="Demos.HSP.html#43907" class="Bound">ğ‘¨</a> <a id="43909" class="Symbol">:</a> <a id="43911" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="43919" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="43921" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="43923" class="Symbol">}</a> <a id="43925" class="Symbol">â†’</a> <a id="43927" href="Demos.HSP.html#43907" class="Bound">ğ‘¨</a> <a id="43929" href="Demos.HSP.html#43774" class="Function Operator">IsHomImageOf</a> <a id="43942" href="Demos.HSP.html#43907" class="Bound">ğ‘¨</a>
<a id="43944" href="Demos.HSP.html#43893" class="Function">IdHomImage</a> <a id="43955" class="Symbol">{</a><a id="43956" class="Argument">Î±</a> <a id="43958" class="Symbol">=</a> <a id="43960" href="Demos.HSP.html#43960" class="Bound">Î±</a><a id="43961" class="Symbol">}{</a><a id="43963" class="Argument">ğ‘¨</a> <a id="43965" class="Symbol">=</a> <a id="43967" href="Demos.HSP.html#43967" class="Bound">ğ‘¨</a><a id="43968" class="Symbol">}</a> <a id="43970" class="Symbol">=</a> <a id="43972" href="Demos.HSP.html#37764" class="Function">ğ’¾ğ’¹</a> <a id="43975" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="43977" class="Symbol">Î»</a> <a id="43979" class="Symbol">{</a><a id="43980" href="Demos.HSP.html#43980" class="Bound">y</a><a id="43981" class="Symbol">}</a> <a id="43983" class="Symbol">â†’</a> <a id="43985" href="Demos.HSP.html#13459" class="InductiveConstructor">Image_âˆ‹_.eq</a> <a id="43997" href="Demos.HSP.html#43980" class="Bound">y</a> <a id="43999" href="Relation.Binary.Structures.html#1568" class="Function">refl</a>
 <a id="44005" class="Keyword">where</a> <a id="44011" class="Keyword">open</a> <a id="44016" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="44023" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="44026" href="Demos.HSP.html#43967" class="Bound">ğ‘¨</a> <a id="44028" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="44030" class="Keyword">using</a> <a id="44036" class="Symbol">(</a> <a id="44038" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="44043" class="Symbol">)</a>
</pre>
%\noindent These types should be self-explanatory, but just to be sure, we pause
%to describe the semantics of the Sigma type appearing in the definition of \af{HomImages}.
%If \ab{ğ‘¨} : \af{Algebra} \ab{Î±} \ab{Ïáµƒ} is an \ab{ğ‘†}-algebra, then \af{HomImages} \ab{ğ‘¨}
%denotes the type of pairs (\ab{ğ‘©} \aic{,} \ab p) such that \ab{ğ‘©} : \ar{Algebra} \ab{Î²} \ab{Ïáµ‡}
%and \ab p is a proof that there exists a hom from \ab{ğ‘¨} onto \ab{ğ‘©}.

%% -----------------------------------------------------------------------------
\paragraph*{Factorization of homomorphisms}
Another theorem in the \agdaalgebras library, called \af{HomFactor}, formalizes the following factorization result: if \ab g : \af{hom}
\ab{ğ‘¨} \ab{ğ‘©}, \ab h : \af{hom} \ab{ğ‘¨} \ab{ğ‘ª}, \ab h is surjective, and \af{ker} \ab h
\aof{âŠ†} \af{ker} \ab g, then there exists \ab{Ï†} : \af{hom} \ab{ğ‘ª} \ab{ğ‘©} such that \ab g = \ab{Ï†} \aof{âˆ˜} \ab h.
A special case of this result that we use below is the fact that the setoid function factorization we saw above %---\ab f = %: \ab A \aor{âŸ¶} \ab B factors as a surjective map
%\ab{fromIm} \aof{âˆ˜} \ab{toIm}---% : \ab A \aor{âŸ¶} \ab{Im} \ab f followed by an injective map \ab{fromIm} : \ab{Im} \ab f \aor{âŸ¶} \ab B.
lifts to factorization of homomorphisms. Moreover, we associate a homomorphism \ab h with its image---which is (the domain of) a subalgebra of the codomain of \ab h---using the function \ab{HomIm} defined below.\footnote{The definition of \ab{HomIm} was provided by an anonymous referee; it is indeed simpler than the general \af{HomFactor} theorem.}

<pre class="Agda">

<a id="45628" class="Keyword">module</a> <a id="45635" href="Demos.HSP.html#45635" class="Module">_</a> <a id="45637" class="Symbol">{</a><a id="45638" href="Demos.HSP.html#45638" class="Bound">ğ‘¨</a> <a id="45640" class="Symbol">:</a> <a id="45642" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="45650" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="45652" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="45654" class="Symbol">}{</a><a id="45656" href="Demos.HSP.html#45656" class="Bound">ğ‘©</a> <a id="45658" class="Symbol">:</a> <a id="45660" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="45668" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="45670" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="45672" class="Symbol">}</a> <a id="45674" class="Keyword">where</a>

 <a id="45682" href="Demos.HSP.html#45682" class="Function">HomIm</a> <a id="45688" class="Symbol">:</a> <a id="45690" class="Symbol">(</a><a id="45691" href="Demos.HSP.html#45691" class="Bound">h</a> <a id="45693" class="Symbol">:</a> <a id="45695" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="45699" href="Demos.HSP.html#45638" class="Bound">ğ‘¨</a> <a id="45701" href="Demos.HSP.html#45656" class="Bound">ğ‘©</a><a id="45702" class="Symbol">)</a> <a id="45704" class="Symbol">â†’</a> <a id="45706" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="45714" class="Symbol">_</a> <a id="45716" class="Symbol">_</a>
 <a id="45719" href="Demos.HSP.html#24623" class="Field">Domain</a> <a id="45726" class="Symbol">(</a><a id="45727" href="Demos.HSP.html#45682" class="Function">HomIm</a> <a id="45733" href="Demos.HSP.html#45733" class="Bound">h</a><a id="45734" class="Symbol">)</a> <a id="45736" class="Symbol">=</a> <a id="45738" href="Demos.HSP.html#17043" class="Function">Im</a> <a id="45741" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="45743" href="Demos.HSP.html#45733" class="Bound">h</a> <a id="45745" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>
 <a id="45748" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="45755" class="Symbol">(</a><a id="45756" href="Demos.HSP.html#45682" class="Function">HomIm</a> <a id="45762" href="Demos.HSP.html#45762" class="Bound">h</a><a id="45763" class="Symbol">)</a> <a id="45765" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="45769" class="Symbol">(</a><a id="45770" href="Demos.HSP.html#45770" class="Bound">f</a> <a id="45772" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="45774" href="Demos.HSP.html#45774" class="Bound">la</a><a id="45776" class="Symbol">)</a> <a id="45778" class="Symbol">=</a> <a id="45780" class="Symbol">(</a><a id="45781" href="Demos.HSP.html#45770" class="Bound">f</a> <a id="45783" href="Demos.HSP.html#25610" class="Function Operator">Ì‚</a> <a id="45785" href="Demos.HSP.html#45638" class="Bound">ğ‘¨</a><a id="45786" class="Symbol">)</a> <a id="45788" href="Demos.HSP.html#45774" class="Bound">la</a>
 <a id="45792" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="45797" class="Symbol">(</a><a id="45798" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="45805" class="Symbol">(</a><a id="45806" href="Demos.HSP.html#45682" class="Function">HomIm</a> <a id="45812" href="Demos.HSP.html#45812" class="Bound">h</a><a id="45813" class="Symbol">))</a> <a id="45816" class="Symbol">{</a><a id="45817" href="Demos.HSP.html#45817" class="Bound">x1</a> <a id="45820" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="45822" href="Demos.HSP.html#45822" class="Bound">x2</a><a id="45824" class="Symbol">}</a> <a id="45826" class="Symbol">{</a><a id="45827" class="DottedPattern Symbol">.</a><a id="45828" href="Demos.HSP.html#45817" class="DottedPattern Bound">x1</a> <a id="45831" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="45833" href="Demos.HSP.html#45833" class="Bound">y2</a><a id="45835" class="Symbol">}</a> <a id="45837" class="Symbol">(</a><a id="45838" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="45845" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="45847" href="Demos.HSP.html#45847" class="Bound">e</a><a id="45848" class="Symbol">)</a> <a id="45850" class="Symbol">=</a>
  <a id="45854" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>
      <a id="45866" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="45868" href="Demos.HSP.html#45812" class="Bound">h</a> <a id="45870" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>  <a id="45873" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a>         <a id="45885" class="Symbol">(</a><a id="45886" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="45893" href="Demos.HSP.html#45638" class="Bound">ğ‘¨</a>  <a id="45896" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="45900" class="Symbol">(</a><a id="45901" href="Demos.HSP.html#45817" class="Bound">x1</a> <a id="45904" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="45906" href="Demos.HSP.html#45822" class="Bound">x2</a><a id="45908" class="Symbol">))</a>  <a id="45912" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a> <a id="45915" href="Demos.HSP.html#46285" class="Function">h-compatible</a>                  <a id="45945" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
   <a id="45950" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="45957" href="Demos.HSP.html#45656" class="Bound">ğ‘©</a>  <a id="45960" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="45964" class="Symbol">(</a><a id="45965" href="Demos.HSP.html#45817" class="Bound">x1</a> <a id="45968" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="45970" class="Symbol">Î»</a> <a id="45972" href="Demos.HSP.html#45972" class="Bound">x</a> <a id="45974" class="Symbol">â†’</a> <a id="45976" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="45978" href="Demos.HSP.html#45812" class="Bound">h</a> <a id="45980" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>  <a id="45983" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="45987" href="Demos.HSP.html#45822" class="Bound">x2</a> <a id="45990" href="Demos.HSP.html#45972" class="Bound">x</a><a id="45991" class="Symbol">)</a>       <a id="45999" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a> <a id="46002" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="46007" class="Symbol">(</a><a id="46008" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="46015" href="Demos.HSP.html#45656" class="Bound">ğ‘©</a><a id="46016" class="Symbol">)</a> <a id="46018" class="Symbol">(</a><a id="46019" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="46026" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="46028" href="Demos.HSP.html#45847" class="Bound">e</a><a id="46029" class="Symbol">)</a>  <a id="46032" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
   <a id="46037" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="46044" href="Demos.HSP.html#45656" class="Bound">ğ‘©</a>  <a id="46047" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="46051" class="Symbol">(</a><a id="46052" href="Demos.HSP.html#45817" class="Bound">x1</a> <a id="46055" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="46057" class="Symbol">Î»</a> <a id="46059" href="Demos.HSP.html#46059" class="Bound">x</a> <a id="46061" class="Symbol">â†’</a> <a id="46063" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="46065" href="Demos.HSP.html#45812" class="Bound">h</a> <a id="46067" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>  <a id="46070" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="46074" href="Demos.HSP.html#45833" class="Bound">y2</a> <a id="46077" href="Demos.HSP.html#46059" class="Bound">x</a><a id="46078" class="Symbol">)</a>       <a id="46086" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">â‰ˆË˜âŸ¨</a> <a id="46090" href="Demos.HSP.html#46285" class="Function">h-compatible</a>                 <a id="46119" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">âŸ©</a>
      <a id="46127" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="46129" href="Demos.HSP.html#45812" class="Bound">h</a> <a id="46131" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>  <a id="46134" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a>         <a id="46146" class="Symbol">(</a><a id="46147" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="46154" href="Demos.HSP.html#45638" class="Bound">ğ‘¨</a>  <a id="46157" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="46161" class="Symbol">(</a><a id="46162" href="Demos.HSP.html#45817" class="Bound">x1</a> <a id="46165" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="46167" href="Demos.HSP.html#45833" class="Bound">y2</a><a id="46169" class="Symbol">))</a>  <a id="46173" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">âˆ</a>
   <a id="46178" class="Keyword">where</a>  <a id="46185" class="Keyword">open</a> <a id="46190" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="46197" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="46200" href="Demos.HSP.html#45656" class="Bound">ğ‘©</a> <a id="46202" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="46204" class="Symbol">;</a> <a id="46206" class="Keyword">open</a> <a id="46211" href="Relation.Binary.Reasoning.Setoid.html" class="Module">SetoidReasoning</a> <a id="46227" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="46230" href="Demos.HSP.html#45656" class="Bound">ğ‘©</a> <a id="46232" href="Demos.HSP.html#25499" class="Function Operator">]</a>
          <a id="46244" class="Keyword">open</a> <a id="46249" href="Demos.HSP.html#34414" class="Module">IsHom</a> <a id="46255" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="46257" href="Demos.HSP.html#45812" class="Bound">h</a> <a id="46259" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="46261" class="Keyword">renaming</a> <a id="46270" class="Symbol">(</a><a id="46271" href="Demos.HSP.html#34508" class="Field">compatible</a> <a id="46282" class="Symbol">to</a> <a id="46285" class="Field">h-compatible</a><a id="46297" class="Symbol">)</a>

 <a id="46301" href="Demos.HSP.html#46301" class="Function">toHomIm</a> <a id="46309" class="Symbol">:</a> <a id="46311" class="Symbol">(</a><a id="46312" href="Demos.HSP.html#46312" class="Bound">h</a> <a id="46314" class="Symbol">:</a> <a id="46316" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="46320" href="Demos.HSP.html#45638" class="Bound">ğ‘¨</a> <a id="46322" href="Demos.HSP.html#45656" class="Bound">ğ‘©</a><a id="46323" class="Symbol">)</a> <a id="46325" class="Symbol">â†’</a> <a id="46327" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="46331" href="Demos.HSP.html#45638" class="Bound">ğ‘¨</a> <a id="46333" class="Symbol">(</a><a id="46334" href="Demos.HSP.html#45682" class="Function">HomIm</a> <a id="46340" href="Demos.HSP.html#46312" class="Bound">h</a><a id="46341" class="Symbol">)</a>
 <a id="46344" href="Demos.HSP.html#46301" class="Function">toHomIm</a> <a id="46352" href="Demos.HSP.html#46352" class="Bound">h</a> <a id="46354" class="Symbol">=</a> <a id="46356" href="Demos.HSP.html#17261" class="Function">toIm</a> <a id="46361" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="46363" href="Demos.HSP.html#46352" class="Bound">h</a> <a id="46365" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="46367" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="46369" href="Demos.HSP.html#34487" class="InductiveConstructor">mkhom</a> <a id="46375" class="Symbol">(</a><a id="46376" href="Demos.HSP.html#8932" class="Function">reflË¢</a> <a id="46382" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="46385" href="Demos.HSP.html#45656" class="Bound">ğ‘©</a> <a id="46387" href="Demos.HSP.html#25499" class="Function Operator">]</a><a id="46388" class="Symbol">)</a>

 <a id="46392" href="Demos.HSP.html#46392" class="Function">fromHomIm</a> <a id="46402" class="Symbol">:</a> <a id="46404" class="Symbol">(</a><a id="46405" href="Demos.HSP.html#46405" class="Bound">h</a> <a id="46407" class="Symbol">:</a> <a id="46409" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="46413" href="Demos.HSP.html#45638" class="Bound">ğ‘¨</a> <a id="46415" href="Demos.HSP.html#45656" class="Bound">ğ‘©</a><a id="46416" class="Symbol">)</a> <a id="46418" class="Symbol">â†’</a> <a id="46420" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="46424" class="Symbol">(</a><a id="46425" href="Demos.HSP.html#45682" class="Function">HomIm</a> <a id="46431" href="Demos.HSP.html#46405" class="Bound">h</a><a id="46432" class="Symbol">)</a> <a id="46434" href="Demos.HSP.html#45656" class="Bound">ğ‘©</a>
 <a id="46437" href="Demos.HSP.html#46392" class="Function">fromHomIm</a> <a id="46447" href="Demos.HSP.html#46447" class="Bound">h</a> <a id="46449" class="Symbol">=</a> <a id="46451" href="Demos.HSP.html#17337" class="Function">fromIm</a> <a id="46458" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="46460" href="Demos.HSP.html#46447" class="Bound">h</a> <a id="46462" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="46464" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="46466" href="Demos.HSP.html#34487" class="InductiveConstructor">mkhom</a> <a id="46472" class="Symbol">(</a><a id="46473" href="Demos.HSP.html#34508" class="Field">IsHom.compatible</a> <a id="46490" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="46492" href="Demos.HSP.html#46447" class="Bound">h</a> <a id="46494" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a><a id="46495" class="Symbol">)</a>
</pre>



%% -----------------------------------------------------------------------------
\subsection{Lift-Alg is an algebraic invariant}\label{sec:lift-alg}
The \af{Lift-Alg} operation neatly resolves the technical problem of
universe non-cumulativity because isomorphism classes of algebras are closed under \af{Lift-Alg}.

<pre class="Agda">

<a id="46842" class="Keyword">module</a> <a id="46849" href="Demos.HSP.html#46849" class="Module">_</a> <a id="46851" class="Symbol">{</a><a id="46852" href="Demos.HSP.html#46852" class="Bound">ğ‘¨</a> <a id="46854" class="Symbol">:</a> <a id="46856" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="46864" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="46866" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="46868" class="Symbol">}{</a><a id="46870" href="Demos.HSP.html#46870" class="Bound">â„“</a> <a id="46872" class="Symbol">:</a> <a id="46874" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="46879" class="Symbol">}</a> <a id="46881" class="Keyword">where</a>
 <a id="46888" href="Demos.HSP.html#46888" class="Function">Lift-â‰…Ë¡</a> <a id="46896" class="Symbol">:</a> <a id="46898" href="Demos.HSP.html#46852" class="Bound">ğ‘¨</a> <a id="46900" href="Demos.HSP.html#41313" class="Record Operator">â‰…</a> <a id="46902" class="Symbol">(</a><a id="46903" href="Demos.HSP.html#28541" class="Function">Lift-AlgË¡</a> <a id="46913" href="Demos.HSP.html#46852" class="Bound">ğ‘¨</a> <a id="46915" href="Demos.HSP.html#46870" class="Bound">â„“</a><a id="46916" class="Symbol">)</a>
 <a id="46919" href="Demos.HSP.html#46888" class="Function">Lift-â‰…Ë¡</a> <a id="46927" class="Symbol">=</a> <a id="46929" href="Demos.HSP.html#41372" class="InductiveConstructor">mkiso</a> <a id="46935" href="Demos.HSP.html#38235" class="Function">ToLiftË¡</a> <a id="46943" href="Demos.HSP.html#38339" class="Function">FromLiftË¡</a> <a id="46953" class="Symbol">(</a><a id="46954" href="Demos.HSP.html#38435" class="Function">ToFromLiftË¡</a><a id="46965" class="Symbol">{</a><a id="46966" class="Argument">ğ‘¨</a> <a id="46968" class="Symbol">=</a> <a id="46970" href="Demos.HSP.html#46852" class="Bound">ğ‘¨</a><a id="46971" class="Symbol">})</a> <a id="46974" class="Symbol">(</a><a id="46975" href="Demos.HSP.html#38524" class="Function">FromToLiftË¡</a><a id="46986" class="Symbol">{</a><a id="46987" class="Argument">ğ‘¨</a> <a id="46989" class="Symbol">=</a> <a id="46991" href="Demos.HSP.html#46852" class="Bound">ğ‘¨</a><a id="46992" class="Symbol">}{</a><a id="46994" href="Demos.HSP.html#46870" class="Bound">â„“</a><a id="46995" class="Symbol">})</a>
 <a id="46999" href="Demos.HSP.html#46999" class="Function">Lift-â‰…Ê³</a> <a id="47007" class="Symbol">:</a> <a id="47009" href="Demos.HSP.html#46852" class="Bound">ğ‘¨</a> <a id="47011" href="Demos.HSP.html#41313" class="Record Operator">â‰…</a> <a id="47013" class="Symbol">(</a><a id="47014" href="Demos.HSP.html#28936" class="Function">Lift-AlgÊ³</a> <a id="47024" href="Demos.HSP.html#46852" class="Bound">ğ‘¨</a> <a id="47026" href="Demos.HSP.html#46870" class="Bound">â„“</a><a id="47027" class="Symbol">)</a>
 <a id="47030" href="Demos.HSP.html#46999" class="Function">Lift-â‰…Ê³</a> <a id="47038" class="Symbol">=</a> <a id="47040" href="Demos.HSP.html#41372" class="InductiveConstructor">mkiso</a> <a id="47046" href="Demos.HSP.html#38612" class="Function">ToLiftÊ³</a> <a id="47054" href="Demos.HSP.html#38723" class="Function">FromLiftÊ³</a> <a id="47064" class="Symbol">(</a><a id="47065" href="Demos.HSP.html#38819" class="Function">ToFromLiftÊ³</a><a id="47076" class="Symbol">{</a><a id="47077" class="Argument">ğ‘¨</a> <a id="47079" class="Symbol">=</a> <a id="47081" href="Demos.HSP.html#46852" class="Bound">ğ‘¨</a><a id="47082" class="Symbol">})</a> <a id="47085" class="Symbol">(</a><a id="47086" href="Demos.HSP.html#38912" class="Function">FromToLiftÊ³</a><a id="47097" class="Symbol">{</a><a id="47098" class="Argument">ğ‘¨</a> <a id="47100" class="Symbol">=</a> <a id="47102" href="Demos.HSP.html#46852" class="Bound">ğ‘¨</a><a id="47103" class="Symbol">}{</a><a id="47105" href="Demos.HSP.html#46870" class="Bound">â„“</a><a id="47106" class="Symbol">})</a>

<a id="Lift-â‰…"></a><a id="47110" href="Demos.HSP.html#47110" class="Function">Lift-â‰…</a> <a id="47117" class="Symbol">:</a> <a id="47119" class="Symbol">{</a><a id="47120" href="Demos.HSP.html#47120" class="Bound">ğ‘¨</a> <a id="47122" class="Symbol">:</a> <a id="47124" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="47132" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="47134" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="47136" class="Symbol">}{</a><a id="47138" href="Demos.HSP.html#47138" class="Bound">â„“</a> <a id="47140" href="Demos.HSP.html#47140" class="Bound">Ï</a> <a id="47142" class="Symbol">:</a> <a id="47144" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="47149" class="Symbol">}</a> <a id="47151" class="Symbol">â†’</a> <a id="47153" href="Demos.HSP.html#47120" class="Bound">ğ‘¨</a> <a id="47155" href="Demos.HSP.html#41313" class="Record Operator">â‰…</a> <a id="47157" class="Symbol">(</a><a id="47158" href="Demos.HSP.html#29482" class="Function">Lift-Alg</a> <a id="47167" href="Demos.HSP.html#47120" class="Bound">ğ‘¨</a> <a id="47169" href="Demos.HSP.html#47138" class="Bound">â„“</a> <a id="47171" href="Demos.HSP.html#47140" class="Bound">Ï</a><a id="47172" class="Symbol">)</a>
<a id="47174" href="Demos.HSP.html#47110" class="Function">Lift-â‰…</a> <a id="47181" class="Symbol">=</a> <a id="47183" href="Demos.HSP.html#42569" class="Function">â‰…-trans</a> <a id="47191" href="Demos.HSP.html#46888" class="Function">Lift-â‰…Ë¡</a> <a id="47199" href="Demos.HSP.html#46999" class="Function">Lift-â‰…Ê³</a>
</pre>
%% -------------------------------------------------------------------------------------
\subsection{Subalgebras}
\label{subalgebras}
%Given \ab{ğ‘†}-algebras \ab{ğ‘¨} and \ab{ğ‘©},
We say that \ab{ğ‘¨} is a \defn{subalgebra} of
\ab{ğ‘©} and write \ab{ğ‘¨}~\aof{â‰¤}~\ab{ğ‘©} just in case \ab{ğ‘¨} can be \emph{homomorphically
embedded} in \ab{ğ‘©}; in other terms, \ab{ğ‘¨}~\aof{â‰¤}~\ab{ğ‘©} iff there exists an injective
hom from \ab{ğ‘¨} to \ab{ğ‘©}.

<pre class="Agda">

<a id="_â‰¤_"></a><a id="47658" href="Demos.HSP.html#47658" class="Function Operator">_â‰¤_</a> <a id="47662" class="Symbol">:</a> <a id="47664" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="47672" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="47674" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="47677" class="Symbol">â†’</a> <a id="47679" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="47687" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="47689" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a> <a id="47692" class="Symbol">â†’</a> <a id="47694" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="47699" class="Symbol">_</a>
<a id="47701" href="Demos.HSP.html#47701" class="Bound">ğ‘¨</a> <a id="47703" href="Demos.HSP.html#47658" class="Function Operator">â‰¤</a> <a id="47705" href="Demos.HSP.html#47705" class="Bound">ğ‘©</a> <a id="47707" class="Symbol">=</a> <a id="47709" href="Data.Product.html#916" class="Function">Î£[</a> <a id="47712" href="Demos.HSP.html#47712" class="Bound">h</a> <a id="47714" href="Data.Product.html#916" class="Function">âˆˆ</a> <a id="47716" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="47720" href="Demos.HSP.html#47701" class="Bound">ğ‘¨</a> <a id="47722" href="Demos.HSP.html#47705" class="Bound">ğ‘©</a> <a id="47724" href="Data.Product.html#916" class="Function">]</a> <a id="47726" href="Demos.HSP.html#15537" class="Function">IsInjective</a> <a id="47738" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="47740" href="Demos.HSP.html#47712" class="Bound">h</a> <a id="47742" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>

</pre>
The subalgebra relation is reflexive, by the identity monomorphism (and transitive by composition of monomorphisms, hence, a \defn{preorder}, though we won't need this fact here).

<pre class="Agda">

<a id="â‰¤-reflexive"></a><a id="47951" href="Demos.HSP.html#47951" class="Function">â‰¤-reflexive</a>   <a id="47965" class="Symbol">:</a>  <a id="47968" class="Symbol">{</a><a id="47969" href="Demos.HSP.html#47969" class="Bound">ğ‘¨</a> <a id="47971" class="Symbol">:</a> <a id="47973" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="47981" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="47983" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="47985" class="Symbol">}</a> <a id="47987" class="Symbol">â†’</a> <a id="47989" href="Demos.HSP.html#47969" class="Bound">ğ‘¨</a> <a id="47991" href="Demos.HSP.html#47658" class="Function Operator">â‰¤</a> <a id="47993" href="Demos.HSP.html#47969" class="Bound">ğ‘¨</a>
<a id="47995" href="Demos.HSP.html#47951" class="Function">â‰¤-reflexive</a> <a id="48007" class="Symbol">=</a> <a id="48009" href="Demos.HSP.html#37764" class="Function">ğ’¾ğ’¹</a> <a id="48012" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="48014" href="Function.Base.html#615" class="Function">id</a>

</pre>
%â‰¤-transitive  :  {ğ‘¨ : Algebra Î± Ïáµƒ}{ğ‘© : Algebra Î² Ïáµ‡}{ğ‘ª : Algebra Î³ Ïá¶œ} â†’ ğ‘¨ â‰¤ ğ‘© â†’ ğ‘© â‰¤ ğ‘ª â†’ ğ‘¨ â‰¤ ğ‘ª
%â‰¤-transitive ( f , finj ) ( g , ginj ) = (âˆ˜-hom f g ) , âˆ˜-IsInjective âˆ£ f âˆ£ âˆ£ g âˆ£ finj ginj
If
\ab{ğ’œ} : \ab I â†’ \af{Algebra} \ab{Î±} \ab{Ïáµƒ},
\ab{â„¬} : \ab I â†’ \af{Algebra} \ab{Î²} \ab{Ïáµ‡} (families of \ab{ğ‘†}-algebras) and if
\ab{â„¬} \ab i \af{â‰¤} \ab{ğ’œ} \ab i for all \ab i~:~\ab I, then \af{â¨…} \ab{â„¬} is a subalgebra
of \af{â¨…} \ab{ğ’œ}. Below we will use \af{â¨…-â‰¤} to denote this fact.

We conclude this section with an easy fact that will be useful later;
it simply converts a monomorphism into a proof of a subalgebra relationship.
%The first converts a monomorphism to a subalgebra witness while the second is an algebraic invariance property of \aof{â‰¤}.

<pre class="Agda">

<a id="monâ†’â‰¤"></a><a id="48794" href="Demos.HSP.html#48794" class="Function">monâ†’â‰¤</a> <a id="48800" class="Symbol">:</a> <a id="48802" class="Symbol">{</a><a id="48803" href="Demos.HSP.html#48803" class="Bound">ğ‘¨</a> <a id="48805" class="Symbol">:</a> <a id="48807" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="48815" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="48817" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="48819" class="Symbol">}{</a><a id="48821" href="Demos.HSP.html#48821" class="Bound">ğ‘©</a> <a id="48823" class="Symbol">:</a> <a id="48825" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="48833" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="48835" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="48837" class="Symbol">}</a> <a id="48839" class="Symbol">â†’</a> <a id="48841" href="Demos.HSP.html#35230" class="Function">mon</a> <a id="48845" href="Demos.HSP.html#48803" class="Bound">ğ‘¨</a> <a id="48847" href="Demos.HSP.html#48821" class="Bound">ğ‘©</a> <a id="48849" class="Symbol">â†’</a> <a id="48851" href="Demos.HSP.html#48803" class="Bound">ğ‘¨</a> <a id="48853" href="Demos.HSP.html#47658" class="Function Operator">â‰¤</a> <a id="48855" href="Demos.HSP.html#48821" class="Bound">ğ‘©</a>
<a id="48857" href="Demos.HSP.html#48794" class="Function">monâ†’â‰¤</a> <a id="48863" class="Symbol">{</a><a id="48864" class="Argument">ğ‘¨</a> <a id="48866" class="Symbol">=</a> <a id="48868" href="Demos.HSP.html#48868" class="Bound">ğ‘¨</a><a id="48869" class="Symbol">}{</a><a id="48871" href="Demos.HSP.html#48871" class="Bound">ğ‘©</a><a id="48872" class="Symbol">}</a> <a id="48874" href="Demos.HSP.html#48874" class="Bound">x</a> <a id="48876" class="Symbol">=</a> <a id="48878" href="Demos.HSP.html#35922" class="Function">monâ†’intohom</a> <a id="48890" href="Demos.HSP.html#48868" class="Bound">ğ‘¨</a> <a id="48892" href="Demos.HSP.html#48871" class="Bound">ğ‘©</a> <a id="48894" href="Demos.HSP.html#48874" class="Bound">x</a>
</pre>
%â‰…-trans-â‰¤ :  {ğ‘¨ : Algebra Î± Ïáµƒ}{ğ‘© : Algebra Î² Ïáµ‡}{ğ‘ª : Algebra Î³ Ïá¶œ} â†’ ğ‘¨ â‰… ğ‘© â†’ ğ‘© â‰¤ ğ‘ª â†’ ğ‘¨ â‰¤ ğ‘ª
%â‰…-trans-â‰¤ Aâ‰…B (h , hinj) = (âˆ˜-hom (to Aâ‰…B) h) , (âˆ˜-IsInjective âˆ£ to Aâ‰…B âˆ£ âˆ£ h âˆ£ (toIsInjective Aâ‰…B) hinj)


%% -------------------------------------------------------------------------------------

\subsection{Terms}
\label{terms}
Fix a signature \ab{ğ‘†} and let \ab X denote an arbitrary nonempty collection of variable
symbols. Such a collection is called a \defn{context}.
Assume the symbols in \ab X are distinct from the operation symbols of
\ab{ğ‘†}, that is \ab X \aof{âˆ©} \aof{âˆ£} \ab{ğ‘†} \aof{âˆ£} = âˆ….
A \defn{word} in the language of \ab{ğ‘†} is a finite sequence of members of \ab X \aof{âˆª}
\aof{âˆ£~\ab{ğ‘†}~âˆ£}. We denote the concatenation of such sequences by simple juxtaposition.
Let \ab{Sâ‚€} denote the set of nullary operation symbols of \ab{ğ‘†}. We define by induction
on \textit{n} the sets \ab{ğ‘‡â‚™} of \emph{words} over \ab X \aof{âˆª} \aof{âˆ£~\ab{ğ‘†}~âˆ£} as
follows: %(cf.~\cite[Def. 4.19]{Bergman:2012}):
\ab{ğ‘‡â‚€} := \ab X \aof{âˆª} \ab{Sâ‚€} and
\ab{ğ‘‡â‚™â‚Šâ‚} := \ab{ğ‘‡â‚™} \aof{âˆª} \ab{ğ’¯â‚™}, where \ab{ğ’¯â‚™} is the collection of all \ab f \ab t
such that \ab f : \aof{âˆ£~\ab{ğ‘†}~âˆ£} and \ab t : \aof{âˆ¥~\ab{ğ‘†}~âˆ¥} \ab f \as{â†’}
\ab{ğ‘‡â‚™}.
\ifshort\else
(Recall, \aof{âˆ¥~\ab{ğ‘†}~âˆ¥} \ab f is the arity of the operation symbol \ab f.)
\fi
An \ab{ğ‘†}-\defn{term} is a term in the language of \ab{ğ‘†} and the collection of all
\ab{ğ‘†}-\defn{terms} in the context \ab X is \Term{X} := \aof{â‹ƒâ‚™} \ab{ğ‘‡â‚™}.

In type theory, this translates to two cases: variable injection and applying an
operation symbol to a tuple of terms. This represents each term as a tree
with an operation symbol at each \aic{node} and a variable symbol at each leaf \aic{â„Š};
hence the constructor names (\aic{â„Š} for ``generator'' and \aic{node} for ``node'') in the
following inductively defined type.

<pre class="Agda">

<a id="50758" class="Keyword">data</a> <a id="Term"></a><a id="50763" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="50768" class="Symbol">(</a><a id="50769" href="Demos.HSP.html#50769" class="Bound">X</a> <a id="50771" class="Symbol">:</a> <a id="50773" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="50778" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="50779" class="Symbol">)</a> <a id="50781" class="Symbol">:</a> <a id="50783" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="50788" class="Symbol">(</a><a id="50789" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="50792" href="Demos.HSP.html#50778" class="Bound">Ï‡</a><a id="50793" class="Symbol">)</a>  <a id="50796" class="Keyword">where</a>
 <a id="Term.â„Š"></a><a id="50803" href="Demos.HSP.html#50803" class="InductiveConstructor">â„Š</a> <a id="50805" class="Symbol">:</a> <a id="50807" href="Demos.HSP.html#50769" class="Bound">X</a> <a id="50809" class="Symbol">â†’</a> <a id="50811" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="50816" href="Demos.HSP.html#50769" class="Bound">X</a>
 <a id="Term.node"></a><a id="50819" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="50824" class="Symbol">:</a> <a id="50826" class="Symbol">(</a><a id="50827" href="Demos.HSP.html#50827" class="Bound">f</a> <a id="50829" class="Symbol">:</a> <a id="50831" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="50833" href="Demos.HSP.html#7243" class="Bound">ğ‘†</a> <a id="50835" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a><a id="50836" class="Symbol">)(</a><a id="50838" href="Demos.HSP.html#50838" class="Bound">t</a> <a id="50840" class="Symbol">:</a> <a id="50842" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="50844" href="Demos.HSP.html#7243" class="Bound">ğ‘†</a> <a id="50846" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="50848" href="Demos.HSP.html#50827" class="Bound">f</a> <a id="50850" class="Symbol">â†’</a> <a id="50852" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="50857" href="Demos.HSP.html#50769" class="Bound">X</a><a id="50858" class="Symbol">)</a> <a id="50860" class="Symbol">â†’</a> <a id="50862" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="50867" href="Demos.HSP.html#50769" class="Bound">X</a>
</pre>
%% -----------------------------------------------------------------------------
\paragraph*{The term algebra}
We enrich the \ad{Term} type to a setoid of  \ab{ğ‘†}-terms, which will ultimately
be the domain of an algebra, called the \emph{term algebra in the signature} \ab{ğ‘†}.
For this we need an equivalence relation on terms.

<pre class="Agda">

<a id="51223" class="Keyword">module</a> <a id="51230" href="Demos.HSP.html#51230" class="Module">_</a> <a id="51232" class="Symbol">{</a><a id="51233" href="Demos.HSP.html#51233" class="Bound">X</a> <a id="51235" class="Symbol">:</a> <a id="51237" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="51242" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a> <a id="51244" class="Symbol">}</a> <a id="51246" class="Keyword">where</a>

 <a id="51254" class="Keyword">data</a> <a id="51259" href="Demos.HSP.html#51259" class="Datatype Operator">_â‰ƒ_</a> <a id="51263" class="Symbol">:</a> <a id="51265" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="51270" href="Demos.HSP.html#51233" class="Bound">X</a> <a id="51272" class="Symbol">â†’</a> <a id="51274" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="51279" href="Demos.HSP.html#51233" class="Bound">X</a> <a id="51281" class="Symbol">â†’</a> <a id="51283" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="51288" class="Symbol">(</a><a id="51289" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="51292" href="Demos.HSP.html#51242" class="Bound">Ï‡</a><a id="51293" class="Symbol">)</a> <a id="51295" class="Keyword">where</a>
  <a id="51303" href="Demos.HSP.html#51303" class="InductiveConstructor">rfl</a> <a id="51307" class="Symbol">:</a> <a id="51309" class="Symbol">{</a><a id="51310" href="Demos.HSP.html#51310" class="Bound">x</a> <a id="51312" href="Demos.HSP.html#51312" class="Bound">y</a> <a id="51314" class="Symbol">:</a> <a id="51316" href="Demos.HSP.html#51233" class="Bound">X</a><a id="51317" class="Symbol">}</a> <a id="51319" class="Symbol">â†’</a> <a id="51321" href="Demos.HSP.html#51310" class="Bound">x</a> <a id="51323" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="51325" href="Demos.HSP.html#51312" class="Bound">y</a> <a id="51327" class="Symbol">â†’</a> <a id="51329" class="Symbol">(</a><a id="51330" href="Demos.HSP.html#50803" class="InductiveConstructor">â„Š</a> <a id="51332" href="Demos.HSP.html#51310" class="Bound">x</a><a id="51333" class="Symbol">)</a> <a id="51335" href="Demos.HSP.html#51259" class="Datatype Operator">â‰ƒ</a> <a id="51337" class="Symbol">(</a><a id="51338" href="Demos.HSP.html#50803" class="InductiveConstructor">â„Š</a> <a id="51340" href="Demos.HSP.html#51312" class="Bound">y</a><a id="51341" class="Symbol">)</a>
  <a id="51345" href="Demos.HSP.html#51345" class="InductiveConstructor">gnl</a> <a id="51349" class="Symbol">:</a> <a id="51351" class="Symbol">âˆ€</a> <a id="51353" class="Symbol">{</a><a id="51354" href="Demos.HSP.html#51354" class="Bound">f</a><a id="51355" class="Symbol">}{</a><a id="51357" href="Demos.HSP.html#51357" class="Bound">s</a> <a id="51359" href="Demos.HSP.html#51359" class="Bound">t</a> <a id="51361" class="Symbol">:</a> <a id="51363" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="51365" href="Demos.HSP.html#7243" class="Bound">ğ‘†</a> <a id="51367" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="51369" href="Demos.HSP.html#51354" class="Bound">f</a> <a id="51371" class="Symbol">â†’</a> <a id="51373" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="51378" href="Demos.HSP.html#51233" class="Bound">X</a><a id="51379" class="Symbol">}</a> <a id="51381" class="Symbol">â†’</a> <a id="51383" class="Symbol">(âˆ€</a> <a id="51386" href="Demos.HSP.html#51386" class="Bound">i</a> <a id="51388" class="Symbol">â†’</a> <a id="51390" class="Symbol">(</a><a id="51391" href="Demos.HSP.html#51357" class="Bound">s</a> <a id="51393" href="Demos.HSP.html#51386" class="Bound">i</a><a id="51394" class="Symbol">)</a> <a id="51396" href="Demos.HSP.html#51259" class="Datatype Operator">â‰ƒ</a> <a id="51398" class="Symbol">(</a><a id="51399" href="Demos.HSP.html#51359" class="Bound">t</a> <a id="51401" href="Demos.HSP.html#51386" class="Bound">i</a><a id="51402" class="Symbol">))</a> <a id="51405" class="Symbol">â†’</a> <a id="51407" class="Symbol">(</a><a id="51408" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="51413" href="Demos.HSP.html#51354" class="Bound">f</a> <a id="51415" href="Demos.HSP.html#51357" class="Bound">s</a><a id="51416" class="Symbol">)</a> <a id="51418" href="Demos.HSP.html#51259" class="Datatype Operator">â‰ƒ</a> <a id="51420" class="Symbol">(</a><a id="51421" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="51426" href="Demos.HSP.html#51354" class="Bound">f</a> <a id="51428" href="Demos.HSP.html#51359" class="Bound">t</a><a id="51429" class="Symbol">)</a>

</pre>
\ifshort
Below we denote by \af{â‰ƒ-isEquiv} the easy (omitted) proof that \ad{\au{}â‰ƒ\au{}} is an equivalence relation.
\else
It is easy to show that \ad{\au{}â‰ƒ\au{}} is an equivalence relation as follows.

<pre class="Agda">

 <a id="51663" href="Demos.HSP.html#51663" class="Function">â‰ƒ-isRefl</a>   <a id="51674" class="Symbol">:</a> <a id="51676" href="Relation.Binary.Definitions.html#1339" class="Function">Reflexive</a>      <a id="51691" href="Demos.HSP.html#51259" class="Datatype Operator">_â‰ƒ_</a>
 <a id="51696" href="Demos.HSP.html#51663" class="Function">â‰ƒ-isRefl</a> <a id="51705" class="Symbol">{</a><a id="51706" href="Demos.HSP.html#50803" class="InductiveConstructor">â„Š</a> <a id="51708" class="Symbol">_}</a> <a id="51711" class="Symbol">=</a> <a id="51713" href="Demos.HSP.html#51303" class="InductiveConstructor">rfl</a> <a id="51717" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a>
 <a id="51725" href="Demos.HSP.html#51663" class="Function">â‰ƒ-isRefl</a> <a id="51734" class="Symbol">{</a><a id="51735" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="51740" class="Symbol">_</a> <a id="51742" class="Symbol">_}</a> <a id="51745" class="Symbol">=</a> <a id="51747" href="Demos.HSP.html#51345" class="InductiveConstructor">gnl</a> <a id="51751" class="Symbol">Î»</a> <a id="51753" href="Demos.HSP.html#51753" class="Bound">_</a> <a id="51755" class="Symbol">â†’</a> <a id="51757" href="Demos.HSP.html#51663" class="Function">â‰ƒ-isRefl</a>

 <a id="51768" href="Demos.HSP.html#51768" class="Function">â‰ƒ-isSym</a>    <a id="51779" class="Symbol">:</a> <a id="51781" href="Relation.Binary.Definitions.html#1498" class="Function">Symmetric</a>      <a id="51796" href="Demos.HSP.html#51259" class="Datatype Operator">_â‰ƒ_</a>
 <a id="51801" href="Demos.HSP.html#51768" class="Function">â‰ƒ-isSym</a> <a id="51809" class="Symbol">(</a><a id="51810" href="Demos.HSP.html#51303" class="InductiveConstructor">rfl</a> <a id="51814" href="Demos.HSP.html#51814" class="Bound">x</a><a id="51815" class="Symbol">)</a> <a id="51817" class="Symbol">=</a> <a id="51819" href="Demos.HSP.html#51303" class="InductiveConstructor">rfl</a> <a id="51823" class="Symbol">(</a><a id="51824" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">â‰¡.sym</a> <a id="51830" href="Demos.HSP.html#51814" class="Bound">x</a><a id="51831" class="Symbol">)</a>
 <a id="51834" href="Demos.HSP.html#51768" class="Function">â‰ƒ-isSym</a> <a id="51842" class="Symbol">(</a><a id="51843" href="Demos.HSP.html#51345" class="InductiveConstructor">gnl</a> <a id="51847" href="Demos.HSP.html#51847" class="Bound">x</a><a id="51848" class="Symbol">)</a> <a id="51850" class="Symbol">=</a> <a id="51852" href="Demos.HSP.html#51345" class="InductiveConstructor">gnl</a> <a id="51856" class="Symbol">Î»</a> <a id="51858" href="Demos.HSP.html#51858" class="Bound">i</a> <a id="51860" class="Symbol">â†’</a> <a id="51862" href="Demos.HSP.html#51768" class="Function">â‰ƒ-isSym</a> <a id="51870" class="Symbol">(</a><a id="51871" href="Demos.HSP.html#51847" class="Bound">x</a> <a id="51873" href="Demos.HSP.html#51858" class="Bound">i</a><a id="51874" class="Symbol">)</a>

 <a id="51878" href="Demos.HSP.html#51878" class="Function">â‰ƒ-isTrans</a>  <a id="51889" class="Symbol">:</a> <a id="51891" href="Relation.Binary.Definitions.html#1978" class="Function">Transitive</a>     <a id="51906" href="Demos.HSP.html#51259" class="Datatype Operator">_â‰ƒ_</a>
 <a id="51911" href="Demos.HSP.html#51878" class="Function">â‰ƒ-isTrans</a> <a id="51921" class="Symbol">(</a><a id="51922" href="Demos.HSP.html#51303" class="InductiveConstructor">rfl</a> <a id="51926" href="Demos.HSP.html#51926" class="Bound">x</a><a id="51927" class="Symbol">)</a> <a id="51929" class="Symbol">(</a><a id="51930" href="Demos.HSP.html#51303" class="InductiveConstructor">rfl</a> <a id="51934" href="Demos.HSP.html#51934" class="Bound">y</a><a id="51935" class="Symbol">)</a> <a id="51937" class="Symbol">=</a> <a id="51939" href="Demos.HSP.html#51303" class="InductiveConstructor">rfl</a> <a id="51943" class="Symbol">(</a><a id="51944" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">â‰¡.trans</a> <a id="51952" href="Demos.HSP.html#51926" class="Bound">x</a> <a id="51954" href="Demos.HSP.html#51934" class="Bound">y</a><a id="51955" class="Symbol">)</a>
 <a id="51958" href="Demos.HSP.html#51878" class="Function">â‰ƒ-isTrans</a> <a id="51968" class="Symbol">(</a><a id="51969" href="Demos.HSP.html#51345" class="InductiveConstructor">gnl</a> <a id="51973" href="Demos.HSP.html#51973" class="Bound">x</a><a id="51974" class="Symbol">)</a> <a id="51976" class="Symbol">(</a><a id="51977" href="Demos.HSP.html#51345" class="InductiveConstructor">gnl</a> <a id="51981" href="Demos.HSP.html#51981" class="Bound">y</a><a id="51982" class="Symbol">)</a> <a id="51984" class="Symbol">=</a> <a id="51986" href="Demos.HSP.html#51345" class="InductiveConstructor">gnl</a> <a id="51990" class="Symbol">Î»</a> <a id="51992" href="Demos.HSP.html#51992" class="Bound">i</a> <a id="51994" class="Symbol">â†’</a> <a id="51996" href="Demos.HSP.html#51878" class="Function">â‰ƒ-isTrans</a> <a id="52006" class="Symbol">(</a><a id="52007" href="Demos.HSP.html#51973" class="Bound">x</a> <a id="52009" href="Demos.HSP.html#51992" class="Bound">i</a><a id="52010" class="Symbol">)</a> <a id="52012" class="Symbol">(</a><a id="52013" href="Demos.HSP.html#51981" class="Bound">y</a> <a id="52015" href="Demos.HSP.html#51992" class="Bound">i</a><a id="52016" class="Symbol">)</a>

 <a id="52020" href="Demos.HSP.html#52020" class="Function">â‰ƒ-isEquiv</a>  <a id="52031" class="Symbol">:</a> <a id="52033" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a>  <a id="52048" href="Demos.HSP.html#51259" class="Datatype Operator">_â‰ƒ_</a>
 <a id="52053" href="Demos.HSP.html#52020" class="Function">â‰ƒ-isEquiv</a> <a id="52063" class="Symbol">=</a> <a id="52065" class="Keyword">record</a> <a id="52072" class="Symbol">{</a> <a id="52074" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="52079" class="Symbol">=</a> <a id="52081" href="Demos.HSP.html#51663" class="Function">â‰ƒ-isRefl</a> <a id="52090" class="Symbol">;</a> <a id="52092" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="52096" class="Symbol">=</a> <a id="52098" href="Demos.HSP.html#51768" class="Function">â‰ƒ-isSym</a> <a id="52106" class="Symbol">;</a> <a id="52108" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="52114" class="Symbol">=</a> <a id="52116" href="Demos.HSP.html#51878" class="Function">â‰ƒ-isTrans</a> <a id="52126" class="Symbol">}</a>
</pre>
\fi

For a given signature \ab{ğ‘†} and context \ab X,
%if the type \Term{X} is nonempty (equivalently, if \ab X or
%\aof{âˆ£~\ab{ğ‘†}~âˆ£} is nonempty), then
we define the algebra \T{X}, known as the \defn{term algebra in} \ab{ğ‘†} \defn{over} \ab
X.
%Terms are viewed as acting on other terms, so both
%the elements of the domain of \T{X}
%and its basic operations are terms themselves.
The domain of \T{X} is \Term{X} and, for each operation symbol \ab
f : \aof{âˆ£~\ab{ğ‘†}~âˆ£}, we define \ab f~\aof{Ì‚}~\T{X} to be the operation which maps
each tuple \ab t : \aof{âˆ¥~\ab{ğ‘†}~âˆ¥} \ab f \as{â†’} \Term{X} of terms to the formal
term \ab f \ab t.
%We let \T{X} denote the term algebra in \ab{ğ‘†} over \ab X; it has universe \Term{X} and
%operations \ab f \aof{Ì‚} (\T{X}), one for each symbol \ab f in \aof{âˆ£~\ab{ğ‘†}~âˆ£}.

<pre class="Agda">

<a id="TermSetoid"></a><a id="52953" href="Demos.HSP.html#52953" class="Function">TermSetoid</a> <a id="52964" class="Symbol">:</a> <a id="52966" class="Symbol">(</a><a id="52967" href="Demos.HSP.html#52967" class="Bound">X</a> <a id="52969" class="Symbol">:</a> <a id="52971" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="52976" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="52977" class="Symbol">)</a> <a id="52979" class="Symbol">â†’</a> <a id="52981" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="52988" class="Symbol">_</a> <a id="52990" class="Symbol">_</a>
<a id="52992" href="Demos.HSP.html#52953" class="Function">TermSetoid</a> <a id="53003" href="Demos.HSP.html#53003" class="Bound">X</a> <a id="53005" class="Symbol">=</a> <a id="53007" class="Keyword">record</a> <a id="53014" class="Symbol">{</a> <a id="53016" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a> <a id="53024" class="Symbol">=</a> <a id="53026" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="53031" href="Demos.HSP.html#53003" class="Bound">X</a> <a id="53033" class="Symbol">;</a> <a id="53035" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="53039" class="Symbol">=</a> <a id="53041" href="Demos.HSP.html#51259" class="Datatype Operator">_â‰ƒ_</a> <a id="53045" class="Symbol">;</a> <a id="53047" href="Relation.Binary.Bundles.html#1132" class="Field">isEquivalence</a> <a id="53061" class="Symbol">=</a> <a id="53063" href="Demos.HSP.html#52020" class="Function">â‰ƒ-isEquiv</a> <a id="53073" class="Symbol">}</a>

<a id="ğ‘»"></a><a id="53076" href="Demos.HSP.html#53076" class="Function">ğ‘»</a> <a id="53078" class="Symbol">:</a> <a id="53080" class="Symbol">(</a><a id="53081" href="Demos.HSP.html#53081" class="Bound">X</a> <a id="53083" class="Symbol">:</a> <a id="53085" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="53090" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="53091" class="Symbol">)</a> <a id="53093" class="Symbol">â†’</a> <a id="53095" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="53103" class="Symbol">(</a><a id="53104" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="53107" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="53108" class="Symbol">)</a> <a id="53110" class="Symbol">(</a><a id="53111" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="53114" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="53115" class="Symbol">)</a>
<a id="53117" href="Demos.HSP.html#24623" class="Field">Algebra.Domain</a> <a id="53132" class="Symbol">(</a><a id="53133" href="Demos.HSP.html#53076" class="Function">ğ‘»</a> <a id="53135" href="Demos.HSP.html#53135" class="Bound">X</a><a id="53136" class="Symbol">)</a> <a id="53138" class="Symbol">=</a> <a id="53140" href="Demos.HSP.html#52953" class="Function">TermSetoid</a> <a id="53151" href="Demos.HSP.html#53135" class="Bound">X</a>
<a id="53153" href="Demos.HSP.html#24652" class="Field">Algebra.Interp</a> <a id="53168" class="Symbol">(</a><a id="53169" href="Demos.HSP.html#53076" class="Function">ğ‘»</a> <a id="53171" href="Demos.HSP.html#53171" class="Bound">X</a><a id="53172" class="Symbol">)</a> <a id="53174" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="53178" class="Symbol">(</a><a id="53179" href="Demos.HSP.html#53179" class="Bound">f</a> <a id="53181" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="53183" href="Demos.HSP.html#53183" class="Bound">ts</a><a id="53185" class="Symbol">)</a> <a id="53187" class="Symbol">=</a> <a id="53189" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="53194" href="Demos.HSP.html#53179" class="Bound">f</a> <a id="53196" href="Demos.HSP.html#53183" class="Bound">ts</a>
<a id="53199" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="53204" class="Symbol">(</a><a id="53205" href="Demos.HSP.html#24652" class="Field">Algebra.Interp</a> <a id="53220" class="Symbol">(</a><a id="53221" href="Demos.HSP.html#53076" class="Function">ğ‘»</a> <a id="53223" href="Demos.HSP.html#53223" class="Bound">X</a><a id="53224" class="Symbol">))</a> <a id="53227" class="Symbol">(</a><a id="53228" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="53235" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="53237" href="Demos.HSP.html#53237" class="Bound">ssâ‰ƒts</a><a id="53242" class="Symbol">)</a> <a id="53244" class="Symbol">=</a> <a id="53246" href="Demos.HSP.html#51345" class="InductiveConstructor">gnl</a> <a id="53250" href="Demos.HSP.html#53237" class="Bound">ssâ‰ƒts</a>
</pre>
%% -----------------------------------------------------------------------------
%\paragraph*{Substitution, environments and interpretation of terms}
\paragraph*{Environments and interpretation of terms}

\begin{comment}
Recall that the domain of an algebra \ab{ğ‘¨} is a setoid, which we denote by \af{ğ”»[~\ab{ğ‘¨}~]}, whose carrier is that of \ab{ğ‘¨} (denoted \af{ğ•Œ[~\ab{ğ‘¨}~]}) and whose equivalence relation represents equality of elements in \af{ğ•Œ[~\ab{ğ‘¨}~]}. \af{Sub} performs substitution from one context to another; specifically, if \ab X, \ab Y are contexts, then \af{Sub} \ab X \ab Y assigns a term in \ab X to each symbol in \ab Y.
begin{code}
-- Sub : Type Ï‡ â†’ Type Ï‡ â†’ Type _
-- Sub X Y = (y : Y) â†’ Term X
end{code}
A substitution \ab{Ïƒ} applied to a term \ab t is denoted by \af{[~\ab{Ïƒ}~]} \ab t.
begin{code}
-- [_]_ : {X Y : Type Ï‡} â†’ Sub X Y â†’ Term Y â†’ Term X
-- [ Ïƒ ] (â„Š x) = Ïƒ x
-- [ Ïƒ ] (node f ts) = node f Î» i â†’ [ Ïƒ ] (ts i)
end{code}
\end{comment}
Fix a signature \ab{ğ‘†} and a context \ab X.
%The next two types are defined relative to a fixed \ab{ğ‘†}-algebra, say, \ab{ğ‘¨}, so
%we place them in a submodule that takes the algebra as given.
An \defn{environment} for \ab{ğ‘¨} and \ab X is a setoid whose carrier is a mapping from the variable symbols \ab X to the domain \AgdaOperator{\AgdaFunction{ğ•Œ[}}~\AgdaBound{ğ‘¨}~\AgdaOperator{\AgdaFunction{]}} and whose equivalence relation is pointwise equality. Our formalization of this concept is the same as that of~\cite{Abel:2021}, which Abel uses to formalize Birkhoff's completeness theorem.

<pre class="Agda">

<a id="54836" class="Keyword">module</a> <a id="Environment"></a><a id="54843" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="54855" class="Symbol">(</a><a id="54856" href="Demos.HSP.html#54856" class="Bound">ğ‘¨</a> <a id="54858" class="Symbol">:</a> <a id="54860" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="54868" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="54870" href="Demos.HSP.html#9462" class="Generalizable">â„“</a><a id="54871" class="Symbol">)</a> <a id="54873" class="Keyword">where</a>
 <a id="54880" class="Keyword">open</a> <a id="54885" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="54892" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="54895" href="Demos.HSP.html#54856" class="Bound">ğ‘¨</a> <a id="54897" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="54899" class="Keyword">using</a> <a id="54905" class="Symbol">(</a> <a id="54907" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="54911" class="Symbol">;</a> <a id="54913" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="54918" class="Symbol">;</a> <a id="54920" href="Relation.Binary.Structures.html#1594" class="Function">sym</a> <a id="54924" class="Symbol">;</a> <a id="54926" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="54932" class="Symbol">)</a>

 <a id="Environment.Env"></a><a id="54936" href="Demos.HSP.html#54936" class="Function">Env</a> <a id="54940" class="Symbol">:</a> <a id="54942" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="54947" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a> <a id="54949" class="Symbol">â†’</a> <a id="54951" href="Relation.Binary.Bundles.html#1009" class="Record">Setoid</a> <a id="54958" class="Symbol">_</a> <a id="54960" class="Symbol">_</a>
 <a id="54963" href="Demos.HSP.html#54936" class="Function">Env</a> <a id="54967" href="Demos.HSP.html#54967" class="Bound">X</a> <a id="54969" class="Symbol">=</a> <a id="54971" class="Keyword">record</a>  <a id="54979" class="Symbol">{</a> <a id="54981" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a> <a id="54989" class="Symbol">=</a> <a id="54991" href="Demos.HSP.html#54967" class="Bound">X</a> <a id="54993" class="Symbol">â†’</a> <a id="54995" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="54998" href="Demos.HSP.html#54856" class="Bound">ğ‘¨</a> <a id="55000" href="Demos.HSP.html#25552" class="Function Operator">]</a>
                 <a id="55019" class="Symbol">;</a> <a id="55021" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="55025" class="Symbol">=</a> <a id="55027" class="Symbol">Î»</a> <a id="55029" href="Demos.HSP.html#55029" class="Bound">Ï</a> <a id="55031" href="Demos.HSP.html#55031" class="Bound">Ï„</a> <a id="55033" class="Symbol">â†’</a> <a id="55035" class="Symbol">(</a><a id="55036" href="Demos.HSP.html#55036" class="Bound">x</a> <a id="55038" class="Symbol">:</a> <a id="55040" href="Demos.HSP.html#54967" class="Bound">X</a><a id="55041" class="Symbol">)</a> <a id="55043" class="Symbol">â†’</a> <a id="55045" href="Demos.HSP.html#55029" class="Bound">Ï</a> <a id="55047" href="Demos.HSP.html#55036" class="Bound">x</a> <a id="55049" href="Relation.Binary.Bundles.html#1098" class="Function Operator">â‰ˆ</a> <a id="55051" href="Demos.HSP.html#55031" class="Bound">Ï„</a> <a id="55053" href="Demos.HSP.html#55036" class="Bound">x</a>
                 <a id="55072" class="Symbol">;</a> <a id="55074" href="Relation.Binary.Bundles.html#1132" class="Field">isEquivalence</a> <a id="55088" class="Symbol">=</a> <a id="55090" class="Keyword">record</a>  <a id="55098" class="Symbol">{</a> <a id="55100" href="Relation.Binary.Structures.html#1568" class="Field">refl</a>   <a id="55107" class="Symbol">=</a> <a id="55109" class="Symbol">Î»</a> <a id="55111" href="Demos.HSP.html#55111" class="Bound">_</a>      <a id="55118" class="Symbol">â†’</a> <a id="55120" href="Relation.Binary.Structures.html#1568" class="Function">refl</a>
                                           <a id="55168" class="Symbol">;</a> <a id="55170" href="Relation.Binary.Structures.html#1594" class="Field">sym</a>    <a id="55177" class="Symbol">=</a> <a id="55179" class="Symbol">Î»</a> <a id="55181" href="Demos.HSP.html#55181" class="Bound">h</a> <a id="55183" href="Demos.HSP.html#55183" class="Bound">x</a>    <a id="55188" class="Symbol">â†’</a> <a id="55190" href="Relation.Binary.Structures.html#1594" class="Function">sym</a> <a id="55194" class="Symbol">(</a><a id="55195" href="Demos.HSP.html#55181" class="Bound">h</a> <a id="55197" href="Demos.HSP.html#55183" class="Bound">x</a><a id="55198" class="Symbol">)</a>
                                           <a id="55243" class="Symbol">;</a> <a id="55245" href="Relation.Binary.Structures.html#1620" class="Field">trans</a>  <a id="55252" class="Symbol">=</a> <a id="55254" class="Symbol">Î»</a> <a id="55256" href="Demos.HSP.html#55256" class="Bound">g</a> <a id="55258" href="Demos.HSP.html#55258" class="Bound">h</a> <a id="55260" href="Demos.HSP.html#55260" class="Bound">x</a>  <a id="55263" class="Symbol">â†’</a> <a id="55265" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="55271" class="Symbol">(</a><a id="55272" href="Demos.HSP.html#55256" class="Bound">g</a> <a id="55274" href="Demos.HSP.html#55260" class="Bound">x</a><a id="55275" class="Symbol">)(</a><a id="55277" href="Demos.HSP.html#55258" class="Bound">h</a> <a id="55279" href="Demos.HSP.html#55260" class="Bound">x</a><a id="55280" class="Symbol">)</a> <a id="55282" class="Symbol">}}</a>

</pre>
The \defn{interpretation} of a term \emph{evaluated} in a particular environment is defined as follows.

<pre class="Agda">

 <a id="Environment.âŸ¦_âŸ§"></a><a id="55417" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="55421" class="Symbol">:</a> <a id="55423" class="Symbol">{</a><a id="55424" href="Demos.HSP.html#55424" class="Bound">X</a> <a id="55426" class="Symbol">:</a> <a id="55428" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="55433" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="55434" class="Symbol">}(</a><a id="55436" href="Demos.HSP.html#55436" class="Bound">t</a> <a id="55438" class="Symbol">:</a> <a id="55440" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="55445" href="Demos.HSP.html#55424" class="Bound">X</a><a id="55446" class="Symbol">)</a> <a id="55448" class="Symbol">â†’</a> <a id="55450" class="Symbol">(</a><a id="55451" href="Demos.HSP.html#54936" class="Function">Env</a> <a id="55455" href="Demos.HSP.html#55424" class="Bound">X</a><a id="55456" class="Symbol">)</a> <a id="55458" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="55460" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="55463" href="Demos.HSP.html#54856" class="Bound">ğ‘¨</a> <a id="55465" href="Demos.HSP.html#25499" class="Function Operator">]</a>
 <a id="55468" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="55470" href="Demos.HSP.html#50803" class="InductiveConstructor">â„Š</a> <a id="55472" href="Demos.HSP.html#55472" class="Bound">x</a> <a id="55474" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a>          <a id="55485" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="55489" href="Demos.HSP.html#55489" class="Bound">Ï</a>    <a id="55494" class="Symbol">=</a> <a id="55496" href="Demos.HSP.html#55489" class="Bound">Ï</a> <a id="55498" href="Demos.HSP.html#55472" class="Bound">x</a>
 <a id="55501" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="55503" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="55508" href="Demos.HSP.html#55508" class="Bound">f</a> <a id="55510" href="Demos.HSP.html#55510" class="Bound">args</a> <a id="55515" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a>  <a id="55518" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="55522" href="Demos.HSP.html#55522" class="Bound">Ï</a>    <a id="55527" class="Symbol">=</a> <a id="55529" class="Symbol">(</a><a id="55530" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="55537" href="Demos.HSP.html#54856" class="Bound">ğ‘¨</a><a id="55538" class="Symbol">)</a> <a id="55540" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="55544" class="Symbol">(</a><a id="55545" href="Demos.HSP.html#55508" class="Bound">f</a> <a id="55547" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="55549" class="Symbol">Î»</a> <a id="55551" href="Demos.HSP.html#55551" class="Bound">i</a> <a id="55553" class="Symbol">â†’</a> <a id="55555" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="55557" href="Demos.HSP.html#55510" class="Bound">args</a> <a id="55562" href="Demos.HSP.html#55551" class="Bound">i</a> <a id="55564" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="55566" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="55570" href="Demos.HSP.html#55522" class="Bound">Ï</a><a id="55571" class="Symbol">)</a>
 <a id="55574" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="55579" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="55581" href="Demos.HSP.html#50803" class="InductiveConstructor">â„Š</a> <a id="55583" href="Demos.HSP.html#55583" class="Bound">x</a> <a id="55585" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="55587" href="Demos.HSP.html#55587" class="Bound">uâ‰ˆv</a>          <a id="55600" class="Symbol">=</a> <a id="55602" href="Demos.HSP.html#55587" class="Bound">uâ‰ˆv</a> <a id="55606" href="Demos.HSP.html#55583" class="Bound">x</a>
 <a id="55609" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="55614" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="55616" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="55621" href="Demos.HSP.html#55621" class="Bound">f</a> <a id="55623" href="Demos.HSP.html#55623" class="Bound">args</a> <a id="55628" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="55630" href="Demos.HSP.html#55630" class="Bound">xâ‰ˆy</a>  <a id="55635" class="Symbol">=</a> <a id="55637" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="55642" class="Symbol">(</a><a id="55643" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="55650" href="Demos.HSP.html#54856" class="Bound">ğ‘¨</a><a id="55651" class="Symbol">)(</a><a id="55653" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="55660" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="55662" class="Symbol">Î»</a> <a id="55664" href="Demos.HSP.html#55664" class="Bound">i</a> <a id="55666" class="Symbol">â†’</a> <a id="55668" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="55673" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="55675" href="Demos.HSP.html#55623" class="Bound">args</a> <a id="55680" href="Demos.HSP.html#55664" class="Bound">i</a> <a id="55682" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="55684" href="Demos.HSP.html#55630" class="Bound">xâ‰ˆy</a> <a id="55688" class="Symbol">)</a>

</pre>
Two terms are proclaimed \defn{equal} if they are equal for all environments.

<pre class="Agda">

 <a id="Environment.Equal"></a><a id="55796" href="Demos.HSP.html#55796" class="Function">Equal</a> <a id="55802" class="Symbol">:</a> <a id="55804" class="Symbol">{</a><a id="55805" href="Demos.HSP.html#55805" class="Bound">X</a> <a id="55807" class="Symbol">:</a> <a id="55809" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="55814" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="55815" class="Symbol">}(</a><a id="55817" href="Demos.HSP.html#55817" class="Bound">s</a> <a id="55819" href="Demos.HSP.html#55819" class="Bound">t</a> <a id="55821" class="Symbol">:</a> <a id="55823" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="55828" href="Demos.HSP.html#55805" class="Bound">X</a><a id="55829" class="Symbol">)</a> <a id="55831" class="Symbol">â†’</a> <a id="55833" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="55838" class="Symbol">_</a>
 <a id="55841" href="Demos.HSP.html#55796" class="Function">Equal</a> <a id="55847" class="Symbol">{</a><a id="55848" class="Argument">X</a> <a id="55850" class="Symbol">=</a> <a id="55852" href="Demos.HSP.html#55852" class="Bound">X</a><a id="55853" class="Symbol">}</a> <a id="55855" href="Demos.HSP.html#55855" class="Bound">s</a> <a id="55857" href="Demos.HSP.html#55857" class="Bound">t</a> <a id="55859" class="Symbol">=</a> <a id="55861" class="Symbol">âˆ€</a> <a id="55863" class="Symbol">(</a><a id="55864" href="Demos.HSP.html#55864" class="Bound">Ï</a> <a id="55866" class="Symbol">:</a> <a id="55868" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a> <a id="55876" class="Symbol">(</a><a id="55877" href="Demos.HSP.html#54936" class="Function">Env</a> <a id="55881" href="Demos.HSP.html#55852" class="Bound">X</a><a id="55882" class="Symbol">))</a> <a id="55885" class="Symbol">â†’</a> <a id="55887" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="55889" href="Demos.HSP.html#55855" class="Bound">s</a> <a id="55891" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="55893" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="55897" href="Demos.HSP.html#55864" class="Bound">Ï</a> <a id="55899" href="Relation.Binary.Bundles.html#1098" class="Function Operator">â‰ˆ</a> <a id="55901" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="55903" href="Demos.HSP.html#55857" class="Bound">t</a> <a id="55905" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="55907" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="55911" href="Demos.HSP.html#55864" class="Bound">Ï</a>

</pre>
Proof that \af{Equal} is an equivalence relation, and that the implication \ab
s~\af{â‰ƒ}~\ab t \as{â†’} \af{Equal} \ab s \ab t holds for all terms \ab s and \ab t,
is also found in~\cite{Abel:2021}.
\ifshort
We denote the latter %-- proofs of these facts by \af{EqualIsEquiv} and 
by \af{â‰ƒâ†’Equal} in the sequel.
\else
We reproduce them here to keep the paper self-contained.
<pre class="Agda">
 <a id="Environment.â‰ƒâ†’Equal"></a><a id="56311" href="Demos.HSP.html#56311" class="Function">â‰ƒâ†’Equal</a> <a id="56319" class="Symbol">:</a> <a id="56321" class="Symbol">{</a><a id="56322" href="Demos.HSP.html#56322" class="Bound">X</a> <a id="56324" class="Symbol">:</a> <a id="56326" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="56331" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="56332" class="Symbol">}(</a><a id="56334" href="Demos.HSP.html#56334" class="Bound">s</a> <a id="56336" href="Demos.HSP.html#56336" class="Bound">t</a> <a id="56338" class="Symbol">:</a> <a id="56340" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="56345" href="Demos.HSP.html#56322" class="Bound">X</a><a id="56346" class="Symbol">)</a> <a id="56348" class="Symbol">â†’</a> <a id="56350" href="Demos.HSP.html#56334" class="Bound">s</a> <a id="56352" href="Demos.HSP.html#51259" class="Datatype Operator">â‰ƒ</a> <a id="56354" href="Demos.HSP.html#56336" class="Bound">t</a> <a id="56356" class="Symbol">â†’</a> <a id="56358" href="Demos.HSP.html#55796" class="Function">Equal</a> <a id="56364" href="Demos.HSP.html#56334" class="Bound">s</a> <a id="56366" href="Demos.HSP.html#56336" class="Bound">t</a>
 <a id="56369" href="Demos.HSP.html#56311" class="Function">â‰ƒâ†’Equal</a> <a id="56377" class="DottedPattern Symbol">.(</a><a id="56379" href="Demos.HSP.html#50803" class="DottedPattern InductiveConstructor">â„Š</a> <a id="56381" class="DottedPattern Symbol">_)</a> <a id="56384" class="DottedPattern Symbol">.(</a><a id="56386" href="Demos.HSP.html#50803" class="DottedPattern InductiveConstructor">â„Š</a> <a id="56388" class="DottedPattern Symbol">_)</a> <a id="56391" class="Symbol">(</a><a id="56392" href="Demos.HSP.html#51303" class="InductiveConstructor">rfl</a> <a id="56396" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a><a id="56402" class="Symbol">)</a> <a id="56404" class="Symbol">=</a> <a id="56406" class="Symbol">Î»</a> <a id="56408" href="Demos.HSP.html#56408" class="Bound">_</a> <a id="56410" class="Symbol">â†’</a> <a id="56412" href="Relation.Binary.Structures.html#1568" class="Function">refl</a>
 <a id="56418" href="Demos.HSP.html#56311" class="Function">â‰ƒâ†’Equal</a> <a id="56426" class="Symbol">(</a><a id="56427" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="56432" class="Symbol">_</a> <a id="56434" href="Demos.HSP.html#56434" class="Bound">s</a><a id="56435" class="Symbol">)(</a><a id="56437" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="56442" class="Symbol">_</a> <a id="56444" href="Demos.HSP.html#56444" class="Bound">t</a><a id="56445" class="Symbol">)(</a><a id="56447" href="Demos.HSP.html#51345" class="InductiveConstructor">gnl</a> <a id="56451" href="Demos.HSP.html#56451" class="Bound">x</a><a id="56452" class="Symbol">)</a> <a id="56454" class="Symbol">=</a>
  <a id="56458" class="Symbol">Î»</a> <a id="56460" href="Demos.HSP.html#56460" class="Bound">Ï</a> <a id="56462" class="Symbol">â†’</a> <a id="56464" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="56469" class="Symbol">(</a><a id="56470" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="56477" href="Demos.HSP.html#54856" class="Bound">ğ‘¨</a><a id="56478" class="Symbol">)(</a><a id="56480" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="56487" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="56489" class="Symbol">Î»</a> <a id="56491" href="Demos.HSP.html#56491" class="Bound">i</a> <a id="56493" class="Symbol">â†’</a> <a id="56495" href="Demos.HSP.html#56311" class="Function">â‰ƒâ†’Equal</a><a id="56502" class="Symbol">(</a><a id="56503" href="Demos.HSP.html#56434" class="Bound">s</a> <a id="56505" href="Demos.HSP.html#56491" class="Bound">i</a><a id="56506" class="Symbol">)(</a><a id="56508" href="Demos.HSP.html#56444" class="Bound">t</a> <a id="56510" href="Demos.HSP.html#56491" class="Bound">i</a><a id="56511" class="Symbol">)(</a><a id="56513" href="Demos.HSP.html#56451" class="Bound">x</a> <a id="56515" href="Demos.HSP.html#56491" class="Bound">i</a><a id="56516" class="Symbol">)</a><a id="56517" href="Demos.HSP.html#56460" class="Bound">Ï</a> <a id="56519" class="Symbol">)</a>

 <a id="Environment.EqualIsEquiv"></a><a id="56523" href="Demos.HSP.html#56523" class="Function">EqualIsEquiv</a> <a id="56536" class="Symbol">:</a> <a id="56538" class="Symbol">{</a><a id="56539" href="Demos.HSP.html#56539" class="Bound">Î“</a> <a id="56541" class="Symbol">:</a> <a id="56543" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="56548" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="56549" class="Symbol">}</a> <a id="56551" class="Symbol">â†’</a> <a id="56553" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="56567" class="Symbol">(</a><a id="56568" href="Demos.HSP.html#55796" class="Function">Equal</a> <a id="56574" class="Symbol">{</a><a id="56575" class="Argument">X</a> <a id="56577" class="Symbol">=</a> <a id="56579" href="Demos.HSP.html#56539" class="Bound">Î“</a><a id="56580" class="Symbol">})</a>
 <a id="56584" href="Demos.HSP.html#8708" class="Field">refláµ‰</a>   <a id="56592" href="Demos.HSP.html#56523" class="Function">EqualIsEquiv</a> <a id="56605" class="Symbol">=</a> <a id="56607" class="Symbol">Î»</a> <a id="56609" href="Demos.HSP.html#56609" class="Bound">_</a>        <a id="56618" class="Symbol">â†’</a> <a id="56620" href="Relation.Binary.Structures.html#1568" class="Function">refl</a>
 <a id="56626" href="Demos.HSP.html#8769" class="Field">symáµ‰</a>    <a id="56634" href="Demos.HSP.html#56523" class="Function">EqualIsEquiv</a> <a id="56647" class="Symbol">=</a> <a id="56649" class="Symbol">Î»</a> <a id="56651" href="Demos.HSP.html#56651" class="Bound">x=y</a> <a id="56655" href="Demos.HSP.html#56655" class="Bound">Ï</a>    <a id="56660" class="Symbol">â†’</a> <a id="56662" href="Relation.Binary.Structures.html#1594" class="Function">sym</a> <a id="56666" class="Symbol">(</a><a id="56667" href="Demos.HSP.html#56651" class="Bound">x=y</a> <a id="56671" href="Demos.HSP.html#56655" class="Bound">Ï</a><a id="56672" class="Symbol">)</a>
 <a id="56675" href="Demos.HSP.html#8830" class="Field">transáµ‰</a>  <a id="56683" href="Demos.HSP.html#56523" class="Function">EqualIsEquiv</a> <a id="56696" class="Symbol">=</a> <a id="56698" class="Symbol">Î»</a> <a id="56700" href="Demos.HSP.html#56700" class="Bound">ij</a> <a id="56703" href="Demos.HSP.html#56703" class="Bound">jk</a> <a id="56706" href="Demos.HSP.html#56706" class="Bound">Ï</a>  <a id="56709" class="Symbol">â†’</a> <a id="56711" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="56717" class="Symbol">(</a><a id="56718" href="Demos.HSP.html#56700" class="Bound">ij</a> <a id="56721" href="Demos.HSP.html#56706" class="Bound">Ï</a><a id="56722" class="Symbol">)</a> <a id="56724" class="Symbol">(</a><a id="56725" href="Demos.HSP.html#56703" class="Bound">jk</a> <a id="56728" href="Demos.HSP.html#56706" class="Bound">Ï</a><a id="56729" class="Symbol">)</a>
</pre>
\fi
\begin{comment}
Another useful fact we will need is that substitution and evaluation commute; that is, applying substitution \ab{Ïƒ} to a term \ab{t} and evaluating the result in environment \ab{Ï} has the same effect as evaluating \ab{t} in the environment \as{Î»} \ab x \as{â†’} \aof{âŸ¦~\ab{Ïƒ}~\ab{x}~âŸ§}~\aofld{âŸ¨\$âŸ©} \ab{Ï} (see~\cite{Abel:2021} or~\cite[Lem.~3.3.11]{Mitchell:1996}).
begin{code}
 -- substitution :  {X Y : Type Ï‡} â†’ (t : Term Y) (Ïƒ : Sub X Y) (Ï : Carrier( Env X ) )
 --  â†’              âŸ¦ [ Ïƒ ] t âŸ§ âŸ¨$âŸ© Ï â‰ˆ âŸ¦ t âŸ§ âŸ¨$âŸ© (Î» x â†’ âŸ¦ Ïƒ x âŸ§ âŸ¨$âŸ© Ï)
 -- substitution    (â„Š x)        Ïƒ Ï = refl
 -- substitution    (node f ts)  Ïƒ Ï = cong (Interp ğ‘¨)(â‰¡.refl , Î» i â†’ substitution (ts i) Ïƒ Ï)
end{code}
\end{comment}
%% -----------------------------------------------------------------------------

\paragraph*{Compatibility of terms}
We need to formalize two more concepts involving terms.
The first (\af{comm-hom-term}) is the assertion that every term commutes with every homomorphism, and
the second (\af{interp-prod}) is the interpretation of a term in a product algebra.

<pre class="Agda">

<a id="57838" class="Keyword">module</a> <a id="57845" href="Demos.HSP.html#57845" class="Module">_</a> <a id="57847" class="Symbol">{</a><a id="57848" href="Demos.HSP.html#57848" class="Bound">X</a> <a id="57850" class="Symbol">:</a> <a id="57852" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="57857" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="57858" class="Symbol">}{</a><a id="57860" href="Demos.HSP.html#57860" class="Bound">ğ‘¨</a> <a id="57862" class="Symbol">:</a> <a id="57864" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="57872" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="57874" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="57876" class="Symbol">}{</a><a id="57878" href="Demos.HSP.html#57878" class="Bound">ğ‘©</a> <a id="57880" class="Symbol">:</a> <a id="57882" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="57890" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="57892" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="57894" class="Symbol">}(</a><a id="57896" href="Demos.HSP.html#57896" class="Bound">hh</a> <a id="57899" class="Symbol">:</a> <a id="57901" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="57905" href="Demos.HSP.html#57860" class="Bound">ğ‘¨</a> <a id="57907" href="Demos.HSP.html#57878" class="Bound">ğ‘©</a><a id="57908" class="Symbol">)</a> <a id="57910" class="Keyword">where</a>
 <a id="57917" class="Keyword">open</a> <a id="57922" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="57934" href="Demos.HSP.html#57860" class="Bound">ğ‘¨</a>  <a id="57937" class="Keyword">using</a> <a id="57943" class="Symbol">(</a> <a id="57945" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="57949" class="Symbol">)</a>
 <a id="57952" class="Keyword">open</a> <a id="57957" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="57969" href="Demos.HSP.html#57878" class="Bound">ğ‘©</a>  <a id="57972" class="Keyword">using</a> <a id="57978" class="Symbol">()</a> <a id="57981" class="Keyword">renaming</a> <a id="57990" class="Symbol">(</a> <a id="57992" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="57996" class="Symbol">to</a> <a id="57999" class="Function Operator">âŸ¦_âŸ§á´®</a> <a id="58004" class="Symbol">)</a>
 <a id="58007" class="Keyword">open</a> <a id="58012" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="58019" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="58022" href="Demos.HSP.html#57878" class="Bound">ğ‘©</a> <a id="58024" href="Demos.HSP.html#25499" class="Function Operator">]</a>  <a id="58027" class="Keyword">using</a> <a id="58033" class="Symbol">(</a> <a id="58035" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="58039" class="Symbol">;</a> <a id="58041" href="Relation.Binary.Structures.html#1568" class="Function">refl</a>  <a id="58047" class="Symbol">)</a>
 <a id="58050" class="Keyword">private</a> <a id="58058" href="Demos.HSP.html#58058" class="Function">hfunc</a> <a id="58064" class="Symbol">=</a> <a id="58066" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="58068" href="Demos.HSP.html#57896" class="Bound">hh</a> <a id="58071" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="58073" class="Symbol">;</a> <a id="58075" href="Demos.HSP.html#58075" class="Function">h</a> <a id="58077" class="Symbol">=</a> <a id="58079" href="Demos.HSP.html#8606" class="Field Operator">_âŸ¨$âŸ©_</a> <a id="58085" href="Demos.HSP.html#58058" class="Function">hfunc</a>

 <a id="58093" href="Demos.HSP.html#58093" class="Function">comm-hom-term</a> <a id="58107" class="Symbol">:</a> <a id="58109" class="Symbol">(</a><a id="58110" href="Demos.HSP.html#58110" class="Bound">t</a> <a id="58112" class="Symbol">:</a> <a id="58114" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="58119" href="Demos.HSP.html#57848" class="Bound">X</a><a id="58120" class="Symbol">)</a> <a id="58122" class="Symbol">(</a><a id="58123" href="Demos.HSP.html#58123" class="Bound">a</a> <a id="58125" class="Symbol">:</a> <a id="58127" href="Demos.HSP.html#57848" class="Bound">X</a> <a id="58129" class="Symbol">â†’</a> <a id="58131" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="58134" href="Demos.HSP.html#57860" class="Bound">ğ‘¨</a> <a id="58136" href="Demos.HSP.html#25552" class="Function Operator">]</a><a id="58137" class="Symbol">)</a> <a id="58139" class="Symbol">â†’</a> <a id="58141" href="Demos.HSP.html#58075" class="Function">h</a> <a id="58143" class="Symbol">(</a><a id="58144" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="58146" href="Demos.HSP.html#58110" class="Bound">t</a> <a id="58148" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="58150" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="58154" href="Demos.HSP.html#58123" class="Bound">a</a><a id="58155" class="Symbol">)</a> <a id="58157" href="Relation.Binary.Bundles.html#1098" class="Function Operator">â‰ˆ</a> <a id="58159" href="Demos.HSP.html#57999" class="Function Operator">âŸ¦</a> <a id="58161" href="Demos.HSP.html#58110" class="Bound">t</a> <a id="58163" href="Demos.HSP.html#57999" class="Function Operator">âŸ§á´®</a> <a id="58166" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="58170" class="Symbol">(</a><a id="58171" href="Demos.HSP.html#58075" class="Function">h</a> <a id="58173" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="58175" href="Demos.HSP.html#58123" class="Bound">a</a><a id="58176" class="Symbol">)</a>
 <a id="58179" href="Demos.HSP.html#58093" class="Function">comm-hom-term</a> <a id="58193" class="Symbol">(</a><a id="58194" href="Demos.HSP.html#50803" class="InductiveConstructor">â„Š</a> <a id="58196" href="Demos.HSP.html#58196" class="Bound">x</a><a id="58197" class="Symbol">)</a> <a id="58199" href="Demos.HSP.html#58199" class="Bound">a</a> <a id="58201" class="Symbol">=</a> <a id="58203" href="Relation.Binary.Structures.html#1568" class="Function">refl</a>
 <a id="58209" href="Demos.HSP.html#58093" class="Function">comm-hom-term</a> <a id="58223" class="Symbol">(</a><a id="58224" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="58229" href="Demos.HSP.html#58229" class="Bound">f</a> <a id="58231" href="Demos.HSP.html#58231" class="Bound">t</a><a id="58232" class="Symbol">)</a> <a id="58234" href="Demos.HSP.html#58234" class="Bound">a</a> <a id="58236" class="Symbol">=</a>  <a id="58239" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>
   <a id="58248" href="Demos.HSP.html#58075" class="Function">h</a><a id="58249" class="Symbol">(</a><a id="58250" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="58252" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="58257" href="Demos.HSP.html#58229" class="Bound">f</a> <a id="58259" href="Demos.HSP.html#58231" class="Bound">t</a> <a id="58261" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="58263" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="58267" href="Demos.HSP.html#58234" class="Bound">a</a><a id="58268" class="Symbol">)</a>            <a id="58281" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a> <a id="58284" href="Demos.HSP.html#34508" class="Field">compatible</a> <a id="58295" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="58297" href="Demos.HSP.html#57896" class="Bound">hh</a> <a id="58300" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="58302" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
   <a id="58307" class="Symbol">(</a><a id="58308" href="Demos.HSP.html#58229" class="Bound">f</a> <a id="58310" href="Demos.HSP.html#25610" class="Function Operator">Ì‚</a> <a id="58312" href="Demos.HSP.html#57878" class="Bound">ğ‘©</a><a id="58313" class="Symbol">)(Î»</a> <a id="58317" href="Demos.HSP.html#58317" class="Bound">i</a> <a id="58319" class="Symbol">â†’</a> <a id="58321" href="Demos.HSP.html#58075" class="Function">h</a><a id="58322" class="Symbol">(</a><a id="58323" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="58325" href="Demos.HSP.html#58231" class="Bound">t</a> <a id="58327" href="Demos.HSP.html#58317" class="Bound">i</a> <a id="58329" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="58331" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="58335" href="Demos.HSP.html#58234" class="Bound">a</a><a id="58336" class="Symbol">))</a>  <a id="58340" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a> <a id="58343" href="Function.Bundles.html#1938" class="Field">cong</a><a id="58347" class="Symbol">(</a><a id="58348" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="58355" href="Demos.HSP.html#57878" class="Bound">ğ‘©</a><a id="58356" class="Symbol">)(</a><a id="58358" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="58365" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="58367" class="Symbol">Î»</a> <a id="58369" href="Demos.HSP.html#58369" class="Bound">i</a> <a id="58371" class="Symbol">â†’</a> <a id="58373" href="Demos.HSP.html#58093" class="Function">comm-hom-term</a><a id="58386" class="Symbol">(</a><a id="58387" href="Demos.HSP.html#58231" class="Bound">t</a> <a id="58389" href="Demos.HSP.html#58369" class="Bound">i</a><a id="58390" class="Symbol">)</a> <a id="58392" href="Demos.HSP.html#58234" class="Bound">a</a><a id="58393" class="Symbol">)</a> <a id="58395" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
   <a id="58400" href="Demos.HSP.html#57999" class="Function Operator">âŸ¦</a> <a id="58402" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="58407" href="Demos.HSP.html#58229" class="Bound">f</a> <a id="58409" href="Demos.HSP.html#58231" class="Bound">t</a> <a id="58411" href="Demos.HSP.html#57999" class="Function Operator">âŸ§á´®</a> <a id="58414" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="58418" class="Symbol">(</a><a id="58419" href="Demos.HSP.html#58075" class="Function">h</a> <a id="58421" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="58423" href="Demos.HSP.html#58234" class="Bound">a</a><a id="58424" class="Symbol">)</a>   <a id="58428" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">âˆ</a> <a id="58430" class="Keyword">where</a> <a id="58436" class="Keyword">open</a> <a id="58441" href="Relation.Binary.Reasoning.Setoid.html" class="Module">SetoidReasoning</a> <a id="58457" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="58460" href="Demos.HSP.html#57878" class="Bound">ğ‘©</a> <a id="58462" href="Demos.HSP.html#25499" class="Function Operator">]</a>

<a id="58465" class="Keyword">module</a> <a id="58472" href="Demos.HSP.html#58472" class="Module">_</a> <a id="58474" class="Symbol">{</a><a id="58475" href="Demos.HSP.html#58475" class="Bound">X</a> <a id="58477" class="Symbol">:</a> <a id="58479" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="58484" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="58485" class="Symbol">}{</a><a id="58487" href="Demos.HSP.html#58487" class="Bound">Î¹</a> <a id="58489" class="Symbol">:</a> <a id="58491" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="58496" class="Symbol">}</a> <a id="58498" class="Symbol">{</a><a id="58499" href="Demos.HSP.html#58499" class="Bound">I</a> <a id="58501" class="Symbol">:</a> <a id="58503" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="58508" href="Demos.HSP.html#58487" class="Bound">Î¹</a><a id="58509" class="Symbol">}</a> <a id="58511" class="Symbol">(</a><a id="58512" href="Demos.HSP.html#58512" class="Bound">ğ’œ</a> <a id="58514" class="Symbol">:</a> <a id="58516" href="Demos.HSP.html#58499" class="Bound">I</a> <a id="58518" class="Symbol">â†’</a> <a id="58520" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="58528" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="58530" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="58532" class="Symbol">)</a> <a id="58534" class="Keyword">where</a>
 <a id="58541" class="Keyword">open</a> <a id="58546" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="58553" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="58556" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="58558" href="Demos.HSP.html#58512" class="Bound">ğ’œ</a> <a id="58560" href="Demos.HSP.html#25499" class="Function Operator">]</a>  <a id="58563" class="Keyword">using</a> <a id="58569" class="Symbol">(</a> <a id="58571" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="58575" class="Symbol">)</a>
 <a id="58578" class="Keyword">open</a> <a id="58583" href="Demos.HSP.html#54843" class="Module">Environment</a>      <a id="58600" class="Keyword">using</a> <a id="58606" class="Symbol">(</a> <a id="58608" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="58612" class="Symbol">;</a> <a id="58614" href="Demos.HSP.html#56311" class="Function">â‰ƒâ†’Equal</a> <a id="58622" class="Symbol">)</a>

 <a id="58626" href="Demos.HSP.html#58626" class="Function">interp-prod</a> <a id="58638" class="Symbol">:</a> <a id="58640" class="Symbol">(</a><a id="58641" href="Demos.HSP.html#58641" class="Bound">p</a> <a id="58643" class="Symbol">:</a> <a id="58645" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="58650" href="Demos.HSP.html#58475" class="Bound">X</a><a id="58651" class="Symbol">)</a> <a id="58653" class="Symbol">â†’</a> <a id="58655" class="Symbol">âˆ€</a> <a id="58657" href="Demos.HSP.html#58657" class="Bound">Ï</a> <a id="58659" class="Symbol">â†’</a>  <a id="58662" class="Symbol">(</a><a id="58663" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="58665" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="58667" href="Demos.HSP.html#58512" class="Bound">ğ’œ</a> <a id="58669" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="58671" href="Demos.HSP.html#58641" class="Bound">p</a><a id="58672" class="Symbol">)</a> <a id="58674" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="58678" href="Demos.HSP.html#58657" class="Bound">Ï</a>   <a id="58682" href="Relation.Binary.Bundles.html#1098" class="Function Operator">â‰ˆ</a>   <a id="58686" class="Symbol">Î»</a> <a id="58688" href="Demos.HSP.html#58688" class="Bound">i</a> <a id="58690" class="Symbol">â†’</a> <a id="58692" class="Symbol">(</a><a id="58693" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="58695" href="Demos.HSP.html#58512" class="Bound">ğ’œ</a> <a id="58697" href="Demos.HSP.html#58688" class="Bound">i</a> <a id="58699" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="58701" href="Demos.HSP.html#58641" class="Bound">p</a><a id="58702" class="Symbol">)</a> <a id="58704" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="58708" class="Symbol">Î»</a> <a id="58710" href="Demos.HSP.html#58710" class="Bound">x</a> <a id="58712" class="Symbol">â†’</a> <a id="58714" class="Symbol">(</a><a id="58715" href="Demos.HSP.html#58657" class="Bound">Ï</a> <a id="58717" href="Demos.HSP.html#58710" class="Bound">x</a><a id="58718" class="Symbol">)</a> <a id="58720" href="Demos.HSP.html#58688" class="Bound">i</a>
 <a id="58723" href="Demos.HSP.html#58626" class="Function">interp-prod</a> <a id="58735" class="Symbol">(</a><a id="58736" href="Demos.HSP.html#50803" class="InductiveConstructor">â„Š</a> <a id="58738" href="Demos.HSP.html#58738" class="Bound">x</a><a id="58739" class="Symbol">)</a>       <a id="58747" class="Symbol">=</a> <a id="58749" class="Symbol">Î»</a> <a id="58751" href="Demos.HSP.html#58751" class="Bound">Ï</a> <a id="58753" href="Demos.HSP.html#58753" class="Bound">i</a>  <a id="58756" class="Symbol">â†’</a> <a id="58758" href="Demos.HSP.html#56311" class="Function">â‰ƒâ†’Equal</a> <a id="58766" class="Symbol">(</a><a id="58767" href="Demos.HSP.html#58512" class="Bound">ğ’œ</a> <a id="58769" href="Demos.HSP.html#58753" class="Bound">i</a><a id="58770" class="Symbol">)</a> <a id="58772" class="Symbol">(</a><a id="58773" href="Demos.HSP.html#50803" class="InductiveConstructor">â„Š</a> <a id="58775" href="Demos.HSP.html#58738" class="Bound">x</a><a id="58776" class="Symbol">)</a> <a id="58778" class="Symbol">(</a><a id="58779" href="Demos.HSP.html#50803" class="InductiveConstructor">â„Š</a> <a id="58781" href="Demos.HSP.html#58738" class="Bound">x</a><a id="58782" class="Symbol">)</a> <a id="58784" href="Demos.HSP.html#51663" class="Function">â‰ƒ-isRefl</a> <a id="58793" class="Symbol">Î»</a> <a id="58795" href="Demos.HSP.html#58795" class="Bound">_</a> <a id="58797" class="Symbol">â†’</a> <a id="58799" class="Symbol">(</a><a id="58800" href="Demos.HSP.html#58751" class="Bound">Ï</a> <a id="58802" href="Demos.HSP.html#58738" class="Bound">x</a><a id="58803" class="Symbol">)</a> <a id="58805" href="Demos.HSP.html#58753" class="Bound">i</a>
 <a id="58808" href="Demos.HSP.html#58626" class="Function">interp-prod</a> <a id="58820" class="Symbol">(</a><a id="58821" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="58826" href="Demos.HSP.html#58826" class="Bound">f</a> <a id="58828" href="Demos.HSP.html#58828" class="Bound">t</a><a id="58829" class="Symbol">)</a>  <a id="58832" class="Symbol">=</a> <a id="58834" class="Symbol">Î»</a> <a id="58836" href="Demos.HSP.html#58836" class="Bound">Ï</a>    <a id="58841" class="Symbol">â†’</a> <a id="58843" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="58848" class="Symbol">(</a><a id="58849" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="58856" class="Symbol">(</a><a id="58857" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="58859" href="Demos.HSP.html#58512" class="Bound">ğ’œ</a><a id="58860" class="Symbol">))</a> <a id="58863" class="Symbol">(</a> <a id="58865" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="58872" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="58874" class="Symbol">Î»</a> <a id="58876" href="Demos.HSP.html#58876" class="Bound">j</a> <a id="58878" href="Demos.HSP.html#58878" class="Bound">k</a> <a id="58880" class="Symbol">â†’</a> <a id="58882" href="Demos.HSP.html#58626" class="Function">interp-prod</a> <a id="58894" class="Symbol">(</a><a id="58895" href="Demos.HSP.html#58828" class="Bound">t</a> <a id="58897" href="Demos.HSP.html#58876" class="Bound">j</a><a id="58898" class="Symbol">)</a> <a id="58900" href="Demos.HSP.html#58836" class="Bound">Ï</a> <a id="58902" href="Demos.HSP.html#58878" class="Bound">k</a> <a id="58904" class="Symbol">)</a>
</pre>

\section{Equational Logic}
\label{equational-logic}
%% -----------------------------------------------------------------------------
\paragraph*{Term identities, equational theories, and the âŠ§ relation}
%Given a signature \ab{ğ‘†} and a context \ab X,
An \ab{ğ‘†}-\defn{term equation} (or \ab{ğ‘†}-\defn{term identity})
is an ordered pair (\ab p , \ab q) of ğ‘†-terms, also denoted by \ab p \af{â‰ˆ} \ab q.
%They are often simply called equations or identities, especially when the signature \ab{ğ‘†} is evident.
We define an \defn{equational theory} (or \defn{algebraic theory}) to be a pair \ab{T} =
(\ab{ğ‘†} , \ab{â„°}) consisting of a signature \ab{ğ‘†} and a collection \ab{â„°} of
\ab{ğ‘†}-term equations.\footnote{Some authors reserve the term \defn{theory} for
a \emph{deductively closed} set of equations, that is, a set of equations that is closed
under entailment.}

We say that the algebra \ab{ğ‘¨} \defn{models} the identity \ab{p}~\af{â‰ˆ}~\ab{q} and we write
\ab{ğ‘¨}~\aof{âŠ§}~\ab{p}~\aof{â‰ˆ}~\ab{q}
if for all \ab{Ï} : \ab X \as{â†’} \aof{ğ”»[~\ab{ğ‘¨}~]}
we have \aof{âŸ¦~\ab{p}~âŸ§} \aofld{âŸ¨\$âŸ©} \ab{Ï} \af{â‰ˆ} \aof{âŸ¦~\ab{q}~âŸ§} \aofld{âŸ¨\$âŸ©} \ab{Ï}.
In other words, when interpreted in the algebra \ab{ğ‘¨},
the terms \ab{p} and \ab{q} are equal no matter what values are assigned to variable symbols occurring in \ab{p} and \ab{q}.
If \ab{ğ’¦} is a class of algebras of a given signature, then we write \ab{ğ’¦}~\aof{âŠ«}~\ab{p}~\aof{â‰ˆ}~\ab{q}
and say that \ab{ğ’¦} \defn{models} the identity \ab{p}~\af{â‰ˆ}~\ab{q} provided \ab{ğ‘¨}~\aof{âŠ§}~\ab{p}~\aof{â‰ˆ}~\ab{q} for every \ab{ğ‘¨} \aof{âˆˆ} \ab{ğ’¦}.

<pre class="Agda">

<a id="60494" class="Keyword">module</a> <a id="60501" href="Demos.HSP.html#60501" class="Module">_</a> <a id="60503" class="Symbol">{</a><a id="60504" href="Demos.HSP.html#60504" class="Bound">X</a> <a id="60506" class="Symbol">:</a> <a id="60508" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="60513" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="60514" class="Symbol">}</a> <a id="60516" class="Keyword">where</a>
 <a id="60523" href="Demos.HSP.html#60523" class="Function Operator">_âŠ§_â‰ˆ_</a> <a id="60529" class="Symbol">:</a> <a id="60531" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="60539" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="60541" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="60544" class="Symbol">â†’</a> <a id="60546" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="60551" href="Demos.HSP.html#60504" class="Bound">X</a> <a id="60553" class="Symbol">â†’</a> <a id="60555" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="60560" href="Demos.HSP.html#60504" class="Bound">X</a> <a id="60562" class="Symbol">â†’</a> <a id="60564" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="60569" class="Symbol">_</a>
 <a id="60572" href="Demos.HSP.html#60572" class="Bound">ğ‘¨</a> <a id="60574" href="Demos.HSP.html#60523" class="Function Operator">âŠ§</a> <a id="60576" href="Demos.HSP.html#60576" class="Bound">p</a> <a id="60578" href="Demos.HSP.html#60523" class="Function Operator">â‰ˆ</a> <a id="60580" href="Demos.HSP.html#60580" class="Bound">q</a> <a id="60582" class="Symbol">=</a> <a id="60584" href="Demos.HSP.html#55796" class="Function">Equal</a> <a id="60590" href="Demos.HSP.html#60576" class="Bound">p</a> <a id="60592" href="Demos.HSP.html#60580" class="Bound">q</a> <a id="60594" class="Keyword">where</a> <a id="60600" class="Keyword">open</a> <a id="60605" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="60617" href="Demos.HSP.html#60572" class="Bound">ğ‘¨</a>

 <a id="60621" href="Demos.HSP.html#60621" class="Function Operator">_âŠ«_â‰ˆ_</a> <a id="60627" class="Symbol">:</a> <a id="60629" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="60634" class="Symbol">(</a><a id="60635" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="60643" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="60645" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="60647" class="Symbol">)</a> <a id="60649" href="Demos.HSP.html#9462" class="Generalizable">â„“</a> <a id="60651" class="Symbol">â†’</a> <a id="60653" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="60658" href="Demos.HSP.html#60504" class="Bound">X</a> <a id="60660" class="Symbol">â†’</a> <a id="60662" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="60667" href="Demos.HSP.html#60504" class="Bound">X</a> <a id="60669" class="Symbol">â†’</a> <a id="60671" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="60676" class="Symbol">_</a>
 <a id="60679" href="Demos.HSP.html#60679" class="Bound">ğ’¦</a> <a id="60681" href="Demos.HSP.html#60621" class="Function Operator">âŠ«</a> <a id="60683" href="Demos.HSP.html#60683" class="Bound">p</a> <a id="60685" href="Demos.HSP.html#60621" class="Function Operator">â‰ˆ</a> <a id="60687" href="Demos.HSP.html#60687" class="Bound">q</a> <a id="60689" class="Symbol">=</a> <a id="60691" class="Symbol">âˆ€</a> <a id="60693" href="Demos.HSP.html#60693" class="Bound">ğ‘¨</a> <a id="60695" class="Symbol">â†’</a> <a id="60697" href="Demos.HSP.html#60679" class="Bound">ğ’¦</a> <a id="60699" href="Demos.HSP.html#60693" class="Bound">ğ‘¨</a> <a id="60701" class="Symbol">â†’</a> <a id="60703" href="Demos.HSP.html#60693" class="Bound">ğ‘¨</a> <a id="60705" href="Demos.HSP.html#60523" class="Function Operator">âŠ§</a> <a id="60707" href="Demos.HSP.html#60683" class="Bound">p</a> <a id="60709" href="Demos.HSP.html#60523" class="Function Operator">â‰ˆ</a> <a id="60711" href="Demos.HSP.html#60687" class="Bound">q</a>

</pre>
We represent a set of term identities as a predicate over pairs of terms,
\ifshort\else
say, \ab{â„°} : \af{Pred}(\ad{Term} \ab{X} \af{Ã—} \ad{Term} \ab{X})~\au{}
\fi
and we denote by \ab{ğ‘¨}~\aof{âŠ¨}~\ab{â„°} the assertion that \ab{ğ‘¨} models \ab{p}~\af{â‰ˆ}~\ab{q}
for all (\ab{p} , \ab{q}) \af{âˆˆ} \ab{â„°}.%
\ifshort\else\footnote{\af{âŠ¨} is a stretched version of the models symbol, \af{âŠ§},
so \agda can distinguish between the two.and parse expressions involving the types
\af{\au{}âŠ¨\au{}} and \af{\au{}âŠ§\au{}â‰ˆ\au{}}.
In Emacs \texttt{agda2-mode}, the symbol \af{âŠ¨} is produced by typing
\textbackslash\textbar{}=, while \af{âŠ§} is produced with \textbackslash{}models.}
\fi

<pre class="Agda">

 <a id="61407" href="Demos.HSP.html#61407" class="Function Operator">_âŠ¨_</a> <a id="61411" class="Symbol">:</a> <a id="61413" class="Symbol">(</a><a id="61414" href="Demos.HSP.html#61414" class="Bound">ğ‘¨</a> <a id="61416" class="Symbol">:</a> <a id="61418" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="61426" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="61428" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="61430" class="Symbol">)</a> <a id="61432" class="Symbol">â†’</a> <a id="61434" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="61438" class="Symbol">(</a><a id="61439" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="61444" href="Demos.HSP.html#60504" class="Bound">X</a> <a id="61446" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="61448" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="61453" href="Demos.HSP.html#60504" class="Bound">X</a><a id="61454" class="Symbol">)(</a><a id="61456" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="61459" href="Demos.HSP.html#60513" class="Bound">Ï‡</a><a id="61460" class="Symbol">)</a> <a id="61462" class="Symbol">â†’</a> <a id="61464" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="61469" class="Symbol">_</a>
 <a id="61472" href="Demos.HSP.html#61472" class="Bound">ğ‘¨</a> <a id="61474" href="Demos.HSP.html#61407" class="Function Operator">âŠ¨</a> <a id="61476" href="Demos.HSP.html#61476" class="Bound">â„°</a> <a id="61478" class="Symbol">=</a> <a id="61480" class="Symbol">âˆ€</a> <a id="61482" class="Symbol">{</a><a id="61483" href="Demos.HSP.html#61483" class="Bound">p</a> <a id="61485" href="Demos.HSP.html#61485" class="Bound">q</a><a id="61486" class="Symbol">}</a> <a id="61488" class="Symbol">â†’</a> <a id="61490" class="Symbol">(</a><a id="61491" href="Demos.HSP.html#61483" class="Bound">p</a> <a id="61493" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="61495" href="Demos.HSP.html#61485" class="Bound">q</a><a id="61496" class="Symbol">)</a> <a id="61498" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="61500" href="Demos.HSP.html#61476" class="Bound">â„°</a> <a id="61502" class="Symbol">â†’</a> <a id="61504" href="Demos.HSP.html#55796" class="Function">Equal</a> <a id="61510" href="Demos.HSP.html#61483" class="Bound">p</a> <a id="61512" href="Demos.HSP.html#61485" class="Bound">q</a> <a id="61514" class="Keyword">where</a> <a id="61520" class="Keyword">open</a> <a id="61525" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="61537" href="Demos.HSP.html#61472" class="Bound">ğ‘¨</a>

</pre>
An important property of the binary relation \aof{âŠ§} is \emph{algebraic invariance} (i.e.,
invariance under isomorphism).  We formalize this result as follows.

<pre class="Agda">

<a id="61726" class="Keyword">module</a> <a id="61733" href="Demos.HSP.html#61733" class="Module">_</a> <a id="61735" class="Symbol">{</a><a id="61736" href="Demos.HSP.html#61736" class="Bound">X</a> <a id="61738" class="Symbol">:</a> <a id="61740" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="61745" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="61746" class="Symbol">}{</a><a id="61748" href="Demos.HSP.html#61748" class="Bound">ğ‘¨</a> <a id="61750" class="Symbol">:</a> <a id="61752" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="61760" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="61762" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="61764" class="Symbol">}(</a><a id="61766" href="Demos.HSP.html#61766" class="Bound">ğ‘©</a> <a id="61768" class="Symbol">:</a> <a id="61770" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="61778" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="61780" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="61782" class="Symbol">)(</a><a id="61784" href="Demos.HSP.html#61784" class="Bound">p</a> <a id="61786" href="Demos.HSP.html#61786" class="Bound">q</a> <a id="61788" class="Symbol">:</a> <a id="61790" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="61795" href="Demos.HSP.html#61736" class="Bound">X</a><a id="61796" class="Symbol">)</a> <a id="61798" class="Keyword">where</a>
 <a id="61805" href="Demos.HSP.html#61805" class="Function">âŠ§-I-invar</a> <a id="61815" class="Symbol">:</a> <a id="61817" href="Demos.HSP.html#61748" class="Bound">ğ‘¨</a> <a id="61819" href="Demos.HSP.html#60523" class="Function Operator">âŠ§</a> <a id="61821" href="Demos.HSP.html#61784" class="Bound">p</a> <a id="61823" href="Demos.HSP.html#60523" class="Function Operator">â‰ˆ</a> <a id="61825" href="Demos.HSP.html#61786" class="Bound">q</a>  <a id="61828" class="Symbol">â†’</a>  <a id="61831" href="Demos.HSP.html#61748" class="Bound">ğ‘¨</a> <a id="61833" href="Demos.HSP.html#41313" class="Record Operator">â‰…</a> <a id="61835" href="Demos.HSP.html#61766" class="Bound">ğ‘©</a>  <a id="61838" class="Symbol">â†’</a>  <a id="61841" href="Demos.HSP.html#61766" class="Bound">ğ‘©</a> <a id="61843" href="Demos.HSP.html#60523" class="Function Operator">âŠ§</a> <a id="61845" href="Demos.HSP.html#61784" class="Bound">p</a> <a id="61847" href="Demos.HSP.html#60523" class="Function Operator">â‰ˆ</a> <a id="61849" href="Demos.HSP.html#61786" class="Bound">q</a>
 <a id="61852" href="Demos.HSP.html#61805" class="Function">âŠ§-I-invar</a> <a id="61862" href="Demos.HSP.html#61862" class="Bound">Apq</a> <a id="61866" class="Symbol">(</a><a id="61867" href="Demos.HSP.html#41372" class="InductiveConstructor">mkiso</a> <a id="61873" href="Demos.HSP.html#61873" class="Bound">fh</a> <a id="61876" href="Demos.HSP.html#61876" class="Bound">gh</a> <a id="61879" href="Demos.HSP.html#61879" class="Bound">fâˆ¼g</a> <a id="61883" href="Demos.HSP.html#61883" class="Bound">gâˆ¼f</a><a id="61886" class="Symbol">)</a> <a id="61888" href="Demos.HSP.html#61888" class="Bound">Ï</a> <a id="61890" class="Symbol">=</a> <a id="61892" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>
  <a id="61900" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="61902" href="Demos.HSP.html#61784" class="Bound">p</a> <a id="61904" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a>     <a id="61910" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a>             <a id="61926" href="Demos.HSP.html#61888" class="Bound">Ï</a>    <a id="61931" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">â‰ˆË˜âŸ¨</a>  <a id="61936" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="61941" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="61943" href="Demos.HSP.html#61784" class="Bound">p</a> <a id="61945" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="61947" class="Symbol">(</a><a id="61948" href="Demos.HSP.html#61879" class="Bound">fâˆ¼g</a> <a id="61952" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="61954" href="Demos.HSP.html#61888" class="Bound">Ï</a><a id="61955" class="Symbol">)</a>        <a id="61964" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">âŸ©</a>
  <a id="61968" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="61970" href="Demos.HSP.html#61784" class="Bound">p</a> <a id="61972" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a>     <a id="61978" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="61982" class="Symbol">(</a><a id="61983" href="Demos.HSP.html#62290" class="Function">f</a> <a id="61985" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a>  <a id="61988" class="Symbol">(</a><a id="61989" href="Demos.HSP.html#62309" class="Function">g</a> <a id="61991" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a>  <a id="61994" href="Demos.HSP.html#61888" class="Bound">Ï</a><a id="61995" class="Symbol">))</a>  <a id="61999" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">â‰ˆË˜âŸ¨</a>  <a id="62004" href="Demos.HSP.html#58093" class="Function">comm-hom-term</a> <a id="62018" href="Demos.HSP.html#61873" class="Bound">fh</a> <a id="62021" href="Demos.HSP.html#61784" class="Bound">p</a> <a id="62023" class="Symbol">(</a><a id="62024" href="Demos.HSP.html#62309" class="Function">g</a> <a id="62026" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="62028" href="Demos.HSP.html#61888" class="Bound">Ï</a><a id="62029" class="Symbol">)</a>  <a id="62032" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">âŸ©</a>
  <a id="62036" href="Demos.HSP.html#62290" class="Function">f</a><a id="62037" class="Symbol">(</a><a id="62038" href="Demos.HSP.html#62382" class="Function Operator">âŸ¦</a> <a id="62040" href="Demos.HSP.html#61784" class="Bound">p</a> <a id="62042" href="Demos.HSP.html#62382" class="Function Operator">âŸ§á´¬</a>  <a id="62046" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a>       <a id="62056" class="Symbol">(</a><a id="62057" href="Demos.HSP.html#62309" class="Function">g</a> <a id="62059" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a>  <a id="62062" href="Demos.HSP.html#61888" class="Bound">Ï</a><a id="62063" class="Symbol">))</a>  <a id="62067" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a>   <a id="62072" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="62077" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="62079" href="Demos.HSP.html#61873" class="Bound">fh</a> <a id="62082" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="62084" class="Symbol">(</a><a id="62085" href="Demos.HSP.html#61862" class="Bound">Apq</a> <a id="62089" class="Symbol">(</a><a id="62090" href="Demos.HSP.html#62309" class="Function">g</a> <a id="62092" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="62094" href="Demos.HSP.html#61888" class="Bound">Ï</a><a id="62095" class="Symbol">))</a>   <a id="62100" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
  <a id="62104" href="Demos.HSP.html#62290" class="Function">f</a><a id="62105" class="Symbol">(</a><a id="62106" href="Demos.HSP.html#62382" class="Function Operator">âŸ¦</a> <a id="62108" href="Demos.HSP.html#61786" class="Bound">q</a> <a id="62110" href="Demos.HSP.html#62382" class="Function Operator">âŸ§á´¬</a>  <a id="62114" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a>       <a id="62124" class="Symbol">(</a><a id="62125" href="Demos.HSP.html#62309" class="Function">g</a> <a id="62127" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a>  <a id="62130" href="Demos.HSP.html#61888" class="Bound">Ï</a><a id="62131" class="Symbol">))</a>  <a id="62135" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a>   <a id="62140" href="Demos.HSP.html#58093" class="Function">comm-hom-term</a> <a id="62154" href="Demos.HSP.html#61873" class="Bound">fh</a> <a id="62157" href="Demos.HSP.html#61786" class="Bound">q</a> <a id="62159" class="Symbol">(</a><a id="62160" href="Demos.HSP.html#62309" class="Function">g</a> <a id="62162" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="62164" href="Demos.HSP.html#61888" class="Bound">Ï</a><a id="62165" class="Symbol">)</a>  <a id="62168" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
  <a id="62172" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="62174" href="Demos.HSP.html#61786" class="Bound">q</a> <a id="62176" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a>     <a id="62182" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="62186" class="Symbol">(</a><a id="62187" href="Demos.HSP.html#62290" class="Function">f</a> <a id="62189" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a>  <a id="62192" class="Symbol">(</a><a id="62193" href="Demos.HSP.html#62309" class="Function">g</a> <a id="62195" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a>  <a id="62198" href="Demos.HSP.html#61888" class="Bound">Ï</a><a id="62199" class="Symbol">))</a>  <a id="62203" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a>   <a id="62208" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="62213" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="62215" href="Demos.HSP.html#61786" class="Bound">q</a> <a id="62217" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="62219" class="Symbol">(</a><a id="62220" href="Demos.HSP.html#61879" class="Bound">fâˆ¼g</a> <a id="62224" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="62226" href="Demos.HSP.html#61888" class="Bound">Ï</a><a id="62227" class="Symbol">)</a>        <a id="62236" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
  <a id="62240" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="62242" href="Demos.HSP.html#61786" class="Bound">q</a> <a id="62244" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a>     <a id="62250" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a>             <a id="62266" href="Demos.HSP.html#61888" class="Bound">Ï</a>    <a id="62271" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">âˆ</a>
  <a id="62275" class="Keyword">where</a>  <a id="62282" class="Keyword">private</a> <a id="62290" href="Demos.HSP.html#62290" class="Function">f</a> <a id="62292" class="Symbol">=</a> <a id="62294" href="Demos.HSP.html#8606" class="Field Operator">_âŸ¨$âŸ©_</a> <a id="62300" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="62302" href="Demos.HSP.html#61873" class="Bound">fh</a> <a id="62305" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="62307" class="Symbol">;</a> <a id="62309" href="Demos.HSP.html#62309" class="Function">g</a> <a id="62311" class="Symbol">=</a> <a id="62313" href="Demos.HSP.html#8606" class="Field Operator">_âŸ¨$âŸ©_</a> <a id="62319" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="62321" href="Demos.HSP.html#61876" class="Bound">gh</a> <a id="62324" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>
         <a id="62335" class="Keyword">open</a> <a id="62340" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="62352" href="Demos.HSP.html#61748" class="Bound">ğ‘¨</a>  <a id="62355" class="Keyword">using</a> <a id="62361" class="Symbol">()</a> <a id="62364" class="Keyword">renaming</a> <a id="62373" class="Symbol">(</a> <a id="62375" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="62379" class="Symbol">to</a> <a id="62382" class="Function Operator">âŸ¦_âŸ§á´¬</a> <a id="62387" class="Symbol">)</a>
         <a id="62398" class="Keyword">open</a> <a id="62403" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="62415" href="Demos.HSP.html#61766" class="Bound">ğ‘©</a>  <a id="62418" class="Keyword">using</a> <a id="62424" class="Symbol">(</a> <a id="62426" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="62430" class="Symbol">)</a> <a id="62432" class="Symbol">;</a> <a id="62434" class="Keyword">open</a> <a id="62439" href="Relation.Binary.Reasoning.Setoid.html" class="Module">SetoidReasoning</a> <a id="62455" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="62458" href="Demos.HSP.html#61766" class="Bound">ğ‘©</a> <a id="62460" href="Demos.HSP.html#25499" class="Function Operator">]</a>

</pre>
If \ab{ğ’¦} is a class of \ab{ğ‘†}-algebras, the set of identities modeled by \ab{ğ’¦}, denoted \af{Th}~\ab{ğ’¦}, is called the \defn{equational theory} of \ab{ğ’¦}. If \ab{â„°} is a set of \ab{ğ‘†}-term identities,
the class of algebras modeling \ab{â„°}, denoted \af{Mod}~\ab{â„°}, is called the \defn{equational class axiomatized} by \ab{â„°}. We codify these notions in the next two definitions.

<pre class="Agda">

<a id="Th"></a><a id="62869" href="Demos.HSP.html#62869" class="Function">Th</a> <a id="62872" class="Symbol">:</a> <a id="62874" class="Symbol">{</a><a id="62875" href="Demos.HSP.html#62875" class="Bound">X</a> <a id="62877" class="Symbol">:</a> <a id="62879" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="62884" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="62885" class="Symbol">}</a> <a id="62887" class="Symbol">â†’</a> <a id="62889" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="62894" class="Symbol">(</a><a id="62895" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="62903" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="62905" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="62907" class="Symbol">)</a> <a id="62909" href="Demos.HSP.html#9462" class="Generalizable">â„“</a> <a id="62911" class="Symbol">â†’</a> <a id="62913" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="62917" class="Symbol">(</a><a id="62918" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="62923" href="Demos.HSP.html#62875" class="Bound">X</a> <a id="62925" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="62927" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="62932" href="Demos.HSP.html#62875" class="Bound">X</a><a id="62933" class="Symbol">)</a> <a id="62935" class="Symbol">_</a>
<a id="62937" href="Demos.HSP.html#62869" class="Function">Th</a> <a id="62940" href="Demos.HSP.html#62940" class="Bound">ğ’¦</a> <a id="62942" class="Symbol">=</a> <a id="62944" class="Symbol">Î»</a> <a id="62946" class="Symbol">(</a><a id="62947" href="Demos.HSP.html#62947" class="Bound">p</a> <a id="62949" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="62951" href="Demos.HSP.html#62951" class="Bound">q</a><a id="62952" class="Symbol">)</a> <a id="62954" class="Symbol">â†’</a> <a id="62956" href="Demos.HSP.html#62940" class="Bound">ğ’¦</a> <a id="62958" href="Demos.HSP.html#60621" class="Function Operator">âŠ«</a> <a id="62960" href="Demos.HSP.html#62947" class="Bound">p</a> <a id="62962" href="Demos.HSP.html#60621" class="Function Operator">â‰ˆ</a> <a id="62964" href="Demos.HSP.html#62951" class="Bound">q</a>

<a id="Mod"></a><a id="62967" href="Demos.HSP.html#62967" class="Function">Mod</a> <a id="62971" class="Symbol">:</a> <a id="62973" class="Symbol">{</a><a id="62974" href="Demos.HSP.html#62974" class="Bound">X</a> <a id="62976" class="Symbol">:</a> <a id="62978" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="62983" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="62984" class="Symbol">}</a> <a id="62986" class="Symbol">â†’</a> <a id="62988" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="62992" class="Symbol">(</a><a id="62993" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="62998" href="Demos.HSP.html#62974" class="Bound">X</a> <a id="63000" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="63002" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="63007" href="Demos.HSP.html#62974" class="Bound">X</a><a id="63008" class="Symbol">)</a> <a id="63010" href="Demos.HSP.html#9462" class="Generalizable">â„“</a> <a id="63012" class="Symbol">â†’</a> <a id="63014" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="63019" class="Symbol">(</a><a id="63020" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="63028" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="63030" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="63032" class="Symbol">)</a> <a id="63034" class="Symbol">_</a>
<a id="63036" href="Demos.HSP.html#62967" class="Function">Mod</a> <a id="63040" href="Demos.HSP.html#63040" class="Bound">â„°</a> <a id="63042" href="Demos.HSP.html#63042" class="Bound">ğ‘¨</a> <a id="63044" class="Symbol">=</a> <a id="63046" class="Symbol">âˆ€</a> <a id="63048" class="Symbol">{</a><a id="63049" href="Demos.HSP.html#63049" class="Bound">p</a> <a id="63051" href="Demos.HSP.html#63051" class="Bound">q</a><a id="63052" class="Symbol">}</a> <a id="63054" class="Symbol">â†’</a> <a id="63056" class="Symbol">(</a><a id="63057" href="Demos.HSP.html#63049" class="Bound">p</a> <a id="63059" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="63061" href="Demos.HSP.html#63051" class="Bound">q</a><a id="63062" class="Symbol">)</a> <a id="63064" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="63066" href="Demos.HSP.html#63040" class="Bound">â„°</a> <a id="63068" class="Symbol">â†’</a> <a id="63070" href="Demos.HSP.html#55796" class="Function">Equal</a> <a id="63076" href="Demos.HSP.html#63049" class="Bound">p</a> <a id="63078" href="Demos.HSP.html#63051" class="Bound">q</a> <a id="63080" class="Keyword">where</a> <a id="63086" class="Keyword">open</a> <a id="63091" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="63103" href="Demos.HSP.html#63042" class="Bound">ğ‘¨</a>
</pre>

\begin{comment}
\paragraph*{Entailment}
If \ab{â„°} is a set of identities and \ab{p} and \ab{q} are terms,
we say that \ab{â„°} \defn{entails} \ab{p}~\aof{â‰ˆ}~\ab{q} and write
\ab{â„°}~\ad{âŠ¢}~\ab{p}~\ad{â‰ˆ}~\ab{q} just in case every model of \ab{â„°} also models
\ab{p}~\aof{â‰ˆ}~\ab{q}.
We base our definition of \defn{entailment type} on the one in~\cite{Abel:2021}.  It contains cases for representing hypotheses, congruence of term
application, that substitution respects entailment, and that entailment is
an equivalence.
begin{code}
end{code}
The fact that this represents the informal semantic notion of entailment given earlier is called \defn{soundness} and \defn{completeness}. More precisely, \defn{the entailment type is sound} means that \ab{â„°}~\ad{âŠ¢}~\ab{X}~\ad{â–¹}~\ab p~\ad{â‰ˆ}~\ab q only if \ab p \aof{â‰ˆ} \ab q in every model of \ab{â„°}. \defn{The entailment type is complete} means \ab p \aof{â‰ˆ} \ab q in every model of \ab{â„°} only if \ab{â„°}~\ad{âŠ¢}~\ab{X}~\ad{â–¹}~\ab p~\aof{â‰ˆ}~\ab q.
We will use soundness of entailment only once below~(by the name \af{sound}), so we omit its proof (but see~\cite{Abel:2021} for details).
\end{comment}

%% -----------------------------------------------------------------------------
\paragraph*{The Closure Operators H, S, P and V}
Fix a signature \ab{ğ‘†}, let \ab{ğ’¦} be a class of \ab{ğ‘†}-algebras, and define
\begin{itemize}
\item \af H \ab{ğ’¦} := the class of all homomorphic images of members of \ab{ğ’¦};
\item \af S \ab{ğ’¦} := the class of all subalgebras of members of \ab{ğ’¦};
\item \af P \ab{ğ’¦} := the class of all products of members of \ab{ğ’¦}.
\end{itemize}
\af H, \af S, and \af P are \emph{closure operators} (expansive, monotone, and
idempotent).  A class \ab{ğ’¦} of \ab{ğ‘†}-algebras is said to be \emph{closed under
the taking of homomorphic images} provided \af H \ab{ğ’¦} \aof{âŠ†} \ab{ğ’¦}. Similarly, \ab{ğ’¦} is
\emph{closed under the taking of subalgebras} (resp., \emph{arbitrary products}) provided
\af S~\ab{ğ’¦}~\aof{âŠ†}~\ab{ğ’¦} (resp., \af P \ab{ğ’¦} \aof{âŠ†} \ab{ğ’¦}). The operators \af H, \af
S, and \af P can be composed with one another repeatedly, forming yet more closure
operators. We represent these three closure operators in type theory as follows.

\begin{comment}
An algebra is a homomorphic image (resp., subalgebra; resp., product) of every algebra to which it is isomorphic.
Thus, the class \af H \ab{ğ’¦} (resp., \af S \ab{ğ’¦}; resp., \af P \ab{ğ’¦}) is closed under isomorphism.
We now define the type \af H to represent classes of algebras that include all homomorphic images
of algebras in the class---i.e., classes that are closed under the taking of homomorphic
images---the type \af S to represent classes of algebras that closed under the taking of subalgebras,
and the type \af P to represent classes of algebras closed under the taking of arbitrary products.
\end{comment}

<pre class="Agda">

<a id="65966" class="Keyword">module</a> <a id="65973" href="Demos.HSP.html#65973" class="Module">_</a> <a id="65975" class="Symbol">{</a><a id="65976" href="Demos.HSP.html#65976" class="Bound">Î±</a> <a id="65978" href="Demos.HSP.html#65978" class="Bound">Ïáµƒ</a> <a id="65981" href="Demos.HSP.html#65981" class="Bound">Î²</a> <a id="65983" href="Demos.HSP.html#65983" class="Bound">Ïáµ‡</a> <a id="65986" class="Symbol">:</a> <a id="65988" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="65993" class="Symbol">}</a> <a id="65995" class="Keyword">where</a>
 <a id="66002" class="Keyword">private</a> <a id="66010" href="Demos.HSP.html#66010" class="Function">a</a> <a id="66012" class="Symbol">=</a> <a id="66014" href="Demos.HSP.html#65976" class="Bound">Î±</a> <a id="66016" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="66018" href="Demos.HSP.html#65978" class="Bound">Ïáµƒ</a>
 <a id="66022" href="Demos.HSP.html#66022" class="Function">H</a> <a id="66024" class="Symbol">:</a> <a id="66026" class="Symbol">âˆ€</a> <a id="66028" href="Demos.HSP.html#66028" class="Bound">â„“</a> <a id="66030" class="Symbol">â†’</a> <a id="66032" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="66036" class="Symbol">(</a><a id="66037" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="66045" href="Demos.HSP.html#65976" class="Bound">Î±</a> <a id="66047" href="Demos.HSP.html#65978" class="Bound">Ïáµƒ</a><a id="66049" class="Symbol">)</a> <a id="66051" class="Symbol">(</a><a id="66052" href="Demos.HSP.html#66010" class="Function">a</a> <a id="66054" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="66056" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="66059" href="Demos.HSP.html#66028" class="Bound">â„“</a><a id="66060" class="Symbol">)</a> <a id="66062" class="Symbol">â†’</a> <a id="66064" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="66068" class="Symbol">(</a><a id="66069" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="66077" href="Demos.HSP.html#65981" class="Bound">Î²</a> <a id="66079" href="Demos.HSP.html#65983" class="Bound">Ïáµ‡</a><a id="66081" class="Symbol">)</a> <a id="66083" class="Symbol">_</a>
 <a id="66086" href="Demos.HSP.html#66022" class="Function">H</a> <a id="66088" class="Symbol">_</a> <a id="66090" href="Demos.HSP.html#66090" class="Bound">ğ’¦</a> <a id="66092" href="Demos.HSP.html#66092" class="Bound">ğ‘©</a> <a id="66094" class="Symbol">=</a> <a id="66096" href="Data.Product.html#916" class="Function">Î£[</a> <a id="66099" href="Demos.HSP.html#66099" class="Bound">ğ‘¨</a> <a id="66101" href="Data.Product.html#916" class="Function">âˆˆ</a> <a id="66103" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="66111" href="Demos.HSP.html#65976" class="Bound">Î±</a> <a id="66113" href="Demos.HSP.html#65978" class="Bound">Ïáµƒ</a> <a id="66116" href="Data.Product.html#916" class="Function">]</a> <a id="66118" href="Demos.HSP.html#66099" class="Bound">ğ‘¨</a> <a id="66120" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="66122" href="Demos.HSP.html#66090" class="Bound">ğ’¦</a> <a id="66124" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="66126" href="Demos.HSP.html#66092" class="Bound">ğ‘©</a> <a id="66128" href="Demos.HSP.html#43774" class="Function Operator">IsHomImageOf</a> <a id="66141" href="Demos.HSP.html#66099" class="Bound">ğ‘¨</a>

 <a id="66145" href="Demos.HSP.html#66145" class="Function">S</a> <a id="66147" class="Symbol">:</a> <a id="66149" class="Symbol">âˆ€</a> <a id="66151" href="Demos.HSP.html#66151" class="Bound">â„“</a> <a id="66153" class="Symbol">â†’</a> <a id="66155" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="66159" class="Symbol">(</a><a id="66160" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="66168" href="Demos.HSP.html#65976" class="Bound">Î±</a> <a id="66170" href="Demos.HSP.html#65978" class="Bound">Ïáµƒ</a><a id="66172" class="Symbol">)</a> <a id="66174" class="Symbol">(</a><a id="66175" href="Demos.HSP.html#66010" class="Function">a</a> <a id="66177" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="66179" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="66182" href="Demos.HSP.html#66151" class="Bound">â„“</a><a id="66183" class="Symbol">)</a> <a id="66185" class="Symbol">â†’</a> <a id="66187" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="66191" class="Symbol">(</a><a id="66192" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="66200" href="Demos.HSP.html#65981" class="Bound">Î²</a> <a id="66202" href="Demos.HSP.html#65983" class="Bound">Ïáµ‡</a><a id="66204" class="Symbol">)</a> <a id="66206" class="Symbol">_</a>
 <a id="66209" href="Demos.HSP.html#66145" class="Function">S</a> <a id="66211" class="Symbol">_</a> <a id="66213" href="Demos.HSP.html#66213" class="Bound">ğ’¦</a> <a id="66215" href="Demos.HSP.html#66215" class="Bound">ğ‘©</a> <a id="66217" class="Symbol">=</a> <a id="66219" href="Data.Product.html#916" class="Function">Î£[</a> <a id="66222" href="Demos.HSP.html#66222" class="Bound">ğ‘¨</a> <a id="66224" href="Data.Product.html#916" class="Function">âˆˆ</a> <a id="66226" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="66234" href="Demos.HSP.html#65976" class="Bound">Î±</a> <a id="66236" href="Demos.HSP.html#65978" class="Bound">Ïáµƒ</a> <a id="66239" href="Data.Product.html#916" class="Function">]</a> <a id="66241" href="Demos.HSP.html#66222" class="Bound">ğ‘¨</a> <a id="66243" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="66245" href="Demos.HSP.html#66213" class="Bound">ğ’¦</a> <a id="66247" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="66249" href="Demos.HSP.html#66215" class="Bound">ğ‘©</a> <a id="66251" href="Demos.HSP.html#47658" class="Function Operator">â‰¤</a> <a id="66253" href="Demos.HSP.html#66222" class="Bound">ğ‘¨</a>

 <a id="66257" href="Demos.HSP.html#66257" class="Function">P</a> <a id="66259" class="Symbol">:</a> <a id="66261" class="Symbol">âˆ€</a> <a id="66263" href="Demos.HSP.html#66263" class="Bound">â„“</a> <a id="66265" href="Demos.HSP.html#66265" class="Bound">Î¹</a> <a id="66267" class="Symbol">â†’</a> <a id="66269" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="66273" class="Symbol">(</a><a id="66274" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="66282" href="Demos.HSP.html#65976" class="Bound">Î±</a> <a id="66284" href="Demos.HSP.html#65978" class="Bound">Ïáµƒ</a><a id="66286" class="Symbol">)</a> <a id="66288" class="Symbol">(</a><a id="66289" href="Demos.HSP.html#66010" class="Function">a</a> <a id="66291" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="66293" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="66296" href="Demos.HSP.html#66263" class="Bound">â„“</a><a id="66297" class="Symbol">)</a> <a id="66299" class="Symbol">â†’</a> <a id="66301" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="66305" class="Symbol">(</a><a id="66306" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="66314" href="Demos.HSP.html#65981" class="Bound">Î²</a> <a id="66316" href="Demos.HSP.html#65983" class="Bound">Ïáµ‡</a><a id="66318" class="Symbol">)</a> <a id="66320" class="Symbol">_</a>
 <a id="66323" href="Demos.HSP.html#66257" class="Function">P</a> <a id="66325" class="Symbol">_</a> <a id="66327" href="Demos.HSP.html#66327" class="Bound">Î¹</a> <a id="66329" href="Demos.HSP.html#66329" class="Bound">ğ’¦</a> <a id="66331" href="Demos.HSP.html#66331" class="Bound">ğ‘©</a> <a id="66333" class="Symbol">=</a> <a id="66335" href="Data.Product.html#916" class="Function">Î£[</a> <a id="66338" href="Demos.HSP.html#66338" class="Bound">I</a> <a id="66340" href="Data.Product.html#916" class="Function">âˆˆ</a> <a id="66342" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="66347" href="Demos.HSP.html#66327" class="Bound">Î¹</a> <a id="66349" href="Data.Product.html#916" class="Function">]</a> <a id="66351" class="Symbol">(</a><a id="66352" href="Data.Product.html#916" class="Function">Î£[</a> <a id="66355" href="Demos.HSP.html#66355" class="Bound">ğ’œ</a> <a id="66357" href="Data.Product.html#916" class="Function">âˆˆ</a> <a id="66359" class="Symbol">(</a><a id="66360" href="Demos.HSP.html#66338" class="Bound">I</a> <a id="66362" class="Symbol">â†’</a> <a id="66364" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="66372" href="Demos.HSP.html#65976" class="Bound">Î±</a> <a id="66374" href="Demos.HSP.html#65978" class="Bound">Ïáµƒ</a><a id="66376" class="Symbol">)</a> <a id="66378" href="Data.Product.html#916" class="Function">]</a> <a id="66380" class="Symbol">(âˆ€</a> <a id="66383" href="Demos.HSP.html#66383" class="Bound">i</a> <a id="66385" class="Symbol">â†’</a> <a id="66387" href="Demos.HSP.html#66355" class="Bound">ğ’œ</a> <a id="66389" href="Demos.HSP.html#66383" class="Bound">i</a> <a id="66391" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="66393" href="Demos.HSP.html#66329" class="Bound">ğ’¦</a><a id="66394" class="Symbol">)</a> <a id="66396" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="66398" class="Symbol">(</a><a id="66399" href="Demos.HSP.html#66331" class="Bound">ğ‘©</a> <a id="66401" href="Demos.HSP.html#41313" class="Record Operator">â‰…</a> <a id="66403" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="66405" href="Demos.HSP.html#66355" class="Bound">ğ’œ</a><a id="66406" class="Symbol">))</a>

</pre>
Identities modeled by an algebra \ab{ğ‘¨} are also modeled by every homomorphic image of
\ab{ğ‘¨} and by every subalgebra of \ab{ğ‘¨}.
\ifshort
We refer to these facts as \af{âŠ§-H-invar} and \af{âŠ§-S-invar}; their
definitions are similar to that of \af{âŠ§-I-invar}.
\else
These facts are formalized in \agda as follows.

<pre class="Agda">

<a id="66747" class="Keyword">module</a> <a id="66754" href="Demos.HSP.html#66754" class="Module">_</a> <a id="66756" class="Symbol">{</a><a id="66757" href="Demos.HSP.html#66757" class="Bound">X</a> <a id="66759" class="Symbol">:</a> <a id="66761" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="66766" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="66767" class="Symbol">}{</a><a id="66769" href="Demos.HSP.html#66769" class="Bound">ğ‘¨</a> <a id="66771" class="Symbol">:</a> <a id="66773" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="66781" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="66783" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="66785" class="Symbol">}{</a><a id="66787" href="Demos.HSP.html#66787" class="Bound">ğ‘©</a> <a id="66789" class="Symbol">:</a> <a id="66791" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="66799" href="Demos.HSP.html#9443" class="Generalizable">Î²</a> <a id="66801" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="66803" class="Symbol">}{</a><a id="66805" href="Demos.HSP.html#66805" class="Bound">p</a> <a id="66807" href="Demos.HSP.html#66807" class="Bound">q</a> <a id="66809" class="Symbol">:</a> <a id="66811" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="66816" href="Demos.HSP.html#66757" class="Bound">X</a><a id="66817" class="Symbol">}</a> <a id="66819" class="Keyword">where</a>
 <a id="66826" href="Demos.HSP.html#66826" class="Function">âŠ§-H-invar</a> <a id="66836" class="Symbol">:</a> <a id="66838" href="Demos.HSP.html#66769" class="Bound">ğ‘¨</a> <a id="66840" href="Demos.HSP.html#60523" class="Function Operator">âŠ§</a> <a id="66842" href="Demos.HSP.html#66805" class="Bound">p</a> <a id="66844" href="Demos.HSP.html#60523" class="Function Operator">â‰ˆ</a> <a id="66846" href="Demos.HSP.html#66807" class="Bound">q</a> <a id="66848" class="Symbol">â†’</a> <a id="66850" href="Demos.HSP.html#66787" class="Bound">ğ‘©</a> <a id="66852" href="Demos.HSP.html#43774" class="Function Operator">IsHomImageOf</a> <a id="66865" href="Demos.HSP.html#66769" class="Bound">ğ‘¨</a> <a id="66867" class="Symbol">â†’</a> <a id="66869" href="Demos.HSP.html#66787" class="Bound">ğ‘©</a> <a id="66871" href="Demos.HSP.html#60523" class="Function Operator">âŠ§</a> <a id="66873" href="Demos.HSP.html#66805" class="Bound">p</a> <a id="66875" href="Demos.HSP.html#60523" class="Function Operator">â‰ˆ</a> <a id="66877" href="Demos.HSP.html#66807" class="Bound">q</a>
 <a id="66880" href="Demos.HSP.html#66826" class="Function">âŠ§-H-invar</a> <a id="66890" href="Demos.HSP.html#66890" class="Bound">Apq</a> <a id="66894" class="Symbol">(</a><a id="66895" href="Demos.HSP.html#66895" class="Bound">Ï†h</a> <a id="66898" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="66900" href="Demos.HSP.html#66900" class="Bound">Ï†E</a><a id="66902" class="Symbol">)</a> <a id="66904" href="Demos.HSP.html#66904" class="Bound">Ï</a> <a id="66906" class="Symbol">=</a> <a id="66908" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>
       <a id="66921" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="66923" href="Demos.HSP.html#66805" class="Bound">p</a> <a id="66925" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a>   <a id="66929" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a>               <a id="66947" href="Demos.HSP.html#66904" class="Bound">Ï</a>    <a id="66952" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">â‰ˆË˜âŸ¨</a>  <a id="66957" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="66962" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="66964" href="Demos.HSP.html#66805" class="Bound">p</a> <a id="66966" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a><a id="66967" class="Symbol">(Î»</a> <a id="66970" href="Demos.HSP.html#66970" class="Bound">_</a> <a id="66972" class="Symbol">â†’</a> <a id="66974" href="Demos.HSP.html#14110" class="Function">InvIsInverseÊ³</a> <a id="66988" href="Demos.HSP.html#66900" class="Bound">Ï†E</a><a id="66990" class="Symbol">)</a>  <a id="66993" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">âŸ©</a>
       <a id="67002" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="67004" href="Demos.HSP.html#66805" class="Bound">p</a> <a id="67006" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a>   <a id="67010" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="67014" class="Symbol">(</a><a id="67015" href="Demos.HSP.html#67428" class="Function">Ï†</a> <a id="67017" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a>  <a id="67020" href="Demos.HSP.html#67368" class="Function">Ï†â»Â¹</a>  <a id="67025" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a>  <a id="67028" href="Demos.HSP.html#66904" class="Bound">Ï</a><a id="67029" class="Symbol">)</a>   <a id="67033" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">â‰ˆË˜âŸ¨</a>  <a id="67038" href="Demos.HSP.html#58093" class="Function">comm-hom-term</a> <a id="67052" href="Demos.HSP.html#66895" class="Bound">Ï†h</a> <a id="67055" href="Demos.HSP.html#66805" class="Bound">p</a> <a id="67057" class="Symbol">(</a><a id="67058" href="Demos.HSP.html#67368" class="Function">Ï†â»Â¹</a> <a id="67062" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="67064" href="Demos.HSP.html#66904" class="Bound">Ï</a><a id="67065" class="Symbol">)</a>        <a id="67074" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">âŸ©</a>
   <a id="67079" href="Demos.HSP.html#67428" class="Function">Ï†</a><a id="67080" class="Symbol">(</a>  <a id="67083" href="Demos.HSP.html#67497" class="Function Operator">âŸ¦</a> <a id="67085" href="Demos.HSP.html#66805" class="Bound">p</a> <a id="67087" href="Demos.HSP.html#67497" class="Function Operator">âŸ§á´¬</a>  <a id="67091" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="67095" class="Symbol">(</a>     <a id="67101" href="Demos.HSP.html#67368" class="Function">Ï†â»Â¹</a>  <a id="67106" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a>  <a id="67109" href="Demos.HSP.html#66904" class="Bound">Ï</a><a id="67110" class="Symbol">))</a>  <a id="67114" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a>   <a id="67119" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="67124" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="67126" href="Demos.HSP.html#66895" class="Bound">Ï†h</a> <a id="67129" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="67131" class="Symbol">(</a><a id="67132" href="Demos.HSP.html#66890" class="Bound">Apq</a> <a id="67136" class="Symbol">(</a><a id="67137" href="Demos.HSP.html#67368" class="Function">Ï†â»Â¹</a> <a id="67141" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="67143" href="Demos.HSP.html#66904" class="Bound">Ï</a><a id="67144" class="Symbol">))</a>         <a id="67155" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
   <a id="67160" href="Demos.HSP.html#67428" class="Function">Ï†</a><a id="67161" class="Symbol">(</a>  <a id="67164" href="Demos.HSP.html#67497" class="Function Operator">âŸ¦</a> <a id="67166" href="Demos.HSP.html#66807" class="Bound">q</a> <a id="67168" href="Demos.HSP.html#67497" class="Function Operator">âŸ§á´¬</a>  <a id="67172" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="67176" class="Symbol">(</a>     <a id="67182" href="Demos.HSP.html#67368" class="Function">Ï†â»Â¹</a>  <a id="67187" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a>  <a id="67190" href="Demos.HSP.html#66904" class="Bound">Ï</a><a id="67191" class="Symbol">))</a>  <a id="67195" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a>   <a id="67200" href="Demos.HSP.html#58093" class="Function">comm-hom-term</a> <a id="67214" href="Demos.HSP.html#66895" class="Bound">Ï†h</a> <a id="67217" href="Demos.HSP.html#66807" class="Bound">q</a> <a id="67219" class="Symbol">(</a><a id="67220" href="Demos.HSP.html#67368" class="Function">Ï†â»Â¹</a> <a id="67224" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="67226" href="Demos.HSP.html#66904" class="Bound">Ï</a><a id="67227" class="Symbol">)</a>        <a id="67236" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
       <a id="67245" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="67247" href="Demos.HSP.html#66807" class="Bound">q</a> <a id="67249" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a>   <a id="67253" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="67257" class="Symbol">(</a><a id="67258" href="Demos.HSP.html#67428" class="Function">Ï†</a> <a id="67260" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a>  <a id="67263" href="Demos.HSP.html#67368" class="Function">Ï†â»Â¹</a>  <a id="67268" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a>  <a id="67271" href="Demos.HSP.html#66904" class="Bound">Ï</a><a id="67272" class="Symbol">)</a>   <a id="67276" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a>   <a id="67281" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="67286" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="67288" href="Demos.HSP.html#66807" class="Bound">q</a> <a id="67290" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a><a id="67291" class="Symbol">(Î»</a> <a id="67294" href="Demos.HSP.html#67294" class="Bound">_</a> <a id="67296" class="Symbol">â†’</a> <a id="67298" href="Demos.HSP.html#14110" class="Function">InvIsInverseÊ³</a> <a id="67312" href="Demos.HSP.html#66900" class="Bound">Ï†E</a><a id="67314" class="Symbol">)</a>  <a id="67317" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
       <a id="67326" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="67328" href="Demos.HSP.html#66807" class="Bound">q</a> <a id="67330" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a>   <a id="67334" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a>               <a id="67352" href="Demos.HSP.html#66904" class="Bound">Ï</a>    <a id="67357" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">âˆ</a> <a id="67359" class="Keyword">where</a>
   <a id="67368" href="Demos.HSP.html#67368" class="Function">Ï†â»Â¹</a> <a id="67372" class="Symbol">:</a> <a id="67374" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="67377" href="Demos.HSP.html#66787" class="Bound">ğ‘©</a> <a id="67379" href="Demos.HSP.html#25552" class="Function Operator">]</a> <a id="67381" class="Symbol">â†’</a> <a id="67383" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="67386" href="Demos.HSP.html#66769" class="Bound">ğ‘¨</a> <a id="67388" href="Demos.HSP.html#25552" class="Function Operator">]</a>
   <a id="67393" href="Demos.HSP.html#67368" class="Function">Ï†â»Â¹</a> <a id="67397" class="Symbol">=</a> <a id="67399" href="Demos.HSP.html#15704" class="Function">SurjInv</a> <a id="67407" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="67409" href="Demos.HSP.html#66895" class="Bound">Ï†h</a> <a id="67412" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="67414" href="Demos.HSP.html#66900" class="Bound">Ï†E</a>
   <a id="67420" class="Keyword">private</a> <a id="67428" href="Demos.HSP.html#67428" class="Function">Ï†</a> <a id="67430" class="Symbol">=</a> <a id="67432" class="Symbol">(</a><a id="67433" href="Demos.HSP.html#8606" class="Field Operator">_âŸ¨$âŸ©_</a> <a id="67439" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="67441" href="Demos.HSP.html#66895" class="Bound">Ï†h</a> <a id="67444" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a><a id="67445" class="Symbol">)</a>
   <a id="67450" class="Keyword">open</a> <a id="67455" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="67467" href="Demos.HSP.html#66769" class="Bound">ğ‘¨</a>  <a id="67470" class="Keyword">using</a> <a id="67476" class="Symbol">()</a> <a id="67479" class="Keyword">renaming</a> <a id="67488" class="Symbol">(</a> <a id="67490" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="67494" class="Symbol">to</a> <a id="67497" class="Function Operator">âŸ¦_âŸ§á´¬</a><a id="67501" class="Symbol">)</a>
   <a id="67506" class="Keyword">open</a> <a id="67511" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="67523" href="Demos.HSP.html#66787" class="Bound">ğ‘©</a>  <a id="67526" class="Keyword">using</a> <a id="67532" class="Symbol">(</a> <a id="67534" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="67538" class="Symbol">)</a> <a id="67540" class="Symbol">;</a> <a id="67542" class="Keyword">open</a> <a id="67547" href="Relation.Binary.Reasoning.Setoid.html" class="Module">SetoidReasoning</a> <a id="67563" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="67566" href="Demos.HSP.html#66787" class="Bound">ğ‘©</a> <a id="67568" href="Demos.HSP.html#25499" class="Function Operator">]</a>

 <a id="67572" href="Demos.HSP.html#67572" class="Function">âŠ§-S-invar</a> <a id="67582" class="Symbol">:</a> <a id="67584" href="Demos.HSP.html#66769" class="Bound">ğ‘¨</a> <a id="67586" href="Demos.HSP.html#60523" class="Function Operator">âŠ§</a> <a id="67588" href="Demos.HSP.html#66805" class="Bound">p</a> <a id="67590" href="Demos.HSP.html#60523" class="Function Operator">â‰ˆ</a> <a id="67592" href="Demos.HSP.html#66807" class="Bound">q</a> <a id="67594" class="Symbol">â†’</a> <a id="67596" href="Demos.HSP.html#66787" class="Bound">ğ‘©</a> <a id="67598" href="Demos.HSP.html#47658" class="Function Operator">â‰¤</a> <a id="67600" href="Demos.HSP.html#66769" class="Bound">ğ‘¨</a> <a id="67602" class="Symbol">â†’</a> <a id="67604" href="Demos.HSP.html#66787" class="Bound">ğ‘©</a> <a id="67606" href="Demos.HSP.html#60523" class="Function Operator">âŠ§</a> <a id="67608" href="Demos.HSP.html#66805" class="Bound">p</a> <a id="67610" href="Demos.HSP.html#60523" class="Function Operator">â‰ˆ</a> <a id="67612" href="Demos.HSP.html#66807" class="Bound">q</a>
 <a id="67615" href="Demos.HSP.html#67572" class="Function">âŠ§-S-invar</a> <a id="67625" href="Demos.HSP.html#67625" class="Bound">Apq</a> <a id="67629" href="Demos.HSP.html#67629" class="Bound">Bâ‰¤A</a> <a id="67633" href="Demos.HSP.html#67633" class="Bound">b</a> <a id="67635" class="Symbol">=</a> <a id="67637" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="67639" href="Demos.HSP.html#67629" class="Bound">Bâ‰¤A</a> <a id="67643" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a>
  <a id="67647" class="Symbol">(</a> <a id="67649" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>
    <a id="67659" href="Demos.HSP.html#68061" class="Function">h</a> <a id="67661" class="Symbol">(</a>  <a id="67664" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="67666" href="Demos.HSP.html#66805" class="Bound">p</a> <a id="67668" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a>   <a id="67672" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a>       <a id="67682" href="Demos.HSP.html#67633" class="Bound">b</a><a id="67683" class="Symbol">)</a>  <a id="67686" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a>   <a id="67691" href="Demos.HSP.html#58093" class="Function">comm-hom-term</a> <a id="67705" href="Demos.HSP.html#68046" class="Function">hh</a> <a id="67708" href="Demos.HSP.html#66805" class="Bound">p</a> <a id="67710" href="Demos.HSP.html#67633" class="Bound">b</a>  <a id="67713" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
         <a id="67724" href="Demos.HSP.html#67993" class="Function Operator">âŸ¦</a> <a id="67726" href="Demos.HSP.html#66805" class="Bound">p</a> <a id="67728" href="Demos.HSP.html#67993" class="Function Operator">âŸ§á´¬</a>  <a id="67732" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="67736" class="Symbol">(</a><a id="67737" href="Demos.HSP.html#68061" class="Function">h</a> <a id="67739" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a>  <a id="67742" href="Demos.HSP.html#67633" class="Bound">b</a><a id="67743" class="Symbol">)</a>  <a id="67746" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a>   <a id="67751" href="Demos.HSP.html#67625" class="Bound">Apq</a> <a id="67755" class="Symbol">(</a><a id="67756" href="Demos.HSP.html#68061" class="Function">h</a> <a id="67758" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="67760" href="Demos.HSP.html#67633" class="Bound">b</a><a id="67761" class="Symbol">)</a>           <a id="67773" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
         <a id="67784" href="Demos.HSP.html#67993" class="Function Operator">âŸ¦</a> <a id="67786" href="Demos.HSP.html#66807" class="Bound">q</a> <a id="67788" href="Demos.HSP.html#67993" class="Function Operator">âŸ§á´¬</a>  <a id="67792" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="67796" class="Symbol">(</a><a id="67797" href="Demos.HSP.html#68061" class="Function">h</a> <a id="67799" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a>  <a id="67802" href="Demos.HSP.html#67633" class="Bound">b</a><a id="67803" class="Symbol">)</a>  <a id="67806" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">â‰ˆË˜âŸ¨</a>  <a id="67811" href="Demos.HSP.html#58093" class="Function">comm-hom-term</a> <a id="67825" href="Demos.HSP.html#68046" class="Function">hh</a> <a id="67828" href="Demos.HSP.html#66807" class="Bound">q</a> <a id="67830" href="Demos.HSP.html#67633" class="Bound">b</a>  <a id="67833" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">âŸ©</a>
    <a id="67839" href="Demos.HSP.html#68061" class="Function">h</a> <a id="67841" class="Symbol">(</a>  <a id="67844" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="67846" href="Demos.HSP.html#66807" class="Bound">q</a> <a id="67848" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a>   <a id="67852" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a>       <a id="67862" href="Demos.HSP.html#67633" class="Bound">b</a><a id="67863" class="Symbol">)</a>  <a id="67866" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">âˆ</a> <a id="67868" class="Symbol">)</a>
  <a id="67872" class="Keyword">where</a>
  <a id="67880" class="Keyword">open</a> <a id="67885" href="Relation.Binary.Reasoning.Setoid.html" class="Module">SetoidReasoning</a> <a id="67901" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="67904" href="Demos.HSP.html#66769" class="Bound">ğ‘¨</a> <a id="67906" href="Demos.HSP.html#25499" class="Function Operator">]</a>
  <a id="67910" class="Keyword">open</a> <a id="67915" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="67922" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="67925" href="Demos.HSP.html#66769" class="Bound">ğ‘¨</a> <a id="67927" href="Demos.HSP.html#25499" class="Function Operator">]</a>  <a id="67930" class="Keyword">using</a> <a id="67936" class="Symbol">(</a> <a id="67938" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="67942" class="Symbol">)</a>
  <a id="67946" class="Keyword">open</a> <a id="67951" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="67963" href="Demos.HSP.html#66769" class="Bound">ğ‘¨</a>  <a id="67966" class="Keyword">using</a> <a id="67972" class="Symbol">()</a> <a id="67975" class="Keyword">renaming</a> <a id="67984" class="Symbol">(</a> <a id="67986" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="67990" class="Symbol">to</a> <a id="67993" class="Function Operator">âŸ¦_âŸ§á´¬</a> <a id="67998" class="Symbol">)</a>
  <a id="68002" class="Keyword">open</a> <a id="68007" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="68019" href="Demos.HSP.html#66787" class="Bound">ğ‘©</a>  <a id="68022" class="Keyword">using</a> <a id="68028" class="Symbol">(</a> <a id="68030" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="68034" class="Symbol">)</a>
  <a id="68038" class="Keyword">private</a> <a id="68046" href="Demos.HSP.html#68046" class="Function">hh</a> <a id="68049" class="Symbol">=</a> <a id="68051" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="68053" href="Demos.HSP.html#67629" class="Bound">Bâ‰¤A</a> <a id="68057" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="68059" class="Symbol">;</a> <a id="68061" href="Demos.HSP.html#68061" class="Function">h</a> <a id="68063" class="Symbol">=</a> <a id="68065" href="Demos.HSP.html#8606" class="Field Operator">_âŸ¨$âŸ©_</a> <a id="68071" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="68073" href="Demos.HSP.html#68046" class="Function">hh</a> <a id="68076" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a>

</pre>
\fi
An identity satisfied by all algebras in an indexed collection is
also satisfied by the product of algebras in the collection.
\ifshort
We refer to this fact as \af{âŠ§-P-invar}.
\else

<pre class="Agda">

<a id="68292" class="Keyword">module</a> <a id="68299" href="Demos.HSP.html#68299" class="Module">_</a> <a id="68301" class="Symbol">{</a><a id="68302" href="Demos.HSP.html#68302" class="Bound">X</a> <a id="68304" class="Symbol">:</a> <a id="68306" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="68311" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="68312" class="Symbol">}{</a><a id="68314" href="Demos.HSP.html#68314" class="Bound">I</a> <a id="68316" class="Symbol">:</a> <a id="68318" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="68323" href="Demos.HSP.html#9462" class="Generalizable">â„“</a><a id="68324" class="Symbol">}(</a><a id="68326" href="Demos.HSP.html#68326" class="Bound">ğ’œ</a> <a id="68328" class="Symbol">:</a> <a id="68330" href="Demos.HSP.html#68314" class="Bound">I</a> <a id="68332" class="Symbol">â†’</a> <a id="68334" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="68342" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="68344" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="68346" class="Symbol">){</a><a id="68348" href="Demos.HSP.html#68348" class="Bound">p</a> <a id="68350" href="Demos.HSP.html#68350" class="Bound">q</a> <a id="68352" class="Symbol">:</a> <a id="68354" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="68359" href="Demos.HSP.html#68302" class="Bound">X</a><a id="68360" class="Symbol">}</a> <a id="68362" class="Keyword">where</a>
 <a id="68369" href="Demos.HSP.html#68369" class="Function">âŠ§-P-invar</a> <a id="68379" class="Symbol">:</a> <a id="68381" class="Symbol">(âˆ€</a> <a id="68384" href="Demos.HSP.html#68384" class="Bound">i</a> <a id="68386" class="Symbol">â†’</a> <a id="68388" href="Demos.HSP.html#68326" class="Bound">ğ’œ</a> <a id="68390" href="Demos.HSP.html#68384" class="Bound">i</a> <a id="68392" href="Demos.HSP.html#60523" class="Function Operator">âŠ§</a> <a id="68394" href="Demos.HSP.html#68348" class="Bound">p</a> <a id="68396" href="Demos.HSP.html#60523" class="Function Operator">â‰ˆ</a> <a id="68398" href="Demos.HSP.html#68350" class="Bound">q</a><a id="68399" class="Symbol">)</a> <a id="68401" class="Symbol">â†’</a> <a id="68403" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="68405" href="Demos.HSP.html#68326" class="Bound">ğ’œ</a> <a id="68407" href="Demos.HSP.html#60523" class="Function Operator">âŠ§</a> <a id="68409" href="Demos.HSP.html#68348" class="Bound">p</a> <a id="68411" href="Demos.HSP.html#60523" class="Function Operator">â‰ˆ</a> <a id="68413" href="Demos.HSP.html#68350" class="Bound">q</a>
 <a id="68416" href="Demos.HSP.html#68369" class="Function">âŠ§-P-invar</a> <a id="68426" href="Demos.HSP.html#68426" class="Bound">ğ’œpq</a> <a id="68430" href="Demos.HSP.html#68430" class="Bound">a</a> <a id="68432" class="Symbol">=</a> <a id="68434" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>
   <a id="68443" href="Demos.HSP.html#68793" class="Function Operator">âŸ¦</a> <a id="68445" href="Demos.HSP.html#68348" class="Bound">p</a> <a id="68447" href="Demos.HSP.html#68793" class="Function Operator">âŸ§â‚</a>               <a id="68464" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a>  <a id="68469" href="Demos.HSP.html#68430" class="Bound">a</a>                <a id="68486" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a>   <a id="68491" href="Demos.HSP.html#58626" class="Function">interp-prod</a> <a id="68503" href="Demos.HSP.html#68326" class="Bound">ğ’œ</a> <a id="68505" href="Demos.HSP.html#68348" class="Bound">p</a> <a id="68507" href="Demos.HSP.html#68430" class="Bound">a</a>            <a id="68520" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
   <a id="68525" class="Symbol">(</a> <a id="68527" class="Symbol">Î»</a> <a id="68529" href="Demos.HSP.html#68529" class="Bound">i</a> <a id="68531" class="Symbol">â†’</a> <a id="68533" class="Symbol">(</a><a id="68534" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="68536" href="Demos.HSP.html#68326" class="Bound">ğ’œ</a> <a id="68538" href="Demos.HSP.html#68529" class="Bound">i</a> <a id="68540" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="68542" href="Demos.HSP.html#68348" class="Bound">p</a><a id="68543" class="Symbol">)</a>  <a id="68546" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a>  <a id="68551" class="Symbol">Î»</a> <a id="68553" href="Demos.HSP.html#68553" class="Bound">x</a> <a id="68555" class="Symbol">â†’</a> <a id="68557" class="Symbol">(</a><a id="68558" href="Demos.HSP.html#68430" class="Bound">a</a> <a id="68560" href="Demos.HSP.html#68553" class="Bound">x</a><a id="68561" class="Symbol">)</a> <a id="68563" href="Demos.HSP.html#68529" class="Bound">i</a> <a id="68565" class="Symbol">)</a>  <a id="68568" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a> <a id="68571" class="Symbol">(Î»</a> <a id="68574" href="Demos.HSP.html#68574" class="Bound">i</a> <a id="68576" class="Symbol">â†’</a> <a id="68578" href="Demos.HSP.html#68426" class="Bound">ğ’œpq</a> <a id="68582" href="Demos.HSP.html#68574" class="Bound">i</a> <a id="68584" class="Symbol">(Î»</a> <a id="68587" href="Demos.HSP.html#68587" class="Bound">x</a> <a id="68589" class="Symbol">â†’</a> <a id="68591" class="Symbol">(</a><a id="68592" href="Demos.HSP.html#68430" class="Bound">a</a> <a id="68594" href="Demos.HSP.html#68587" class="Bound">x</a><a id="68595" class="Symbol">)</a> <a id="68597" href="Demos.HSP.html#68574" class="Bound">i</a><a id="68598" class="Symbol">))</a>  <a id="68602" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
   <a id="68607" class="Symbol">(</a> <a id="68609" class="Symbol">Î»</a> <a id="68611" href="Demos.HSP.html#68611" class="Bound">i</a> <a id="68613" class="Symbol">â†’</a> <a id="68615" class="Symbol">(</a><a id="68616" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="68618" href="Demos.HSP.html#68326" class="Bound">ğ’œ</a> <a id="68620" href="Demos.HSP.html#68611" class="Bound">i</a> <a id="68622" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="68624" href="Demos.HSP.html#68350" class="Bound">q</a><a id="68625" class="Symbol">)</a>  <a id="68628" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a>  <a id="68633" class="Symbol">Î»</a> <a id="68635" href="Demos.HSP.html#68635" class="Bound">x</a> <a id="68637" class="Symbol">â†’</a> <a id="68639" class="Symbol">(</a><a id="68640" href="Demos.HSP.html#68430" class="Bound">a</a> <a id="68642" href="Demos.HSP.html#68635" class="Bound">x</a><a id="68643" class="Symbol">)</a> <a id="68645" href="Demos.HSP.html#68611" class="Bound">i</a> <a id="68647" class="Symbol">)</a>  <a id="68650" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">â‰ˆË˜âŸ¨</a>  <a id="68655" href="Demos.HSP.html#58626" class="Function">interp-prod</a> <a id="68667" href="Demos.HSP.html#68326" class="Bound">ğ’œ</a> <a id="68669" href="Demos.HSP.html#68350" class="Bound">q</a> <a id="68671" href="Demos.HSP.html#68430" class="Bound">a</a>            <a id="68684" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">âŸ©</a>
   <a id="68689" href="Demos.HSP.html#68793" class="Function Operator">âŸ¦</a> <a id="68691" href="Demos.HSP.html#68350" class="Bound">q</a> <a id="68693" href="Demos.HSP.html#68793" class="Function Operator">âŸ§â‚</a>               <a id="68710" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a>  <a id="68715" href="Demos.HSP.html#68430" class="Bound">a</a>                <a id="68732" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">âˆ</a> <a id="68734" class="Keyword">where</a>
  <a id="68742" class="Keyword">open</a> <a id="68747" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="68759" class="Symbol">(</a><a id="68760" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="68762" href="Demos.HSP.html#68326" class="Bound">ğ’œ</a><a id="68763" class="Symbol">)</a>  <a id="68766" class="Keyword">using</a> <a id="68772" class="Symbol">()</a> <a id="68775" class="Keyword">renaming</a> <a id="68784" class="Symbol">(</a> <a id="68786" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="68790" class="Symbol">to</a> <a id="68793" class="Function Operator">âŸ¦_âŸ§â‚</a> <a id="68798" class="Symbol">)</a>
  <a id="68802" class="Keyword">open</a> <a id="68807" href="Demos.HSP.html#54843" class="Module">Environment</a>        <a id="68826" class="Keyword">using</a> <a id="68832" class="Symbol">(</a> <a id="68834" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="68838" class="Symbol">)</a>
  <a id="68842" class="Keyword">open</a> <a id="68847" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="68854" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="68857" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="68859" href="Demos.HSP.html#68326" class="Bound">ğ’œ</a> <a id="68861" href="Demos.HSP.html#25499" class="Function Operator">]</a>    <a id="68866" class="Keyword">using</a> <a id="68872" class="Symbol">(</a> <a id="68874" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="68878" class="Symbol">)</a>
  <a id="68882" class="Keyword">open</a> <a id="68887" href="Relation.Binary.Reasoning.Setoid.html" class="Module">SetoidReasoning</a> <a id="68903" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="68906" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="68908" href="Demos.HSP.html#68326" class="Bound">ğ’œ</a> <a id="68910" href="Demos.HSP.html#25499" class="Function Operator">]</a>

</pre>
\fi

A \emph{variety} is a class of \ab{ğ‘†}-algebras that is closed under the taking of
homomorphic images, subalgebras, and arbitrary products.
%To represent varieties
%we define composable types representing \af H, \af S, and \af P and we define the type \af V to be the compos%ition of all three.
%If \ab{ğ’¦} is a class of \ab{ğ‘†}-algebras, then
If we define \af V \ab{ğ’¦} := \af H (\af S (\af P \ab{ğ’¦})), then \ab{ğ’¦} is a variety iff \af V \ab{ğ’¦} \aof{âŠ†} \ab{ğ’¦}.
%(The converse inclusion holds by virtue of the fact that \af V is a composition of closure operators.)
The class \af{V}~\ab{ğ’¦} is called the \defn{varietal closure} of \ab{ğ’¦}. Here is how we define \af{V} in type theory.
(The explicit universe level declarations that appear in the definition are needed for disambiguation.)

<pre class="Agda">

<a id="69728" class="Keyword">module</a> <a id="69735" href="Demos.HSP.html#69735" class="Module">_</a>  <a id="69738" class="Symbol">{</a><a id="69739" href="Demos.HSP.html#69739" class="Bound">Î±</a> <a id="69741" href="Demos.HSP.html#69741" class="Bound">Ïáµƒ</a> <a id="69744" href="Demos.HSP.html#69744" class="Bound">Î²</a> <a id="69746" href="Demos.HSP.html#69746" class="Bound">Ïáµ‡</a> <a id="69749" href="Demos.HSP.html#69749" class="Bound">Î³</a> <a id="69751" href="Demos.HSP.html#69751" class="Bound">Ïá¶œ</a> <a id="69754" href="Demos.HSP.html#69754" class="Bound">Î´</a> <a id="69756" href="Demos.HSP.html#69756" class="Bound">Ïáµˆ</a> <a id="69759" class="Symbol">:</a> <a id="69761" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="69766" class="Symbol">}</a> <a id="69768" class="Keyword">where</a>
 <a id="69775" class="Keyword">private</a> <a id="69783" href="Demos.HSP.html#69783" class="Function">a</a> <a id="69785" class="Symbol">=</a> <a id="69787" href="Demos.HSP.html#69739" class="Bound">Î±</a> <a id="69789" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="69791" href="Demos.HSP.html#69741" class="Bound">Ïáµƒ</a> <a id="69794" class="Symbol">;</a> <a id="69796" href="Demos.HSP.html#69796" class="Function">b</a> <a id="69798" class="Symbol">=</a> <a id="69800" href="Demos.HSP.html#69744" class="Bound">Î²</a> <a id="69802" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="69804" href="Demos.HSP.html#69746" class="Bound">Ïáµ‡</a>
 <a id="69808" href="Demos.HSP.html#69808" class="Function">V</a> <a id="69810" class="Symbol">:</a> <a id="69812" class="Symbol">âˆ€</a> <a id="69814" href="Demos.HSP.html#69814" class="Bound">â„“</a> <a id="69816" href="Demos.HSP.html#69816" class="Bound">Î¹</a> <a id="69818" class="Symbol">â†’</a> <a id="69820" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="69824" class="Symbol">(</a><a id="69825" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="69833" href="Demos.HSP.html#69739" class="Bound">Î±</a> <a id="69835" href="Demos.HSP.html#69741" class="Bound">Ïáµƒ</a><a id="69837" class="Symbol">)</a> <a id="69839" class="Symbol">(</a><a id="69840" href="Demos.HSP.html#69783" class="Function">a</a> <a id="69842" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="69844" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="69847" href="Demos.HSP.html#69814" class="Bound">â„“</a><a id="69848" class="Symbol">)</a> <a id="69850" class="Symbol">â†’</a>  <a id="69853" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="69857" class="Symbol">(</a><a id="69858" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="69866" href="Demos.HSP.html#69754" class="Bound">Î´</a> <a id="69868" href="Demos.HSP.html#69756" class="Bound">Ïáµˆ</a><a id="69870" class="Symbol">)</a> <a id="69872" class="Symbol">_</a>
 <a id="69875" href="Demos.HSP.html#69808" class="Function">V</a> <a id="69877" href="Demos.HSP.html#69877" class="Bound">â„“</a> <a id="69879" href="Demos.HSP.html#69879" class="Bound">Î¹</a> <a id="69881" href="Demos.HSP.html#69881" class="Bound">ğ’¦</a> <a id="69883" class="Symbol">=</a> <a id="69885" href="Demos.HSP.html#66022" class="Function">H</a><a id="69886" class="Symbol">{</a><a id="69887" href="Demos.HSP.html#69749" class="Bound">Î³</a><a id="69888" class="Symbol">}{</a><a id="69890" href="Demos.HSP.html#69751" class="Bound">Ïá¶œ</a><a id="69892" class="Symbol">}{</a><a id="69894" href="Demos.HSP.html#69754" class="Bound">Î´</a><a id="69895" class="Symbol">}{</a><a id="69897" href="Demos.HSP.html#69756" class="Bound">Ïáµˆ</a><a id="69899" class="Symbol">}</a> <a id="69901" class="Symbol">(</a><a id="69902" href="Demos.HSP.html#69783" class="Function">a</a> <a id="69904" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="69906" href="Demos.HSP.html#69796" class="Function">b</a> <a id="69908" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="69910" href="Demos.HSP.html#69877" class="Bound">â„“</a> <a id="69912" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="69914" href="Demos.HSP.html#69879" class="Bound">Î¹</a><a id="69915" class="Symbol">)</a> <a id="69917" class="Symbol">(</a><a id="69918" href="Demos.HSP.html#66145" class="Function">S</a><a id="69919" class="Symbol">{</a><a id="69920" href="Demos.HSP.html#69744" class="Bound">Î²</a><a id="69921" class="Symbol">}{</a><a id="69923" href="Demos.HSP.html#69746" class="Bound">Ïáµ‡</a><a id="69925" class="Symbol">}</a> <a id="69927" class="Symbol">(</a><a id="69928" href="Demos.HSP.html#69783" class="Function">a</a> <a id="69930" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="69932" href="Demos.HSP.html#69877" class="Bound">â„“</a> <a id="69934" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="69936" href="Demos.HSP.html#69879" class="Bound">Î¹</a><a id="69937" class="Symbol">)</a> <a id="69939" class="Symbol">(</a><a id="69940" href="Demos.HSP.html#66257" class="Function">P</a> <a id="69942" href="Demos.HSP.html#69877" class="Bound">â„“</a> <a id="69944" href="Demos.HSP.html#69879" class="Bound">Î¹</a> <a id="69946" href="Demos.HSP.html#69881" class="Bound">ğ’¦</a><a id="69947" class="Symbol">))</a>

</pre>



The classes \af H \ab{ğ’¦}, \af S \ab{ğ’¦}, \af P \ab{ğ’¦}, and \af V \ab{ğ’¦} all satisfy the
same term identities.  We will only use a subset of the inclusions needed to prove this
assertion.\footnote{The others are included in the
\ualmodule{Setoid.Varieties.Preservation} module of the \agdaalgebras library.}
First, the closure operator \af H preserves the identities modeled by the
given class; this follows almost immediately from the invariance lemma
\af{âŠ§-H-invar}.

<pre class="Agda">

<a id="70447" class="Keyword">module</a> <a id="70454" href="Demos.HSP.html#70454" class="Module">_</a>  <a id="70457" class="Symbol">{</a><a id="70458" href="Demos.HSP.html#70458" class="Bound">X</a> <a id="70460" class="Symbol">:</a> <a id="70462" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="70467" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="70468" class="Symbol">}{</a><a id="70470" href="Demos.HSP.html#70470" class="Bound">ğ’¦</a> <a id="70472" class="Symbol">:</a> <a id="70474" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="70478" class="Symbol">(</a><a id="70479" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="70487" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="70489" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="70491" class="Symbol">)</a> <a id="70493" class="Symbol">(</a><a id="70494" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="70496" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="70498" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="70501" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="70503" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="70506" href="Demos.HSP.html#9462" class="Generalizable">â„“</a><a id="70507" class="Symbol">)}{</a><a id="70510" href="Demos.HSP.html#70510" class="Bound">p</a> <a id="70512" href="Demos.HSP.html#70512" class="Bound">q</a> <a id="70514" class="Symbol">:</a> <a id="70516" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="70521" href="Demos.HSP.html#70458" class="Bound">X</a><a id="70522" class="Symbol">}</a> <a id="70524" class="Keyword">where</a>
 <a id="70531" href="Demos.HSP.html#70531" class="Function">H-id1</a> <a id="70537" class="Symbol">:</a> <a id="70539" href="Demos.HSP.html#70470" class="Bound">ğ’¦</a> <a id="70541" href="Demos.HSP.html#60621" class="Function Operator">âŠ«</a> <a id="70543" href="Demos.HSP.html#70510" class="Bound">p</a> <a id="70545" href="Demos.HSP.html#60621" class="Function Operator">â‰ˆ</a> <a id="70547" href="Demos.HSP.html#70512" class="Bound">q</a> <a id="70549" class="Symbol">â†’</a> <a id="70551" href="Demos.HSP.html#66022" class="Function">H</a><a id="70552" class="Symbol">{</a><a id="70553" class="Argument">Î²</a> <a id="70555" class="Symbol">=</a> <a id="70557" href="Demos.HSP.html#70487" class="Bound">Î±</a><a id="70558" class="Symbol">}{</a><a id="70560" href="Demos.HSP.html#70489" class="Bound">Ïáµƒ</a><a id="70562" class="Symbol">}</a><a id="70563" href="Demos.HSP.html#70506" class="Bound">â„“</a> <a id="70565" href="Demos.HSP.html#70470" class="Bound">ğ’¦</a> <a id="70567" href="Demos.HSP.html#60621" class="Function Operator">âŠ«</a> <a id="70569" href="Demos.HSP.html#70510" class="Bound">p</a> <a id="70571" href="Demos.HSP.html#60621" class="Function Operator">â‰ˆ</a> <a id="70573" href="Demos.HSP.html#70512" class="Bound">q</a>
 <a id="70576" href="Demos.HSP.html#70531" class="Function">H-id1</a> <a id="70582" href="Demos.HSP.html#70582" class="Bound">Ïƒ</a> <a id="70584" href="Demos.HSP.html#70584" class="Bound">ğ‘©</a> <a id="70586" class="Symbol">(</a><a id="70587" href="Demos.HSP.html#70587" class="Bound">ğ‘¨</a> <a id="70589" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="70591" href="Demos.HSP.html#70591" class="Bound">kA</a> <a id="70594" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="70596" href="Demos.HSP.html#70596" class="Bound">BimgA</a><a id="70601" class="Symbol">)</a> <a id="70603" class="Symbol">=</a> <a id="70605" href="Demos.HSP.html#66826" class="Function">âŠ§-H-invar</a><a id="70614" class="Symbol">{</a><a id="70615" class="Argument">p</a> <a id="70617" class="Symbol">=</a> <a id="70619" href="Demos.HSP.html#70510" class="Bound">p</a><a id="70620" class="Symbol">}{</a><a id="70622" href="Demos.HSP.html#70512" class="Bound">q</a><a id="70623" class="Symbol">}</a> <a id="70625" class="Symbol">(</a><a id="70626" href="Demos.HSP.html#70582" class="Bound">Ïƒ</a> <a id="70628" href="Demos.HSP.html#70587" class="Bound">ğ‘¨</a> <a id="70630" href="Demos.HSP.html#70591" class="Bound">kA</a><a id="70632" class="Symbol">)</a> <a id="70634" href="Demos.HSP.html#70596" class="Bound">BimgA</a>

</pre>
The analogous preservation result for \af S is a consequence of the invariance lemma \af{âŠ§-S-invar}; the converse, which we call \af{S-id2}, has an equally straightforward proof.

<pre class="Agda">

 <a id="70847" href="Demos.HSP.html#70847" class="Function">S-id1</a> <a id="70853" class="Symbol">:</a> <a id="70855" href="Demos.HSP.html#70470" class="Bound">ğ’¦</a> <a id="70857" href="Demos.HSP.html#60621" class="Function Operator">âŠ«</a> <a id="70859" href="Demos.HSP.html#70510" class="Bound">p</a> <a id="70861" href="Demos.HSP.html#60621" class="Function Operator">â‰ˆ</a> <a id="70863" href="Demos.HSP.html#70512" class="Bound">q</a> <a id="70865" class="Symbol">â†’</a> <a id="70867" href="Demos.HSP.html#66145" class="Function">S</a><a id="70868" class="Symbol">{</a><a id="70869" class="Argument">Î²</a> <a id="70871" class="Symbol">=</a> <a id="70873" href="Demos.HSP.html#70487" class="Bound">Î±</a><a id="70874" class="Symbol">}{</a><a id="70876" href="Demos.HSP.html#70489" class="Bound">Ïáµƒ</a><a id="70878" class="Symbol">}</a><a id="70879" href="Demos.HSP.html#70506" class="Bound">â„“</a> <a id="70881" href="Demos.HSP.html#70470" class="Bound">ğ’¦</a> <a id="70883" href="Demos.HSP.html#60621" class="Function Operator">âŠ«</a> <a id="70885" href="Demos.HSP.html#70510" class="Bound">p</a> <a id="70887" href="Demos.HSP.html#60621" class="Function Operator">â‰ˆ</a> <a id="70889" href="Demos.HSP.html#70512" class="Bound">q</a>
 <a id="70892" href="Demos.HSP.html#70847" class="Function">S-id1</a> <a id="70898" href="Demos.HSP.html#70898" class="Bound">Ïƒ</a> <a id="70900" href="Demos.HSP.html#70900" class="Bound">ğ‘©</a> <a id="70902" class="Symbol">(</a><a id="70903" href="Demos.HSP.html#70903" class="Bound">ğ‘¨</a> <a id="70905" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="70907" href="Demos.HSP.html#70907" class="Bound">kA</a> <a id="70910" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="70912" href="Demos.HSP.html#70912" class="Bound">Bâ‰¤A</a><a id="70915" class="Symbol">)</a> <a id="70917" class="Symbol">=</a> <a id="70919" href="Demos.HSP.html#67572" class="Function">âŠ§-S-invar</a><a id="70928" class="Symbol">{</a><a id="70929" class="Argument">p</a> <a id="70931" class="Symbol">=</a> <a id="70933" href="Demos.HSP.html#70510" class="Bound">p</a><a id="70934" class="Symbol">}{</a><a id="70936" href="Demos.HSP.html#70512" class="Bound">q</a><a id="70937" class="Symbol">}</a> <a id="70939" class="Symbol">(</a><a id="70940" href="Demos.HSP.html#70898" class="Bound">Ïƒ</a> <a id="70942" href="Demos.HSP.html#70903" class="Bound">ğ‘¨</a> <a id="70944" href="Demos.HSP.html#70907" class="Bound">kA</a><a id="70946" class="Symbol">)</a> <a id="70948" href="Demos.HSP.html#70912" class="Bound">Bâ‰¤A</a>

 <a id="70954" href="Demos.HSP.html#70954" class="Function">S-id2</a> <a id="70960" class="Symbol">:</a> <a id="70962" href="Demos.HSP.html#66145" class="Function">S</a> <a id="70964" href="Demos.HSP.html#70506" class="Bound">â„“</a> <a id="70966" href="Demos.HSP.html#70470" class="Bound">ğ’¦</a> <a id="70968" href="Demos.HSP.html#60621" class="Function Operator">âŠ«</a> <a id="70970" href="Demos.HSP.html#70510" class="Bound">p</a> <a id="70972" href="Demos.HSP.html#60621" class="Function Operator">â‰ˆ</a> <a id="70974" href="Demos.HSP.html#70512" class="Bound">q</a> <a id="70976" class="Symbol">â†’</a> <a id="70978" href="Demos.HSP.html#70470" class="Bound">ğ’¦</a> <a id="70980" href="Demos.HSP.html#60621" class="Function Operator">âŠ«</a> <a id="70982" href="Demos.HSP.html#70510" class="Bound">p</a> <a id="70984" href="Demos.HSP.html#60621" class="Function Operator">â‰ˆ</a> <a id="70986" href="Demos.HSP.html#70512" class="Bound">q</a>
 <a id="70989" href="Demos.HSP.html#70954" class="Function">S-id2</a> <a id="70995" href="Demos.HSP.html#70995" class="Bound">Spq</a> <a id="70999" href="Demos.HSP.html#70999" class="Bound">ğ‘¨</a> <a id="71001" href="Demos.HSP.html#71001" class="Bound">kA</a> <a id="71004" class="Symbol">=</a> <a id="71006" href="Demos.HSP.html#70995" class="Bound">Spq</a> <a id="71010" href="Demos.HSP.html#70999" class="Bound">ğ‘¨</a> <a id="71012" class="Symbol">(</a><a id="71013" href="Demos.HSP.html#70999" class="Bound">ğ‘¨</a> <a id="71015" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="71017" class="Symbol">(</a><a id="71018" href="Demos.HSP.html#71001" class="Bound">kA</a> <a id="71021" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="71023" href="Demos.HSP.html#47951" class="Function">â‰¤-reflexive</a><a id="71034" class="Symbol">))</a>

</pre>
The \agdaalgebras library includes analogous pairs of implications for \af P, \af H, and \af V, called \af{P-id1}, \af{P-id2}, \af{H-id1}, etc.
\ifshort
whose formalizations we suppress.
\else
In each case, we will only need the first implication, so we omit the others from this presentation.

<pre class="Agda">

 <a id="71359" href="Demos.HSP.html#71359" class="Function">P-id1</a> <a id="71365" class="Symbol">:</a> <a id="71367" class="Symbol">âˆ€{</a><a id="71369" href="Demos.HSP.html#71369" class="Bound">Î¹</a><a id="71370" class="Symbol">}</a> <a id="71372" class="Symbol">â†’</a> <a id="71374" href="Demos.HSP.html#70470" class="Bound">ğ’¦</a> <a id="71376" href="Demos.HSP.html#60621" class="Function Operator">âŠ«</a> <a id="71378" href="Demos.HSP.html#70510" class="Bound">p</a> <a id="71380" href="Demos.HSP.html#60621" class="Function Operator">â‰ˆ</a> <a id="71382" href="Demos.HSP.html#70512" class="Bound">q</a> <a id="71384" class="Symbol">â†’</a> <a id="71386" href="Demos.HSP.html#66257" class="Function">P</a><a id="71387" class="Symbol">{</a><a id="71388" class="Argument">Î²</a> <a id="71390" class="Symbol">=</a> <a id="71392" href="Demos.HSP.html#70487" class="Bound">Î±</a><a id="71393" class="Symbol">}{</a><a id="71395" href="Demos.HSP.html#70489" class="Bound">Ïáµƒ</a><a id="71397" class="Symbol">}</a><a id="71398" href="Demos.HSP.html#70506" class="Bound">â„“</a> <a id="71400" href="Demos.HSP.html#71369" class="Bound">Î¹</a> <a id="71402" href="Demos.HSP.html#70470" class="Bound">ğ’¦</a> <a id="71404" href="Demos.HSP.html#60621" class="Function Operator">âŠ«</a> <a id="71406" href="Demos.HSP.html#70510" class="Bound">p</a> <a id="71408" href="Demos.HSP.html#60621" class="Function Operator">â‰ˆ</a> <a id="71410" href="Demos.HSP.html#70512" class="Bound">q</a>
 <a id="71413" href="Demos.HSP.html#71359" class="Function">P-id1</a> <a id="71419" href="Demos.HSP.html#71419" class="Bound">Ïƒ</a> <a id="71421" href="Demos.HSP.html#71421" class="Bound">ğ‘¨</a> <a id="71423" class="Symbol">(</a><a id="71424" href="Demos.HSP.html#71424" class="Bound">I</a> <a id="71426" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="71428" href="Demos.HSP.html#71428" class="Bound">ğ’œ</a> <a id="71430" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="71432" href="Demos.HSP.html#71432" class="Bound">kA</a> <a id="71435" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="71437" href="Demos.HSP.html#71437" class="Bound">Aâ‰…â¨…A</a><a id="71441" class="Symbol">)</a> <a id="71443" class="Symbol">=</a> <a id="71445" href="Demos.HSP.html#61805" class="Function">âŠ§-I-invar</a> <a id="71455" href="Demos.HSP.html#71421" class="Bound">ğ‘¨</a> <a id="71457" href="Demos.HSP.html#70510" class="Bound">p</a> <a id="71459" href="Demos.HSP.html#70512" class="Bound">q</a> <a id="71461" href="Demos.HSP.html#71485" class="Function">IH</a> <a id="71464" class="Symbol">(</a><a id="71465" href="Demos.HSP.html#42474" class="Function">â‰…-sym</a> <a id="71471" href="Demos.HSP.html#71437" class="Bound">Aâ‰…â¨…A</a><a id="71475" class="Symbol">)</a> <a id="71477" class="Keyword">where</a>
  <a id="71485" href="Demos.HSP.html#71485" class="Function">IH</a> <a id="71488" class="Symbol">:</a> <a id="71490" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="71492" href="Demos.HSP.html#71428" class="Bound">ğ’œ</a> <a id="71494" href="Demos.HSP.html#60523" class="Function Operator">âŠ§</a> <a id="71496" href="Demos.HSP.html#70510" class="Bound">p</a> <a id="71498" href="Demos.HSP.html#60523" class="Function Operator">â‰ˆ</a> <a id="71500" href="Demos.HSP.html#70512" class="Bound">q</a>
  <a id="71504" href="Demos.HSP.html#71485" class="Function">IH</a> <a id="71507" class="Symbol">=</a> <a id="71509" href="Demos.HSP.html#68369" class="Function">âŠ§-P-invar</a> <a id="71519" href="Demos.HSP.html#71428" class="Bound">ğ’œ</a> <a id="71521" class="Symbol">{</a><a id="71522" href="Demos.HSP.html#70510" class="Bound">p</a><a id="71523" class="Symbol">}{</a><a id="71525" href="Demos.HSP.html#70512" class="Bound">q</a><a id="71526" class="Symbol">}</a> <a id="71528" class="Symbol">Î»</a> <a id="71530" href="Demos.HSP.html#71530" class="Bound">i</a> <a id="71532" class="Symbol">â†’</a> <a id="71534" href="Demos.HSP.html#71419" class="Bound">Ïƒ</a> <a id="71536" class="Symbol">(</a><a id="71537" href="Demos.HSP.html#71428" class="Bound">ğ’œ</a> <a id="71539" href="Demos.HSP.html#71530" class="Bound">i</a><a id="71540" class="Symbol">)</a> <a id="71542" class="Symbol">(</a><a id="71543" href="Demos.HSP.html#71432" class="Bound">kA</a> <a id="71546" href="Demos.HSP.html#71530" class="Bound">i</a><a id="71547" class="Symbol">)</a>

<a id="71550" class="Keyword">module</a> <a id="71557" href="Demos.HSP.html#71557" class="Module">_</a> <a id="71559" class="Symbol">{</a><a id="71560" href="Demos.HSP.html#71560" class="Bound">X</a> <a id="71562" class="Symbol">:</a> <a id="71564" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="71569" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="71570" class="Symbol">}{</a><a id="71572" href="Demos.HSP.html#71572" class="Bound">Î¹</a> <a id="71574" class="Symbol">:</a> <a id="71576" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="71581" class="Symbol">}(</a><a id="71583" href="Demos.HSP.html#71583" class="Bound">â„“</a> <a id="71585" class="Symbol">:</a> <a id="71587" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="71592" class="Symbol">){</a><a id="71594" href="Demos.HSP.html#71594" class="Bound">ğ’¦</a> <a id="71596" class="Symbol">:</a> <a id="71598" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="71602" class="Symbol">(</a><a id="71603" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="71611" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="71613" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="71615" class="Symbol">)(</a><a id="71617" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="71619" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="71621" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="71624" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="71626" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="71629" href="Demos.HSP.html#71583" class="Bound">â„“</a><a id="71630" class="Symbol">)}{</a><a id="71633" href="Demos.HSP.html#71633" class="Bound">p</a> <a id="71635" href="Demos.HSP.html#71635" class="Bound">q</a> <a id="71637" class="Symbol">:</a> <a id="71639" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="71644" href="Demos.HSP.html#71560" class="Bound">X</a><a id="71645" class="Symbol">}</a> <a id="71647" class="Keyword">where</a>
 <a id="71654" class="Keyword">private</a> <a id="71662" href="Demos.HSP.html#71662" class="Function">aâ„“Î¹</a> <a id="71666" class="Symbol">=</a> <a id="71668" href="Demos.HSP.html#71611" class="Bound">Î±</a> <a id="71670" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="71672" href="Demos.HSP.html#71613" class="Bound">Ïáµƒ</a> <a id="71675" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="71677" href="Demos.HSP.html#71583" class="Bound">â„“</a> <a id="71679" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="71681" href="Demos.HSP.html#71572" class="Bound">Î¹</a>
 <a id="71684" href="Demos.HSP.html#71684" class="Function">V-id1</a> <a id="71690" class="Symbol">:</a> <a id="71692" href="Demos.HSP.html#71594" class="Bound">ğ’¦</a> <a id="71694" href="Demos.HSP.html#60621" class="Function Operator">âŠ«</a> <a id="71696" href="Demos.HSP.html#71633" class="Bound">p</a> <a id="71698" href="Demos.HSP.html#60621" class="Function Operator">â‰ˆ</a> <a id="71700" href="Demos.HSP.html#71635" class="Bound">q</a> <a id="71702" class="Symbol">â†’</a> <a id="71704" href="Demos.HSP.html#69808" class="Function">V</a> <a id="71706" href="Demos.HSP.html#71583" class="Bound">â„“</a> <a id="71708" href="Demos.HSP.html#71572" class="Bound">Î¹</a> <a id="71710" href="Demos.HSP.html#71594" class="Bound">ğ’¦</a> <a id="71712" href="Demos.HSP.html#60621" class="Function Operator">âŠ«</a> <a id="71714" href="Demos.HSP.html#71633" class="Bound">p</a> <a id="71716" href="Demos.HSP.html#60621" class="Function Operator">â‰ˆ</a> <a id="71718" href="Demos.HSP.html#71635" class="Bound">q</a>
 <a id="71721" href="Demos.HSP.html#71684" class="Function">V-id1</a> <a id="71727" href="Demos.HSP.html#71727" class="Bound">Ïƒ</a> <a id="71729" href="Demos.HSP.html#71729" class="Bound">ğ‘©</a> <a id="71731" class="Symbol">(</a><a id="71732" href="Demos.HSP.html#71732" class="Bound">ğ‘¨</a> <a id="71734" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="71736" class="Symbol">(</a><a id="71737" href="Demos.HSP.html#71737" class="Bound">â¨…A</a> <a id="71740" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="71742" href="Demos.HSP.html#71742" class="Bound">pâ¨…A</a> <a id="71746" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="71748" href="Demos.HSP.html#71748" class="Bound">Aâ‰¤â¨…A</a><a id="71752" class="Symbol">)</a> <a id="71754" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="71756" href="Demos.HSP.html#71756" class="Bound">BimgA</a><a id="71761" class="Symbol">)</a> <a id="71763" class="Symbol">=</a>
  <a id="71767" href="Demos.HSP.html#70531" class="Function">H-id1</a><a id="71772" class="Symbol">{</a><a id="71773" class="Argument">â„“</a> <a id="71775" class="Symbol">=</a> <a id="71777" href="Demos.HSP.html#71662" class="Function">aâ„“Î¹</a><a id="71780" class="Symbol">}{</a><a id="71782" class="Argument">ğ’¦</a> <a id="71784" class="Symbol">=</a> <a id="71786" href="Demos.HSP.html#66145" class="Function">S</a> <a id="71788" href="Demos.HSP.html#71662" class="Function">aâ„“Î¹</a> <a id="71792" class="Symbol">(</a><a id="71793" href="Demos.HSP.html#66257" class="Function">P</a> <a id="71795" class="Symbol">{</a><a id="71796" class="Argument">Î²</a> <a id="71798" class="Symbol">=</a> <a id="71800" href="Demos.HSP.html#71611" class="Bound">Î±</a><a id="71801" class="Symbol">}{</a><a id="71803" href="Demos.HSP.html#71613" class="Bound">Ïáµƒ</a><a id="71805" class="Symbol">}</a><a id="71806" href="Demos.HSP.html#71583" class="Bound">â„“</a> <a id="71808" href="Demos.HSP.html#71572" class="Bound">Î¹</a> <a id="71810" href="Demos.HSP.html#71594" class="Bound">ğ’¦</a><a id="71811" class="Symbol">)}{</a><a id="71814" class="Argument">p</a> <a id="71816" class="Symbol">=</a> <a id="71818" href="Demos.HSP.html#71633" class="Bound">p</a><a id="71819" class="Symbol">}{</a><a id="71821" href="Demos.HSP.html#71635" class="Bound">q</a><a id="71822" class="Symbol">}</a> <a id="71824" href="Demos.HSP.html#71929" class="Function">spKâŠ§pq</a> <a id="71831" href="Demos.HSP.html#71729" class="Bound">ğ‘©</a> <a id="71833" class="Symbol">(</a><a id="71834" href="Demos.HSP.html#71732" class="Bound">ğ‘¨</a> <a id="71836" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="71838" class="Symbol">(</a><a id="71839" href="Demos.HSP.html#71862" class="Function">spA</a> <a id="71843" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="71845" href="Demos.HSP.html#71756" class="Bound">BimgA</a><a id="71850" class="Symbol">))</a> <a id="71853" class="Keyword">where</a>
   <a id="71862" href="Demos.HSP.html#71862" class="Function">spA</a> <a id="71866" class="Symbol">:</a> <a id="71868" href="Demos.HSP.html#71732" class="Bound">ğ‘¨</a> <a id="71870" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="71872" href="Demos.HSP.html#66145" class="Function">S</a> <a id="71874" href="Demos.HSP.html#71662" class="Function">aâ„“Î¹</a> <a id="71878" class="Symbol">(</a><a id="71879" href="Demos.HSP.html#66257" class="Function">P</a> <a id="71881" class="Symbol">{</a><a id="71882" class="Argument">Î²</a> <a id="71884" class="Symbol">=</a> <a id="71886" href="Demos.HSP.html#71611" class="Bound">Î±</a><a id="71887" class="Symbol">}{</a><a id="71889" href="Demos.HSP.html#71613" class="Bound">Ïáµƒ</a><a id="71891" class="Symbol">}</a><a id="71892" href="Demos.HSP.html#71583" class="Bound">â„“</a> <a id="71894" href="Demos.HSP.html#71572" class="Bound">Î¹</a> <a id="71896" href="Demos.HSP.html#71594" class="Bound">ğ’¦</a><a id="71897" class="Symbol">)</a>
   <a id="71902" href="Demos.HSP.html#71862" class="Function">spA</a> <a id="71906" class="Symbol">=</a> <a id="71908" href="Demos.HSP.html#71737" class="Bound">â¨…A</a> <a id="71911" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="71913" class="Symbol">(</a><a id="71914" href="Demos.HSP.html#71742" class="Bound">pâ¨…A</a> <a id="71918" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="71920" href="Demos.HSP.html#71748" class="Bound">Aâ‰¤â¨…A</a><a id="71924" class="Symbol">)</a>
   <a id="71929" href="Demos.HSP.html#71929" class="Function">spKâŠ§pq</a> <a id="71936" class="Symbol">:</a> <a id="71938" href="Demos.HSP.html#66145" class="Function">S</a> <a id="71940" href="Demos.HSP.html#71662" class="Function">aâ„“Î¹</a> <a id="71944" class="Symbol">(</a><a id="71945" href="Demos.HSP.html#66257" class="Function">P</a> <a id="71947" href="Demos.HSP.html#71583" class="Bound">â„“</a> <a id="71949" href="Demos.HSP.html#71572" class="Bound">Î¹</a> <a id="71951" href="Demos.HSP.html#71594" class="Bound">ğ’¦</a><a id="71952" class="Symbol">)</a> <a id="71954" href="Demos.HSP.html#60621" class="Function Operator">âŠ«</a> <a id="71956" href="Demos.HSP.html#71633" class="Bound">p</a> <a id="71958" href="Demos.HSP.html#60621" class="Function Operator">â‰ˆ</a> <a id="71960" href="Demos.HSP.html#71635" class="Bound">q</a>
   <a id="71965" href="Demos.HSP.html#71929" class="Function">spKâŠ§pq</a> <a id="71972" class="Symbol">=</a> <a id="71974" href="Demos.HSP.html#70847" class="Function">S-id1</a><a id="71979" class="Symbol">{</a><a id="71980" class="Argument">â„“</a> <a id="71982" class="Symbol">=</a> <a id="71984" href="Demos.HSP.html#71662" class="Function">aâ„“Î¹</a><a id="71987" class="Symbol">}{</a><a id="71989" class="Argument">p</a> <a id="71991" class="Symbol">=</a> <a id="71993" href="Demos.HSP.html#71633" class="Bound">p</a><a id="71994" class="Symbol">}{</a><a id="71996" href="Demos.HSP.html#71635" class="Bound">q</a><a id="71997" class="Symbol">}</a> <a id="71999" class="Symbol">(</a><a id="72000" href="Demos.HSP.html#71359" class="Function">P-id1</a><a id="72005" class="Symbol">{</a><a id="72006" class="Argument">â„“</a> <a id="72008" class="Symbol">=</a> <a id="72010" href="Demos.HSP.html#71583" class="Bound">â„“</a><a id="72011" class="Symbol">}</a> <a id="72013" class="Symbol">{</a><a id="72014" class="Argument">ğ’¦</a> <a id="72016" class="Symbol">=</a> <a id="72018" href="Demos.HSP.html#71594" class="Bound">ğ’¦</a><a id="72019" class="Symbol">}{</a><a id="72021" class="Argument">p</a> <a id="72023" class="Symbol">=</a> <a id="72025" href="Demos.HSP.html#71633" class="Bound">p</a><a id="72026" class="Symbol">}{</a><a id="72028" href="Demos.HSP.html#71635" class="Bound">q</a><a id="72029" class="Symbol">}</a> <a id="72031" href="Demos.HSP.html#71727" class="Bound">Ïƒ</a><a id="72032" class="Symbol">)</a>
</pre>
\fi
%% -------------------------------------------------------------------------------------
\section{Free Algebras}
\label{free-algebras}
%% -----------------------------------------------------------------------------
\paragraph*{The absolutely free algebra}
The term algebra \af{ğ‘»} \ab X is the \emph{absolutely free} \ab{ğ‘†}-algebra over \ab X.
That is, for every \ab{ğ‘†}-algebra \ab{ğ‘¨}, the following hold.
\begin{itemize}
\item Every function from \ab{X} to \af{ğ•Œ[ \ab{ğ‘¨} ]} lifts to a homomorphism from \af{ğ‘»} \ab{X} to \ab{ğ‘¨}.
\item That homomorphism is unique.
\end{itemize}
Here we formalize the first of these properties by defining the lifting function \af{free-lift}
and its setoid analog \af{free-lift-func}, and then proving the latter is a homomorphism.%
\footnote{For the proof of uniqueness, see the \ualmodule{Setoid.Terms.Properties} module of the \agdaalgebras library.}

<pre class="Agda">

<a id="72950" class="Keyword">module</a> <a id="72957" href="Demos.HSP.html#72957" class="Module">_</a> <a id="72959" class="Symbol">{</a><a id="72960" href="Demos.HSP.html#72960" class="Bound">X</a> <a id="72962" class="Symbol">:</a> <a id="72964" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="72969" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="72970" class="Symbol">}{</a><a id="72972" href="Demos.HSP.html#72972" class="Bound">ğ‘¨</a> <a id="72974" class="Symbol">:</a> <a id="72976" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="72984" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="72986" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="72988" class="Symbol">}(</a><a id="72990" href="Demos.HSP.html#72990" class="Bound">h</a> <a id="72992" class="Symbol">:</a> <a id="72994" href="Demos.HSP.html#72960" class="Bound">X</a> <a id="72996" class="Symbol">â†’</a> <a id="72998" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="73001" href="Demos.HSP.html#72972" class="Bound">ğ‘¨</a> <a id="73003" href="Demos.HSP.html#25552" class="Function Operator">]</a><a id="73004" class="Symbol">)</a> <a id="73006" class="Keyword">where</a>
 <a id="73013" href="Demos.HSP.html#73013" class="Function">free-lift</a> <a id="73023" class="Symbol">:</a> <a id="73025" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="73028" href="Demos.HSP.html#53076" class="Function">ğ‘»</a> <a id="73030" href="Demos.HSP.html#72960" class="Bound">X</a> <a id="73032" href="Demos.HSP.html#25552" class="Function Operator">]</a> <a id="73034" class="Symbol">â†’</a> <a id="73036" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="73039" href="Demos.HSP.html#72972" class="Bound">ğ‘¨</a> <a id="73041" href="Demos.HSP.html#25552" class="Function Operator">]</a>
 <a id="73044" href="Demos.HSP.html#73013" class="Function">free-lift</a> <a id="73054" class="Symbol">(</a><a id="73055" href="Demos.HSP.html#50803" class="InductiveConstructor">â„Š</a> <a id="73057" href="Demos.HSP.html#73057" class="Bound">x</a><a id="73058" class="Symbol">)</a>       <a id="73066" class="Symbol">=</a> <a id="73068" href="Demos.HSP.html#72990" class="Bound">h</a> <a id="73070" href="Demos.HSP.html#73057" class="Bound">x</a>
 <a id="73073" href="Demos.HSP.html#73013" class="Function">free-lift</a> <a id="73083" class="Symbol">(</a><a id="73084" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="73089" href="Demos.HSP.html#73089" class="Bound">f</a> <a id="73091" href="Demos.HSP.html#73091" class="Bound">t</a><a id="73092" class="Symbol">)</a>  <a id="73095" class="Symbol">=</a> <a id="73097" class="Symbol">(</a><a id="73098" href="Demos.HSP.html#73089" class="Bound">f</a> <a id="73100" href="Demos.HSP.html#25610" class="Function Operator">Ì‚</a> <a id="73102" href="Demos.HSP.html#72972" class="Bound">ğ‘¨</a><a id="73103" class="Symbol">)</a> <a id="73105" class="Symbol">Î»</a> <a id="73107" href="Demos.HSP.html#73107" class="Bound">i</a> <a id="73109" class="Symbol">â†’</a> <a id="73111" href="Demos.HSP.html#73013" class="Function">free-lift</a> <a id="73121" class="Symbol">(</a><a id="73122" href="Demos.HSP.html#73091" class="Bound">t</a> <a id="73124" href="Demos.HSP.html#73107" class="Bound">i</a><a id="73125" class="Symbol">)</a>

 <a id="73129" href="Demos.HSP.html#73129" class="Function">free-lift-func</a> <a id="73144" class="Symbol">:</a> <a id="73146" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="73149" href="Demos.HSP.html#53076" class="Function">ğ‘»</a> <a id="73151" href="Demos.HSP.html#72960" class="Bound">X</a> <a id="73153" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="73155" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="73157" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="73160" href="Demos.HSP.html#72972" class="Bound">ğ‘¨</a> <a id="73162" href="Demos.HSP.html#25499" class="Function Operator">]</a>
 <a id="73165" href="Demos.HSP.html#73129" class="Function">free-lift-func</a> <a id="73180" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="73184" href="Demos.HSP.html#73184" class="Bound">x</a> <a id="73186" class="Symbol">=</a> <a id="73188" href="Demos.HSP.html#73013" class="Function">free-lift</a> <a id="73198" href="Demos.HSP.html#73184" class="Bound">x</a>
 <a id="73201" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="73206" href="Demos.HSP.html#73129" class="Function">free-lift-func</a> <a id="73221" class="Symbol">=</a> <a id="73223" href="Demos.HSP.html#73310" class="Function">flcong</a> <a id="73230" class="Keyword">where</a>
  <a id="73238" class="Keyword">open</a> <a id="73243" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="73250" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="73253" href="Demos.HSP.html#72972" class="Bound">ğ‘¨</a> <a id="73255" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="73257" class="Keyword">using</a> <a id="73263" class="Symbol">(</a> <a id="73265" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="73269" class="Symbol">)</a> <a id="73271" class="Keyword">renaming</a> <a id="73280" class="Symbol">(</a> <a id="73282" href="Relation.Binary.Structures.html#1646" class="Function">reflexive</a> <a id="73292" class="Symbol">to</a> <a id="73295" class="Function">reflexiveá´¬</a> <a id="73306" class="Symbol">)</a>
  <a id="73310" href="Demos.HSP.html#73310" class="Function">flcong</a> <a id="73317" class="Symbol">:</a> <a id="73319" class="Symbol">âˆ€</a> <a id="73321" class="Symbol">{</a><a id="73322" href="Demos.HSP.html#73322" class="Bound">s</a> <a id="73324" href="Demos.HSP.html#73324" class="Bound">t</a><a id="73325" class="Symbol">}</a> <a id="73327" class="Symbol">â†’</a> <a id="73329" href="Demos.HSP.html#73322" class="Bound">s</a> <a id="73331" href="Demos.HSP.html#51259" class="Datatype Operator">â‰ƒ</a> <a id="73333" href="Demos.HSP.html#73324" class="Bound">t</a> <a id="73335" class="Symbol">â†’</a> <a id="73337" href="Demos.HSP.html#73013" class="Function">free-lift</a> <a id="73347" href="Demos.HSP.html#73322" class="Bound">s</a> <a id="73349" href="Relation.Binary.Bundles.html#1098" class="Function Operator">â‰ˆ</a> <a id="73351" href="Demos.HSP.html#73013" class="Function">free-lift</a> <a id="73361" href="Demos.HSP.html#73324" class="Bound">t</a>
  <a id="73365" href="Demos.HSP.html#73310" class="Function">flcong</a> <a id="73372" class="Symbol">(</a><a id="73373" href="Demos.HSP.html#51303" class="InductiveConstructor">_â‰ƒ_.rfl</a> <a id="73381" href="Demos.HSP.html#73381" class="Bound">x</a><a id="73382" class="Symbol">)</a> <a id="73384" class="Symbol">=</a> <a id="73386" href="Demos.HSP.html#73295" class="Function">reflexiveá´¬</a> <a id="73397" class="Symbol">(</a><a id="73398" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">â‰¡.cong</a> <a id="73405" href="Demos.HSP.html#72990" class="Bound">h</a> <a id="73407" href="Demos.HSP.html#73381" class="Bound">x</a><a id="73408" class="Symbol">)</a>
  <a id="73412" href="Demos.HSP.html#73310" class="Function">flcong</a> <a id="73419" class="Symbol">(</a><a id="73420" href="Demos.HSP.html#51345" class="InductiveConstructor">_â‰ƒ_.gnl</a> <a id="73428" href="Demos.HSP.html#73428" class="Bound">x</a><a id="73429" class="Symbol">)</a> <a id="73431" class="Symbol">=</a> <a id="73433" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="73438" class="Symbol">(</a><a id="73439" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="73446" href="Demos.HSP.html#72972" class="Bound">ğ‘¨</a><a id="73447" class="Symbol">)</a> <a id="73449" class="Symbol">(</a><a id="73450" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="73457" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="73459" class="Symbol">Î»</a> <a id="73461" href="Demos.HSP.html#73461" class="Bound">i</a> <a id="73463" class="Symbol">â†’</a> <a id="73465" href="Demos.HSP.html#73310" class="Function">flcong</a> <a id="73472" class="Symbol">(</a><a id="73473" href="Demos.HSP.html#73428" class="Bound">x</a> <a id="73475" href="Demos.HSP.html#73461" class="Bound">i</a><a id="73476" class="Symbol">))</a>

 <a id="73481" href="Demos.HSP.html#73481" class="Function">lift-hom</a> <a id="73490" class="Symbol">:</a> <a id="73492" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="73496" class="Symbol">(</a><a id="73497" href="Demos.HSP.html#53076" class="Function">ğ‘»</a> <a id="73499" href="Demos.HSP.html#72960" class="Bound">X</a><a id="73500" class="Symbol">)</a> <a id="73502" href="Demos.HSP.html#72972" class="Bound">ğ‘¨</a>
 <a id="73505" href="Demos.HSP.html#73481" class="Function">lift-hom</a> <a id="73514" class="Symbol">=</a> <a id="73516" href="Demos.HSP.html#73129" class="Function">free-lift-func</a> <a id="73531" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a>
   <a id="73536" href="Demos.HSP.html#34487" class="InductiveConstructor">mkhom</a> <a id="73542" class="Symbol">Î»{</a><a id="73544" href="Demos.HSP.html#73544" class="Bound">_</a><a id="73545" class="Symbol">}{</a><a id="73547" href="Demos.HSP.html#73547" class="Bound">a</a><a id="73548" class="Symbol">}</a> <a id="73550" class="Symbol">â†’</a> <a id="73552" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="73557" class="Symbol">(</a><a id="73558" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="73565" href="Demos.HSP.html#72972" class="Bound">ğ‘¨</a><a id="73566" class="Symbol">)</a> <a id="73568" class="Symbol">(</a><a id="73569" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="73576" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="73578" class="Symbol">Î»</a> <a id="73580" href="Demos.HSP.html#73580" class="Bound">i</a> <a id="73582" class="Symbol">â†’</a> <a id="73584" class="Symbol">(</a><a id="73585" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="73590" href="Demos.HSP.html#73129" class="Function">free-lift-func</a><a id="73604" class="Symbol">){</a><a id="73606" href="Demos.HSP.html#73547" class="Bound">a</a> <a id="73608" href="Demos.HSP.html#73580" class="Bound">i</a><a id="73609" class="Symbol">}</a> <a id="73611" href="Demos.HSP.html#51663" class="Function">â‰ƒ-isRefl</a><a id="73619" class="Symbol">)</a>

</pre>

It turns out that the interpretation of a term \ab p in an environment \ab{Î·} is the same
as the free lift of \ab{Î·} evaluated at \ab p. We apply this fact a number of times in the sequel.

<pre class="Agda">

<a id="73838" class="Keyword">module</a> <a id="73845" href="Demos.HSP.html#73845" class="Module">_</a>  <a id="73848" class="Symbol">{</a><a id="73849" href="Demos.HSP.html#73849" class="Bound">X</a> <a id="73851" class="Symbol">:</a> <a id="73853" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="73858" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="73859" class="Symbol">}</a> <a id="73861" class="Symbol">{</a><a id="73862" href="Demos.HSP.html#73862" class="Bound">ğ‘¨</a> <a id="73864" class="Symbol">:</a> <a id="73866" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="73874" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="73876" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="73878" class="Symbol">}</a>   <a id="73882" class="Keyword">where</a>
 <a id="73889" class="Keyword">open</a> <a id="73894" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="73901" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="73904" href="Demos.HSP.html#73862" class="Bound">ğ‘¨</a> <a id="73906" href="Demos.HSP.html#25499" class="Function Operator">]</a>  <a id="73909" class="Keyword">using</a> <a id="73915" class="Symbol">(</a> <a id="73917" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="73921" class="Symbol">;</a> <a id="73923" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="73928" class="Symbol">)</a>
 <a id="73931" class="Keyword">open</a> <a id="73936" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="73948" href="Demos.HSP.html#73862" class="Bound">ğ‘¨</a>  <a id="73951" class="Keyword">using</a> <a id="73957" class="Symbol">(</a> <a id="73959" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="73963" class="Symbol">)</a>

 <a id="73967" href="Demos.HSP.html#73967" class="Function">free-lift-interp</a> <a id="73984" class="Symbol">:</a> <a id="73986" class="Symbol">(</a><a id="73987" href="Demos.HSP.html#73987" class="Bound">Î·</a> <a id="73989" class="Symbol">:</a> <a id="73991" href="Demos.HSP.html#73849" class="Bound">X</a> <a id="73993" class="Symbol">â†’</a> <a id="73995" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="73998" href="Demos.HSP.html#73862" class="Bound">ğ‘¨</a> <a id="74000" href="Demos.HSP.html#25552" class="Function Operator">]</a><a id="74001" class="Symbol">)(</a><a id="74003" href="Demos.HSP.html#74003" class="Bound">p</a> <a id="74005" class="Symbol">:</a> <a id="74007" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="74012" href="Demos.HSP.html#73849" class="Bound">X</a><a id="74013" class="Symbol">)</a> <a id="74015" class="Symbol">â†’</a> <a id="74017" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="74019" href="Demos.HSP.html#74003" class="Bound">p</a> <a id="74021" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="74023" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="74027" href="Demos.HSP.html#73987" class="Bound">Î·</a> <a id="74029" href="Relation.Binary.Bundles.html#1098" class="Function Operator">â‰ˆ</a> <a id="74031" class="Symbol">(</a><a id="74032" href="Demos.HSP.html#73013" class="Function">free-lift</a><a id="74041" class="Symbol">{</a><a id="74042" class="Argument">ğ‘¨</a> <a id="74044" class="Symbol">=</a> <a id="74046" href="Demos.HSP.html#73862" class="Bound">ğ‘¨</a><a id="74047" class="Symbol">}</a> <a id="74049" href="Demos.HSP.html#73987" class="Bound">Î·</a><a id="74050" class="Symbol">)</a> <a id="74052" href="Demos.HSP.html#74003" class="Bound">p</a>
 <a id="74055" href="Demos.HSP.html#73967" class="Function">free-lift-interp</a> <a id="74072" href="Demos.HSP.html#74072" class="Bound">Î·</a> <a id="74074" class="Symbol">(</a><a id="74075" href="Demos.HSP.html#50803" class="InductiveConstructor">â„Š</a> <a id="74077" href="Demos.HSP.html#74077" class="Bound">x</a><a id="74078" class="Symbol">)</a>       <a id="74086" class="Symbol">=</a> <a id="74088" href="Relation.Binary.Structures.html#1568" class="Function">refl</a>
 <a id="74094" href="Demos.HSP.html#73967" class="Function">free-lift-interp</a> <a id="74111" href="Demos.HSP.html#74111" class="Bound">Î·</a> <a id="74113" class="Symbol">(</a><a id="74114" href="Demos.HSP.html#50819" class="InductiveConstructor">node</a> <a id="74119" href="Demos.HSP.html#74119" class="Bound">f</a> <a id="74121" href="Demos.HSP.html#74121" class="Bound">t</a><a id="74122" class="Symbol">)</a>  <a id="74125" class="Symbol">=</a> <a id="74127" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="74132" class="Symbol">(</a><a id="74133" href="Demos.HSP.html#24652" class="Field">Interp</a> <a id="74140" href="Demos.HSP.html#73862" class="Bound">ğ‘¨</a><a id="74141" class="Symbol">)</a> <a id="74143" class="Symbol">(</a><a id="74144" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">â‰¡.refl</a> <a id="74151" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="74153" class="Symbol">(</a><a id="74154" href="Demos.HSP.html#73967" class="Function">free-lift-interp</a> <a id="74171" href="Demos.HSP.html#74111" class="Bound">Î·</a><a id="74172" class="Symbol">)</a> <a id="74174" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="74176" href="Demos.HSP.html#74121" class="Bound">t</a><a id="74177" class="Symbol">)</a>
</pre>
%% -----------------------------------------------------------------------------
\paragraph*{The relatively free algebra}
Given an arbitrary class \ab{ğ’¦} of \ab{ğ‘†}-algebras, we cannot expect that \T{X} belongs to \ab{ğ’¦}.
%, so we say \T{X} is free \emph{for} \ab{ğ’¦} (as opposed to free \emph{in} \ab{ğ’¦}).
Indeed, there may be no free algebra in \ab{ğ’¦}.
Nonetheless, it is always possible to construct an algebra that is free for \ab{ğ’¦} and belongs to the class \af{S} (\af{P} \ab{ğ’¦}).
Such an algebra is called a \defn{relatively free algebra over} \ab{X} (relative to \ab{ğ’¦}).
There are several informal approaches to defining this algebra.
We now describe the approach on which our formal construction is based and then we present the formalization.

Let \Free{X} denote the relatively free algebra over \ab{X}.  We represent
\Free{X} as the quotient
\T{X}~\af{/}~\afld{â‰ˆ} where \ab x~\afld{â‰ˆ}~\ab y if and only if
\ab h \ab x = \ab h \ab y for every homomorphism \ab h from \T{X} into a member of \ab{ğ’¦}.
%Then \Free{X} satisfies the identities in \af{Th} \ab{ğ’¦}.
%Indeed, for each pair \ab p \ab q : \Term{X}, if \ab{ğ’¦} \af{âŠ«} \ab p \af{â‰ˆ} \ab
%q, then \ab p and \ab q belong to the same \afld{â‰ˆ}-class, so \ab p and \ab q are
%identified in \Free{X}.
More precisely, if \ab{ğ‘¨}~\aof{âˆˆ}~\ab{ğ’¦} and \ab h~\as{:}~\af{hom}~(\T{X})~\ab{ğ‘¨}, then \ab h factors as \T{X} $\overset{\text{\ab h}}{\twoheadrightarrow}$ \af{HomIm}~\ab h $\overset{âŠ†}{â†£}$ \ab{ğ‘¨} and \T{X}~\af{/}~\af{ker}~\ab h â‰… \af{HomIm}~\ab h â‰¤ \ab{ğ‘¨}; that is, \T{X}~\af{/}~\af{ker}~\ab h is (isomorphic to) an algebra in \af{S}~\ab{ğ’¦}. Letting
\afld{â‰ˆ} := â‹‚ \{\ab{Î¸}~\aof{âˆˆ}~\ab{Con}~\T{X}~âˆ£~\T{X}~\af{/}~\ab{Î¸}~\aof{âˆˆ}~\af{S} \ab{ğ’¦}\},
observe that \Free{X} := \T{X}~\af{/}~\afld{â‰ˆ} is a subdirect product of the algebras \{\T{X}~\af{/}~\af{ker}~\ab h\!\}
as \ab h ranges over all homomorphisms from \T{X} to algebras in \ab{ğ’¦}.  Thus, \Free{X} \af{âˆˆ}
\af{P} (\af{S} \ab{ğ’¦}) \aof{âŠ†} \af{S} (\af{P} \ab{ğ’¦}).
As we have seen,
%if \ab{ğ‘¨}~\aof{âˆˆ}~\ab{ğ’¦}, then
every map \ab{Ï} : \ab X â†’ \aof{ğ•Œ[}~\ab{ğ‘¨}~\aof{]}
extends uniquely to a homomorphism \ab h~\as{:}~\af{hom}~(\T{X})~\ab{ğ‘¨} and \ab h
factors through the natural projection \T{X}~\as{â†’}~\Free{X} (since \afld{â‰ˆ}~\aof{âŠ†}~\af{ker}~\ab h) yielding a unique homomorphism from \Free{X} to \ab{ğ‘¨} extending Ï.
%â‰… \af{HomIm}~\ab h â‰¤ \ab{ğ‘©}
%~\ab{Î¸}~\aof{âˆˆ}~\ab{Con}~\ab{ğ‘¨} and

%\T{X}~\af{/}~\af{ker}~\ab h
%Moreover, \ab x~\afld{â‰ˆ}~\ab y if and only if the pair (\ab x,~\ab y) belongs to all congruences \ab{Î¸}~\aof{âˆˆ}~\ab{Con}~\ab{ğ‘¨} where \ab{ğ‘¨} ranges over homomorphic images of algebras in \af{S}~\ab{ğ’¦}.


%Evidently \Free{X} is a subdirect product of all the algebras in \ab{ğ’¦}.

In \agda we construct \Free{X} as a homomorphic image of \T{X} in the following way.
First, given \ab X we define \ab{ğ‘ª} as the product of pairs (\ab{ğ‘¨}, \ab{Ï}) of
algebras \ab{ğ‘¨}~\aof{âˆˆ}~\ab{ğ’¦} along with environments \ab{Ï}~\as{:}~\ab X~\as{â†’}~\aof{ğ•Œ[}~\ab{ğ‘¨}~\aof{]}.
To do so, we contrive an index type for the product;
%class \ab{ğ’¦} by letting the indices be the algebras in \ab{ğ’¦}. Actually,
each index is a triple (\ab{ğ‘¨}, \ab p, \ab{Ï}) where \ab{ğ‘¨} is an algebra, \ab p is proof of \ab{ğ‘¨}~\aof{âˆˆ}~\ab{ğ’¦}, and \ab{Ï}~\as{:}~\ab X~\as{â†’}~\aof{ğ•Œ[}~\ab{ğ‘¨}~\aof{]} is an arbitrary environment.
%Using this indexing scheme, we construct \ab{ğ‘ª}, as follows.
%The indexing type \ab{â„‘} %, the family of algebras \ab{ğ”„},
%and the product \ab{ğ‘ª} are defined as follows.

<pre class="Agda">

<a id="77672" class="Keyword">module</a> <a id="FreeAlgebra"></a><a id="77679" href="Demos.HSP.html#77679" class="Module">FreeAlgebra</a> <a id="77691" class="Symbol">(</a><a id="77692" href="Demos.HSP.html#77692" class="Bound">ğ’¦</a> <a id="77694" class="Symbol">:</a> <a id="77696" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="77701" class="Symbol">(</a><a id="77702" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="77710" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="77712" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="77714" class="Symbol">)</a> <a id="77716" href="Demos.HSP.html#9462" class="Generalizable">â„“</a><a id="77717" class="Symbol">)</a> <a id="77719" class="Keyword">where</a>
 <a id="77726" class="Keyword">private</a> <a id="FreeAlgebra.c"></a><a id="77734" href="Demos.HSP.html#77734" class="Function">c</a> <a id="77736" class="Symbol">=</a> <a id="77738" href="Demos.HSP.html#77710" class="Bound">Î±</a> <a id="77740" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="77742" href="Demos.HSP.html#77712" class="Bound">Ïáµƒ</a> <a id="77745" class="Symbol">;</a> <a id="FreeAlgebra.Î¹"></a><a id="77747" href="Demos.HSP.html#77747" class="Function">Î¹</a> <a id="77749" class="Symbol">=</a> <a id="77751" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="77754" href="Demos.HSP.html#77734" class="Function">c</a> <a id="77756" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="77758" href="Demos.HSP.html#77716" class="Bound">â„“</a>
 <a id="FreeAlgebra.â„‘"></a><a id="77761" href="Demos.HSP.html#77761" class="Function">â„‘</a> <a id="77763" class="Symbol">:</a> <a id="77765" class="Symbol">{</a><a id="77766" href="Demos.HSP.html#77766" class="Bound">Ï‡</a> <a id="77768" class="Symbol">:</a> <a id="77770" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="77775" class="Symbol">}</a> <a id="77777" class="Symbol">â†’</a> <a id="77779" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="77784" href="Demos.HSP.html#77766" class="Bound">Ï‡</a> <a id="77786" class="Symbol">â†’</a> <a id="77788" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="77793" class="Symbol">(</a><a id="77794" href="Demos.HSP.html#77747" class="Function">Î¹</a> <a id="77796" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="77798" href="Demos.HSP.html#77766" class="Bound">Ï‡</a><a id="77799" class="Symbol">)</a>
 <a id="77802" href="Demos.HSP.html#77761" class="Function">â„‘</a> <a id="77804" href="Demos.HSP.html#77804" class="Bound">X</a> <a id="77806" class="Symbol">=</a> <a id="77808" href="Data.Product.html#916" class="Function">Î£[</a> <a id="77811" href="Demos.HSP.html#77811" class="Bound">ğ‘¨</a> <a id="77813" href="Data.Product.html#916" class="Function">âˆˆ</a> <a id="77815" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="77823" href="Demos.HSP.html#77710" class="Bound">Î±</a> <a id="77825" href="Demos.HSP.html#77712" class="Bound">Ïáµƒ</a> <a id="77828" href="Data.Product.html#916" class="Function">]</a> <a id="77830" href="Demos.HSP.html#77811" class="Bound">ğ‘¨</a> <a id="77832" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="77834" href="Demos.HSP.html#77692" class="Bound">ğ’¦</a> <a id="77836" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="77838" class="Symbol">(</a><a id="77839" href="Demos.HSP.html#77804" class="Bound">X</a> <a id="77841" class="Symbol">â†’</a> <a id="77843" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="77846" href="Demos.HSP.html#77811" class="Bound">ğ‘¨</a> <a id="77848" href="Demos.HSP.html#25552" class="Function Operator">]</a><a id="77849" class="Symbol">)</a>

 <a id="FreeAlgebra.ğ‘ª"></a><a id="77853" href="Demos.HSP.html#77853" class="Function">ğ‘ª</a> <a id="77855" class="Symbol">:</a> <a id="77857" class="Symbol">{</a><a id="77858" href="Demos.HSP.html#77858" class="Bound">Ï‡</a> <a id="77860" class="Symbol">:</a> <a id="77862" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="77867" class="Symbol">}</a> <a id="77869" class="Symbol">â†’</a> <a id="77871" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="77876" href="Demos.HSP.html#77858" class="Bound">Ï‡</a> <a id="77878" class="Symbol">â†’</a> <a id="77880" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="77888" class="Symbol">(</a><a id="77889" href="Demos.HSP.html#77747" class="Function">Î¹</a> <a id="77891" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="77893" href="Demos.HSP.html#77858" class="Bound">Ï‡</a><a id="77894" class="Symbol">)(</a><a id="77896" href="Demos.HSP.html#77747" class="Function">Î¹</a> <a id="77898" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="77900" href="Demos.HSP.html#77858" class="Bound">Ï‡</a><a id="77901" class="Symbol">)</a>
 <a id="77904" href="Demos.HSP.html#77853" class="Function">ğ‘ª</a> <a id="77906" href="Demos.HSP.html#77906" class="Bound">X</a> <a id="77908" class="Symbol">=</a> <a id="77910" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="77912" class="Symbol">{</a><a id="77913" class="Argument">I</a> <a id="77915" class="Symbol">=</a> <a id="77917" href="Demos.HSP.html#77761" class="Function">â„‘</a> <a id="77919" href="Demos.HSP.html#77906" class="Bound">X</a><a id="77920" class="Symbol">}</a> <a id="77922" href="Demos.HSP.html#10362" class="Function Operator">âˆ£_âˆ£</a>

</pre>
We then define \Free{X} to be the image of a homomorphism from \T{X} to \ab{ğ‘ª} as follows.

<pre class="Agda">

 <a id="FreeAlgebra.homC"></a><a id="78045" href="Demos.HSP.html#78045" class="Function">homC</a> <a id="78050" class="Symbol">:</a> <a id="78052" class="Symbol">(</a><a id="78053" href="Demos.HSP.html#78053" class="Bound">X</a> <a id="78055" class="Symbol">:</a> <a id="78057" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="78062" href="Demos.HSP.html#9460" class="Generalizable">Ï‡</a><a id="78063" class="Symbol">)</a> <a id="78065" class="Symbol">â†’</a> <a id="78067" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="78071" class="Symbol">(</a><a id="78072" href="Demos.HSP.html#53076" class="Function">ğ‘»</a> <a id="78074" href="Demos.HSP.html#78053" class="Bound">X</a><a id="78075" class="Symbol">)</a> <a id="78077" class="Symbol">(</a><a id="78078" href="Demos.HSP.html#77853" class="Function">ğ‘ª</a> <a id="78080" href="Demos.HSP.html#78053" class="Bound">X</a><a id="78081" class="Symbol">)</a>
 <a id="78084" href="Demos.HSP.html#78045" class="Function">homC</a> <a id="78089" href="Demos.HSP.html#78089" class="Bound">X</a> <a id="78091" class="Symbol">=</a> <a id="78093" href="Demos.HSP.html#40337" class="Function">â¨…-hom-co</a> <a id="78102" class="Symbol">_</a> <a id="78104" class="Symbol">(Î»</a> <a id="78107" href="Demos.HSP.html#78107" class="Bound">i</a> <a id="78109" class="Symbol">â†’</a> <a id="78111" href="Demos.HSP.html#73481" class="Function">lift-hom</a> <a id="78120" class="Symbol">(</a><a id="78121" href="Demos.HSP.html#8443" class="Field">snd</a> <a id="78125" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="78127" href="Demos.HSP.html#78107" class="Bound">i</a> <a id="78129" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a><a id="78130" class="Symbol">))</a>

 <a id="FreeAlgebra.ğ”½[_]"></a><a id="78135" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[_]</a> <a id="78140" class="Symbol">:</a> <a id="78142" class="Symbol">{</a><a id="78143" href="Demos.HSP.html#78143" class="Bound">Ï‡</a> <a id="78145" class="Symbol">:</a> <a id="78147" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="78152" class="Symbol">}</a> <a id="78154" class="Symbol">â†’</a> <a id="78156" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="78161" href="Demos.HSP.html#78143" class="Bound">Ï‡</a> <a id="78163" class="Symbol">â†’</a> <a id="78165" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="78173" class="Symbol">(</a><a id="78174" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="78177" href="Demos.HSP.html#78143" class="Bound">Ï‡</a><a id="78178" class="Symbol">)</a> <a id="78180" class="Symbol">(</a><a id="78181" href="Demos.HSP.html#77747" class="Function">Î¹</a> <a id="78183" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="78185" href="Demos.HSP.html#78143" class="Bound">Ï‡</a><a id="78186" class="Symbol">)</a>
 <a id="78189" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="78192" href="Demos.HSP.html#78192" class="Bound">X</a> <a id="78194" href="Demos.HSP.html#78135" class="Function Operator">]</a> <a id="78196" class="Symbol">=</a> <a id="78198" href="Demos.HSP.html#45682" class="Function">HomIm</a> <a id="78204" class="Symbol">(</a><a id="78205" href="Demos.HSP.html#78045" class="Function">homC</a> <a id="78210" href="Demos.HSP.html#78192" class="Bound">X</a><a id="78211" class="Symbol">)</a>

</pre>

Observe that if the identity \ab{p} \af{â‰ˆ} \ab q holds in all \ab{ğ‘¨} \aof{âˆˆ} \ab{ğ’¦} (for all environments), then \ab p \af{â‰ˆ} \ab q holds in \Free{X}; equivalently, the pair (\ab p , \ab q) belongs to the
kernel of the natural homomorphism from \T{X} onto \Free{X}.
This natural epimorphism %from \T{X} onto \Free{X} %(= \T{X}~\af{/}~\afld{â‰ˆ})
is defined as follows.%
%and prove that its kernel is contained in the collection of identities modeled
%by \af{V} \ab{ğ’¦}.%(which we represent by \af{Th} (\af{V} \ab{ğ’¦})).
\ifshort%
\footnote{The \AgdaFunction{HomReduct} method of the \ar{IsEpi} record type extracts the \af{hom} part of an epimorphism.}
\fi

<pre class="Agda">

<a id="78894" class="Keyword">module</a> <a id="FreeHom"></a><a id="78901" href="Demos.HSP.html#78901" class="Module">FreeHom</a> <a id="78909" class="Symbol">{</a><a id="78910" href="Demos.HSP.html#78910" class="Bound">ğ’¦</a> <a id="78912" class="Symbol">:</a> <a id="78914" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="78918" class="Symbol">(</a><a id="78919" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="78927" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="78929" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="78931" class="Symbol">)</a> <a id="78933" class="Symbol">(</a><a id="78934" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="78936" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="78938" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="78941" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="78943" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="78946" href="Demos.HSP.html#9462" class="Generalizable">â„“</a><a id="78947" class="Symbol">)}</a> <a id="78950" class="Keyword">where</a>
 <a id="78957" class="Keyword">private</a> <a id="FreeHom.c"></a><a id="78965" href="Demos.HSP.html#78965" class="Function">c</a> <a id="78967" class="Symbol">=</a> <a id="78969" href="Demos.HSP.html#78927" class="Bound">Î±</a> <a id="78971" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="78973" href="Demos.HSP.html#78929" class="Bound">Ïáµƒ</a> <a id="78976" class="Symbol">;</a> <a id="FreeHom.Î¹"></a><a id="78978" href="Demos.HSP.html#78978" class="Function">Î¹</a> <a id="78980" class="Symbol">=</a> <a id="78982" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="78985" href="Demos.HSP.html#78965" class="Function">c</a> <a id="78987" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="78989" href="Demos.HSP.html#78946" class="Bound">â„“</a>
 <a id="78992" class="Keyword">open</a> <a id="78997" href="Demos.HSP.html#77679" class="Module">FreeAlgebra</a> <a id="79009" href="Demos.HSP.html#78910" class="Bound">ğ’¦</a> <a id="79011" class="Keyword">using</a> <a id="79017" class="Symbol">(</a> <a id="79019" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[_]</a> <a id="79024" class="Symbol">;</a> <a id="79026" href="Demos.HSP.html#78045" class="Function">homC</a> <a id="79031" class="Symbol">)</a>

 <a id="FreeHom.epiF[_]"></a><a id="79035" href="Demos.HSP.html#79035" class="Function Operator">epiF[_]</a> <a id="79043" class="Symbol">:</a> <a id="79045" class="Symbol">(</a><a id="79046" href="Demos.HSP.html#79046" class="Bound">X</a> <a id="79048" class="Symbol">:</a> <a id="79050" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="79055" href="Demos.HSP.html#78965" class="Function">c</a><a id="79056" class="Symbol">)</a> <a id="79058" class="Symbol">â†’</a> <a id="79060" href="Demos.HSP.html#35676" class="Function">epi</a> <a id="79064" class="Symbol">(</a><a id="79065" href="Demos.HSP.html#53076" class="Function">ğ‘»</a> <a id="79067" href="Demos.HSP.html#79046" class="Bound">X</a><a id="79068" class="Symbol">)</a> <a id="79070" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="79073" href="Demos.HSP.html#79046" class="Bound">X</a> <a id="79075" href="Demos.HSP.html#78135" class="Function Operator">]</a>
 <a id="79078" href="Demos.HSP.html#79035" class="Function Operator">epiF[</a> <a id="79084" href="Demos.HSP.html#79084" class="Bound">X</a> <a id="79086" href="Demos.HSP.html#79035" class="Function Operator">]</a> <a id="79088" class="Symbol">=</a> <a id="79090" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="79092" href="Demos.HSP.html#46301" class="Function">toHomIm</a> <a id="79100" class="Symbol">(</a><a id="79101" href="Demos.HSP.html#78045" class="Function">homC</a> <a id="79106" href="Demos.HSP.html#79084" class="Bound">X</a><a id="79107" class="Symbol">)</a> <a id="79109" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="79111" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="79113" class="Keyword">record</a>  <a id="79121" class="Symbol">{</a> <a id="79123" href="Demos.HSP.html#35577" class="Field">isHom</a> <a id="79129" class="Symbol">=</a> <a id="79131" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="79133" href="Demos.HSP.html#46301" class="Function">toHomIm</a> <a id="79141" class="Symbol">(</a><a id="79142" href="Demos.HSP.html#78045" class="Function">homC</a> <a id="79147" href="Demos.HSP.html#79084" class="Bound">X</a><a id="79148" class="Symbol">)</a> <a id="79150" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a>
                                            <a id="79196" class="Symbol">;</a> <a id="79198" href="Demos.HSP.html#35602" class="Field">isSurjective</a> <a id="79211" class="Symbol">=</a> <a id="79213" href="Demos.HSP.html#17495" class="Function">toIm-surj</a> <a id="79223" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="79225" href="Demos.HSP.html#78045" class="Function">homC</a> <a id="79230" href="Demos.HSP.html#79084" class="Bound">X</a> <a id="79232" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="79234" class="Symbol">}</a>

 <a id="FreeHom.homF[_]"></a><a id="79238" href="Demos.HSP.html#79238" class="Function Operator">homF[_]</a> <a id="79246" class="Symbol">:</a> <a id="79248" class="Symbol">(</a><a id="79249" href="Demos.HSP.html#79249" class="Bound">X</a> <a id="79251" class="Symbol">:</a> <a id="79253" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="79258" href="Demos.HSP.html#78965" class="Function">c</a><a id="79259" class="Symbol">)</a> <a id="79261" class="Symbol">â†’</a> <a id="79263" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="79267" class="Symbol">(</a><a id="79268" href="Demos.HSP.html#53076" class="Function">ğ‘»</a> <a id="79270" href="Demos.HSP.html#79249" class="Bound">X</a><a id="79271" class="Symbol">)</a> <a id="79273" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="79276" href="Demos.HSP.html#79249" class="Bound">X</a> <a id="79278" href="Demos.HSP.html#78135" class="Function Operator">]</a>
 <a id="79281" href="Demos.HSP.html#79238" class="Function Operator">homF[</a> <a id="79287" href="Demos.HSP.html#79287" class="Bound">X</a> <a id="79289" href="Demos.HSP.html#79238" class="Function Operator">]</a> <a id="79291" class="Symbol">=</a> <a id="79293" href="Demos.HSP.html#35634" class="Function">IsEpi.HomReduct</a> <a id="79309" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="79311" href="Demos.HSP.html#79035" class="Function Operator">epiF[</a> <a id="79317" href="Demos.HSP.html#79287" class="Bound">X</a> <a id="79319" href="Demos.HSP.html#79035" class="Function Operator">]</a> <a id="79321" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a>

</pre>

Before formalizing the HSP theorem in the next section, we need to prove the following important property of the relatively free algebra:
%(relative to \ab{ğ’¦} and satisfying the identities in \af{Th}~\ab{ğ’¦}),
For every algebra \ab{ğ‘¨}, if \ab{ğ‘¨}~\af{âŠ¨}~\ab{Th}~(\af{V}~\ab{ğ’¦}),
then there exists an epimorphism from \Free{A} onto \ab{ğ‘¨}, where \ab{A} denotes the carrier of \ab{ğ‘¨}.

<pre class="Agda">

<a id="79732" class="Keyword">module</a> <a id="79739" href="Demos.HSP.html#79739" class="Module">_</a> <a id="79741" class="Symbol">{</a><a id="79742" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a> <a id="79744" class="Symbol">:</a> <a id="79746" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="79754" class="Symbol">(</a><a id="79755" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="79757" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="79759" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="79762" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="79764" href="Demos.HSP.html#9462" class="Generalizable">â„“</a><a id="79765" class="Symbol">)(</a><a id="79767" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="79769" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="79771" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="79774" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="79776" href="Demos.HSP.html#9462" class="Generalizable">â„“</a><a id="79777" class="Symbol">)}{</a><a id="79780" href="Demos.HSP.html#79780" class="Bound">ğ’¦</a> <a id="79782" class="Symbol">:</a> <a id="79784" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="79788" class="Symbol">(</a><a id="79789" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="79797" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="79799" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="79801" class="Symbol">)(</a><a id="79803" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="79805" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="79807" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="79810" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="79812" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="79815" href="Demos.HSP.html#9462" class="Generalizable">â„“</a><a id="79816" class="Symbol">)}</a> <a id="79819" class="Keyword">where</a>
 <a id="79826" class="Keyword">private</a> <a id="79834" href="Demos.HSP.html#79834" class="Function">c</a> <a id="79836" class="Symbol">=</a> <a id="79838" href="Demos.HSP.html#79755" class="Bound">Î±</a> <a id="79840" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="79842" href="Demos.HSP.html#79759" class="Bound">Ïáµƒ</a> <a id="79845" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="79847" href="Demos.HSP.html#79764" class="Bound">â„“</a> <a id="79849" class="Symbol">;</a> <a id="79851" href="Demos.HSP.html#79851" class="Function">Î¹</a> <a id="79853" class="Symbol">=</a> <a id="79855" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="79858" href="Demos.HSP.html#79834" class="Function">c</a>
 <a id="79861" class="Keyword">open</a> <a id="79866" href="Demos.HSP.html#77679" class="Module">FreeAlgebra</a> <a id="79878" href="Demos.HSP.html#79780" class="Bound">ğ’¦</a> <a id="79880" class="Keyword">using</a> <a id="79886" class="Symbol">(</a> <a id="79888" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[_]</a> <a id="79893" class="Symbol">;</a> <a id="79895" href="Demos.HSP.html#77853" class="Function">ğ‘ª</a> <a id="79897" class="Symbol">)</a>
 <a id="79900" class="Keyword">open</a> <a id="79905" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="79912" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="79915" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a> <a id="79917" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="79919" class="Keyword">using</a> <a id="79925" class="Symbol">(</a> <a id="79927" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="79932" class="Symbol">;</a> <a id="79934" href="Relation.Binary.Structures.html#1594" class="Function">sym</a> <a id="79938" class="Symbol">;</a> <a id="79940" href="Relation.Binary.Structures.html#1620" class="Function">trans</a> <a id="79946" class="Symbol">)</a> <a id="79948" class="Keyword">renaming</a> <a id="79957" class="Symbol">(</a> <a id="79959" href="Relation.Binary.Bundles.html#1072" class="Field">Carrier</a> <a id="79967" class="Symbol">to</a> <a id="79970" class="Field">A</a> <a id="79972" class="Symbol">;</a> <a id="79974" href="Relation.Binary.Bundles.html#1098" class="Field Operator">_â‰ˆ_</a> <a id="79978" class="Symbol">to</a> <a id="79981" class="Field Operator">_â‰ˆá´¬_</a> <a id="79986" class="Symbol">)</a>

 <a id="79990" href="Demos.HSP.html#79990" class="Function">F-ModTh-epi</a> <a id="80002" class="Symbol">:</a> <a id="80004" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a> <a id="80006" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="80008" href="Demos.HSP.html#62967" class="Function">Mod</a> <a id="80012" class="Symbol">(</a><a id="80013" href="Demos.HSP.html#62869" class="Function">Th</a> <a id="80016" href="Demos.HSP.html#79780" class="Bound">ğ’¦</a><a id="80017" class="Symbol">)</a> <a id="80019" class="Symbol">â†’</a> <a id="80021" href="Demos.HSP.html#35676" class="Function">epi</a> <a id="80025" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="80028" href="Demos.HSP.html#79970" class="Function">A</a> <a id="80030" href="Demos.HSP.html#78135" class="Function Operator">]</a>  <a id="80033" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a>
 <a id="80036" href="Demos.HSP.html#79990" class="Function">F-ModTh-epi</a> <a id="80048" href="Demos.HSP.html#80048" class="Bound">AâˆˆModThK</a> <a id="80057" class="Symbol">=</a> <a id="80059" href="Demos.HSP.html#80078" class="Function">Ï†</a> <a id="80061" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="80063" href="Demos.HSP.html#80826" class="Function">isEpi</a> <a id="80069" class="Keyword">where</a>

  <a id="80078" href="Demos.HSP.html#80078" class="Function">Ï†</a> <a id="80080" class="Symbol">:</a> <a id="80082" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="80085" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="80088" href="Demos.HSP.html#79970" class="Function">A</a> <a id="80090" href="Demos.HSP.html#78135" class="Function Operator">]</a> <a id="80092" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="80094" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="80096" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="80099" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a> <a id="80101" href="Demos.HSP.html#25499" class="Function Operator">]</a>
  <a id="80105" href="Demos.HSP.html#8606" class="Field Operator">_âŸ¨$âŸ©_</a> <a id="80111" href="Demos.HSP.html#80078" class="Function">Ï†</a>            <a id="80124" class="Symbol">=</a> <a id="80126" href="Demos.HSP.html#73013" class="Function">free-lift</a><a id="80135" class="Symbol">{</a><a id="80136" class="Argument">ğ‘¨</a> <a id="80138" class="Symbol">=</a> <a id="80140" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a><a id="80141" class="Symbol">}</a> <a id="80143" href="Function.Base.html#615" class="Function">id</a>
  <a id="80148" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="80153" href="Demos.HSP.html#80078" class="Function">Ï†</a> <a id="80155" class="Symbol">{</a><a id="80156" href="Demos.HSP.html#80156" class="Bound">p</a><a id="80157" class="Symbol">}</a> <a id="80159" class="Symbol">{</a><a id="80160" href="Demos.HSP.html#80160" class="Bound">q</a><a id="80161" class="Symbol">}</a> <a id="80163" href="Demos.HSP.html#80163" class="Bound">pq</a>  <a id="80167" class="Symbol">=</a> <a id="80169" href="Demos.HSP.html#80497" class="Function">Goal</a>
   <a id="80177" class="Keyword">where</a>
   <a id="80186" href="Demos.HSP.html#80186" class="Function">lift-pq</a> <a id="80194" class="Symbol">:</a> <a id="80196" class="Symbol">(</a><a id="80197" href="Demos.HSP.html#80156" class="Bound">p</a> <a id="80199" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="80201" href="Demos.HSP.html#80160" class="Bound">q</a><a id="80202" class="Symbol">)</a> <a id="80204" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="80206" href="Demos.HSP.html#62869" class="Function">Th</a> <a id="80209" href="Demos.HSP.html#79780" class="Bound">ğ’¦</a>
   <a id="80214" href="Demos.HSP.html#80186" class="Function">lift-pq</a> <a id="80222" href="Demos.HSP.html#80222" class="Bound">ğ‘©</a> <a id="80224" href="Demos.HSP.html#80224" class="Bound">x</a> <a id="80226" href="Demos.HSP.html#80226" class="Bound">Ï</a> <a id="80228" class="Symbol">=</a> <a id="80230" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>
    <a id="80240" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="80242" href="Demos.HSP.html#80156" class="Bound">p</a> <a id="80244" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="80246" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="80250" href="Demos.HSP.html#80226" class="Bound">Ï</a>    <a id="80255" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a> <a id="80258" href="Demos.HSP.html#73967" class="Function">free-lift-interp</a> <a id="80275" class="Symbol">{</a><a id="80276" class="Argument">ğ‘¨</a> <a id="80278" class="Symbol">=</a> <a id="80280" href="Demos.HSP.html#80222" class="Bound">ğ‘©</a><a id="80281" class="Symbol">}</a> <a id="80283" href="Demos.HSP.html#80226" class="Bound">Ï</a> <a id="80285" href="Demos.HSP.html#80156" class="Bound">p</a>  <a id="80288" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
    <a id="80294" href="Demos.HSP.html#73013" class="Function">free-lift</a> <a id="80304" href="Demos.HSP.html#80226" class="Bound">Ï</a> <a id="80306" href="Demos.HSP.html#80156" class="Bound">p</a>  <a id="80309" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a> <a id="80312" href="Demos.HSP.html#80163" class="Bound">pq</a> <a id="80315" class="Symbol">(</a><a id="80316" href="Demos.HSP.html#80222" class="Bound">ğ‘©</a> <a id="80318" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="80320" href="Demos.HSP.html#80224" class="Bound">x</a> <a id="80322" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="80324" href="Demos.HSP.html#80226" class="Bound">Ï</a><a id="80325" class="Symbol">)</a>                <a id="80342" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
    <a id="80348" href="Demos.HSP.html#73013" class="Function">free-lift</a> <a id="80358" href="Demos.HSP.html#80226" class="Bound">Ï</a> <a id="80360" href="Demos.HSP.html#80160" class="Bound">q</a>  <a id="80363" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">â‰ˆË˜âŸ¨</a> <a id="80367" href="Demos.HSP.html#73967" class="Function">free-lift-interp</a><a id="80383" class="Symbol">{</a><a id="80384" class="Argument">ğ‘¨</a> <a id="80386" class="Symbol">=</a> <a id="80388" href="Demos.HSP.html#80222" class="Bound">ğ‘©</a><a id="80389" class="Symbol">}</a> <a id="80391" href="Demos.HSP.html#80226" class="Bound">Ï</a> <a id="80393" href="Demos.HSP.html#80160" class="Bound">q</a>  <a id="80396" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">âŸ©</a>
    <a id="80402" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="80404" href="Demos.HSP.html#80160" class="Bound">q</a> <a id="80406" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="80408" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="80412" href="Demos.HSP.html#80226" class="Bound">Ï</a>    <a id="80417" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">âˆ</a>
     <a id="80424" class="Keyword">where</a> <a id="80430" class="Keyword">open</a> <a id="80435" href="Relation.Binary.Reasoning.Setoid.html" class="Module">SetoidReasoning</a> <a id="80451" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="80454" href="Demos.HSP.html#80222" class="Bound">ğ‘©</a> <a id="80456" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="80458" class="Symbol">;</a> <a id="80460" class="Keyword">open</a> <a id="80465" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="80477" href="Demos.HSP.html#80222" class="Bound">ğ‘©</a> <a id="80479" class="Keyword">using</a> <a id="80485" class="Symbol">(</a> <a id="80487" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="80491" class="Symbol">)</a>

   <a id="80497" href="Demos.HSP.html#80497" class="Function">Goal</a> <a id="80502" class="Symbol">:</a> <a id="80504" href="Demos.HSP.html#73013" class="Function">free-lift</a> <a id="80514" href="Function.Base.html#615" class="Function">id</a> <a id="80517" href="Demos.HSP.html#80156" class="Bound">p</a> <a id="80519" href="Demos.HSP.html#79981" class="Function Operator">â‰ˆá´¬</a> <a id="80522" href="Demos.HSP.html#73013" class="Function">free-lift</a> <a id="80532" href="Function.Base.html#615" class="Function">id</a> <a id="80535" href="Demos.HSP.html#80160" class="Bound">q</a>
   <a id="80540" href="Demos.HSP.html#80497" class="Function">Goal</a> <a id="80545" class="Symbol">=</a> <a id="80547" href="Relation.Binary.Reasoning.Base.Single.html#1916" class="Function Operator">begin</a>
    <a id="80557" href="Demos.HSP.html#73013" class="Function">free-lift</a> <a id="80567" href="Function.Base.html#615" class="Function">id</a> <a id="80570" href="Demos.HSP.html#80156" class="Bound">p</a>  <a id="80573" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">â‰ˆË˜âŸ¨</a> <a id="80577" href="Demos.HSP.html#73967" class="Function">free-lift-interp</a> <a id="80594" class="Symbol">{</a><a id="80595" class="Argument">ğ‘¨</a> <a id="80597" class="Symbol">=</a> <a id="80599" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a><a id="80600" class="Symbol">}</a> <a id="80602" href="Function.Base.html#615" class="Function">id</a> <a id="80605" href="Demos.HSP.html#80156" class="Bound">p</a>   <a id="80609" href="Relation.Binary.Reasoning.Setoid.html#1153" class="Function">âŸ©</a>
    <a id="80615" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="80617" href="Demos.HSP.html#80156" class="Bound">p</a> <a id="80619" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="80621" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="80625" href="Function.Base.html#615" class="Function">id</a>    <a id="80631" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a> <a id="80634" href="Demos.HSP.html#80048" class="Bound">AâˆˆModThK</a> <a id="80643" class="Symbol">{</a><a id="80644" class="Argument">p</a> <a id="80646" class="Symbol">=</a> <a id="80648" href="Demos.HSP.html#80156" class="Bound">p</a><a id="80649" class="Symbol">}</a> <a id="80651" class="Symbol">{</a><a id="80652" href="Demos.HSP.html#80160" class="Bound">q</a><a id="80653" class="Symbol">}</a> <a id="80655" href="Demos.HSP.html#80186" class="Function">lift-pq</a> <a id="80663" href="Function.Base.html#615" class="Function">id</a>  <a id="80667" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
    <a id="80673" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦</a> <a id="80675" href="Demos.HSP.html#80160" class="Bound">q</a> <a id="80677" href="Demos.HSP.html#55417" class="Function Operator">âŸ§</a> <a id="80679" href="Demos.HSP.html#8606" class="Field Operator">âŸ¨$âŸ©</a> <a id="80683" href="Function.Base.html#615" class="Function">id</a>    <a id="80689" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">â‰ˆâŸ¨</a> <a id="80692" href="Demos.HSP.html#73967" class="Function">free-lift-interp</a> <a id="80709" class="Symbol">{</a><a id="80710" class="Argument">ğ‘¨</a> <a id="80712" class="Symbol">=</a> <a id="80714" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a><a id="80715" class="Symbol">}</a> <a id="80717" href="Function.Base.html#615" class="Function">id</a> <a id="80720" href="Demos.HSP.html#80160" class="Bound">q</a>    <a id="80725" href="Relation.Binary.Reasoning.Setoid.html#1052" class="Function">âŸ©</a>
    <a id="80731" href="Demos.HSP.html#73013" class="Function">free-lift</a> <a id="80741" href="Function.Base.html#615" class="Function">id</a> <a id="80744" href="Demos.HSP.html#80160" class="Bound">q</a>  <a id="80747" href="Relation.Binary.Reasoning.Base.Single.html#2555" class="Function Operator">âˆ</a>
     <a id="80754" class="Keyword">where</a> <a id="80760" class="Keyword">open</a> <a id="80765" href="Relation.Binary.Reasoning.Setoid.html" class="Module">SetoidReasoning</a> <a id="80781" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="80784" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a> <a id="80786" href="Demos.HSP.html#25499" class="Function Operator">]</a> <a id="80788" class="Symbol">;</a> <a id="80790" class="Keyword">open</a> <a id="80795" href="Demos.HSP.html#54843" class="Module">Environment</a> <a id="80807" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a> <a id="80809" class="Keyword">using</a> <a id="80815" class="Symbol">(</a> <a id="80817" href="Demos.HSP.html#55417" class="Function Operator">âŸ¦_âŸ§</a> <a id="80821" class="Symbol">)</a>

  <a id="80826" href="Demos.HSP.html#80826" class="Function">isEpi</a> <a id="80832" class="Symbol">:</a> <a id="80834" href="Demos.HSP.html#35506" class="Record">IsEpi</a> <a id="80840" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="80843" href="Demos.HSP.html#79970" class="Function">A</a> <a id="80845" href="Demos.HSP.html#78135" class="Function Operator">]</a> <a id="80847" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a> <a id="80849" href="Demos.HSP.html#80078" class="Function">Ï†</a>
  <a id="80853" href="Demos.HSP.html#80826" class="Function">isEpi</a> <a id="80859" class="Symbol">=</a> <a id="80861" class="Keyword">record</a> <a id="80868" class="Symbol">{</a> <a id="80870" href="Demos.HSP.html#35577" class="Field">isHom</a> <a id="80876" class="Symbol">=</a> <a id="80878" href="Demos.HSP.html#34487" class="InductiveConstructor">mkhom</a> <a id="80884" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="80889" class="Symbol">;</a> <a id="80891" href="Demos.HSP.html#35602" class="Field">isSurjective</a> <a id="80904" class="Symbol">=</a> <a id="80906" href="Demos.HSP.html#13459" class="InductiveConstructor">eq</a> <a id="80909" class="Symbol">(</a><a id="80910" href="Demos.HSP.html#50803" class="InductiveConstructor">â„Š</a> <a id="80912" class="Symbol">_)</a> <a id="80915" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="80920" class="Symbol">}</a>

 <a id="80924" href="Demos.HSP.html#80924" class="Function">F-ModThV-epi</a> <a id="80937" class="Symbol">:</a> <a id="80939" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a> <a id="80941" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="80943" href="Demos.HSP.html#62967" class="Function">Mod</a> <a id="80947" class="Symbol">(</a><a id="80948" href="Demos.HSP.html#62869" class="Function">Th</a> <a id="80951" class="Symbol">(</a><a id="80952" href="Demos.HSP.html#69808" class="Function">V</a> <a id="80954" href="Demos.HSP.html#79764" class="Bound">â„“</a> <a id="80956" href="Demos.HSP.html#79851" class="Function">Î¹</a> <a id="80958" href="Demos.HSP.html#79780" class="Bound">ğ’¦</a><a id="80959" class="Symbol">))</a> <a id="80962" class="Symbol">â†’</a> <a id="80964" href="Demos.HSP.html#35676" class="Function">epi</a> <a id="80968" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="80971" href="Demos.HSP.html#79970" class="Function">A</a> <a id="80973" href="Demos.HSP.html#78135" class="Function Operator">]</a>  <a id="80976" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a>
 <a id="80979" href="Demos.HSP.html#80924" class="Function">F-ModThV-epi</a> <a id="80992" href="Demos.HSP.html#80992" class="Bound">AâˆˆModThVK</a> <a id="81002" class="Symbol">=</a> <a id="81004" href="Demos.HSP.html#79990" class="Function">F-ModTh-epi</a> <a id="81016" class="Symbol">Î»</a> <a id="81018" class="Symbol">{</a><a id="81019" href="Demos.HSP.html#81019" class="Bound">p</a><a id="81020" class="Symbol">}{</a><a id="81022" href="Demos.HSP.html#81022" class="Bound">q</a><a id="81023" class="Symbol">}</a> <a id="81025" class="Symbol">â†’</a> <a id="81027" href="Demos.HSP.html#81049" class="Function">Goal</a> <a id="81032" class="Symbol">{</a><a id="81033" href="Demos.HSP.html#81019" class="Bound">p</a><a id="81034" class="Symbol">}{</a><a id="81036" href="Demos.HSP.html#81022" class="Bound">q</a><a id="81037" class="Symbol">}</a>
  <a id="81041" class="Keyword">where</a>
  <a id="81049" href="Demos.HSP.html#81049" class="Function">Goal</a> <a id="81054" class="Symbol">:</a> <a id="81056" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a> <a id="81058" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="81060" href="Demos.HSP.html#62967" class="Function">Mod</a> <a id="81064" class="Symbol">(</a><a id="81065" href="Demos.HSP.html#62869" class="Function">Th</a> <a id="81068" href="Demos.HSP.html#79780" class="Bound">ğ’¦</a><a id="81069" class="Symbol">)</a>
  <a id="81073" href="Demos.HSP.html#81049" class="Function">Goal</a> <a id="81078" class="Symbol">{</a><a id="81079" href="Demos.HSP.html#81079" class="Bound">p</a><a id="81080" class="Symbol">}{</a><a id="81082" href="Demos.HSP.html#81082" class="Bound">q</a><a id="81083" class="Symbol">}</a> <a id="81085" href="Demos.HSP.html#81085" class="Bound">x</a> <a id="81087" href="Demos.HSP.html#81087" class="Bound">Ï</a> <a id="81089" class="Symbol">=</a> <a id="81091" href="Demos.HSP.html#80992" class="Bound">AâˆˆModThVK</a><a id="81100" class="Symbol">{</a><a id="81101" href="Demos.HSP.html#81079" class="Bound">p</a><a id="81102" class="Symbol">}{</a><a id="81104" href="Demos.HSP.html#81082" class="Bound">q</a><a id="81105" class="Symbol">}</a> <a id="81107" class="Symbol">(</a><a id="81108" href="Demos.HSP.html#71684" class="Function">V-id1</a> <a id="81114" href="Demos.HSP.html#79764" class="Bound">â„“</a> <a id="81116" class="Symbol">{</a><a id="81117" class="Argument">p</a> <a id="81119" class="Symbol">=</a> <a id="81121" href="Demos.HSP.html#81079" class="Bound">p</a><a id="81122" class="Symbol">}{</a><a id="81124" href="Demos.HSP.html#81082" class="Bound">q</a><a id="81125" class="Symbol">}</a> <a id="81127" href="Demos.HSP.html#81085" class="Bound">x</a><a id="81128" class="Symbol">)</a> <a id="81130" href="Demos.HSP.html#81087" class="Bound">Ï</a>
</pre>
\ifshort\else

\noindent Actually, we will need the following lifted version of this result.

<pre class="Agda">

 <a id="81252" href="Demos.HSP.html#81252" class="Function">F-ModTh-epi-lift</a> <a id="81269" class="Symbol">:</a> <a id="81271" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a> <a id="81273" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="81275" href="Demos.HSP.html#62967" class="Function">Mod</a> <a id="81279" class="Symbol">(</a><a id="81280" href="Demos.HSP.html#62869" class="Function">Th</a> <a id="81283" class="Symbol">(</a><a id="81284" href="Demos.HSP.html#69808" class="Function">V</a> <a id="81286" href="Demos.HSP.html#79764" class="Bound">â„“</a> <a id="81288" href="Demos.HSP.html#79851" class="Function">Î¹</a> <a id="81290" href="Demos.HSP.html#79780" class="Bound">ğ’¦</a><a id="81291" class="Symbol">))</a> <a id="81294" class="Symbol">â†’</a> <a id="81296" href="Demos.HSP.html#35676" class="Function">epi</a> <a id="81300" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="81303" href="Demos.HSP.html#79970" class="Function">A</a> <a id="81305" href="Demos.HSP.html#78135" class="Function Operator">]</a> <a id="81307" class="Symbol">(</a><a id="81308" href="Demos.HSP.html#29482" class="Function">Lift-Alg</a> <a id="81317" href="Demos.HSP.html#79742" class="Bound">ğ‘¨</a> <a id="81319" href="Demos.HSP.html#79851" class="Function">Î¹</a> <a id="81321" href="Demos.HSP.html#79851" class="Function">Î¹</a><a id="81322" class="Symbol">)</a>
 <a id="81325" href="Demos.HSP.html#81252" class="Function">F-ModTh-epi-lift</a> <a id="81342" href="Demos.HSP.html#81342" class="Bound">AâˆˆModThK</a> <a id="81351" class="Symbol">=</a> <a id="81353" href="Demos.HSP.html#37351" class="Function">âˆ˜-epi</a> <a id="81359" class="Symbol">(</a><a id="81360" href="Demos.HSP.html#80924" class="Function">F-ModThV-epi</a> <a id="81373" class="Symbol">Î»</a> <a id="81375" class="Symbol">{</a><a id="81376" href="Demos.HSP.html#81376" class="Bound">p</a> <a id="81378" href="Demos.HSP.html#81378" class="Bound">q</a><a id="81379" class="Symbol">}</a> <a id="81381" class="Symbol">â†’</a> <a id="81383" href="Demos.HSP.html#81342" class="Bound">AâˆˆModThK</a><a id="81391" class="Symbol">{</a><a id="81392" class="Argument">p</a> <a id="81394" class="Symbol">=</a> <a id="81396" href="Demos.HSP.html#81376" class="Bound">p</a><a id="81397" class="Symbol">}{</a><a id="81399" href="Demos.HSP.html#81378" class="Bound">q</a><a id="81400" class="Symbol">}</a> <a id="81402" class="Symbol">)</a> <a id="81404" href="Demos.HSP.html#39387" class="Function">ToLift-epi</a>
</pre>
\fi


%% -------------------------------------------------------------------------------------

\section{Birkhoff's Variety Theorem}

Let \ab{ğ’¦} be a class of algebras and recall that \ab{ğ’¦} is a \emph{variety} provided
it is closed under homomorphisms, subalgebras and products; equivalently,
\af{V} \ab{ğ’¦} âŠ† \ab{ğ’¦}.
(Observe that \ab{ğ’¦} âŠ† \af{V} \ab{ğ’¦} holds for all \ab{ğ’¦} since \af{V} is a closure operator.)
We call \ab{ğ’¦} an \emph{equational class} if it is the class of all models of some set of identities.

Birkhoff's variety theorem, also known as the HSP theorem, asserts that \ab{ğ’¦}
is an equational class if and only if it is a variety.  In this section, we present the
statement and proof of this theorem---first in a style similar to
what one finds in textbooks (e.g.,~\cite[Theorem 4.41]{Bergman:2012}),
and then formally in the language of \mltt.
%--------------------------------------
\paragraph*{Informal proof}

%--------------------------------------
\noindent (â‡’) \textit{Every equational class is a variety}. Indeed, suppose \ab{ğ’¦} is an equational
class axiomatized by term identities \ab{â„°}; that is, \ab{ğ‘¨} âˆˆ \ab{ğ’¦} iff
\ab{ğ‘¨} \af{âŠ¨} \ab{â„°}. Since the classes \af H \ab{ğ’¦}, \af S \ab{ğ’¦}, \af P \ab{ğ’¦} and
\ab{ğ’¦} all satisfy the same set of equations, we have \af{V} \ab{ğ’¦} \af{âŠ«} \ab p
\af{â‰ˆ} \ab q for all (\ab p , \ab q) \af{âˆˆ} \ab{â„°}, so \af{V} \ab{ğ’¦} âŠ† \ab{ğ’¦}.

\medskip

%--------------------------------------
\noindent (â‡) \textit{Every variety is an equational class}.\footnote{The proof we present here is based on~\cite[Theorem 4.41]{Bergman:2012}.}
Let \ab{ğ’¦} be an arbitrary variety.  We will describe a set of equations that axiomatizes
\ab{ğ’¦}.  A natural choice is to take \af{Th} \ab{ğ’¦} and try to prove that \ab{ğ’¦} \aof{=} \af{Mod} (\af{Th} \ab{ğ’¦}). Clearly, \ab{ğ’¦}~\aof{âŠ†}~\af{Mod}~(\af{Th}~\ab{ğ’¦}).  To prove the converse inclusion, let \ab{ğ‘¨}~\af{âˆˆ}~\af{Mod}~(\af{Th}~\ab{ğ’¦}). It suffices to find an algebra \ab{ğ‘­} \af{âˆˆ} \af{S} (\af{P} \ab{ğ’¦}) such that
\ab{ğ‘¨} is a homomorphic image of \ab{ğ‘­}, as this will show that \ab{ğ‘¨} \af{âˆˆ}
\af{H} (\af{S} (\af{P} \ab{ğ’¦})) = \ab{ğ’¦}.

Let \ab{X} be such that there exists a surjective environment
\ab{Ï} : \ab{X} \as{â†’} \af{ğ•Œ[~\ab{ğ‘¨}~]}.\footnote{Informally, this is done by assuming \ab{X} has cardinality at least max(|~\af{ğ•Œ[~\ab{ğ‘¨}~]}~|, Ï‰). Later we will see how to construct an \ab{X} with the required property in type theory.}
By the \af{lift-hom} lemma, there is an epimorphism \ab{h} : \T{X} \as{â†’} \aof{ğ•Œ[~\ab{ğ‘¨}~]}
that extends \ab{Ï}.
Put \aof{ğ”½[~\ab{X}~]}~:=~\T{X}/\afld{â‰ˆ} and let \ab{g} : \T{X} \as{â†’} \aof{ğ”½[~\ab{X}~]}
be the natural epimorphism with kernel \afld{â‰ˆ}. We claim \af{ker} \ab g \af{âŠ†}
\af{ker} \ab h. If the claim is true, then there is a map \ab{f} : \aof{ğ”½[~\ab{X}~]} \as{â†’} \ab{ğ‘¨}
such that \ab f \af{âˆ˜} \ab g = \ab h, and since \ab h is surjective so is \ab f. Therefore, \ab{ğ‘¨}
\af{âˆˆ} \af{ğ–§} (\af{ğ”½} \ab X) \aof{âŠ†} \af{Mod} (\af{Th} \ab{ğ’¦}) completing the proof.

It remains to prove the claim \af{ker} \ab g \af{âŠ†} \af{ker} \ab h. Let \ab u, \ab v be terms
and assume \ab g \ab u = \ab g \ab v. Since \T{X} is generated by \ab X, there are terms
\ab p, \ab q such that \ab u = \af{âŸ¦~\T{X}~âŸ§}~\ab p and v = \af{âŸ¦~\T{X}~âŸ§}~\ab q.
%\footnote{Recall, \af{âŸ¦~\ab{ğ‘¨}~âŸ§} \ab t denotes the interpretation of the term
%\ab t in the algebra \ab{ğ‘¨}.}
Therefore,
\ifshort
\af{âŸ¦~\Free{X}~âŸ§} \ab p = \ab g (\af{âŸ¦~\T{X}~âŸ§} \ab p) = \ab g \ab u = \ab g \ab v =
\ab g (\af{âŸ¦~\T{X}~âŸ§} \ab q) = \af{âŸ¦~\Free{X}~âŸ§} \ab q,
\else
\begin{center}
\af{âŸ¦~\Free{X}~âŸ§} \ab p = \ab g (\af{âŸ¦~\T{X}~âŸ§} \ab p) = \ab g \ab u = \ab g \ab v =
\ab g (\af{âŸ¦~\T{X}~âŸ§} \ab q) = \af{âŸ¦~\Free{X}~âŸ§} \ab q,
\end{center}
\fi
so \ab{ğ’¦}~\af{âŠ«}~\ab p~\af{â‰ˆ}~\ab q; thus, (\ab p , \ab q) \af{âˆˆ} \af{Th}
\ab{ğ’¦}. Since \ab{ğ‘¨} \af{âˆˆ} \af{Mod} (\af{Th} \ab{ğ’¦}), we obtain \ab{ğ‘¨}~\af{âŠ§}~\ab p~\af{â‰ˆ}~\ab q, which implies
that \ab h \ab u = (\af{âŸ¦~\ab{ğ‘¨}~âŸ§} \ab p) \aofld{âŸ¨\$âŸ©} \ab{Ï} = (\af{âŸ¦~\ab{ğ‘¨}~âŸ§} \ab q)
\aofld{âŸ¨\$âŸ©} \ab{Ï} = \ab h \ab v, as desired.

\paragraph*{Formal proof}
%We now show how to express and prove the twin assertions that
%(â‡) every equational class is a variety and (â‡’) every variety is an equational class.
%% -----------------------------------------------------------------------------
(â‡’) \textit{Every equational class is a variety}.
We need an arbitrary equational class, which we obtain by starting with an arbitrary
collection \ab{â„°} of equations and then defining \ab{ğ’¦} = \af{Mod} \ab{â„°}, the class
axiomatized by \ab{â„°}. We prove that \ab{ğ’¦} is a variety by showing that
\ab{ğ’¦} = \af{V}~\ab{ğ’¦}. The inclusion \ab{ğ’¦}~\aof{âŠ†}~\af V~\ab{ğ’¦}, which holds for all
classes \ab{ğ’¦}, is called the \defn{expansive} property of \af{V}.

<pre class="Agda">

<a id="86172" class="Keyword">module</a> <a id="86179" href="Demos.HSP.html#86179" class="Module">_</a> <a id="86181" class="Symbol">(</a><a id="86182" href="Demos.HSP.html#86182" class="Bound">ğ’¦</a> <a id="86184" class="Symbol">:</a> <a id="86186" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="86190" class="Symbol">(</a><a id="86191" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="86199" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="86201" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="86203" class="Symbol">)</a> <a id="86205" class="Symbol">(</a><a id="86206" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="86208" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="86210" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="86213" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="86215" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="86218" href="Demos.HSP.html#9462" class="Generalizable">â„“</a><a id="86219" class="Symbol">))</a> <a id="86222" class="Keyword">where</a>
 <a id="86229" href="Demos.HSP.html#86229" class="Function">V-expa</a> <a id="86236" class="Symbol">:</a> <a id="86238" href="Demos.HSP.html#86182" class="Bound">ğ’¦</a> <a id="86240" href="Relation.Unary.html#1742" class="Function Operator">âŠ†</a> <a id="86242" href="Demos.HSP.html#69808" class="Function">V</a> <a id="86244" href="Demos.HSP.html#86218" class="Bound">â„“</a> <a id="86246" class="Symbol">(</a><a id="86247" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="86250" class="Symbol">(</a><a id="86251" href="Demos.HSP.html#86199" class="Bound">Î±</a> <a id="86253" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="86255" href="Demos.HSP.html#86201" class="Bound">Ïáµƒ</a> <a id="86258" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="86260" href="Demos.HSP.html#86218" class="Bound">â„“</a><a id="86261" class="Symbol">))</a> <a id="86264" href="Demos.HSP.html#86182" class="Bound">ğ’¦</a>
 <a id="86267" href="Demos.HSP.html#86229" class="Function">V-expa</a> <a id="86274" class="Symbol">{</a><a id="86275" class="Argument">x</a> <a id="86277" class="Symbol">=</a> <a id="86279" href="Demos.HSP.html#86279" class="Bound">ğ‘¨</a><a id="86280" class="Symbol">}</a><a id="86281" href="Demos.HSP.html#86281" class="Bound">kA</a> <a id="86284" class="Symbol">=</a> <a id="86286" href="Demos.HSP.html#86279" class="Bound">ğ‘¨</a> <a id="86288" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="86290" class="Symbol">(</a><a id="86291" href="Demos.HSP.html#86279" class="Bound">ğ‘¨</a> <a id="86293" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="86295" class="Symbol">(</a><a id="86296" href="Data.Unit.Polymorphic.Base.html#480" class="Function">âŠ¤</a> <a id="86298" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="86300" class="Symbol">(Î»</a> <a id="86303" href="Demos.HSP.html#86303" class="Bound">_</a> <a id="86305" class="Symbol">â†’</a> <a id="86307" href="Demos.HSP.html#86279" class="Bound">ğ‘¨</a><a id="86308" class="Symbol">)</a><a id="86309" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="86311" class="Symbol">(Î»</a> <a id="86314" href="Demos.HSP.html#86314" class="Bound">_</a> <a id="86316" class="Symbol">â†’</a> <a id="86318" href="Demos.HSP.html#86281" class="Bound">kA</a><a id="86320" class="Symbol">)</a><a id="86321" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="86323" href="Demos.HSP.html#86685" class="Function">Goal</a><a id="86327" class="Symbol">)</a><a id="86328" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="86330" href="Demos.HSP.html#47951" class="Function">â‰¤-reflexive</a><a id="86341" class="Symbol">)</a><a id="86342" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="86344" href="Demos.HSP.html#43893" class="Function">IdHomImage</a>
  <a id="86357" class="Keyword">where</a>
  <a id="86365" class="Keyword">open</a> <a id="86370" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="86377" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="86380" href="Demos.HSP.html#86279" class="Bound">ğ‘¨</a> <a id="86382" href="Demos.HSP.html#25499" class="Function Operator">]</a>            <a id="86395" class="Keyword">using</a> <a id="86401" class="Symbol">(</a> <a id="86403" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="86408" class="Symbol">)</a>
  <a id="86412" class="Keyword">open</a> <a id="86417" href="Relation.Binary.Bundles.html#1009" class="Module">Setoid</a> <a id="86424" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="86427" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="86429" class="Symbol">(Î»</a> <a id="86432" href="Demos.HSP.html#86432" class="Bound">_</a> <a id="86434" class="Symbol">â†’</a> <a id="86436" href="Demos.HSP.html#86279" class="Bound">ğ‘¨</a><a id="86437" class="Symbol">)</a> <a id="86439" href="Demos.HSP.html#25499" class="Function Operator">]</a>  <a id="86442" class="Keyword">using</a> <a id="86448" class="Symbol">()</a> <a id="86451" class="Keyword">renaming</a> <a id="86460" class="Symbol">(</a> <a id="86462" href="Relation.Binary.Structures.html#1568" class="Function">refl</a> <a id="86467" class="Symbol">to</a> <a id="86470" class="Function">reflâ¨…</a> <a id="86476" class="Symbol">)</a>
  <a id="86480" href="Demos.HSP.html#86480" class="Function">toâ¨…</a>    <a id="86487" class="Symbol">:</a> <a id="86489" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="86492" href="Demos.HSP.html#86279" class="Bound">ğ‘¨</a> <a id="86494" href="Demos.HSP.html#25499" class="Function Operator">]</a>            <a id="86507" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="86509" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="86512" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="86514" class="Symbol">(Î»</a> <a id="86517" href="Demos.HSP.html#86517" class="Bound">_</a> <a id="86519" class="Symbol">â†’</a> <a id="86521" href="Demos.HSP.html#86279" class="Bound">ğ‘¨</a><a id="86522" class="Symbol">)</a> <a id="86524" href="Demos.HSP.html#25499" class="Function Operator">]</a>
  <a id="86528" href="Demos.HSP.html#86480" class="Function">toâ¨…</a>    <a id="86535" class="Symbol">=</a> <a id="86537" class="Keyword">record</a> <a id="86544" class="Symbol">{</a> <a id="86546" href="Function.Bundles.html#1919" class="Field">f</a> <a id="86548" class="Symbol">=</a> <a id="86550" class="Symbol">Î»</a> <a id="86552" href="Demos.HSP.html#86552" class="Bound">x</a> <a id="86554" href="Demos.HSP.html#86554" class="Bound">_</a> <a id="86556" class="Symbol">â†’</a> <a id="86558" href="Demos.HSP.html#86552" class="Bound">x</a>   <a id="86562" class="Symbol">;</a> <a id="86564" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="86569" class="Symbol">=</a> <a id="86571" class="Symbol">Î»</a> <a id="86573" href="Demos.HSP.html#86573" class="Bound">xy</a> <a id="86576" href="Demos.HSP.html#86576" class="Bound">_</a> <a id="86578" class="Symbol">â†’</a> <a id="86580" href="Demos.HSP.html#86573" class="Bound">xy</a> <a id="86583" class="Symbol">}</a>
  <a id="86587" href="Demos.HSP.html#86587" class="Function">fromâ¨…</a>  <a id="86594" class="Symbol">:</a> <a id="86596" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="86599" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="86601" class="Symbol">(Î»</a> <a id="86604" href="Demos.HSP.html#86604" class="Bound">_</a> <a id="86606" class="Symbol">â†’</a> <a id="86608" href="Demos.HSP.html#86279" class="Bound">ğ‘¨</a><a id="86609" class="Symbol">)</a> <a id="86611" href="Demos.HSP.html#25499" class="Function Operator">]</a>  <a id="86614" href="Demos.HSP.html#8504" class="Record Operator">âŸ¶</a> <a id="86616" href="Demos.HSP.html#25499" class="Function Operator">ğ”»[</a> <a id="86619" href="Demos.HSP.html#86279" class="Bound">ğ‘¨</a> <a id="86621" href="Demos.HSP.html#25499" class="Function Operator">]</a>
  <a id="86625" href="Demos.HSP.html#86587" class="Function">fromâ¨…</a>  <a id="86632" class="Symbol">=</a> <a id="86634" class="Keyword">record</a> <a id="86641" class="Symbol">{</a> <a id="86643" href="Function.Bundles.html#1919" class="Field">f</a> <a id="86645" class="Symbol">=</a> <a id="86647" class="Symbol">Î»</a> <a id="86649" href="Demos.HSP.html#86649" class="Bound">x</a> <a id="86651" class="Symbol">â†’</a> <a id="86653" href="Demos.HSP.html#86649" class="Bound">x</a> <a id="86655" href="Data.Unit.Polymorphic.Base.html#524" class="Function">tt</a>  <a id="86659" class="Symbol">;</a> <a id="86661" href="Function.Bundles.html#1938" class="Field">cong</a> <a id="86666" class="Symbol">=</a> <a id="86668" class="Symbol">Î»</a> <a id="86670" href="Demos.HSP.html#86670" class="Bound">xy</a> <a id="86673" class="Symbol">â†’</a> <a id="86675" href="Demos.HSP.html#86670" class="Bound">xy</a> <a id="86678" href="Data.Unit.Polymorphic.Base.html#524" class="Function">tt</a> <a id="86681" class="Symbol">}</a>
  <a id="86685" href="Demos.HSP.html#86685" class="Function">Goal</a>   <a id="86692" class="Symbol">:</a> <a id="86694" href="Demos.HSP.html#86279" class="Bound">ğ‘¨</a> <a id="86696" href="Demos.HSP.html#41313" class="Record Operator">â‰…</a> <a id="86698" href="Demos.HSP.html#31746" class="Function">â¨…</a> <a id="86700" class="Symbol">(Î»</a> <a id="86703" href="Demos.HSP.html#86703" class="Bound">x</a> <a id="86705" class="Symbol">â†’</a> <a id="86707" href="Demos.HSP.html#86279" class="Bound">ğ‘¨</a><a id="86708" class="Symbol">)</a>
  <a id="86712" href="Demos.HSP.html#86685" class="Function">Goal</a>   <a id="86719" class="Symbol">=</a> <a id="86721" href="Demos.HSP.html#41372" class="InductiveConstructor">mkiso</a> <a id="86727" class="Symbol">(</a><a id="86728" href="Demos.HSP.html#86480" class="Function">toâ¨…</a> <a id="86732" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="86734" href="Demos.HSP.html#34487" class="InductiveConstructor">mkhom</a> <a id="86740" href="Demos.HSP.html#86470" class="Function">reflâ¨…</a><a id="86745" class="Symbol">)</a> <a id="86747" class="Symbol">(</a><a id="86748" href="Demos.HSP.html#86587" class="Function">fromâ¨…</a> <a id="86754" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="86756" href="Demos.HSP.html#34487" class="InductiveConstructor">mkhom</a> <a id="86762" href="Relation.Binary.Structures.html#1568" class="Function">refl</a><a id="86766" class="Symbol">)</a> <a id="86768" class="Symbol">(Î»</a> <a id="86771" href="Demos.HSP.html#86771" class="Bound">_</a> <a id="86773" href="Demos.HSP.html#86773" class="Bound">_</a> <a id="86775" class="Symbol">â†’</a> <a id="86777" href="Relation.Binary.Structures.html#1568" class="Function">refl</a><a id="86781" class="Symbol">)</a> <a id="86783" class="Symbol">(Î»</a> <a id="86786" href="Demos.HSP.html#86786" class="Bound">_</a> <a id="86788" class="Symbol">â†’</a> <a id="86790" href="Relation.Binary.Structures.html#1568" class="Function">refl</a><a id="86794" class="Symbol">)</a>

</pre>
Observe how \ab{ğ‘¨} is expressed as (isomorphic to) a product with just one factor (itself), that is, the product
\af{â¨…} (\as{Î»} \ab x \as{â†’} \ab{ğ‘¨}) indexed over the one-element type \af{âŠ¤}.

For the inclusion \af V \ab{ğ’¦} \aof{âŠ†} \ab{ğ’¦},
%requires the assumption that \ab{ğ’¦} is an equational class. R
recall lemma \af{V-id1} which asserts that \ab{ğ’¦} \aof{âŠ«} \ab p \aof{â‰ˆ} \ab q implies
\af{V}~\ab{â„“}~\ab{Î¹}~\ab{ğ’¦}~\aof{âŠ«}~\ab p~\aof{â‰ˆ}~\ab q; whence, if \ab{ğ’¦} is an equational
class, then \af V \ab{ğ’¦} \aof{âŠ†} \ab{ğ’¦}, as we now confirm.

<pre class="Agda">

<a id="87363" class="Keyword">module</a> <a id="87370" href="Demos.HSP.html#87370" class="Module">_</a> <a id="87372" class="Symbol">{</a><a id="87373" href="Demos.HSP.html#87373" class="Bound">â„“</a> <a id="87375" class="Symbol">:</a> <a id="87377" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="87382" class="Symbol">}{</a><a id="87384" href="Demos.HSP.html#87384" class="Bound">X</a> <a id="87386" class="Symbol">:</a> <a id="87388" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="87393" href="Demos.HSP.html#87373" class="Bound">â„“</a><a id="87394" class="Symbol">}{</a><a id="87396" href="Demos.HSP.html#87396" class="Bound">â„°</a> <a id="87398" class="Symbol">:</a> <a id="87400" class="Symbol">{</a><a id="87401" href="Demos.HSP.html#87401" class="Bound">Y</a> <a id="87403" class="Symbol">:</a> <a id="87405" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="87410" href="Demos.HSP.html#87373" class="Bound">â„“</a><a id="87411" class="Symbol">}</a> <a id="87413" class="Symbol">â†’</a> <a id="87415" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="87420" class="Symbol">(</a><a id="87421" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="87426" href="Demos.HSP.html#87401" class="Bound">Y</a> <a id="87428" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="87430" href="Demos.HSP.html#50763" class="Datatype">Term</a> <a id="87435" href="Demos.HSP.html#87401" class="Bound">Y</a><a id="87436" class="Symbol">)</a> <a id="87438" class="Symbol">(</a><a id="87439" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="87442" href="Demos.HSP.html#87373" class="Bound">â„“</a><a id="87443" class="Symbol">)}</a> <a id="87446" class="Keyword">where</a>
 <a id="87453" class="Keyword">private</a> <a id="87461" href="Demos.HSP.html#87461" class="Function">ğ’¦</a> <a id="87463" class="Symbol">=</a> <a id="87465" href="Demos.HSP.html#62967" class="Function">Mod</a><a id="87468" class="Symbol">{</a><a id="87469" class="Argument">Î±</a> <a id="87471" class="Symbol">=</a> <a id="87473" href="Demos.HSP.html#87373" class="Bound">â„“</a><a id="87474" class="Symbol">}{</a><a id="87476" href="Demos.HSP.html#87373" class="Bound">â„“</a><a id="87477" class="Symbol">}{</a><a id="87479" href="Demos.HSP.html#87384" class="Bound">X</a><a id="87480" class="Symbol">}</a> <a id="87482" href="Demos.HSP.html#87396" class="Bound">â„°</a>     <a id="87488" class="Comment">-- an arbitrary equational class</a>

 <a id="87523" href="Demos.HSP.html#87523" class="Function">EqClâ‡’Var</a> <a id="87532" class="Symbol">:</a> <a id="87534" href="Demos.HSP.html#69808" class="Function">V</a> <a id="87536" href="Demos.HSP.html#87373" class="Bound">â„“</a> <a id="87538" class="Symbol">(</a><a id="87539" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="87542" href="Demos.HSP.html#87373" class="Bound">â„“</a><a id="87543" class="Symbol">)</a> <a id="87545" href="Demos.HSP.html#87461" class="Function">ğ’¦</a> <a id="87547" href="Relation.Unary.html#1742" class="Function Operator">âŠ†</a> <a id="87549" href="Demos.HSP.html#87461" class="Function">ğ’¦</a>
 <a id="87552" href="Demos.HSP.html#87523" class="Function">EqClâ‡’Var</a> <a id="87561" class="Symbol">{</a><a id="87562" href="Demos.HSP.html#87562" class="Bound">ğ‘¨</a><a id="87563" class="Symbol">}</a> <a id="87565" href="Demos.HSP.html#87565" class="Bound">vA</a> <a id="87568" class="Symbol">{</a><a id="87569" href="Demos.HSP.html#87569" class="Bound">p</a><a id="87570" class="Symbol">}</a> <a id="87572" class="Symbol">{</a><a id="87573" href="Demos.HSP.html#87573" class="Bound">q</a><a id="87574" class="Symbol">}</a> <a id="87576" href="Demos.HSP.html#87576" class="Bound">pâ„°q</a> <a id="87580" href="Demos.HSP.html#87580" class="Bound">Ï</a> <a id="87582" class="Symbol">=</a> <a id="87584" href="Demos.HSP.html#71684" class="Function">V-id1</a> <a id="87590" href="Demos.HSP.html#87373" class="Bound">â„“</a> <a id="87592" class="Symbol">{</a><a id="87593" href="Demos.HSP.html#87461" class="Function">ğ’¦</a><a id="87594" class="Symbol">}</a> <a id="87596" class="Symbol">{</a><a id="87597" href="Demos.HSP.html#87569" class="Bound">p</a><a id="87598" class="Symbol">}</a> <a id="87600" class="Symbol">{</a><a id="87601" href="Demos.HSP.html#87573" class="Bound">q</a><a id="87602" class="Symbol">}</a> <a id="87604" class="Symbol">(Î»</a> <a id="87607" href="Demos.HSP.html#87607" class="Bound">_</a> <a id="87609" href="Demos.HSP.html#87609" class="Bound">x</a> <a id="87611" href="Demos.HSP.html#87611" class="Bound">Ï„</a> <a id="87613" class="Symbol">â†’</a> <a id="87615" href="Demos.HSP.html#87609" class="Bound">x</a> <a id="87617" href="Demos.HSP.html#87576" class="Bound">pâ„°q</a> <a id="87621" href="Demos.HSP.html#87611" class="Bound">Ï„</a><a id="87622" class="Symbol">)</a> <a id="87624" href="Demos.HSP.html#87562" class="Bound">ğ‘¨</a> <a id="87626" href="Demos.HSP.html#87565" class="Bound">vA</a> <a id="87629" href="Demos.HSP.html#87580" class="Bound">Ï</a>

</pre>
By \af{V-expa} and \af{Eqclâ‡’Var}, every equational class is a variety.
%% -----------------------------------------------------------------------------

\bigskip

\noindent (â‡) \textit{Every variety is an equational class}.
To fix an arbitrary variety, start with an arbitrary class
\ab{ğ’¦} of \ab{ğ‘†}-algebras and take the \emph{varietal closure}, \af{V} \ab{ğ’¦}.
We prove that \af{V} \ab{ğ’¦} is precisely the collection of
algebras that model \af{Th} (\af{V} \ab{ğ’¦}); that is, \af{V} \ab{ğ’¦} = \af{Mod} (\af{Th} (\af{V} \ab{ğ’¦})).
The inclusion \af{V} \ab{ğ’¦} \aof{âŠ†} \af{Mod} (\af{Th} (\af{V} \ab{ğ’¦})) is a
consequence of the fact that \af{Mod} \af{Th} is a closure operator.

<pre class="Agda">

<a id="88330" class="Keyword">module</a> <a id="88337" href="Demos.HSP.html#88337" class="Module">_</a> <a id="88339" class="Symbol">(</a><a id="88340" href="Demos.HSP.html#88340" class="Bound">ğ’¦</a> <a id="88342" class="Symbol">:</a> <a id="88344" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="88348" class="Symbol">(</a><a id="88349" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="88357" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="88359" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="88361" class="Symbol">)</a> <a id="88363" class="Symbol">(</a><a id="88364" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="88366" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="88368" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="88371" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="88373" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="88376" href="Demos.HSP.html#9462" class="Generalizable">â„“</a><a id="88377" class="Symbol">)){</a><a id="88380" href="Demos.HSP.html#88380" class="Bound">X</a> <a id="88382" class="Symbol">:</a> <a id="88384" href="Demos.HSP.html#8239" class="Primitive">Type</a> <a id="88389" class="Symbol">(</a><a id="88390" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="88392" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="88394" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="88397" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="88399" href="Demos.HSP.html#9462" class="Generalizable">â„“</a><a id="88400" class="Symbol">)}</a> <a id="88403" class="Keyword">where</a>
 <a id="88410" class="Keyword">private</a> <a id="88418" href="Demos.HSP.html#88418" class="Function">c</a> <a id="88420" class="Symbol">=</a> <a id="88422" href="Demos.HSP.html#88357" class="Bound">Î±</a> <a id="88424" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="88426" href="Demos.HSP.html#88359" class="Bound">Ïáµƒ</a> <a id="88429" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="88431" href="Demos.HSP.html#88376" class="Bound">â„“</a> <a id="88433" class="Symbol">;</a> <a id="88435" href="Demos.HSP.html#88435" class="Function">Î¹</a> <a id="88437" class="Symbol">=</a> <a id="88439" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="88442" href="Demos.HSP.html#88418" class="Function">c</a>

 <a id="88446" href="Demos.HSP.html#88446" class="Function">ModTh-closure</a> <a id="88460" class="Symbol">:</a> <a id="88462" href="Demos.HSP.html#69808" class="Function">V</a><a id="88463" class="Symbol">{</a><a id="88464" class="Argument">Î²</a> <a id="88466" class="Symbol">=</a> <a id="88468" href="Demos.HSP.html#9443" class="Generalizable">Î²</a><a id="88469" class="Symbol">}{</a><a id="88471" href="Demos.HSP.html#9445" class="Generalizable">Ïáµ‡</a><a id="88473" class="Symbol">}{</a><a id="88475" href="Demos.HSP.html#9448" class="Generalizable">Î³</a><a id="88476" class="Symbol">}{</a><a id="88478" href="Demos.HSP.html#9450" class="Generalizable">Ïá¶œ</a><a id="88480" class="Symbol">}{</a><a id="88482" href="Demos.HSP.html#9453" class="Generalizable">Î´</a><a id="88483" class="Symbol">}{</a><a id="88485" href="Demos.HSP.html#9455" class="Generalizable">Ïáµˆ</a><a id="88487" class="Symbol">}</a> <a id="88489" href="Demos.HSP.html#88376" class="Bound">â„“</a> <a id="88491" href="Demos.HSP.html#88435" class="Function">Î¹</a> <a id="88493" href="Demos.HSP.html#88340" class="Bound">ğ’¦</a> <a id="88495" href="Relation.Unary.html#1742" class="Function Operator">âŠ†</a> <a id="88497" href="Demos.HSP.html#62967" class="Function">Mod</a><a id="88500" class="Symbol">{</a><a id="88501" class="Argument">X</a> <a id="88503" class="Symbol">=</a> <a id="88505" href="Demos.HSP.html#88380" class="Bound">X</a><a id="88506" class="Symbol">}</a> <a id="88508" class="Symbol">(</a><a id="88509" href="Demos.HSP.html#62869" class="Function">Th</a> <a id="88512" class="Symbol">(</a><a id="88513" href="Demos.HSP.html#69808" class="Function">V</a> <a id="88515" href="Demos.HSP.html#88376" class="Bound">â„“</a> <a id="88517" href="Demos.HSP.html#88435" class="Function">Î¹</a> <a id="88519" href="Demos.HSP.html#88340" class="Bound">ğ’¦</a><a id="88520" class="Symbol">))</a>
 <a id="88524" href="Demos.HSP.html#88446" class="Function">ModTh-closure</a> <a id="88538" class="Symbol">{</a><a id="88539" class="Argument">x</a> <a id="88541" class="Symbol">=</a> <a id="88543" href="Demos.HSP.html#88543" class="Bound">ğ‘¨</a><a id="88544" class="Symbol">}</a> <a id="88546" href="Demos.HSP.html#88546" class="Bound">vA</a> <a id="88549" class="Symbol">{</a><a id="88550" href="Demos.HSP.html#88550" class="Bound">p</a><a id="88551" class="Symbol">}</a> <a id="88553" class="Symbol">{</a><a id="88554" href="Demos.HSP.html#88554" class="Bound">q</a><a id="88555" class="Symbol">}</a> <a id="88557" href="Demos.HSP.html#88557" class="Bound">x</a> <a id="88559" href="Demos.HSP.html#88559" class="Bound">Ï</a> <a id="88561" class="Symbol">=</a> <a id="88563" href="Demos.HSP.html#88557" class="Bound">x</a> <a id="88565" href="Demos.HSP.html#88543" class="Bound">ğ‘¨</a> <a id="88567" href="Demos.HSP.html#88546" class="Bound">vA</a> <a id="88570" href="Demos.HSP.html#88559" class="Bound">Ï</a>

</pre>
Our proof of the inclusion \af{Mod} (\af{Th} (\af V \ab{ğ’¦})) \aof{âŠ†} \af{V} \ab{ğ’¦} is carried out in two steps.

\begin{enumerate}
\item \label{item:1} Prove \aof{ğ”½[ \ab{X} ]} \af{â‰¤} \ab{ğ‘ª} \ab X.
\item \label{item:2} Prove that every algebra in \af{Mod} (\af{Th} (\af{V}~\ab{ğ’¦})) is a homomorphic image of
\aof{ğ”½[ \ab{X} ]}.
\end{enumerate}

\noindent From \ref{item:1} we have \aof{ğ”½[ \ab{X} ]} \af{âˆˆ} \af{S} (\af{P} \ab{ğ’¦})), since \ab{ğ‘ª}~\ab X is a product of algebras in \ab{ğ’¦}. From this and \ref{item:2} will follow \af{Mod}~(\af{Th}~(\af{V}~\ab{ğ’¦})) âŠ† \af{H}~(\af{S}~(\af{P}~\ab{ğ’¦})) (= \af{V} \ab{ğ’¦}), as desired.

\begin{itemize}
\item \noindent \ref{item:1}. To prove \Free{X} \af{â‰¤} \ab{ğ‘ª} \ab X, we construct a homomorphism from
\Free{X} to \ab{ğ‘ª}~\ab X and then show it is injective,
so \Free{X} is (isomorphic to) a subalgebra of \af{ğ‘ª}~\ab X.
%\footnote{The function \af{monâ†’â‰¤} in the proof of \af{Fâ‰¤C} merely extracts a subalgebra witness from a monomorphism.}

%\T{X} to \ab{ğ‘ª} whose kernel contains the kernel \afld{â‰ˆ} of \aof{homF[}~\ab X~\aof{]} (the natural hom from \T{X} onto \Free{X}).

<pre class="Agda">

 <a id="89711" class="Keyword">open</a> <a id="89716" href="Demos.HSP.html#78901" class="Module">FreeHom</a> <a id="89724" class="Symbol">{</a><a id="89725" class="Argument">â„“</a> <a id="89727" class="Symbol">=</a> <a id="89729" href="Demos.HSP.html#88376" class="Bound">â„“</a><a id="89730" class="Symbol">}{</a><a id="89732" href="Demos.HSP.html#88340" class="Bound">ğ’¦</a><a id="89733" class="Symbol">}</a>
 <a id="89736" class="Keyword">open</a> <a id="89741" href="Demos.HSP.html#77679" class="Module">FreeAlgebra</a> <a id="89753" href="Demos.HSP.html#88340" class="Bound">ğ’¦</a> <a id="89755" class="Keyword">using</a> <a id="89761" class="Symbol">(</a><a id="89762" href="Demos.HSP.html#78045" class="Function">homC</a> <a id="89767" class="Symbol">;</a>  <a id="89770" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[_]</a> <a id="89775" class="Symbol">;</a> <a id="89777" href="Demos.HSP.html#77853" class="Function">ğ‘ª</a> <a id="89779" class="Symbol">)</a>
 <a id="89782" href="Demos.HSP.html#89782" class="Function">homFC</a> <a id="89788" class="Symbol">:</a> <a id="89790" href="Demos.HSP.html#34540" class="Function">hom</a> <a id="89794" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="89797" href="Demos.HSP.html#88380" class="Bound">X</a> <a id="89799" href="Demos.HSP.html#78135" class="Function Operator">]</a> <a id="89801" class="Symbol">(</a><a id="89802" href="Demos.HSP.html#77853" class="Function">ğ‘ª</a> <a id="89804" href="Demos.HSP.html#88380" class="Bound">X</a><a id="89805" class="Symbol">)</a>
 <a id="89808" href="Demos.HSP.html#89782" class="Function">homFC</a> <a id="89814" class="Symbol">=</a> <a id="89816" href="Demos.HSP.html#46392" class="Function">fromHomIm</a> <a id="89826" class="Symbol">(</a><a id="89827" href="Demos.HSP.html#78045" class="Function">homC</a> <a id="89832" href="Demos.HSP.html#88380" class="Bound">X</a><a id="89833" class="Symbol">)</a>

 <a id="89837" href="Demos.HSP.html#89837" class="Function">monFC</a> <a id="89843" class="Symbol">:</a> <a id="89845" href="Demos.HSP.html#35230" class="Function">mon</a> <a id="89849" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="89852" href="Demos.HSP.html#88380" class="Bound">X</a> <a id="89854" href="Demos.HSP.html#78135" class="Function Operator">]</a> <a id="89856" class="Symbol">(</a><a id="89857" href="Demos.HSP.html#77853" class="Function">ğ‘ª</a> <a id="89859" href="Demos.HSP.html#88380" class="Bound">X</a><a id="89860" class="Symbol">)</a>
 <a id="89863" href="Demos.HSP.html#89837" class="Function">monFC</a> <a id="89869" class="Symbol">=</a> <a id="89871" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="89873" href="Demos.HSP.html#89782" class="Function">homFC</a> <a id="89879" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="89881" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="89883" class="Keyword">record</a> <a id="89890" class="Symbol">{</a> <a id="89892" href="Demos.HSP.html#35133" class="Field">isHom</a> <a id="89898" class="Symbol">=</a> <a id="89900" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="89902" href="Demos.HSP.html#89782" class="Function">homFC</a> <a id="89908" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a>
                            <a id="89938" class="Symbol">;</a> <a id="89940" href="Demos.HSP.html#35158" class="Field">isInjective</a> <a id="89952" class="Symbol">=</a>  <a id="89955" class="Symbol">Î»</a> <a id="89957" class="Symbol">{</a><a id="89958" href="Demos.HSP.html#89958" class="Bound">x</a><a id="89959" class="Symbol">}{</a><a id="89961" href="Demos.HSP.html#89961" class="Bound">y</a><a id="89962" class="Symbol">}â†’</a> <a id="89965" href="Demos.HSP.html#17424" class="Function">fromIm-inj</a> <a id="89976" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="89978" href="Demos.HSP.html#78045" class="Function">homC</a> <a id="89983" href="Demos.HSP.html#88380" class="Bound">X</a> <a id="89985" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="89987" class="Symbol">{</a><a id="89988" href="Demos.HSP.html#89958" class="Bound">x</a><a id="89989" class="Symbol">}{</a><a id="89991" href="Demos.HSP.html#89961" class="Bound">y</a><a id="89992" class="Symbol">}</a>   <a id="89996" class="Symbol">}</a>
 <a id="89999" href="Demos.HSP.html#89999" class="Function">Fâ‰¤C</a> <a id="90003" class="Symbol">:</a> <a id="90005" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="90008" href="Demos.HSP.html#88380" class="Bound">X</a> <a id="90010" href="Demos.HSP.html#78135" class="Function Operator">]</a> <a id="90012" href="Demos.HSP.html#47658" class="Function Operator">â‰¤</a> <a id="90014" href="Demos.HSP.html#77853" class="Function">ğ‘ª</a> <a id="90016" href="Demos.HSP.html#88380" class="Bound">X</a>
 <a id="90019" href="Demos.HSP.html#89999" class="Function">Fâ‰¤C</a> <a id="90023" class="Symbol">=</a> <a id="90025" href="Demos.HSP.html#48794" class="Function">monâ†’â‰¤</a> <a id="90031" href="Demos.HSP.html#89837" class="Function">monFC</a>

 <a id="90039" class="Keyword">open</a> <a id="90044" href="Demos.HSP.html#77679" class="Module">FreeAlgebra</a> <a id="90056" href="Demos.HSP.html#88340" class="Bound">ğ’¦</a> <a id="90058" class="Keyword">using</a> <a id="90064" class="Symbol">(</a> <a id="90066" href="Demos.HSP.html#77761" class="Function">â„‘</a> <a id="90068" class="Symbol">)</a>

 <a id="90072" href="Demos.HSP.html#90072" class="Function">SPF</a> <a id="90076" class="Symbol">:</a> <a id="90078" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="90081" href="Demos.HSP.html#88380" class="Bound">X</a> <a id="90083" href="Demos.HSP.html#78135" class="Function Operator">]</a> <a id="90085" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="90087" href="Demos.HSP.html#66145" class="Function">S</a> <a id="90089" href="Demos.HSP.html#88435" class="Function">Î¹</a> <a id="90091" class="Symbol">(</a><a id="90092" href="Demos.HSP.html#66257" class="Function">P</a> <a id="90094" href="Demos.HSP.html#88376" class="Bound">â„“</a> <a id="90096" href="Demos.HSP.html#88435" class="Function">Î¹</a> <a id="90098" href="Demos.HSP.html#88340" class="Bound">ğ’¦</a><a id="90099" class="Symbol">)</a>
 <a id="90102" href="Demos.HSP.html#90072" class="Function">SPF</a> <a id="90106" class="Symbol">=</a> <a id="90108" href="Demos.HSP.html#77853" class="Function">ğ‘ª</a> <a id="90110" href="Demos.HSP.html#88380" class="Bound">X</a> <a id="90112" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="90114" class="Symbol">((</a><a id="90116" href="Demos.HSP.html#77761" class="Function">â„‘</a> <a id="90118" href="Demos.HSP.html#88380" class="Bound">X</a><a id="90119" class="Symbol">)</a> <a id="90121" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="90123" class="Symbol">(</a><a id="90124" href="Demos.HSP.html#10362" class="Function Operator">âˆ£_âˆ£</a> <a id="90128" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="90130" class="Symbol">((Î»</a> <a id="90134" href="Demos.HSP.html#90134" class="Bound">i</a> <a id="90136" class="Symbol">â†’</a> <a id="90138" href="Demos.HSP.html#8341" class="Field">fst</a> <a id="90142" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="90144" href="Demos.HSP.html#90134" class="Bound">i</a> <a id="90146" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a><a id="90147" class="Symbol">)</a> <a id="90149" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="90151" href="Demos.HSP.html#42345" class="Function">â‰…-refl</a><a id="90157" class="Symbol">)))</a> <a id="90161" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a>  <a id="90164" href="Demos.HSP.html#89999" class="Function">Fâ‰¤C</a>
</pre>
\end{itemize}

\begin{itemize}
\item \ref{item:2}. Every algebra in \af{Mod} (\af{Th} (\af{V}
\ab{ğ’¦})) is a homomorphic image of \af{ğ”½[~\ab{X}~]}. Indeed,
<pre class="Agda">

<a id="90348" class="Keyword">module</a> <a id="90355" href="Demos.HSP.html#90355" class="Module">_</a> <a id="90357" class="Symbol">{</a><a id="90358" href="Demos.HSP.html#90358" class="Bound">ğ’¦</a> <a id="90360" class="Symbol">:</a> <a id="90362" href="Relation.Unary.html#1101" class="Function">Pred</a><a id="90366" class="Symbol">(</a><a id="90367" href="Demos.HSP.html#24567" class="Record">Algebra</a> <a id="90375" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="90377" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a><a id="90379" class="Symbol">)</a> <a id="90381" class="Symbol">(</a><a id="90382" href="Demos.HSP.html#9438" class="Generalizable">Î±</a> <a id="90384" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="90386" href="Demos.HSP.html#9440" class="Generalizable">Ïáµƒ</a> <a id="90389" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="90391" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="90394" href="Demos.HSP.html#9462" class="Generalizable">â„“</a><a id="90395" class="Symbol">)}</a> <a id="90398" class="Keyword">where</a>
 <a id="90405" class="Keyword">private</a> <a id="90413" href="Demos.HSP.html#90413" class="Function">c</a> <a id="90415" class="Symbol">=</a> <a id="90417" href="Demos.HSP.html#90375" class="Bound">Î±</a> <a id="90419" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="90421" href="Demos.HSP.html#90377" class="Bound">Ïáµƒ</a> <a id="90424" href="Agda.Primitive.html#810" class="Primitive Operator">âŠ”</a> <a id="90426" href="Demos.HSP.html#90394" class="Bound">â„“</a> <a id="90428" class="Symbol">;</a> <a id="90430" href="Demos.HSP.html#90430" class="Function">Î¹</a> <a id="90432" class="Symbol">=</a> <a id="90434" href="Demos.HSP.html#43704" class="Function">ov</a> <a id="90437" href="Demos.HSP.html#90413" class="Function">c</a>

 <a id="90441" href="Demos.HSP.html#90441" class="Function">Varâ‡’EqCl</a> <a id="90450" class="Symbol">:</a> <a id="90452" class="Symbol">âˆ€</a> <a id="90454" href="Demos.HSP.html#90454" class="Bound">ğ‘¨</a> <a id="90456" class="Symbol">â†’</a> <a id="90458" href="Demos.HSP.html#90454" class="Bound">ğ‘¨</a> <a id="90460" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="90462" href="Demos.HSP.html#62967" class="Function">Mod</a> <a id="90466" class="Symbol">(</a><a id="90467" href="Demos.HSP.html#62869" class="Function">Th</a> <a id="90470" class="Symbol">(</a><a id="90471" href="Demos.HSP.html#69808" class="Function">V</a> <a id="90473" href="Demos.HSP.html#90394" class="Bound">â„“</a> <a id="90475" href="Demos.HSP.html#90430" class="Function">Î¹</a> <a id="90477" href="Demos.HSP.html#90358" class="Bound">ğ’¦</a><a id="90478" class="Symbol">))</a> <a id="90481" class="Symbol">â†’</a> <a id="90483" href="Demos.HSP.html#90454" class="Bound">ğ‘¨</a> <a id="90485" href="Relation.Unary.html#1523" class="Function Operator">âˆˆ</a> <a id="90487" href="Demos.HSP.html#69808" class="Function">V</a> <a id="90489" href="Demos.HSP.html#90394" class="Bound">â„“</a> <a id="90491" href="Demos.HSP.html#90430" class="Function">Î¹</a> <a id="90493" href="Demos.HSP.html#90358" class="Bound">ğ’¦</a>
 <a id="90496" href="Demos.HSP.html#90441" class="Function">Varâ‡’EqCl</a> <a id="90505" href="Demos.HSP.html#90505" class="Bound">ğ‘¨</a> <a id="90507" href="Demos.HSP.html#90507" class="Bound">ModThA</a> <a id="90514" class="Symbol">=</a> <a id="90516" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="90519" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="90522" href="Demos.HSP.html#90505" class="Bound">ğ‘¨</a> <a id="90524" href="Demos.HSP.html#25552" class="Function Operator">]</a> <a id="90526" href="Demos.HSP.html#78135" class="Function Operator">]</a> <a id="90528" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="90530" class="Symbol">(</a><a id="90531" href="Demos.HSP.html#90072" class="Function">SPF</a><a id="90534" class="Symbol">{</a><a id="90535" class="Argument">â„“</a> <a id="90537" class="Symbol">=</a> <a id="90539" href="Demos.HSP.html#90394" class="Bound">â„“</a><a id="90540" class="Symbol">}</a> <a id="90542" href="Demos.HSP.html#90358" class="Bound">ğ’¦</a> <a id="90544" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="90546" href="Demos.HSP.html#90805" class="Function">Aim</a><a id="90549" class="Symbol">)</a>
  <a id="90553" class="Keyword">where</a>
  <a id="90561" class="Keyword">open</a> <a id="90566" href="Demos.HSP.html#77679" class="Module">FreeAlgebra</a> <a id="90578" href="Demos.HSP.html#90358" class="Bound">ğ’¦</a> <a id="90580" class="Keyword">using</a> <a id="90586" class="Symbol">(</a> <a id="90588" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[_]</a> <a id="90593" class="Symbol">)</a>
  <a id="90597" href="Demos.HSP.html#90597" class="Function">epiFlA</a> <a id="90604" class="Symbol">:</a> <a id="90606" href="Demos.HSP.html#35676" class="Function">epi</a> <a id="90610" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="90613" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="90616" href="Demos.HSP.html#90505" class="Bound">ğ‘¨</a> <a id="90618" href="Demos.HSP.html#25552" class="Function Operator">]</a> <a id="90620" href="Demos.HSP.html#78135" class="Function Operator">]</a> <a id="90622" class="Symbol">(</a><a id="90623" href="Demos.HSP.html#29482" class="Function">Lift-Alg</a> <a id="90632" href="Demos.HSP.html#90505" class="Bound">ğ‘¨</a> <a id="90634" href="Demos.HSP.html#90430" class="Function">Î¹</a> <a id="90636" href="Demos.HSP.html#90430" class="Function">Î¹</a><a id="90637" class="Symbol">)</a>
  <a id="90641" href="Demos.HSP.html#90597" class="Function">epiFlA</a> <a id="90648" class="Symbol">=</a> <a id="90650" href="Demos.HSP.html#81252" class="Function">F-ModTh-epi-lift</a><a id="90666" class="Symbol">{</a><a id="90667" class="Argument">â„“</a> <a id="90669" class="Symbol">=</a> <a id="90671" href="Demos.HSP.html#90394" class="Bound">â„“</a><a id="90672" class="Symbol">}</a> <a id="90674" class="Symbol">Î»</a> <a id="90676" class="Symbol">{</a><a id="90677" href="Demos.HSP.html#90677" class="Bound">p</a> <a id="90679" href="Demos.HSP.html#90679" class="Bound">q</a><a id="90680" class="Symbol">}</a> <a id="90682" class="Symbol">â†’</a> <a id="90684" href="Demos.HSP.html#90507" class="Bound">ModThA</a><a id="90690" class="Symbol">{</a><a id="90691" class="Argument">p</a> <a id="90693" class="Symbol">=</a> <a id="90695" href="Demos.HSP.html#90677" class="Bound">p</a><a id="90696" class="Symbol">}{</a><a id="90698" href="Demos.HSP.html#90679" class="Bound">q</a><a id="90699" class="Symbol">}</a>

  <a id="90704" href="Demos.HSP.html#90704" class="Function">Ï†</a> <a id="90706" class="Symbol">:</a> <a id="90708" href="Demos.HSP.html#29482" class="Function">Lift-Alg</a> <a id="90717" href="Demos.HSP.html#90505" class="Bound">ğ‘¨</a> <a id="90719" href="Demos.HSP.html#90430" class="Function">Î¹</a> <a id="90721" href="Demos.HSP.html#90430" class="Function">Î¹</a> <a id="90723" href="Demos.HSP.html#43774" class="Function Operator">IsHomImageOf</a> <a id="90736" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="90739" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="90742" href="Demos.HSP.html#90505" class="Bound">ğ‘¨</a> <a id="90744" href="Demos.HSP.html#25552" class="Function Operator">]</a> <a id="90746" href="Demos.HSP.html#78135" class="Function Operator">]</a>
  <a id="90750" href="Demos.HSP.html#90704" class="Function">Ï†</a> <a id="90752" class="Symbol">=</a> <a id="90754" href="Demos.HSP.html#36044" class="Function">epiâ†’ontohom</a> <a id="90766" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="90769" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="90772" href="Demos.HSP.html#90505" class="Bound">ğ‘¨</a> <a id="90774" href="Demos.HSP.html#25552" class="Function Operator">]</a> <a id="90776" href="Demos.HSP.html#78135" class="Function Operator">]</a> <a id="90778" class="Symbol">(</a><a id="90779" href="Demos.HSP.html#29482" class="Function">Lift-Alg</a> <a id="90788" href="Demos.HSP.html#90505" class="Bound">ğ‘¨</a> <a id="90790" href="Demos.HSP.html#90430" class="Function">Î¹</a> <a id="90792" href="Demos.HSP.html#90430" class="Function">Î¹</a><a id="90793" class="Symbol">)</a> <a id="90795" href="Demos.HSP.html#90597" class="Function">epiFlA</a>

  <a id="90805" href="Demos.HSP.html#90805" class="Function">Aim</a> <a id="90809" class="Symbol">:</a> <a id="90811" href="Demos.HSP.html#90505" class="Bound">ğ‘¨</a> <a id="90813" href="Demos.HSP.html#43774" class="Function Operator">IsHomImageOf</a> <a id="90826" href="Demos.HSP.html#78135" class="Function Operator">ğ”½[</a> <a id="90829" href="Demos.HSP.html#25552" class="Function Operator">ğ•Œ[</a> <a id="90832" href="Demos.HSP.html#90505" class="Bound">ğ‘¨</a> <a id="90834" href="Demos.HSP.html#25552" class="Function Operator">]</a> <a id="90836" href="Demos.HSP.html#78135" class="Function Operator">]</a>
  <a id="90840" href="Demos.HSP.html#90805" class="Function">Aim</a> <a id="90844" class="Symbol">=</a> <a id="90846" href="Demos.HSP.html#37248" class="Function">âˆ˜-hom</a> <a id="90852" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a> <a id="90854" href="Demos.HSP.html#90704" class="Function">Ï†</a> <a id="90856" href="Demos.HSP.html#10362" class="Function Operator">âˆ£</a><a id="90857" class="Symbol">(</a><a id="90858" href="Demos.HSP.html#41424" class="Field">from</a> <a id="90863" href="Demos.HSP.html#47110" class="Function">Lift-â‰…</a><a id="90869" class="Symbol">)</a><a id="90870" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="90872" href="Demos.HSP.html#16289" class="Function">âˆ˜-IsSurjective</a> <a id="90887" class="Symbol">_</a> <a id="90889" class="Symbol">_</a> <a id="90891" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a> <a id="90893" href="Demos.HSP.html#90704" class="Function">Ï†</a> <a id="90895" href="Demos.HSP.html#10399" class="Function Operator">âˆ¥</a><a id="90896" class="Symbol">(</a><a id="90897" href="Demos.HSP.html#42081" class="Function">fromIsSurjective</a><a id="90913" class="Symbol">(</a><a id="90914" href="Demos.HSP.html#47110" class="Function">Lift-â‰…</a><a id="90920" class="Symbol">{</a><a id="90921" class="Argument">ğ‘¨</a> <a id="90923" class="Symbol">=</a> <a id="90925" href="Demos.HSP.html#90505" class="Bound">ğ‘¨</a><a id="90926" class="Symbol">}))</a>

</pre>
By \af{ModTh-closure} and \af{Varâ‡’EqCl}, we have
\af{V} \ab{ğ’¦} = \af{Mod} (\af{Th} (\af{V} \ab{ğ’¦})) for every class \ab{ğ’¦} of \ab{ğ‘†}-algebras.
Thus, every variety is an equational class.
\end{itemize}

This completes the formal proof of Birkhoff's variety theorem. \hfill \qedsymbol

%% -----------------------------------------------------------------------------
\section{Discussion}\label{sec:discuss}
How do we differ from the classical, set-theoretic approach? Most noticeable is
our avoidance of all \emph{size} issues. By using universe levels and level
polymorphism, we always make sure we are in a \emph{large enough} universe.
So we can easily talk about ``all algebras such that \ldots'' because these are
always taken from a bounded (but arbitrary) universe.

Our use of setoids introduces nothing new: all the equivalence relations we
use were already present in the classical proofs. The only ``new'' material is
that we have to prove that functions respect those equivalences.

Our first attempt to formalize Birkhoff's theorem was not sufficiently
careful in its handling of variable symbols \ab X. Specifically, this
type was unconstrained; it is meant to represent the informal notion of a ``sufficiently large'' collection of variable symbols. Consequently, we postulated surjections from \ab X onto the
domains of all algebras in the class under consideration.
%The quantifiers were in the wrong order!
But then, given a signature \ab{ğ‘†} and a one-element \ab{ğ‘†}-algebra \ab{ğ‘¨},
by choosing \ab X to be the empty type \ab{âŠ¥}, our surjectivity postulate gives a map from \ab{âŠ¥} onto the singleton domain of \ab{ğ‘¨}. (For details, see the \href{https://github.com/ualib/agda-algebras/blob/master/src/Demos/ContraX.lagda}{\am{Demos.ContraX}} module which constructs the counterexample in \agda.)

\begin{comment}
The inconsistency in our first effort to formalize Birkhoff's theorem was due to careless handling of the type \ab X of variable symbols.  Specifically, we had allowed \ab X to be any type whatever. Informally, \ab X is a ``sufficiently large'' collection of variable symbols and, in our first formal statement of Birkhoff's theorem, we made the following assumption: (h1) there exist surjections from \ab X to the domain of every algebra in the class under consideration.  Informally, this isn't a problem if we view (h1) as implicitly requiring that \ab X be a type for which such surjections could possibly exist.  Technically, however, by exploiting the freedom to choose \ab X arbitrarily, a contradiction can be contrived.  Specifically, if we take \ab X to be the empty type and take the one-element \ab{ğ‘†}-algebra. By (h1), there is a surjective map from the empty type to a nonempty type, which is clearly a contradiction.
(See the \href{https://github.com/ualib/agda-algebras/blob/master/src/Demos/ContraX.lagda}{\am{Demos.ContraX}} module in the \agdaalgebrasrepo repository for the formal counterexample.)
\end{comment}

%% -----------------------------------------------------------------------------
\section{Related work}
There have been a number of efforts to formalize parts of universal algebra in
type theory besides ours. The Coq proof assistant, based on the Calculus of
Inductive Constructions, was used by Capretta, in~\cite{Capretta:1999}, and
Spitters and Van der Weegen, in~\cite{Spitters:2011}, to formalized the basics
of universal algebra and some classical algebraic structures.
In~\cite{Gunther:2018} Gunther et al developed what seemed (prior to the \agdaalgebras
library) the most extensive library of formalized universal algebra to date.
Like \agdaalgebras,~\cite{Gunther:2018} is based on dependent type theory, is programmed
in \agda, and goes beyond the basic isomorphism theorems to include some equational logic.
Although their coverage is less extensive than that of \agdaalgebras, Gunther et al do treat
\emph{multi-sorted} algebras, whereas \agdaalgebras is currently limited to single-sorted structures.

As noted by Abel~\cite{Abel:2021}, Amato et al, in \cite{Amato:2021}, have
formalized multi-sorted algebras with finitary operators in UniMath. The restriction to
finitary operations was due to limitations of the UniMath type theory, which does
not have W-types nor user-defined inductive types.
Abel also notes that Lynge and Spitters, in~\cite{Lynge:2019}, formalize multi-sorted
algebras with finitary operators in \emph{Homotopy type theory} (\cite{HoTT}) using
Coq.  HoTT's higher inductive types enable them to define quotients as types, without
the need for setoids.  Lynge and Spitters prove three isomorphism theorems concerning
subalgebras and quotient algebras, but do not formalize universal algebras nor varieties.
Finally, in~\cite{Abel:2021}, Abel gives a new formal proof of the soundness and completeness
theorem for multi-sorted algebraic structures.

%Some other projects aimed at formalizing mathematics generally, and algebra in particular,
% have developed into very extensive libraries that include definitions, theorems, and proofs
% about algebraic structures, such as groups, rings, modules, etc.  However, the goals of these
% efforts seem to be the formalization of special classical algebraic structures, as opposed
% to the general theory of (universal) algebras. Moreover, the part of universal algebra and
% equational logic formalized in the \agdaalgebras library extends beyond the scope of prior efforts.

%Prior to our work, a constructive version of Birkhoff's theorem was published by
% Carlstr\"om in~\cite{Carlstrom:2008}.  However, the logical foundations of that work is constructive set
% theory and, as far as we know, there was no attempt to formalize it in type theory and verify
% it with a proof assistant.


% \section{Conclusion}

% One positive outcome of this project is further evidence in support of dependent type theory and the \agda language. We have shown that, despite the technical demands they place on the user, these technologies are accessible to universal algebraists who possess sufficient patience and resolve to codify their work in type theory and verify their results with a proof assistant.













\begin{comment}

%The \defn{relatively free algebra over} \ab{X} (relative to
%\ab{ğ’¦}) is defined to be the quotient \Free{X} := \T{X}~\af{/}~\afld{â‰ˆ}.


is the least equivalence relation on \T{X} such that
on such that (1) âˆ€ (\ab p , \ab q) \af{âˆˆ} \af{Th} \ab{ğ’¦}, âˆ€ \ab{Ï} : \ab X \as{â†’} \Term{X}, \af{âŸ¦~\ab p~âŸ§} \afld{âŸ¨\$âŸ©} \ab{Ï} \afld{â‰ˆ} \af{âŸ¦~\ab q~âŸ§} \afld{âŸ¨\$âŸ©} \ab{Ï}, and (2) \afld{â‰ˆ} âˆˆ \af{Con} \T{X}.  Alternatively, }
\footnote{More precisely, the equivalence relation on \T{X} generated by \ab{â„°} is the least equivalence relation on \T{X} such that
on such that (1) âˆ€ (\ab p , \ab q) \af{âˆˆ} \af{Th} \ab{ğ’¦}, âˆ€ \ab{Ï} : \ab X \as{â†’} \Term{X}, \af{âŸ¦~\ab p~âŸ§} \afld{âŸ¨\$âŸ©} \ab{Ï} \afld{â‰ˆ} \af{âŸ¦~\ab q~âŸ§} \afld{âŸ¨\$âŸ©} \ab{Ï}, and (2) \afld{â‰ˆ} âˆˆ \af{Con} \T{X}.  Alternatively, }
proceeds by taking the quotient of \T{X} modulo the congruence relation \afld{â‰ˆ} := \af{â‹‚}\{\ab{Î¸} \af{âˆˆ} \af{Con} (\T{X}) : \T{X} \af{/} \ab{Î¸} \af{âˆˆ} \af{S}
\ab{ğ’¦}\}.\footnote{\af{Con} (\T{X}) denotes the congruences of \T{X}.}$^,$\footnote{Alternatively,
we could let \ab{â„°} = \af{Th} \ab{ğ’¦} and take \afld{â‰ˆ} to be the least equivalence relation
on T(X) such that (1) âˆ€ (\ab p , \ab q) \af{âˆˆ} \af{Th} \ab{ğ’¦}, âˆ€ \ab{Ï} : \ab X \as{â†’} \Term{X}, \af{âŸ¦~\ab p~âŸ§} \afld{âŸ¨\$âŸ©} \ab{Ï} \afld{â‰ˆ} \af{âŸ¦~\ab q~âŸ§} \afld{âŸ¨\$âŸ©} \ab{Ï}, and (2) \afld{â‰ˆ} âˆˆ \af{Con} \T{X}}
Equivalently, we could let \ab{â„°} = \af{Th} \ab{ğ’¦} and take \afld{â‰ˆ} to be the least equivalence relation
on the domain of \T{X} such that
\begin{enumerate}
\item for every equation (\ab p , \ab q) \af{âˆˆ} \af{Th} \ab{ğ’¦} and every
environment \ab{Ï} : \ab X \as{â†’} \Term{X}, we have\\
\af{âŸ¦~\ab p~âŸ§} \afld{âŸ¨\$âŸ©} \ab{Ï} \afld{â‰ˆ} \af{âŸ¦~\ab q~âŸ§} \afld{âŸ¨\$âŸ©} \ab{Ï}, and
\item \afld{â‰ˆ} is a congruence of \T{X}; that is, for every operation symbol \ab
f : \af{âˆ£~\ab{ğ‘†}~âˆ£}, and for all tuples \ab{s} \ab{t} : \af{âˆ¥~\ab{ğ‘†}~âˆ¥} \ab f
â†’ \Term{X}, the following implication holds:\footnote{Here all
interpretations, denoted by \af{âŸ¦\au{}âŸ§}, are with respect to \T{X}.}\\[-8pt]

(âˆ€ i â†’ \af{âŸ¦~\ab{s}~\ab i~âŸ§}~\afld{âŸ¨\$âŸ©}~\ab{Ï}~\afld{â‰ˆ}~\af{âŸ¦~\ab{t}~\ab
i~âŸ§}~\afld{âŸ¨\$âŸ©}~\ab{Ï})
\as{â†’} \af{âŸ¦~\ab f~\ab s~âŸ§}~\afld{âŸ¨\$âŸ©}~\ab{Ï}~\afld{â‰ˆ}~\af{âŸ¦~\ab f~\ab
t~âŸ§}~\afld{âŸ¨\$âŸ©}~\ab{Ï}\\[-8pt]
\end{comment}
%
