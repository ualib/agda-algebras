% -*- TeX-master: "ualib-part3.tex" -*-
%%% Local Variables: 
%%% mode: latex
%%% TeX-engine: 'xetex
%%% End:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Varieties}\label{sec:varieties}\firstsentence{Varieties}{Varieties}

Fix a signature \ab ğ‘†, let \ab ğ’¦ be a class of \ab ğ‘†-algebras, and define
\begin{itemize}
\item \ad H~\ab ğ’¦ = algebras isomorphic to a homomorphic image of a members of~\ab ğ’¦;
\item \ad S~\ab ğ’¦ = algebras isomorphic to a subalgebra of a member of~\ab ğ’¦;
\item \ad P~\ab ğ’¦ = algebras isomorphic to a product of members of~\ab ğ’¦.
\end{itemize}

A straight-forward verification confirms that \ad H, \ad S, and \ad P are \defn{closure operators} (expansive, monotone, and idempotent). A class \ab ğ’¦ of \ab ğ‘†-algebras is said to be \emph{closed under the taking of homomorphic images} provided \ad H~\ab ğ’¦~\af âŠ†~\ab ğ’¦. Similarly, \ab ğ’¦ is \emph{closed under the taking of subalgebras} (resp., \emph{arbitrary products}) provided \af{S}~\ab ğ’¦~\af âŠ†~\ab ğ’¦ (resp., \texttt{P ğ’¦ âŠ† ğ’¦}).
The operators \ad H, \ad S, and \ad P can be composed with one another repeatedly to obtain other closure operators.

An algebra is a homomorphic image (resp., subalgebra; resp., product) of every algebra to which it is isomorphic. Thus, the class \ad{H}~\ab ğ’¦ (resp., \ad S~\ab ğ’¦; resp., \ad P~\ab ğ’¦) is closed under isomorphism.

A \textbf{variety} is a class of algebras, all of the same signature, that is closed under the taking of homomorphic images, subalgebras, and arbitrary products. To represent varieties we define inductive types for the closure operators~\ad{H},~\ad{S}, and~\ad{P} that are composable. Separately, we define an inductive type \texttt{V} which
simultaneously represents closure under all three operators,~\ad{H}, \ad{S}, and~\ad{P}.

\subsection{The Inductive Types H, S, P, V}\label{the-inductive-types-h-s-p-v}

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--without-K}\AgdaSpace{}%
\AgdaPragma{--exact-split}\AgdaSpace{}%
\AgdaPragma{--safe}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Algebras.Signatures}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Signature}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaGeneralizable{ğ“}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaGeneralizable{ğ“¥}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{MGS-Subsingleton-Theorems}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{global-dfunext}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Varieties.Varieties}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘†}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Signature}\AgdaSpace{}%
\AgdaGeneralizable{ğ“}\AgdaSpace{}%
\AgdaGeneralizable{ğ“¥}\AgdaSymbol{\}\{}\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{global-dfunext}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Varieties.EquationalLogic}\AgdaSymbol{\{}\AgdaArgument{ğ‘†}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}\{}\AgdaBound{gfe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
\>[0]\AgdaComment{--open import MGS-Subsingleton-Theorems using (hfunext) -- public}\<%
\end{code}
\ccpad
Fix a signature ğ‘†, let ğ’¦ be a class of ğ‘†-algebras, and define

\begin{itemize}
\tightlist
\item
  H ğ’¦ = algebras isomorphic to a homomorphic image of a members of ğ’¦;
\item
  S ğ’¦ = algebras isomorphic to a subalgebra of a member of ğ’¦;
\item
  P ğ’¦ = algebras isomorphic to a product of members of ğ’¦.
\end{itemize}

A straight-forward verification confirms that H, S, and P are
\textbf{closure operators} (expansive, monotone, and idempotent). A
class ğ’¦ of ğ‘†-algebras is said to be \emph{closed under the taking of
homomorphic images} provided \texttt{H ğ’¦ âŠ† ğ’¦}. Similarly, ğ’¦ is
\emph{closed under the taking of subalgebras} (resp., \emph{arbitrary
products}) provided \texttt{S ğ’¦ âŠ† ğ’¦} (resp., \texttt{P ğ’¦ âŠ† ğ’¦}).
The operators H, S, and P can be composed with one another repeatedly,
forming yet more closure operators.

An algebra is a homomorphic image (resp., subalgebra; resp., product) of
every algebra to which it is isomorphic. Thus, the class \texttt{H ğ’¦}
(resp., \texttt{S ğ’¦}; resp., \texttt{P ğ’¦}) is closed under
isomorphism.

A \textbf{variety} is a class of algebras, in the same signature, that
is closed under the taking of homomorphic images, subalgebras, and
arbitrary products. To represent varieties we define inductive types for
the closure operators~\ad{H},~\ad{S}, and~\ad{P} that are
composable. Separately, we define an inductive type \texttt{V} which
simultaneously represents closure under all three operators,~\ad{H},
\texttt{S}, and~\ad{P}.

\subsubsection{Homomorphic closure}\label{homomorphic-closure}

We define the inductive type~\ad{H} to represent classes of algebras
that include all homomorphic images of algebras in the class; i.e.,
classes that are closed under the taking of homomorphic images.
\ccpad
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}(}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{))}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
%
\>[1]\AgdaInductiveConstructor{hbase}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{hlift}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{hhimg}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{is-hom-image-of}}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{hiso}%
\>[7]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\end{code}

\subsubsection{Subalgebraic closure}\label{subalgebraic-closure}

The most useful inductive type that we have found for representing the
semantic notion of a class of algebras that is closed under the taking
of subalgebras is the following.
\ccpad
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}(}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{))}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
%
\>[1]\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{ssub}%
\>[7]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{ssubw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{siso}%
\>[7]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\end{code}

\subsubsection{Product closure}\label{product-closure}

The most useful inductive type that we have found for representing the
semantic notion of an class of algebras closed under the taking of
arbitrary products is the following.
\ccpad
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}(}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{))}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
%
\>[1]\AgdaInductiveConstructor{pbase}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{produ}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaSymbol{\}\{}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{prodw}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaSymbol{\}\{}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{pisou}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{pisow}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\end{code}

\subsubsection{Varietal closure}\label{varietal-closure}

A class ğ’¦ of ğ‘†-algebras is called a \textbf{variety} if it is closed
under each of the closure operators H, S, and P introduced above; the
corresponding closure operator is often denoted ğ•, but we will denote it
by \texttt{V}.

We now define \texttt{V} as an inductive type.
\ccpad
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}(}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{))}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
%
\>[1]\AgdaInductiveConstructor{vbase}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{vlift}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{vliftw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{vhimg}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{is-hom-image-of}}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{vssub}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{vprodu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSymbol{\}\{}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{vprodw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSymbol{\}\{}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{visou}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaInductiveConstructor{visow}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\end{code}
\ccpad
Thus, if ğ’¦ is a class of ğ‘†-algebras, then the \textbf{variety generated
by} ğ’¦ is denoted by \texttt{V ğ’¦} and defined to be the smallest class
that contains ğ’¦ and is closed under~\ad{H},~\ad{S}, and~\ad{P}.

With the closure operator V representing closure under HSP, we represent
formally what it means to be a variety of algebras as follows.
\ccpad
\begin{code}%
\>[0]\AgdaFunction{is-variety}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}(}\AgdaBound{ğ’±}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\<%
\\
\>[0]\AgdaFunction{is-variety}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’±}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’±}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaBound{ğ’±}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{variety}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\AgdaOperator{\AgdaFunction{âº}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\<%
\\
\>[0]\AgdaFunction{variety}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Î£}\AgdaSpace{}%
\AgdaBound{ğ’±}\AgdaSpace{}%
\AgdaFunction{ê‰}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{,}\AgdaSpace{}%
\AgdaFunction{is-variety}\AgdaSpace{}%
\AgdaBound{ğ’±}\<%
\end{code}

\subsubsection{V is closed under lift}\label{v-is-closed-under-lift}

As mentioned earlier, a technical hurdle that must be overcome when
formalizing proofs in Agda is the proper handling of universe levels. In
particular, in the proof of the Birkhoff's theorem, for example, we will
need to know that if an algebra ğ‘¨ belongs to the variety V ğ’¦, then so
does the lift of ğ‘¨. Let us get the tedious proof of this technical lemma
out of the way.
\ccpad
\begin{code}%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Lift}\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[694I]\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
\>[.][@{}l@{}]\<[694I]%
\>[7]\AgdaComment{------------------------------------------}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{â†’}%
\>[7]\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vbase}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-associative}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vlift}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vlift}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-associative}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vliftw}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-associative}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vhimg}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{hB}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vhimg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-hom-image}\AgdaSpace{}%
\AgdaBound{hB}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vssub}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vlift}\AgdaSymbol{\{}\AgdaArgument{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-â‰¤-lift}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vssubw}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-â‰¤-lift}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vprodu}\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{ğ’œ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vprodw}\AgdaSpace{}%
\AgdaFunction{vlA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â‰…-sym}\AgdaSpace{}%
\AgdaFunction{Bâ‰…A}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaFunction{ğ‘°}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\<%
\\
%
\>[2]\AgdaFunction{ğ‘°}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{Lift}\AgdaSpace{}%
\AgdaBound{I}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ğ‘°}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{lower}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{vlA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaFunction{vlA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vlift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{lower}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{iso-components}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{lift}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{iso-components}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Bâ‰…A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{lA}\<%
\\
%
\>[2]\AgdaFunction{Bâ‰…A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-â¨…â‰…}\AgdaSpace{}%
\AgdaFunction{iso-components}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vprodw}\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{ğ’œ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vprodw}\AgdaSpace{}%
\AgdaFunction{vlA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â‰…-sym}\AgdaSpace{}%
\AgdaFunction{Bâ‰…A}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaFunction{ğ‘°}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\<%
\\
%
\>[2]\AgdaFunction{ğ‘°}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{Lift}\AgdaSpace{}%
\AgdaBound{I}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ğ‘°}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{lower}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{vlA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaFunction{vlA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{lower}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{iso-components}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{lift}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{iso-components}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Bâ‰…A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{lA}\<%
\\
%
\>[2]\AgdaFunction{Bâ‰…A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-â¨…â‰…}\AgdaSpace{}%
\AgdaFunction{iso-components}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{visou}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vlift}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-iso}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{visow}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-iso}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\<%
\end{code}

\subsubsection{Closure properties}\label{closure-properties}

The types defined above represent operators with useful closure
properties. We now prove a handful of such properties that we need
later.

First,~\ad{P} is a closure operator. This is proved by checking that
\texttt{P} is \emph{monotone}, \emph{expansive}, and \emph{idempotent}.
The meaning of these terms will be clear from the definitions of the
types that follow.
\ccpad
\begin{code}%
\>[0]\AgdaFunction{P-mono}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaBound{ğ’¦'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{â†’}%
\>[9]\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaBound{ğ’¦'}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦'}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{P-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[24]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{kk'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{P-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[24]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{P-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[24]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{P-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[24]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{produ}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{P-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{P-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[24]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{P-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{P-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisou}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisou}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\\
\>[0]\AgdaFunction{P-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{P-expa}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
\>[0]\AgdaFunction{P-expa}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisou}\AgdaSymbol{\{}\AgdaArgument{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}\{}\AgdaArgument{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â‰…-sym}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{â†’}%
\>[11]\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[22]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[1]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[22]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[22]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[22]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\>[1]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[22]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\>[1]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisou}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\\
%
\>[1]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\end{code}
\ccpad
Similarly, S is a closure operator. The facts that S is idempotent and
expansive won't be needed below, so we omit these, but we will make use
of monotonicity of S. Here is the proof of the latter.
\ccpad
\begin{code}%
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaBound{ğ’¦'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{â†’}%
\>[9]\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaBound{ğ’¦'}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦'}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[32]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{kk'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[32]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}%
\>[32]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}%
\>[32]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{kk'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\end{code}
\ccpad
We sometimes want to go back and forth between our two representations
of subalgebras of algebras in a class. The tools \texttt{subalgebraâ†’S}
and \texttt{Sâ†’subalgebra} are made for that purpose.
\ccpad
\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{subalgebraâ†’S}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{subalgebraâ†’S}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Câ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Bâ‰…C}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssub}\AgdaSpace{}%
\AgdaFunction{sA}\AgdaSpace{}%
\AgdaFunction{Bâ‰¤A}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{Bâ‰¤A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â‰¤-iso}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{Bâ‰…C}\AgdaSpace{}%
\AgdaBound{Câ‰¤A}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{slAu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{slAu}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{KA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{sA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{sA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaFunction{slAu}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â‰…-sym}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}%
\>[51]\AgdaSymbol{â†’}%
\>[54]\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{â‰¤-refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â‰…-sym}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{â‰…-trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â‰…-sym}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{Bâ‰…SA}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{BS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{BS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Subalgebra}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰…SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰…SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{Bâ‰¤AS}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{â‰…-refl}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Subalgebra}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â‰¤-TRANS-â‰…}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤AS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤AS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â‰¤-trans}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Bâ‰¤SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{Bâ‰¤AS}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{â‰…-refl}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Subalgebra}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â‰¤-TRANS-â‰…}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤AS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤AS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â‰¤-trans}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Bâ‰¤SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}%
\>[52]\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â‰…-trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â‰…-sym}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{Aâ‰…SA}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Subalgebra}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\>[3]\AgdaFunction{Aâ‰…SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{Aâ‰…SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\end{code}
\ccpad
Next we observe that lifting to a higher universe does not break the
property of being a subalgebra of an algebra of a class. In other words,
if we lift a subalgebra of an algebra in a class, the result is still a
subalgebra of an algebra in the class.

\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{â†’}%
\>[17]\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[17]\AgdaComment{-------------------------------------------------}\<%
\\
%
\>[2]\AgdaSymbol{â†’}%
\>[17]\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}(}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Câ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{pA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Bâ‰…C}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lC}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{lCâ‰¤lA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{plA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-iso}\AgdaSpace{}%
\AgdaBound{Bâ‰…C}\AgdaSymbol{)}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaKeyword{where}\<%
\\
%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaFunction{lC}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\<%
\\
%
\>[3]\AgdaFunction{lC}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaBound{ğ“¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{lCâ‰¤lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lC}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaFunction{lA}\<%
\\
%
\>[3]\AgdaFunction{lCâ‰¤lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰¤-lift}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{Câ‰¤A}\<%
\\
%
\>[3]\AgdaFunction{plA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{plA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{pA}\<%
\end{code}
\ccpad
The next lemma would be too obvious to care about were it not for the
fact that we'll need it later, so it too must be formalized.
\ccpad
\begin{code}%
\>[0]\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{â†’}%
\>[7]\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaDottedPattern{\AgdaSymbol{.(}}\AgdaDottedPattern{\AgdaFunction{lift-alg}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaBound{ğ‘¨}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaBound{ğ“¦}}\AgdaDottedPattern{\AgdaSymbol{)}}\AgdaSymbol{\}(}\AgdaInductiveConstructor{sbase}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaFunction{spllA}\AgdaSymbol{(}\AgdaFunction{â‰…-sym}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
%
\>[1]\AgdaFunction{llA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[1]\AgdaFunction{llA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{spllA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{llA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{spllA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{sbase}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaDottedPattern{\AgdaSymbol{.(}}\AgdaDottedPattern{\AgdaFunction{lift-alg}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaBound{ğ‘¨}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaBound{ğ“¦}}\AgdaDottedPattern{\AgdaSymbol{)}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subalgebraâ†’S}\AgdaSpace{}%
\AgdaFunction{lAsc}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
%
\>[1]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SâŠ†SP}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{Asc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{Asc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{splAu}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaFunction{Asc}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaInductiveConstructor{ssub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{subalgebraâ†’S}\AgdaSpace{}%
\AgdaFunction{lAsc}\AgdaSymbol{)(}\AgdaSpace{}%
\AgdaFunction{â‰¤-lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SâŠ†SP}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Asc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{Asc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{splAu}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaFunction{Asc}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}(}\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaFunction{lAâ‰…B}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
%
\>[1]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[1]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Sâ†’subalgebra}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subalgebraâ†’S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaFunction{lA}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{lAsc}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{lAâ‰…B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\<%
\\
%
\>[1]\AgdaFunction{lAâ‰…B}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â‰…-trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â‰…-sym}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\<%
\end{code}
\ccpad
We need to formalize one more lemma before arriving the main objective
of this section, which is the proof of the inclusion PSâŠ†SP.

\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}\{}\AgdaBound{fe}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hfunext}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{lemPSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSymbol{\}\{}\AgdaBound{â„¬}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{â†’}%
\>[12]\AgdaSymbol{(âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{â„¬}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaComment{-------------------------------------}\<%
\\
%
\>[2]\AgdaSymbol{â†’}%
\>[12]\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{â„¬}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{lemPSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{â„¬}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤K}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{â¨…SAâ‰¤â¨…ğ’œ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{Î¾}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â¨…â‰…}\AgdaSpace{}%
\AgdaFunction{Bâ‰…SA}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[2]\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤K}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[2]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤K}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Bâ‰…SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{â„¬}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaBound{i}\<%
\\
%
\>[2]\AgdaFunction{Bâ‰…SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤K}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{SAâ‰¤ğ’œ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOf}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{SAâ‰¤ğ’œ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤K}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[2]\AgdaFunction{h}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SAâ‰¤ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Î±}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[2]\AgdaFunction{Î±}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{h}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{Î²}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{is-homomorphism}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{ğ’œ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{Î±}\<%
\\
%
\>[2]\AgdaFunction{Î²}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{ğ‘“}\AgdaSpace{}%
\AgdaBound{ğ’‚}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SAâ‰¤ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘“}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ’‚}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{is-embedding}\AgdaSpace{}%
\AgdaFunction{Î±}\<%
\\
%
\>[2]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{embedding-lift}\AgdaSpace{}%
\AgdaBound{fe}\AgdaSpace{}%
\AgdaBound{fe}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaFunction{SA}\AgdaSymbol{\}\{}\AgdaFunction{ğ’œ}\AgdaSymbol{\}}\AgdaFunction{h}\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{SAâ‰¤ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{â¨…SAâ‰¤â¨…ğ’œ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{ğ’œ}\<%
\\
%
\>[2]\AgdaFunction{â¨…SAâ‰¤â¨…ğ’œ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Î±}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{Î²}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{Î³}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Î¾}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaFunction{Î¾}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{produ}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{P-expa}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤K}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\<%
\end{code}

\subsubsection{PS(ğ’¦) âŠ† SP(ğ’¦)}\label{psux1d4a6-spux1d4a6}

Finally, we are in a position to prove that a product of subalgebras of
algebras in a class ğ’¦ is a subalgebra of a product of algebras in ğ’¦.
\ccpad
\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[2066I]\AgdaComment{-- extensionality assumption:}\<%
\\
\>[2066I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{hfunext}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{â†’}%
\>[9]\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SâŠ†SP}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\<%
\\
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{(}\AgdaFunction{SâŠ†SP}\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSymbol{))(}\AgdaFunction{lift-alg-â‰¤-lift}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{â‰…-refl}\<%
\\
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssub}\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{(}\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSymbol{))(}\AgdaFunction{lift-alg-â‰¤-lift}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{lift-alg-iso}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{ğ’œ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{subalgebraâ†’S}\AgdaSpace{}%
\AgdaFunction{Î·}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{Î¾}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Î¾}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Î·}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{Î·}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lemPSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{hfe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ’œ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{Î¾}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prodw}\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{ğ’œ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{subalgebraâ†’S}\AgdaSpace{}%
\AgdaFunction{Î·}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{Î¾}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Î¾}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Î·}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{Î·}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lemPSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{hfe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ’œ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{Î¾}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisou}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{pA}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaBound{pA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\<%
\\
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{pA}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaBound{pA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\<%
\end{code}

\subsubsection{More class inclusions}\label{more-class-inclusions}

We conclude this subsection with three more inclusion relations that
will have bit parts to play later (e.g., in the formal proof of
Birkhoff's Theorem).
\ccpad
\begin{code}%
\>[0]\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vbase}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{PâŠ†V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vlift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PâŠ†V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{PâŠ†V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PâŠ†V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vprodu}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vprodw}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisou}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visou}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\\
\>[0]\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{â†’}%
\>[7]\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{PCloA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaBound{PCloA}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\<%
\\
\>[0]\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\<%
\\
\>[0]\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\end{code}

We just proved that \texttt{SP(ğ’¦) âŠ† V(ğ’¦)}, and we did so under fairly
general assumptions about the universe level parameters. Unfortunately,
this is sometimes not quite general enough, so we now prove the
inclusion again for the specific universe parameters that align with
subsequent applications of this result.
\ccpad
\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{SPâŠ†V'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{SPâŠ†V'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â‰…-sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-associative}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSymbol{))}\<%
\\
%
\>[1]\AgdaFunction{SPâŠ†V'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{SPâŠ†V'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{Bâ‰¤lA}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{Bâ‰¤lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â‰¤-lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{SPâŠ†V'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPâŠ†V'}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{SPâŠ†V'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{VlA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{Î³}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\<%
\\
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â‰…-trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â‰…-sym}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\<%
\end{code}

\subsubsection{â¨… S(ğ’¦) âˆˆ SP(ğ’¦)}\label{sux1d4a6-spux1d4a6}

Finally, we prove a result that plays an important role, e.g., in the
formal proof of Birkhoff's Theorem. As we saw in
{[}Algebras.Products{]}{[}{]}, the (informal) product \texttt{â¨… S(ğ’¦)}
of all subalgebras of algebras in ğ’¦ is implemented (formally) in the
{[}UALib{]}{[}{]} as \texttt{â¨… ğ”„ S(ğ’¦)}. Our goal is to prove that this
product belongs to \texttt{SP(ğ’¦)}. We do so by first proving that the
product belongs to \texttt{PS(ğ’¦)} and then applying the \texttt{PSâŠ†SP}
lemma.
\ccpad
\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Universe}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{class-prod-s-âˆˆ-ps}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{class-product}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}(}\AgdaDatatype{S}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}(}\AgdaDatatype{S}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{class-prod-s-âˆˆ-ps}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisou}\AgdaSpace{}%
\AgdaFunction{psPllA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â¨…â‰…}\AgdaSpace{}%
\AgdaFunction{llAâ‰…A}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaFunction{llA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â„‘}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[10]\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ”„}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{llA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{slA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaFunction{slA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{psllA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{llA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{psllA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{slA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{psPllA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{llA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{psPllA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{produ}\AgdaSpace{}%
\AgdaFunction{psllA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{llAâ‰…A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{llA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ”„}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{llAâ‰…A}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â‰…-trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â‰…-sym}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)(}\AgdaFunction{â‰…-sym}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\<%
\end{code}

So, since \texttt{PSâŠ†SP}, we see that that the product of all
subalgebras of a class \ab{ğ’¦} belongs to \texttt{SP(ğ’¦)}.
\ccpad
\begin{code}%
\>[0][@{}l@{\AgdaIndent{1}}]%
\>[1]\AgdaFunction{class-prod-s-âˆˆ-sp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hfunext}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ov}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{class-product}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}(}\AgdaDatatype{S}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{class-prod-s-âˆˆ-sp}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaFunction{class-prod-s-âˆˆ-ps}\<%
\end{code}
