\subsubsection{Inductive Types H, S, P, and
V}\label{inductive-types-h-s-p-and-v}

This section presents the {[}UALib.Varieties.Varieties{]}{[}{]} module
of the {[}Agda Universal Algebra Library{]}{[}{]}.

Fix a signature , let  be a class of -algebras, and define

\begin{itemize}
\tightlist
\item
  H  = algebras isomorphic to a homomorphic image of a members of ;
\item
  S  = algebras isomorphic to a subalgebra of a member of ;
\item
  P  = algebras isomorphic to a product of members of .
\end{itemize}

A straight-forward verification confirms that H, S, and P are
\textbf{closure operators} (expansive, monotone, and idempotent). A
class  of -algebras is said to be \emph{closed under the taking of
homomorphic images} provided \texttt{H\ \ \ }. Similarly,  is
\emph{closed under the taking of subalgebras} (resp., \emph{arbitrary
products}) provided \texttt{S\ \ \ } (resp., \texttt{P\ \ \ }).

An algebra is a homomorphic image (resp., subalgebra; resp., product) of
every algebra to which it is isomorphic. Thus, the class \texttt{H\ }
(resp., \texttt{S\ }; resp., \texttt{P\ }) is closed under
isomorphism.

The operators H, S, and P can be composed with one another repeatedly,
forming yet more closure operators.

A \textbf{variety} is a class  of algebras in a fixed signature that is
closed under the taking of homomorphic images (H), subalgebras (S), and
arbitrary products (P). That is,  is a variety if and only if
\texttt{H\ S\ P\ \ \ }.

This module defines what we have found to be the most useful inductive
types representing the closure operators H, S, and P. Separately, we
define the inductive type \texttt{V} for simultaneously representing
closure under \texttt{H}, \texttt{S}, and \texttt{P}.

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--without-K}\AgdaSpace{}%
\AgdaPragma{--exact-split}\AgdaSpace{}%
\AgdaPragma{--safe}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{UALib.Algebras}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Signature}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{UALib.Prelude.Preliminaries}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{global-dfunext}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{UALib.Varieties.Varieties}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Signature}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSymbol{\}\{}\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{global-dfunext}\AgdaSymbol{\}}\<%
\\
%
\>[1]\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{\}(}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\<%
\\
%
\>[1]\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{UALib.Varieties.EquationalLogic}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{gfe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
\>[0]\<%
\end{code}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\paragraph{Homomorphism closure}\label{homomorphism-closure}

We define the inductive type \texttt{H} to represent classes of algebras
that include all homomorphic images of algebras in the class; i.e.,
classes that are closed under the taking of homomorphic images.

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaComment{--Closure wrt H}\<%
\\
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}(}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{hbase}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{hlift}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{hhimg}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{is-hom-image-of}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{hiso}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
\>[0]\<%
\end{code}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\paragraph{Subalgebra closure}\label{subalgebra-closure}

The most useful inductive type that we have found for representing
classes of algebras that are closed under the taking of subalgebras as
an inductive type.

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaComment{--Closure wrt S}\<%
\\
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}(}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{ssub}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{ssubw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{siso}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
\>[0]\<%
\end{code}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\paragraph{Product closure}\label{product-closure}

The most useful inductive type that we have found for representing
classes of algebras closed under arbitrary products is the following.

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{pbase}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{produ}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{prodw}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{pisou}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{pisow}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
\>[0]\<%
\end{code}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\paragraph{Varietal closure}\label{varietal-closure}

A class  of -algebras is called a \textbf{variety} if it is closed
under each of the closure operators H, S, and P introduced above; the
corresponding closure operator is often denoted , but we will typically
denote it by \texttt{V}.

Thus, if  is a class of -algebras, then the \textbf{variety generated
by}  is denoted by \texttt{V\ } and defined to be the smallest class
that contains  and is closed under \texttt{H}, \texttt{S}, and
\texttt{P}.

We now define \texttt{V} as an inductive type.

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}(}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{vbase}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{vlift}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{vliftw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{vhimg}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{is-hom-image-of}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{vssub}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{vprodu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{vprodw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{visou}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaInductiveConstructor{visow}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
\>[0]\<%
\end{code}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\paragraph{Closure properties}\label{closure-properties}

The types defined above represent operators with useful closure
properties. We now prove a handful of such properties since we will need
them later.

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaComment{-- P is a closure operator, in particular, it's expansive...}\<%
\\
\>[0]\AgdaFunction{P-expa}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[9]\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
\>[0]\AgdaFunction{P-expa}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisou}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-}\AgdaSpace{}%
\AgdaFunction{lift-alg-}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- ...and idempotent...}\<%
\\
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[10]\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{produ}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{P-idemp}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisou}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisou}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaComment{-- An idempotence variant that handles universes more generally (we need this later)}\<%
\\
%
\>[1]\AgdaFunction{P-idemp'}%
\>[825I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaComment{--\{ : Universe\}\{ : Universe\}\{ : Pred (Algebra  )(OV )\}}\<%
\\
\>[.][@{}l@{}]\<[825I]%
\>[10]\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{P-idemp'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[1]\AgdaFunction{P-idemp'}%
\>[11]\AgdaSymbol{(}\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{P-idemp'}%
\>[11]\AgdaSymbol{(}\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{P-idemp'}%
\>[11]\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{P-idemp'}%
\>[46]\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\>[1]\AgdaFunction{P-idemp'}%
\>[11]\AgdaSymbol{(}\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{P-idemp'}%
\>[46]\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\>[1]\AgdaFunction{P-idemp'}%
\>[11]\AgdaSymbol{(}\AgdaInductiveConstructor{pisou}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[1]\AgdaFunction{P-idemp'}%
\>[11]\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp'}%
\>[43]\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- S is a closure operator}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- In particular, it's monotone.}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[9]\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{'}%
\>[17]\AgdaSymbol{}%
\>[20]\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{'}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ante}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{BA}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{BA}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\<%
\end{code}

We sometimes want to go back and forth between our two representations
of subalgebras of algebras in a class. The tools \texttt{subalgebraS}
and \texttt{Ssubalgebra} are made for that purpose.

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaFunction{subalgebraS}%
\>[948I]\AgdaSymbol{:}%
\>[949I]\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\<%
\\
\>[.][@{}l@{}]\<[949I]%
\>[15]\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
\>[.][@{}l@{}]\<[948I]%
\>[13]\AgdaComment{----------------------------------------------------------}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[20]\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{subalgebraS}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{CB}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssub}\AgdaSpace{}%
\AgdaFunction{sA}\AgdaSpace{}%
\AgdaFunction{CA}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{CA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaFunction{CA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Iso-}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSpace{}%
\AgdaBound{CB}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{slAu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaFunction{slAu}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{KA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{sA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaFunction{sA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaFunction{slAu}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-}\AgdaSpace{}%
\AgdaFunction{lift-alg-}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{Ssubalgebra}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}%
\>[51]\AgdaSymbol{}%
\>[54]\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[1]\AgdaFunction{Ssubalgebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{refl-}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-}\AgdaSpace{}%
\AgdaFunction{lift-alg-}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{Ssubalgebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{KA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{TRANS-}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-}\AgdaSpace{}%
\AgdaFunction{lift-alg-}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{BSA}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{BS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[3]\AgdaFunction{BS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Ssubalgebra}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{SUBALGEBRA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{KA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[3]\AgdaFunction{KA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{BSA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{BSA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{Ssubalgebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{纬}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Ssubalgebra}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{SUBALGEBRA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{BSA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{BSA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{TRANS--}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{BAS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{BAS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{transitivity-}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{\}\{}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{BSA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[8]\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{BAS}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{refl-}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{Ssubalgebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{纬}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Ssubalgebra}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{SUBALGEBRA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{BSA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{BSA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{TRANS--}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{BAS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{BAS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{transitivity-}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{\}\{}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{BSA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[8]\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{BAS}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{refl-}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{Ssubalgebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{AB}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{纬}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Ssubalgebra}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{SUBALGEBRA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{ASA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{ASA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}%
\>[22]\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{TRANS-}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-}\AgdaSpace{}%
\AgdaBound{AB}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{ASA}\AgdaSymbol{)}\<%
\\
\>[0]\<%
\end{code}

Next we observe that lifting to a higher universe does not break the
property of being a subalgebra of an algebra of a class. In other words,
if we lift a subalgebra of an algebra in a class, the result is still a
subalgebra of an algebra in the class.

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[18]\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaComment{---------------------------------------------------}\<%
\\
%
\>[1]\AgdaSymbol{}%
\>[13]\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{CA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{pA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{BC}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{纬}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaFunction{lB}\AgdaSpace{}%
\AgdaFunction{lC}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaFunction{lB}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaFunction{lC}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lClA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lC}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{lA}\<%
\\
%
\>[2]\AgdaFunction{lClA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-lift--lift}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{CA}\<%
\\
%
\>[2]\AgdaFunction{plA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaFunction{plA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{pA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lB}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lC}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{lClA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{plA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-iso}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{BC}\AgdaSymbol{)}\<%
\\
\>[0]\<%
\end{code}

The next lemma would be too obvoius to care about were it not for the
fact that we'll need it later, so it too must be formalized.

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaFunction{SSP}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[7]\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SSP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaDottedPattern{\AgdaSymbol{.(}}\AgdaDottedPattern{\AgdaFunction{lift-alg}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaBound{}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaBound{}}\AgdaDottedPattern{\AgdaSymbol{)}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaFunction{spllA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-}\AgdaSpace{}%
\AgdaFunction{lift-alg-}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{llA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[3]\AgdaFunction{llA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{spllA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{llA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{spllA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{sbase}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SSP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaDottedPattern{\AgdaSymbol{.(}}\AgdaDottedPattern{\AgdaFunction{lift-alg}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaBound{}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaBound{}}\AgdaDottedPattern{\AgdaSymbol{)}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{subalgebraS}\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{lAsc}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SSP}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Asc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Asc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Ssubalgebra}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{splAu}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaFunction{Asc}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SSP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-sub-lift}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SSP}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Asc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Asc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Ssubalgebra}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{splAu}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaFunction{Asc}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subalgebraS}\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{lA}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{lAsc}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SSP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{纬}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SSP}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\>[2]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{spA}\AgdaSpace{}%
\AgdaBound{BA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SSP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{AB}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaFunction{lAB}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SSP}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Ssubalgebra}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{splAu}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subalgebraS}\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{lA}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{lAsc}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lAB}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaFunction{lAB}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Trans-}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-}\AgdaSpace{}%
\AgdaFunction{lift-alg-}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{AB}\<%
\\
\>[0]\<%
\end{code}

We need to formalize one more lemma before arriving the short term
objective of this section, which is the proof of the inclusion PSSP.

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaFunction{lemPSSP}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}\{}\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hfunext}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[10]\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\<%
\\
%
\>[1]\AgdaSymbol{}%
\>[10]\AgdaSymbol{((}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaComment{----------------------------------------------------}\<%
\\
%
\>[1]\AgdaSymbol{}%
\>[11]\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{lemPSSP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{hfe}\AgdaSymbol{\}\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{BK}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{猕}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{猕}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{猕SAも}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaArgument{I}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{P-expa}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{KA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{纬}\<%
\\
%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{BK}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{BK}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{KA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaFunction{KA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{BK}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{BSA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaBound{i}\<%
\\
%
\>[2]\AgdaFunction{BSA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{BK}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[2]\AgdaFunction{pA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaFunction{pA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{KA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{SAゐ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOf}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{SAゐ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{BK}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[2]\AgdaFunction{h}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SAゐ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{猕SAも}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaFunction{}\<%
\\
%
\>[2]\AgdaFunction{猕SAも}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{i}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{ii}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{iii}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaKeyword{where}\<%
\\
\>[3][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[4]\AgdaFunction{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{h}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{ii}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{is-embedding}\AgdaSpace{}%
\AgdaFunction{i}\<%
\\
%
\>[4]\AgdaFunction{ii}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{embedding-lift}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaFunction{SA}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaFunction{h}\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SAゐ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{iii}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{is-homomorphism}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{猕}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{猕}\AgdaSpace{}%
\AgdaFunction{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{i}\<%
\\
%
\>[4]\AgdaFunction{iii}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{SAゐ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaFunction{SA}\<%
\\
%
\>[2]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaFunction{BSA}\<%
\\
\>[0]\<%
\end{code}

\paragraph{PS()  SP()}\label{psux1d4a6-spux1d4a6}

Finally, we are in a position to prove that a product of subalgebras of
algebras in a class  is a subalgebra of a product of algebras in .

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{u}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hfunext}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\<%
\\
%
\>[1]\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{))}\<%
\\
%
\>[1]\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaFunction{splA}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{splA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{splA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SSP}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaBound{u}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaFunction{纬}\AgdaSpace{}%
\AgdaFunction{refl-}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaFunction{lB}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{lB}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{味}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lB}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{lA}\<%
\\
%
\>[3]\AgdaFunction{味}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-lift--lift}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{BA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SSP}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaBound{u}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaFunction{spA}\AgdaSpace{}%
\AgdaFunction{味}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaFunction{splA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaFunction{lB}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{lB}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{splA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{splA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SSP}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{AB}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaFunction{splA}\AgdaSpace{}%
\AgdaFunction{味}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaFunction{lB}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{lB}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{味}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{lB}\<%
\\
%
\>[3]\AgdaFunction{味}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-iso}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{AB}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{splA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{splA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SSP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{纬}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{uw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\<%
\\
%
\>[3]\AgdaFunction{uw}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{尉}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{尉}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Ssubalgebra}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{畏'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{畏'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lemPSSP}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{uw}\AgdaSymbol{)\}\{}\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)\}\{}\AgdaBound{hfe}\AgdaSymbol{\}\{}\AgdaArgument{I}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{尉}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{畏}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{畏}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subalgebraS}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{uw}\AgdaSymbol{)\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{))\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{畏'}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{uw}\AgdaSymbol{)\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{))\}\{}\AgdaArgument{'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp'}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{畏}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prodw}\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{纬}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{uw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\<%
\\
%
\>[3]\AgdaFunction{uw}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{尉}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{尉}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Ssubalgebra}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{畏'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{畏'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lemPSSP}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{uw}\AgdaSymbol{)\}\{}\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)\}\{}\AgdaBound{hfe}\AgdaSymbol{\}\{}\AgdaArgument{I}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{尉}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{畏}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{畏}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subalgebraS}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{uw}\AgdaSymbol{)\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{))\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{畏'}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{uw}\AgdaSymbol{)\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{uw}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{))\}\{}\AgdaArgument{'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{uw}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp'}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{畏}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisou}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{pA}\AgdaSpace{}%
\AgdaBound{AB}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{spA}\AgdaSpace{}%
\AgdaBound{AB}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaBound{pA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{pA}\AgdaSpace{}%
\AgdaBound{AB}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{spA}\AgdaSpace{}%
\AgdaBound{AB}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{PSSP}\AgdaSpace{}%
\AgdaBound{pA}\<%
\\
\>[0]\<%
\end{code}

\paragraph{More class inclusions}\label{more-class-inclusions}

We conclude this module with three more inclusion relations that will
have bit parts to play in our formal proof of Birkhoff's Theorem.

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaFunction{PV}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[6]\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
\>[0]\AgdaFunction{PV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vbase}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{PV}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vlift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PV}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{PV}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PV}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{PV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vprodu}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{PV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{PV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vprodw}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{PV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{PV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisou}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visou}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PV}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{PV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PV}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SV}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[6]\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
\>[0]\AgdaFunction{SV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vbase}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{SV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vlift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SV}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{SV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vssub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SV}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{SV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SV}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{SV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visou}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SV}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SPV}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[6]\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
\>[0]\AgdaFunction{SPV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{PCloA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{PV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaBound{PCloA}\AgdaSpace{}%
\AgdaFunction{lift-alg-}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{SPV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPV}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{SPV}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPV}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{BA}\<%
\\
\>[0]\AgdaFunction{SPV}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSpace{}%
\AgdaBound{BA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPV}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{BA}\<%
\\
\>[0]\AgdaFunction{SPV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPV}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\<%
\end{code}

\paragraph{Products of classes}\label{products-of-classes}

Above we proved PS()  SP(). It is slightly more painful to prove that
the product of \emph{all} algebras in the class S() is a member of
SP(). That is,

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{猕 S}\OtherTok{(}\NormalTok{}\OtherTok{)}\NormalTok{  SP}\OtherTok{(}\NormalTok{}\OtherTok{)}
\end{Highlighting}
\end{Shaded}

This is mainly due to the fact that it's not obvious (at least not to
this author-coder) what should be the type of the product of all members
of a class of algebras. After a few false starts, eventually the right
type revealed itself. Of course, now that we have it in our hands, it
seems rather obvious.

We now describe the this type of product of all algebras in an arbitrary
class  of algebras of the same signature.

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{class-product}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaComment{--  serves as the index of the product}\<%
\\
%
\>[1]\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}%
\>[23]\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[1]\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{危}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaComment{--  produces an algebra for each index (i : ).}\<%
\\
%
\>[1]\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[1]\AgdaFunction{}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaComment{-- The product of all members of  can be written simply as follows:}\<%
\\
%
\>[1]\AgdaFunction{class-product}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[1]\AgdaFunction{class-product}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaComment{-- ...or, more explicitly, here is the expansion of this indexed product.}\<%
\\
%
\>[1]\AgdaFunction{class-product'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[1]\AgdaFunction{class-product'}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{危}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
\>[0]\<%
\end{code}

Notice that, if \texttt{p\ :\ \ \ }, then we can think of the pair
\texttt{(\ ,\ p)\ \ \ } as an index over the class, and so we can
think of \texttt{\ (\ ,\ p)} (which is obviously \texttt{}) as the
projection of the product \texttt{猕\ (\ \{\}\{\}\ )} onto the
\texttt{(\ ,\ p)}-th component.

\paragraph{猕 S()  SP()}\label{sux1d4a6-spux1d4a6}

Finally, we prove the result that plays a leading role in the formal
proof of Birkhoff's Theorem---namely, that our newly defined class
product 猕 ( \{\}\{\} ) belongs to SP().

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaComment{-- The product of all subalgebras of a class  belongs to SP().}\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{class-product-inclusions}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{class-product}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{class-prod-s--ps}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{class-product}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{class-prod-s--ps}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisou}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaFunction{ps猕llA}\AgdaSpace{}%
\AgdaFunction{猕llAcpK}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[3]\AgdaFunction{I}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{sA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{sA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaFunction{llA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{I}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[11]\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{llA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{slA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{slA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{lift-alg-}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{psllA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{llA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{psllA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pbase}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{slA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{ps猕llA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaFunction{llA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{ps猕llA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{produ}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaFunction{psllA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{llAA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{llA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{llAA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Trans-}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{llA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-}\AgdaSpace{}%
\AgdaFunction{lift-alg-}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-}\AgdaSpace{}%
\AgdaFunction{lift-alg-}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{猕llAcpK}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaFunction{llA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{class-product}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{猕llAcpK}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaFunction{llAA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaComment{-- So, since PSSP, we see that that the product of all subalgebras of a class  belongs to SP().}\<%
\\
%
\>[1]\AgdaFunction{class-prod-s--sp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hfunext}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{}%
\>[21]\AgdaFunction{class-product}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{class-prod-s--sp}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{PSSP}\AgdaSymbol{\{}\AgdaArgument{hfe}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{class-prod-s--ps}\AgdaSymbol{)}\<%
\\
\>[0]\<%
\end{code}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\href{UALib.Varieties.EquationalLogic.html}{
UALib.Varieties.EquationalLogic}
{\href{UALib.Varieties.Preservation.html}{UALib.Varieties.Preservation
}}

\{\% include UALib.Links.md \%\}
