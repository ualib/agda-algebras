Fix a signature \ab ğ‘†, let \ab ğ’¦ be a class of \ab ğ‘†-algebras, and define
\begin{itemize}
\item \ad H \ab ğ’¦ \as = algebras isomorphic to a homomorphic image of a members of \ab ğ’¦;
\item \ad S \ab ğ’¦ \as = algebras isomorphic to a subalgebra of a member of \ab ğ’¦;
\item \ad P \ab ğ’¦ \as = algebras isomorphic to a product of members of \ab ğ’¦.
\end{itemize}
A straight-forward verification confirms that \ad H, \ad S, and \ad P are \textbf{closure operators} (expansive, monotone, and idempotent). A class \ab ğ’¦ of \ab ğ‘†-algebras is said to be \emph{closed under the taking of homomorphic images} provided \ad H \ab ğ’¦ \aof âŠ† \ab ğ’¦. Similarly, \ab ğ’¦ is \emph{closed under the taking of subalgebras} (resp., \emph{arbitrary products}) provided \ad S \ab ğ’¦ \aof âŠ† \ab ğ’¦ (resp., \ad P \ab ğ’¦ \aof âŠ†\ ğ’¦).

An algebra is a homomorphic image (resp., subalgebra; resp., product) of every algebra to which it is isomorphic. Thus, the class \ad H \ab ğ’¦ (resp., \ad S \ab ğ’¦; resp., \ad P \ab ğ’¦) is closed under isomorphism.

The operators \ad H, \ad S, and \ad P can be composed with one another repeatedly, forming yet more closure operators.

A \textbf{variety} is a class \ab ğ’¦ of algebras in a fixed signature that is closed under the taking of homomorphic images (\ad H), subalgebras (\ad S), and arbitrary products (\ad P). That is, \ab ğ’¦ is a variety if and only if \ad H \ad S \ad P \ab ğ’¦ \aof âŠ† \ab ğ’¦.

This module defines what we have found to be the most useful inductive types representing the closure operators \ad H, \ad S, and \ad P. Separately, we define the inductive type \ab{V} for simultaneously representing closure under \ad H, \ad S, and \ad P.
\ccpad
\begin{code}%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--without-K}\AgdaSpace{}%
\AgdaPragma{--exact-split}\AgdaSpace{}%
\AgdaPragma{--safe}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{UALib.Algebras}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Signature}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaGeneralizable{ğ“}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaGeneralizable{ğ“¥}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}â† \AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{UALib.Prelude.Preliminaries}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{global-dfunext}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}Ì‡}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{UALib.Varieties.Varieties}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{\{}\AgdaBound{ğ‘†}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Signature}\AgdaSpace{}%
\AgdaGeneralizable{ğ“}\AgdaSpace{}%
\AgdaGeneralizable{ğ“¥}\AgdaSymbol{\}\{}\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{global-dfunext}\AgdaSymbol{\}}\<%
\\
%
\>[1]\AgdaSymbol{\{}\AgdaBound{ğ•}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“§}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ“§}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaSymbol{\}(}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â† }}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\<%
\\
%
\>[1]\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{UALib.Varieties.EquationalLogic}\AgdaSymbol{\{}\AgdaArgument{ğ‘†}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}\{}\AgdaBound{gfe}\AgdaSymbol{\}\{}\AgdaBound{ğ•}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\end{code}

\subsubsection{Homomorphism closure}\label{homomorphism-closure}
We define the inductive type \ad H to represent classes of algebras that include all homomorphic images of algebras in the class; i.e., classes that are closed under the taking of homomorphic images.
\ccpad
\begin{code}%
\>[0]\AgdaComment{--Closure wrt H}\<%
\\
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}(}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{hbase}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{hlift}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{hhimg}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{is-hom-image-of}}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{hiso}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\end{code}

\subsubsection{Subalgebra closure}\label{subalgebra-closure}
The most useful inductive type that we have found for representing classes of algebras that are closed under the taking of subalgebras as an inductive type.
\ccpad
\begin{code}%
\>[0]\AgdaComment{--Closure wrt S}\<%
\\
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}(}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{ssub}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{ssubw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{siso}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\end{code}

\subsubsection{Product closure}\label{product-closure}
The most useful inductive type that we have found for representing classes of algebras closed under arbitrary products is the following.
\ccpad
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{pbase}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{produ}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaSymbol{\}\{}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{prodw}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaSymbol{\}\{}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{pisou}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{pisow}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\end{code}

\subsubsection{Varietal closure}\label{varietal-closure}
A class \ab ğ’¦ of \ab ğ‘†-algebras is called a \textbf{variety} if it is closed under each of the closure operators \ad H, \ad S, and \ad P introduced above; the corresponding closure operator is often denoted ğ•, but we will typically denote it by \ad V.

Thus, if \ab ğ’¦ is a class of \ab ğ‘†-algebras, then the \textbf{variety generated by} \ab ğ’¦ is denoted by \ad V \ab ğ’¦ and defined to be the smallest class that contains \ab ğ’¦ and is closed under \ad H, \ad S, and \ad P.

We now define \ad V as an inductive type.
\ccpad
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}(}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{vbase}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{vlift}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{vliftw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{vhimg}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{is-hom-image-of}}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{vssub}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{vprodu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSymbol{\}\{}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{vprodw}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSymbol{\}\{}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{visou}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaInductiveConstructor{visow}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\end{code}

\subsubsection{Closure properties}\label{closure-properties}
The types defined above represent operators with useful closure properties. We now prove a handful of such properties since we will need them later.
\ccpad
\begin{code}%
\>[0]\AgdaComment{-- P is a closure operator, in particular, it's expansive...}\<%
\\
\>[0]\AgdaFunction{P-expa}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{â†’}%
\>[9]\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
\>[0]\AgdaFunction{P-expa}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisou}\AgdaSymbol{\{}\AgdaArgument{ğ‘¨}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}\{}\AgdaArgument{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-â‰…}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- ...and idempotent...}\<%
\\
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{â†’}%
\>[10]\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{produ}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{P-idemp}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisou}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisou}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\\
\>[0]\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaComment{-- An idempotence variant that handles universes more generally (we need this later)}\<%
\\
%
\>[1]\AgdaFunction{P-idemp'}%
\>[825I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaComment{--\{ğ“¤ : Universe\}\{ğ“¦ : Universe\}\{ğ’¦ : Pred (Algebra ğ“¤ ğ‘†)(OV ğ“¤)\}}\<%
\\
\>[.][@{}l@{}]\<[825I]%
\>[10]\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{P-idemp'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[1]\AgdaFunction{P-idemp'}%
\>[11]\AgdaSymbol{(}\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{P-idemp'}%
\>[11]\AgdaSymbol{(}\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{P-idemp'}%
\>[11]\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{P-idemp'}%
\>[46]\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\>[1]\AgdaFunction{P-idemp'}%
\>[11]\AgdaSymbol{(}\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{P-idemp'}%
\>[46]\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\>[1]\AgdaFunction{P-idemp'}%
\>[11]\AgdaSymbol{(}\AgdaInductiveConstructor{pisou}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\\
%
\>[1]\AgdaFunction{P-idemp'}%
\>[11]\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp'}%
\>[43]\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- S is a closure operator}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- In particular, it's monotone.}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaBound{ğ’¦'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{â†’}%
\>[9]\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaBound{ğ’¦'}%
\>[17]\AgdaSymbol{â†’}%
\>[20]\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦'}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ante}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\<%
\\
\>[0]\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSpace{}%
\AgdaBound{ante}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\end{code}
\ccpad
We sometimes want to go back and forth between our two representations of subalgebras of algebras in a class. The tools \af{subalgebraâ†’S} and \af{Sâ†’subalgebra} are designed for that purpose.
\ccpad
\begin{code}%
\>[0]\AgdaFunction{subalgebraâ†’S}%
\>[948I]\AgdaSymbol{:}%
\>[949I]\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\<%
\\
\>[.][@{}l@{}]\<[949I]%
\>[15]\AgdaSymbol{\{}\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
\>[.][@{}l@{}]\<[948I]%
\>[13]\AgdaComment{----------------------------------------------------------}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{â†’}%
\>[20]\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{subalgebraâ†’S}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaBound{ğ‘ª}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Câ‰…B}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssub}\AgdaSpace{}%
\AgdaFunction{sA}\AgdaSpace{}%
\AgdaFunction{Câ‰¤A}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{Câ‰¤A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\<%
\\
%
\>[2]\AgdaFunction{Câ‰¤A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Iso-â‰¤}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSpace{}%
\AgdaBound{Câ‰…B}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{slAu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaFunction{slAu}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{KA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{sA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaFunction{sA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaFunction{slAu}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-â‰…}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}%
\>[51]\AgdaSymbol{â†’}%
\>[54]\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{refl-â‰¤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-â‰…}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{KA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{TRANS-â‰…}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-â‰…}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{Bâ‰…SA}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{BS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{BS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{SUBALGEBRA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{KA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{KA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Bâ‰…SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰…SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{BS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Î³}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{SUBALGEBRA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{TRANS-â‰¤-â‰…}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤AS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤AS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{transitivity-â‰¤}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSymbol{\}\{}\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{Bâ‰¤SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[8]\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{Bâ‰¤AS}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{refl-â‰…}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Î³}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{SUBALGEBRA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{TRANS-â‰¤-â‰…}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤AS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{Bâ‰¤AS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{transitivity-â‰¤}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSymbol{\}\{}\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{Bâ‰¤SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[8]\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{Bâ‰¤AS}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{refl-â‰…}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Î³}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{AS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{SUBALGEBRA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\>[3]\AgdaFunction{Aâ‰…SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{Aâ‰…SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}%
\>[22]\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{AS}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{TRANS-â‰…}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-â‰…}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{Aâ‰…SA}\AgdaSymbol{)}\<%
\end{code}
\ccpad
Next we observe that lifting to a higher universe does not break the property of being a subalgebra of an algebra of a class. In other words, if we lift a subalgebra of an algebra in a class, the result is still a subalgebra of an algebra in the class.
\ccpad
\begin{code}%
\>[0]\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}\{}\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{â†’}%
\>[18]\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaComment{---------------------------------------------------}\<%
\\
%
\>[1]\AgdaSymbol{â†’}%
\>[13]\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Câ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{pA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Bâ‰…C}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Î³}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaFunction{lB}\AgdaSpace{}%
\AgdaFunction{lC}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\<%
\\
%
\>[2]\AgdaFunction{lB}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaBound{ğ“¦}\<%
\\
%
\>[2]\AgdaFunction{lC}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaBound{ğ“¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lCâ‰¤lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lC}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaFunction{lA}\<%
\\
%
\>[2]\AgdaFunction{lCâ‰¤lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-lift-â‰¤-lift}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Câ‰¤A}\<%
\\
%
\>[2]\AgdaFunction{plA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaFunction{plA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{pA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lB}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lC}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{lCâ‰¤lA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{plA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-iso}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaBound{Bâ‰…C}\AgdaSymbol{)}\<%
\end{code}
\ccpad
The next lemma would be too obvoius to care about were it not for the fact that we'll need it later, so it too must be formalized.
\ccpad
\begin{code}%
\>[0]\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{â†’}%
\>[7]\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaDottedPattern{\AgdaSymbol{.(}}\AgdaDottedPattern{\AgdaFunction{lift-alg}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaBound{ğ‘¨}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaBound{ğ“¦}}\AgdaDottedPattern{\AgdaSymbol{)}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaFunction{spllA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-â‰…}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{llA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[3]\AgdaFunction{llA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{spllA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{llA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{spllA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{sbase}\AgdaSymbol{\{}\AgdaArgument{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)\}\{}\AgdaArgument{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaDottedPattern{\AgdaSymbol{.(}}\AgdaDottedPattern{\AgdaFunction{lift-alg}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaBound{ğ‘¨}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaBound{ğ“¦}}\AgdaDottedPattern{\AgdaSymbol{)}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{subalgebraâ†’S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{lAsc}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SâŠ†SP}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Asc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Asc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{splAu}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaFunction{Asc}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-sub-lift}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SâŠ†SP}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Asc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Asc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{splAu}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaFunction{Asc}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subalgebraâ†’S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaFunction{lA}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{lAsc}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Î³}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\>[2]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{spA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaFunction{lAâ‰…B}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ“¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{splAu}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SâŠ†SP}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{lAsc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-subP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Sâ†’subalgebra}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{splAu}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{lAsp}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subalgebraâ†’S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaFunction{lA}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{lAsc}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lAâ‰…B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaBound{ğ‘©}\<%
\\
%
\>[2]\AgdaFunction{lAâ‰…B}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Trans-â‰…}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-â‰…}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\<%
\end{code}
\ccpad
We need to formalize one more lemma before arriving the short term objective of this section, which is the proof of the inclusion PSâŠ†SP.
\ccpad
\begin{code}%
\>[0]\AgdaFunction{lemPSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}\{}\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hfunext}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{â†’}%
\>[10]\AgdaSymbol{\{}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSymbol{\}\{}\AgdaBound{â„¬}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{\}}\<%
\\
%
\>[1]\AgdaSymbol{â†’}%
\>[10]\AgdaSymbol{((}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{â„¬}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaComment{----------------------------------------------------}\<%
\\
%
\>[1]\AgdaSymbol{â†’}%
\>[11]\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{â„¬}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{lemPSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}\{}\AgdaBound{hfe}\AgdaSymbol{\}\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{â„¬}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤K}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{â¨…SAâ‰¤â¨…ğ’œ}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaArgument{I}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaArgument{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ğ’œ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{P-expa}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{KA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{Î³}\<%
\\
%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[2]\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤K}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[2]\AgdaFunction{SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤K}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{KA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaFunction{KA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤K}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Bâ‰…SA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{â„¬}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaBound{i}\<%
\\
%
\>[2]\AgdaFunction{Bâ‰…SA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤K}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\>[2]\AgdaFunction{pA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[2]\AgdaFunction{pA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{KA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{SAâ‰¤ğ’œ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOf}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{SAâ‰¤ğ’œ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤K}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[2]\AgdaFunction{h}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{SAâ‰¤ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{â¨…SAâ‰¤â¨…ğ’œ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{ğ’œ}\<%
\\
%
\>[2]\AgdaFunction{â¨…SAâ‰¤â¨…ğ’œ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{i}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{ii}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{iii}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaKeyword{where}\<%
\\
\>[3][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[4]\AgdaFunction{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{h}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{ii}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{is-embedding}\AgdaSpace{}%
\AgdaFunction{i}\<%
\\
%
\>[4]\AgdaFunction{ii}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{embedding-lift}\AgdaSymbol{\{}\AgdaArgument{ğ“ }\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaArgument{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaArgument{ğ“˜}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaFunction{SA}\AgdaSymbol{\}\{}\AgdaFunction{ğ’œ}\AgdaSymbol{\}}\AgdaFunction{h}\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{SAâ‰¤ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{iii}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{is-homomorphism}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{SA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{ğ’œ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{i}\<%
\\
%
\>[4]\AgdaFunction{iii}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{ğ‘“}\AgdaSpace{}%
\AgdaBound{ğ’‚}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{snd}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{SAâ‰¤ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘“}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ’‚}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{â„¬}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{SA}\<%
\\
%
\>[2]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â¨…â‰…}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaFunction{Bâ‰…SA}\<%
\end{code}

\subsubsection{PS(ğ’¦) âŠ† SP(ğ’¦)}\label{psux1d4a6-spux1d4a6}
Finally, we are in a position to prove that a product of subalgebras of algebras in a class \ab ğ’¦ is a subalgebra of a product of algebras in \ab ğ’¦.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ccpad
\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦u}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hfunext}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{ğ“¾}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\<%
\\
%
\>[1]\AgdaFunction{ğ“¾}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{))}\<%
\\
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaFunction{splA}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{splA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{splA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SâŠ†SP}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦u}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaFunction{refl-â‰…}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaFunction{lB}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\<%
\\
%
\>[3]\AgdaFunction{lB}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Î¶}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lB}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰¤}}\AgdaSpace{}%
\AgdaFunction{lA}\<%
\\
%
\>[3]\AgdaFunction{Î¶}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-lift-â‰¤-lift}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SâŠ†SP}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦u}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaArgument{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{spA}\AgdaSpace{}%
\AgdaFunction{Î¶}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaArgument{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{splA}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg-â‰¤}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaFunction{lB}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\<%
\\
%
\>[3]\AgdaFunction{lB}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{splA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{splA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaFunction{splA}\AgdaSpace{}%
\AgdaFunction{Î¶}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaFunction{lB}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\<%
\\
%
\>[3]\AgdaFunction{lB}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Î¶}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaFunction{lB}\<%
\\
%
\>[3]\AgdaFunction{Î¶}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-iso}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaBound{ğ‘©}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{splA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{splA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{ğ’œ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Î³}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{Î¾}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Î¾}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSymbol{\{}\AgdaArgument{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Î·'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{Î·'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lemPSâŠ†SP}\AgdaSymbol{\{}\AgdaArgument{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ“¾}\AgdaSymbol{)\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaArgument{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)\}\{}\AgdaBound{hfe}\AgdaSymbol{\}\{}\AgdaArgument{I}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaArgument{â„¬}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{Î¾}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Î·}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{Î·}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subalgebraâ†’S}\AgdaSymbol{\{}\AgdaArgument{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ“¾}\AgdaSymbol{)\}\{}\AgdaArgument{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaArgument{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{))\}\{}\AgdaArgument{ğ‘ª}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{Î·'}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSymbol{\{}\AgdaArgument{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ“¾}\AgdaSymbol{)\}\{}\AgdaArgument{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{))\}\{}\AgdaArgument{ğ’¦'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp'}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{Î·}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prodw}\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{ğ’œ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Î³}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{Î¾}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Î¾}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Sâ†’subalgebra}\AgdaSymbol{\{}\AgdaArgument{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Î·'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{IsSubalgebraOfClass}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{Î·'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lemPSâŠ†SP}\AgdaSymbol{\{}\AgdaArgument{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ“¾}\AgdaSymbol{)\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaArgument{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)\}\{}\AgdaBound{hfe}\AgdaSymbol{\}\{}\AgdaArgument{I}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaArgument{â„¬}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{Î¾}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Î·}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{Î·}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subalgebraâ†’S}\AgdaSymbol{\{}\AgdaArgument{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ“¾}\AgdaSymbol{)\}\{}\AgdaArgument{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaArgument{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{))\}\{}\AgdaArgument{ğ‘ª}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{Î·'}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaBound{ğ’œ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S-mono}\AgdaSymbol{\{}\AgdaArgument{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ“¾}\AgdaSymbol{)\}\{}\AgdaArgument{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{))\}\{}\AgdaArgument{ğ’¦'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-idemp'}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{Î·}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisou}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{pA}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{\}\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{spA}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{pA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{pA}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{\}\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{spA}\AgdaSpace{}%
\AgdaBound{Aâ‰…B}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ğ“¾}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦u}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{spA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{PSâŠ†SP}\AgdaSpace{}%
\AgdaBound{pA}\<%
\end{code}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{More class inclusions}\label{more-class-inclusions}
We conclude this module with three more inclusion relations that will have bit parts to play in our formal proof of Birkhoff's Theorem.
\ccpad
\begin{code}%
\>[0]\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{â†’}%
\>[6]\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
\>[0]\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vbase}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{PâŠ†V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vlift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PâŠ†V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{PâŠ†V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PâŠ†V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vprodu}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prodw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vprodw}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisou}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visou}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\\
\>[0]\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SâŠ†V}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{â†’}%
\>[6]\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
\>[0]\AgdaFunction{SâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vbase}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{SâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vlift}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SâŠ†V}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{SâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vssub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SâŠ†V}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\\
\>[0]\AgdaFunction{SâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SâŠ†V}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\\
\>[0]\AgdaFunction{SâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visou}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SâŠ†V}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{â†’}%
\>[6]\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ”}}\AgdaSpace{}%
\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
\>[0]\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{PCloA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{PâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSpace{}%
\AgdaBound{PCloA}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vliftw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{SPâŠ†V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\<%
\\
\>[0]\AgdaFunction{SPâŠ†V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}\{}\AgdaBound{ğ‘©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaBound{spA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Bâ‰¤A}\<%
\\
\>[0]\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{xâ‚}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{visow}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{SPâŠ†V}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xâ‚}\<%
\end{code}

\subsubsection{Products of classes}\label{products-of-classes}
Above we proved \ad{PS}(\ab ğ’¦) \aof âŠ† \ad{SP}(\ab ğ’¦). It is slightly more painful to prove that the product of \emph{all} algebras in the class \ad S(\ab ğ’¦) is a member of \ad{SP}(\ab ğ’¦). That is,\\
\\
\aof â¨… \ad S (\ab ğ’¦) \aof âˆˆ \ad{SP} (\ab ğ’¦ )\\
\\
This is mainly due to the fact that it's not obvious (at least not to this author-coder) what should be the type of the product of all members of a class of algebras. After a few false starts, eventually the right type revealed itself. Of course, now that we have it in our hands, it seems rather obvious.

We now describe the this type of product of all algebras in an arbitrary class \ab ğ’¦ of algebras of the same signature.
\ccpad
\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{class-product}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaComment{-- â„‘ serves as the index of the product}\<%
\\
%
\>[1]\AgdaFunction{â„‘}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}%
\>[23]\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\<%
\\
%
\>[1]\AgdaFunction{â„‘}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Î£}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaFunction{ê‰}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaComment{-- ğ”„ produces an algebra for each index (i : â„‘).}\<%
\\
%
\>[1]\AgdaFunction{ğ”„}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{â„‘}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[1]\AgdaFunction{ğ”„}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{â„‘}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaComment{-- The product of all members of ğ’¦ can be written simply as follows:}\<%
\\
%
\>[1]\AgdaFunction{class-product}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[1]\AgdaFunction{class-product}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{ğ”„}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ’¦}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaComment{-- ...or, more explicitly, here is the expansion of this indexed product.}\<%
\\
%
\>[1]\AgdaFunction{class-product'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[1]\AgdaFunction{class-product'}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Î£}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaFunction{ê‰}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\AgdaSpace{}%
\AgdaBound{ğ‘¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\end{code}
\ccpad
Notice that, if \ab{p\ :\ ğ‘¨\ âˆˆ\ ğ’¦}, then we can think of the pair \ab{(ğ‘¨\ ,\ p)\ âˆˆ\ â„‘\ ğ’¦} as an index over the class, and so we can think of \ab{ğ”„\ (ğ‘¨\ ,\ p)} (which is obviously \ab{ğ‘¨}) as the projection of the product \ab{â¨…\ (\ ğ”„\{ğ“¤\}\{ğ’¦\}\ )} onto the \ab{(ğ‘¨\ ,\ p)}-th component.

\subsubsection{â¨… S(ğ’¦) âˆˆ SP(ğ’¦)}\label{sux1d4a6-spux1d4a6}
Finally, we prove the result that plays a leading role in the formal proof of Birkhoff's Theorem---namely, that our newly defined class product \aof â¨… (\ab ğ”„\as{\{}\ab ğ“¤\as{\}}\as{\{}\ab ğ’¦\as {\}} ) belongs to \ad{SP}(\ab ğ’¦).
\ccpad
\begin{code}%
\>[0]\AgdaComment{-- The product of all subalgebras of a class ğ’¦ belongs to SP(ğ’¦).}\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{class-product-inclusions}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{class-product}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaArgument{ğ’¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{class-prod-s-âˆˆ-ps}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{class-product}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{class-prod-s-âˆˆ-ps}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pisou}\AgdaSymbol{\{}\AgdaArgument{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}\{}\AgdaArgument{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaFunction{psâ¨…llA}\AgdaSpace{}%
\AgdaFunction{â¨…llAâ‰…cpK}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\<%
\\
%
\>[3]\AgdaFunction{I}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â„‘}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{sA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ”„}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{sA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaFunction{llA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{I}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[3]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[11]\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ”„}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{llA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{slA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{slA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{siso}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{psllA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{llA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{psllA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pbase}\AgdaSymbol{\{}\AgdaArgument{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}\{}\AgdaArgument{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{slA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{psâ¨…llA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{llA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{psâ¨…llA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{produ}\AgdaSymbol{\{}\AgdaArgument{ğ“¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}\{}\AgdaArgument{ğ“¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaFunction{psllA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{llAâ‰…A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{llA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ”„}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{llAâ‰…A}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Trans-â‰…}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{llA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ”„}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-â‰…}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym-â‰…}\AgdaSpace{}%
\AgdaFunction{lift-alg-â‰…}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{â¨…llAâ‰…cpK}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{llA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰…}}\AgdaSpace{}%
\AgdaFunction{class-product}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{â¨…llAâ‰…cpK}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â¨…â‰…}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaFunction{llAâ‰…A}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaComment{-- So, since PSâŠ†SP, we see that that the product of all subalgebras of a class ğ’¦ belongs to SP(ğ’¦).}\<%
\\
%
\>[1]\AgdaFunction{class-prod-s-âˆˆ-sp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hfunext}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{â†’}%
\>[21]\AgdaFunction{class-product}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{class-prod-s-âˆˆ-sp}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{PSâŠ†SP}\AgdaSymbol{\{}\AgdaArgument{hfe}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{hfe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{class-prod-s-âˆˆ-ps}\AgdaSymbol{)}\<%
\end{code}
