In this module we show that identities are preserved by closure operators \ad H, \ad S, and \ad P. This will establish the easy direction of Birkhoff's HSP Theorem.
\ccpad
\begin{code}%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{UALib.Algebras}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Signature}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaGeneralizable{ùìû}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaGeneralizable{ùì•}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}‚Ü†\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{UALib.Prelude.Preliminaries}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{global-dfunext}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}Ãá}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{UALib.Varieties.Preservation}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{\{}\AgdaBound{ùëÜ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Signature}\AgdaSpace{}%
\AgdaGeneralizable{ùìû}\AgdaSpace{}%
\AgdaGeneralizable{ùì•}\AgdaSymbol{\}\{}\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{global-dfunext}\AgdaSymbol{\}}\<%
\\
%
\>[1]\AgdaSymbol{\{}\AgdaBound{ùïè}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaSymbol{\}(}\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùëÜ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚Ü†}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSymbol{\}}\<%
\\
%
\>[1]\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{UALib.Varieties.Varieties}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{ùëÜ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ùëÜ}\AgdaSymbol{\}\{}\AgdaBound{gfe}\AgdaSymbol{\}\{}\AgdaBound{ùïè}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\end{code}

\subsubsection{H preserves identities}\label{h-preserves-identities}

\begin{code}%
\>[0]\AgdaComment{--H preserves identities}\<%
\\
\>[0]\AgdaFunction{H-id1}%
\>[49I]\AgdaSymbol{:}%
\>[50I]\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[50I]%
\>[8]\AgdaSymbol{\{}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùëÜ}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSymbol{)\}}\<%
\\
%
\>[8]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSymbol{\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\})}\<%
\\
\>[49I][@{}l@{\AgdaIndent{0}}]%
\>[7]\AgdaComment{----------------------------------------}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{‚Üí}%
\>[8]\AgdaSymbol{(}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì§}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{H-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{hbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-‚äß}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{H-id1}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{hlift}\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{Œ≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{H-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-‚äß}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaFunction{Œ≤}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{H-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{hhimg}\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}\{}\AgdaBound{ùë™}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{HA}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œïhom}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œïsur}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{B‚âÖC}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚äß-‚âÖ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaBound{B‚âÖC}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{Œ≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{H-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{HA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{preim}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚à£}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚à£}}\<%
\\
%
\>[2]\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Inv}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œïsur}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Œ∂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{ùíÉ}\<%
\\
%
\>[2]\AgdaFunction{Œ∂}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{InvIsInv}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œïsur}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ùíÉ}%
\>[27]\AgdaOperator{\AgdaFunction{‚â°‚ü®}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Œ∂}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{))}\AgdaOperator{\AgdaFunction{‚Åª¬π}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü©}}\<%
\\
%
\>[3]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚â°‚ü®}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{comm-hom-term}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œïhom}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{))}\AgdaOperator{\AgdaFunction{‚Åª¬π}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü©}}\<%
\\
%
\>[3]\AgdaBound{œï}\AgdaSymbol{((}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSymbol{)(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{))}%
\>[27]\AgdaOperator{\AgdaFunction{‚â°‚ü®}}\AgdaSpace{}%
\AgdaFunction{ap}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{intensionality}\AgdaSpace{}%
\AgdaFunction{Œ≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü©}}\<%
\\
%
\>[3]\AgdaBound{œï}\AgdaSymbol{((}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSymbol{)(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{))}%
\>[27]\AgdaOperator{\AgdaFunction{‚â°‚ü®}}\AgdaSpace{}%
\AgdaFunction{comm-hom-term}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œïhom}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü©}}\<%
\\
%
\>[3]\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{))}%
\>[27]\AgdaOperator{\AgdaFunction{‚â°‚ü®}}\AgdaSpace{}%
\AgdaFunction{ap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Œ∂}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü©}}\<%
\\
%
\>[3]\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ùíÉ}%
\>[27]\AgdaOperator{\AgdaFunction{‚àé}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{H-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{hiso}\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚äß-transport}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{H-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x‚ÇÅ}\<%
\end{code}
\ccpad
The converse is almost too obvious to bother with. Nonetheless, we formalize it for completeness.
\ccpad
\begin{code}%
\>[0]\AgdaFunction{H-id2}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}%
\>[295I]\AgdaBound{ùì¶}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSymbol{\}\{}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùëÜ}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSymbol{)\}}\<%
\\
\>[.][@{}l@{}]\<[295I]%
\>[11]\AgdaSymbol{\{}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSymbol{\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{H-id2}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì¶}\AgdaSymbol{\}\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùí¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{p}\AgdaSymbol{\}\{}\AgdaBound{q}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Hpq}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äî}}\AgdaSpace{}%
\AgdaBound{ùì¶}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ùëÜ}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{ùì¶}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{plA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àà}}\AgdaSpace{}%
\AgdaDatatype{H}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùí¶}\<%
\\
%
\>[2]\AgdaFunction{plA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{hbase}\AgdaSpace{}%
\AgdaBound{KA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Œæ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œæ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Hpq}\AgdaSpace{}%
\AgdaFunction{plA}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lower-alg-‚äß}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaFunction{Œæ}\<%
\end{code}

\subsubsection{S preserves identities}\label{s-preserves-identities}

\begin{code}%
\>[0]\AgdaFunction{S-id1}%
\>[371I]\AgdaSymbol{:}%
\>[372I]\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[372I]%
\>[8]\AgdaSymbol{(}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùëÜ}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSymbol{\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\})}\<%
\\
\>[371I][@{}l@{\AgdaIndent{0}}]%
\>[7]\AgdaComment{-------------------------------------}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{‚Üí}%
\>[8]\AgdaSymbol{(}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì§}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{S-id1}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-‚äß}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{S-id1}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{slift}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-‚äß}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{S-id1}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{S-id1}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssub}\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{B‚â§A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{S-‚äß}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{B‚â§A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaInductiveConstructor{ùìá‚ÑØùíªùìÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{id‚âÖ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\AgdaSpace{}%
\AgdaComment{--Apply S-‚äß to the class ùí¶ ‚à™ ÔΩõ ùë® ÔΩù}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{Œ≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[3]\AgdaFunction{Œ≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S-id1}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Apq}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩõ}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩù}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[3]\AgdaFunction{Apq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≤}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚à™}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩõ}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩù}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[3]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[3]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Apq}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{S-id1}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ssubw}\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{sA}\AgdaSpace{}%
\AgdaBound{B‚â§A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{S-‚äß}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{B‚â§A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaInductiveConstructor{ùìá‚ÑØùíªùìÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{id‚âÖ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[9]\AgdaComment{--Apply S-‚äß to the class ùí¶ ‚à™ ÔΩõ ùë® ÔΩù}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{Œ≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[3]\AgdaFunction{Œ≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S-id1}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{sA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Apq}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩõ}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩù}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[3]\AgdaFunction{Apq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≤}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚à™}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩõ}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩù}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[3]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[3]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Apq}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{S-id1}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{siso}\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{Œ∂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ∂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S-id1}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚äß-transport}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaFunction{Œ∂}\AgdaSpace{}%
\AgdaBound{x‚ÇÅ}\<%
\end{code}
\ccpad
Again, the obvious converse is barely worth the bits needed to formalize it.
\ccpad
\begin{code}%
\>[0]\AgdaFunction{S-id2}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}%
\>[607I]\AgdaBound{ùì¶}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSymbol{\}\{}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùëÜ}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSymbol{)\}}\<%
\\
\>[.][@{}l@{}]\<[607I]%
\>[11]\AgdaSymbol{\{}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSymbol{\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{S-id2}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì¶}\AgdaSymbol{\}\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùí¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{p}\AgdaSymbol{\}\{}\AgdaBound{q}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Spq}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äî}}\AgdaSpace{}%
\AgdaBound{ùì¶}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ùëÜ}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{ùì¶}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{plA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àà}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùí¶}\<%
\\
%
\>[2]\AgdaFunction{plA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{KA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Œæ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œæ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Spq}\AgdaSpace{}%
\AgdaFunction{plA}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lower-alg-‚äß}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaFunction{Œæ}\<%
\end{code}

\subsubsection{P preserves identities}\label{p-preserves-identities}

\begin{code}%
\>[0]\AgdaFunction{P-id1}%
\>[683I]\AgdaSymbol{:}%
\>[684I]\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[684I]%
\>[8]\AgdaSymbol{\{}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùëÜ}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSymbol{)\}}\<%
\\
%
\>[8]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSymbol{\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\})}\<%
\\
\>[683I][@{}l@{\AgdaIndent{0}}]%
\>[7]\AgdaComment{------------------------------------}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{‚Üí}%
\>[8]\AgdaSymbol{(}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì§}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{P-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-‚äß}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{P-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftu}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-‚äß}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{P-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{P-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pliftw}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-‚äß}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{P-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{P-id1}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùìß}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{produ}\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{ùíú}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùëÜ}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùíú}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{IH}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaFunction{IH}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-‚äß}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùíú}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{P-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚®Ö}\AgdaSpace{}%
\AgdaBound{ùíú}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚®Ö}\AgdaSpace{}%
\AgdaBound{ùíú}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-products-preserve-ids}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaBound{ùíú}\AgdaSpace{}%
\AgdaFunction{IH}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{P-id1}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{prodw}\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{ùíú}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùëÜ}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùíú}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{IH}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lA}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaFunction{IH}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-‚äß}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùíú}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{P-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚®Ö}\AgdaSpace{}%
\AgdaBound{ùíú}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚®Ö}\AgdaSpace{}%
\AgdaBound{ùíú}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-products-preserve-ids}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaBound{ùíú}\AgdaSpace{}%
\AgdaFunction{IH}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{P-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisou}\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚äß-transport}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{P-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x‚ÇÅ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{P-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{pisow}\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{x‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚äß-transport}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaFunction{Œ∂}\AgdaSpace{}%
\AgdaBound{x‚ÇÅ}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{Œ∂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ∂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{P-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{x}\<%
\end{code}
\ccpad
\ldots{}and conversely\ldots{}
\ccpad
\begin{code}%
\>[0]\AgdaFunction{P-id2}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[930I]\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùì¶}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[930I]%
\>[8]\AgdaSymbol{(}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùëÜ}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaSymbol{\{}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSymbol{\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}\}}\<%
\\
%
\>[8]\AgdaComment{--------------------------------------}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{‚Üí}%
\>[8]\AgdaSymbol{((}\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{P-id2}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{p}\AgdaSymbol{\}\{}\AgdaBound{q}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{PKpq}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äî}}\AgdaSpace{}%
\AgdaBound{ùì¶}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ùëÜ}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{ùì¶}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{plA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àà}}\AgdaSpace{}%
\AgdaDatatype{P}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùí¶}\<%
\\
%
\>[2]\AgdaFunction{plA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{pbase}\AgdaSpace{}%
\AgdaBound{KA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Œæ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œæ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{PKpq}\AgdaSpace{}%
\AgdaFunction{plA}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lower-alg-‚äß}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaFunction{Œæ}\<%
\end{code}

\subsubsection{V preserves identities}\label{v-preserves-identities}

\begin{code}%
\>[0]\AgdaComment{-- V preserves identities}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}%
\>[1008I]\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSymbol{\}\{}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùëÜ}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSymbol{)\}}\<%
\\
\>[.][@{}l@{}]\<[1008I]%
\>[11]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSymbol{\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì§}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vbase}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-‚äß}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}\{}\AgdaBound{ùí¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vlift}\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{Œ≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-‚äß}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaFunction{Œ≤}\<%
\\
\>[0]\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}\{}\AgdaBound{ùí¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vliftw}\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{Œ≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ≤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg-‚äß}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaFunction{Œ≤}\<%
\\
\>[0]\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vhimg}\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}\{}\AgdaBound{ùë™}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{VA}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œïh}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œïE}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{B‚âÖC}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚äß-‚âÖ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaBound{B‚âÖC}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{IH}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{IH}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{VA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{preim}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚à£}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚à£}}\<%
\\
%
\>[2]\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Inv}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œïE}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Œ∂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaComment{-- (ùíÉ :  ‚Üí ‚à£ ùë© ‚à£)(x : X) }\<%
\\
%
\>[2]\AgdaFunction{Œ∂}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{InvIsInv}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œïE}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ùíÉ}%
\>[27]\AgdaOperator{\AgdaFunction{‚â°‚ü®}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Œ∂}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{))}\AgdaOperator{\AgdaFunction{‚Åª¬π}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü©}}\<%
\\
%
\>[3]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚â°‚ü®}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{comm-hom-term}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œïh}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{))}\AgdaOperator{\AgdaFunction{‚Åª¬π}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü©}}\<%
\\
%
\>[3]\AgdaBound{œï}\AgdaSymbol{((}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSymbol{)(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{))}%
\>[27]\AgdaOperator{\AgdaFunction{‚â°‚ü®}}\AgdaSpace{}%
\AgdaFunction{ap}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{intensionality}\AgdaSpace{}%
\AgdaFunction{IH}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü©}}\<%
\\
%
\>[3]\AgdaBound{œï}\AgdaSymbol{((}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSymbol{)(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{))}%
\>[27]\AgdaOperator{\AgdaFunction{‚â°‚ü®}}\AgdaSpace{}%
\AgdaFunction{comm-hom-term}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œïh}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü©}}\<%
\\
%
\>[3]\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{preim}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{))}%
\>[28]\AgdaOperator{\AgdaFunction{‚â°‚ü®}}\AgdaSpace{}%
\AgdaFunction{ap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Œ∂}\AgdaSpace{}%
\AgdaBound{ùíÉ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü©}}\<%
\\
%
\>[3]\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaBound{ùë©}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ùíÉ}%
\>[28]\AgdaOperator{\AgdaFunction{‚àé}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{V-id1}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}\{}\AgdaBound{ùí¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaInductiveConstructor{vssub}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{VA}\AgdaSpace{}%
\AgdaBound{B‚â§A}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{S-‚äß}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{B‚â§A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaInductiveConstructor{ùìá‚ÑØùíªùìÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{id‚âÖ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{IH}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[3]\AgdaFunction{IH}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{VA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Asinglepq}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩõ}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩù}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[3]\AgdaFunction{Asinglepq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{IH}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚à™}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩõ}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩù}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[3]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[3]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Asinglepq}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{V-id1}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}\{}\AgdaBound{ùí¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaInductiveConstructor{vssubw}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{VA}\AgdaSpace{}%
\AgdaBound{B‚â§A}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{S-‚äß}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùë©}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{B‚â§A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaInductiveConstructor{ùìá‚ÑØùíªùìÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{id‚âÖ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{IH}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[3]\AgdaFunction{IH}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{VA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Asinglepq}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩõ}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩù}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[3]\AgdaFunction{Asinglepq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{IH}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚à™}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩõ}}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ÔΩù}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[3]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[3]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Asinglepq}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vprodu}\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{ùíú}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Vùíú}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{IH}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{ùíú}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{IH}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{V-id1}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Vùíú}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚®Ö}\AgdaSpace{}%
\AgdaBound{ùíú}\AgdaSymbol{)}%
\>[17]\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚®Ö}\AgdaSpace{}%
\AgdaBound{ùíú}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{product-id-compatibility}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaBound{ùíú}\AgdaSpace{}%
\AgdaFunction{IH}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vprodw}\AgdaSymbol{\{}\AgdaBound{I}\AgdaSymbol{\}\{}\AgdaBound{ùíú}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Vùíú}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{IH}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{ùíú}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{IH}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{V-id1}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Vùíú}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚®Ö}\AgdaSpace{}%
\AgdaBound{ùíú}\AgdaSymbol{)}%
\>[17]\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚®Ö}\AgdaSpace{}%
\AgdaBound{ùíú}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{product-id-compatibility}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaBound{ùíú}\AgdaSpace{}%
\AgdaFunction{IH}\<%
\\
\>[0]\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{visou}\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{VA}\AgdaSpace{}%
\AgdaBound{A‚âÖB}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚äß-‚âÖ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{VA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{A‚âÖB}\<%
\\
\>[0]\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{visow}\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}\{}\AgdaBound{ùë©}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{VA}\AgdaSpace{}%
\AgdaBound{A‚âÖB}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚äß-‚âÖ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{VA}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{A‚âÖB}\<%
\end{code}
\ccpad
Once again, and for the last time, completeness dictates that we formalize the coverse, however obvious it may be.
\ccpad
\begin{code}%
\>[0]\AgdaFunction{V-id2}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}%
\>[1534I]\AgdaBound{ùì¶}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSymbol{\}\{}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùëÜ}\AgdaSymbol{)(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSymbol{)\}}\<%
\\
\>[.][@{}l@{}]\<[1534I]%
\>[11]\AgdaSymbol{\{}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSymbol{\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{V-id2}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì¶}\AgdaSymbol{\}\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùí¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{p}\AgdaSymbol{\}\{}\AgdaBound{q}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{Vpq}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œ≥}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äî}}\AgdaSpace{}%
\AgdaBound{ùì¶}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ùëÜ}\<%
\\
%
\>[2]\AgdaFunction{lA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-alg}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{ùì¶}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{vlA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àà}}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùì¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ùí¶}\<%
\\
%
\>[2]\AgdaFunction{vlA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{vbase}\AgdaSpace{}%
\AgdaBound{KA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Œæ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{lA}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œæ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Vpq}\AgdaSpace{}%
\AgdaFunction{vlA}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âà}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{Œ≥}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lower-alg-‚äß}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaFunction{Œæ}\<%
\end{code}

\subsubsection{Class identities}\label{class-identities}
It follows from \af{V-id1} that, if \ab ùí¶ is a class of structures, the set of identities modeled by all structures in \ab ùí¶ is the same as the set of identities modeled by all structures in \ad V \ab ùí¶.
\ccpad
\begin{code}%
\>[0]\AgdaComment{-- Th (V ùí¶) is precisely the set of identities modeled by ùí¶}\<%
\\
\>[0]\AgdaFunction{class-identities}%
\>[1610I]\AgdaSymbol{:}%
\>[1611I]\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùìß}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ãá}}\AgdaSymbol{\}\{}\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSpace{}%
\AgdaBound{ùëÜ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{OV}\AgdaSpace{}%
\AgdaBound{ùì§}\AgdaSymbol{)\}}\<%
\\
\>[.][@{}l@{}]\<[1611I]%
\>[19]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚à£}}\AgdaSpace{}%
\AgdaFunction{ùëª}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚à£}}\AgdaSymbol{)}\<%
\\
\>[1610I][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaComment{----------------------------------------------------------}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{‚Üí}%
\>[19]\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}%
\>[30]\AgdaOperator{\AgdaFunction{‚áî}}%
\>[33]\AgdaSymbol{((}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àà}}\AgdaSpace{}%
\AgdaFunction{Th}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{class-identities}\AgdaSymbol{\{}\AgdaBound{ùì§}\AgdaSymbol{\}\{}\AgdaBound{ùìß}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\}\{}\AgdaBound{ùí¶}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{‚áí}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{‚áê}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{‚áí}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àà}}\AgdaSpace{}%
\AgdaFunction{Th}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{‚áí}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{VCloA}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{V-id1}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{Œ±}\AgdaSpace{}%
\AgdaBound{VCloA}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{‚áê}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àà}}\AgdaSpace{}%
\AgdaFunction{Th}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{V}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{ùí¶}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚âã}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[2]\AgdaFunction{‚áê}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{Thpq}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ùë®}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{lower-alg-‚äß}\AgdaSpace{}%
\AgdaBound{ùë®}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Thpq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{vbase}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSymbol{))}\<%
\end{code}
