\>[1]\AgdaFunction{products-preserve-identities}\AgdaSpace{}%
\AgdaSymbol{:}
\>[31]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[31]\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{}%
\>[31]\AgdaSymbol{((}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
%
\>[31]\AgdaComment{---------------------------------------------------------------}\<%
\\
%
\>[2]\AgdaSymbol{}%
\>[31]\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[1]\AgdaFunction{products-preserve-identities}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{pq}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{纬}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{}\<%
\\
\>[3][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{a}%
\>[289I]\>\AgdaOperator{\AgdaFunction{♀}}\AgdaSpace{}%
\AgdaFunction{interp-prod}\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{fevu}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[4]\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)))}\AgdaSpace{}%
\>[.][@{}l@{}]\<[289I]%
\>[38]\AgdaOperator{\AgdaFunction{♀}}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{cong-app}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{pq}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[4]\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)))}\AgdaSpace{}%
\>[38]\AgdaOperator{\AgdaFunction{♀}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{interp-prod}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaOperator{\AgdaFunction{宦}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{a}%
\>[38]\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{products-in-class-preserve-identities}\AgdaSpace{}%
\AgdaSymbol{:}
\>[21]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}\{}\AgdaBound{X}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[21]\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaSymbol{}%
\>[21]\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[21]\AgdaComment{-----------------------------------------------------}\<%
\\
%
\>[3]\AgdaSymbol{}%
\>[21]\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[1]\AgdaFunction{products-in-class-preserve-identities}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{pq}\AgdaSpace{}%
\AgdaBound{alli}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{纬}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{pq}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[3]\AgdaFunction{pq}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{pq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{alli}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{猕}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{products-preserve-identities}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaFunction{pq}\<%
