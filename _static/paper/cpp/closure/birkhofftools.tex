\>[0]\AgdaComment{--More tools for Birkhoff's theorem}\<%
\\
\>[0]\AgdaComment{--Here are some key facts/identities needed to complete the proof of Birkhoff's HSP theorem.}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{SCloğ’¦â†’ğ‘»img}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{SClo}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{ğ‘»img}\<%
\\
%
\>[1]\AgdaFunction{SCloğ’¦â†’ğ‘»img}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaBound{ğ‘ªâˆˆSCloğ’¦}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fst}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ‘»hom-gen}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ‘ªâˆˆSCloğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{snd}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ‘»hom-gen}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSymbol{)))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{ğ‘»imgâ†’ğ‘»âŠ§}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}%
\>[19]\AgdaSymbol{â†’}%
\>[23]\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaFunction{Î¨'}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{â†’}%
\>[11]\AgdaSymbol{(}\AgdaBound{ti}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ğ‘»img}\AgdaSymbol{)}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaComment{---------------------------}\<%
\\
%
\>[2]\AgdaSymbol{â†’}%
\>[10]\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ‘»Ï•}\AgdaSpace{}%
\AgdaBound{ti}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{â„Š}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaDatatype{â‰¡}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ‘»Ï•}\AgdaSpace{}%
\AgdaBound{ti}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{â„Š}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{ğ‘»imgâ†’ğ‘»âŠ§}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{pÎ¨q}\AgdaSpace{}%
\AgdaBound{ti}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{goal1}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaKeyword{where}\<%
\\
\>[3][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{ğ‘ª}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[4]\AgdaFunction{ğ‘ª}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{ti}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hom}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSpace{}%
\AgdaFunction{ğ‘ª}\<%
\\
%
\>[4]\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ğ‘»Ï•}\AgdaSpace{}%
\AgdaBound{ti}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{pCq}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{â‰¡}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[4]\AgdaFunction{pCq}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{pÎ¨q}\AgdaSpace{}%
\AgdaBound{ti}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{ğ“…}\AgdaSpace{}%
\AgdaFunction{ğ“†}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}%
\>[17]\AgdaComment{-- Notation: ğ“… = \textbackslash{}Mcp}\<%
\\
%
\>[4]\AgdaFunction{ğ“…}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{tg}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[4]\AgdaFunction{ğ“†}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{tg}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{pâ‰¡ğ“…}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{â‰¡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ“…}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{â„Š}\<%
\\
%
\>[4]\AgdaFunction{pâ‰¡ğ“…}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{tg}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{qâ‰¡ğ“†}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{â‰¡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ“†}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{â„Š}\<%
\\
%
\>[4]\AgdaFunction{qâ‰¡ğ“†}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{tg}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{Î¾}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{ğ“…}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{â„Š}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{â‰¡}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{ğ“†}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{â„Š}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{Î¾}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ap}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{pâ‰¡ğ“…}\AgdaSymbol{)}\AgdaOperator{\AgdaFunction{â»Â¹}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ™}}\AgdaSpace{}%
\AgdaFunction{pCq}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ™}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ap}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{qâ‰¡ğ“†}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{goal1}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{â„Š}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{â‰¡}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{â„Š}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{goal1}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[954I]\AgdaSymbol{(}\AgdaFunction{ap}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{term-gen-agreement}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{))}\<%
\\
\>[954I][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaOperator{\AgdaFunction{âˆ™}}\AgdaSpace{}%
\AgdaFunction{Î¾}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ™}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ap}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{term-gen-agreement}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{))}\AgdaOperator{\AgdaFunction{â»Â¹}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{Î¨âŠ†ThSCloğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Î¨}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ†}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Th}\AgdaSpace{}%
\AgdaDatatype{SClo}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{Î¨âŠ†ThSCloğ’¦}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{pÎ¨q}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘ª}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ‘ªâˆˆSCloğ’¦}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ğ‘ªâŠ§pâ‰ˆq}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{ti}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ğ‘»img}\<%
\\
%
\>[3]\AgdaFunction{ti}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{SCloğ’¦â†’ğ‘»img}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaBound{ğ‘ªâˆˆSCloğ’¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hom}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\<%
\\
%
\>[3]\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ğ‘»Ï•}\AgdaSpace{}%
\AgdaFunction{ti}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Ï•E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Epic}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{Ï•E}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ğ‘»Ï•E}\AgdaSpace{}%
\AgdaFunction{ti}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Ï•sur}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’„}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{)(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{X}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{Image}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{âˆ‹}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’„}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Ï•sur}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Ï•E}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’„}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{pre}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’„}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSymbol{)(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{X}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[3]\AgdaFunction{pre}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Inv}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’„}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Ï•sur}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Î¶}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’„}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ˜}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{pre}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{â‰¡}}\AgdaSpace{}%
\AgdaBound{ğ’„}\<%
\\
%
\>[3]\AgdaFunction{Î¶}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{InvIsInv}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ’„}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Ï•sur}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ˜}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{â‰¡}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ˜}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{pÎ¨q}\AgdaSpace{}%
\AgdaFunction{ti}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{ğ‘ªâŠ§pâ‰ˆq}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{â‰¡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaFunction{ğ‘ªâŠ§pâ‰ˆq}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSpace{}%
\AgdaSymbol{â†’}\<%
\\
\>[3][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{(}\AgdaBound{p}%
\>[1117I]\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ’„}\<%
\\
\>[1117I][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{â‰¡âŸ¨}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Î¶}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSymbol{))}\AgdaOperator{\AgdaFunction{â»Â¹}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŸ©}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{p}%
\>[1127I]\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSymbol{)(}\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ˜}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{pre}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSymbol{))}\<%
\\
\>[1127I][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{â‰¡âŸ¨}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{comm-hom-term}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{pre}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSymbol{))}\AgdaOperator{\AgdaFunction{â»Â¹}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŸ©}}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}%
\>[1144I]\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSymbol{)(}\AgdaFunction{pre}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSymbol{))}\<%
\\
\>[.][@{}l@{}]\<[1144I]%
\>[8]\AgdaOperator{\AgdaFunction{â‰¡âŸ¨}}\AgdaSpace{}%
\AgdaFunction{intensionality}\AgdaSpace{}%
\AgdaFunction{Î³}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{pre}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŸ©}}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}%
\>[1155I]\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSymbol{)(}\AgdaFunction{pre}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSymbol{))}\<%
\\
\>[.][@{}l@{}]\<[1155I]%
\>[8]\AgdaOperator{\AgdaFunction{â‰¡âŸ¨}}\AgdaSpace{}%
\AgdaFunction{comm-hom-term}\AgdaSpace{}%
\AgdaBound{gfe}\AgdaSpace{}%
\AgdaFunction{ğ‘»}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{pre}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŸ©}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{q}%
\>[1169I]\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSymbol{)(}\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{Ï•}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ˜}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{pre}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSymbol{))}\<%
\\
\>[1169I][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{â‰¡âŸ¨}}\AgdaSpace{}%
\AgdaFunction{ap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Î¶}\AgdaSpace{}%
\AgdaBound{ğ’„}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŸ©}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaBound{q}%
\>[1183I]\AgdaOperator{\AgdaFunction{Ì‡}}\AgdaSpace{}%
\AgdaBound{ğ‘ª}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ğ’„}\<%
\\
\>[1183I][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{âˆ}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{Î¨âŠ†Thğ’¦}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaFunction{Î¨}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŠ§}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{â‰‹}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\>[1]\AgdaFunction{Î¨âŠ†Thğ’¦}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaBound{pÎ¨q}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ğ‘¨}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Î¨âŠ†ThSCloğ’¦}\AgdaSymbol{\{}\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{pÎ¨q}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{sbase}\AgdaSpace{}%
\AgdaBound{KA}\AgdaSymbol{)}\<%
