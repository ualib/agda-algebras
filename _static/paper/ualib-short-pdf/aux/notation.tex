%% \>[1]\AgdaComment{-- ğ• is HSP(ğ’¦)}\<%
%% \\
%% %
\>[1]\AgdaFunction{ğ•}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaFunction{ovu+}\AgdaSpace{}%
\AgdaBound{ğ‘†}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ovu+}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âº}}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{ğ•}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{V}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaFunction{ovu+}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{â„‘s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ovu}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Ì‡}}\<%
\\
%
\>[1]\AgdaFunction{â„‘s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â„‘}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{ğ”„s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â„‘s}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{ğ“¤}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[1]\AgdaFunction{ğ”„s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â„‘s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{SKğ”„}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â„‘s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ”„s}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆˆ}}\AgdaSpace{}%
\AgdaDatatype{S}\AgdaSymbol{\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}\{}\AgdaBound{ğ“¤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ğ’¦}\<%
\\
%
\>[1]\AgdaFunction{SKğ”„}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â„‘s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaComment{-- â„­ is the product of all subalgebras of algebras in ğ’¦.}\<%
\\
%
\>[1]\AgdaFunction{â„­}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaFunction{ovu}\AgdaSpace{}%
\AgdaBound{ğ‘†}\<%
\\
%
\>[1]\AgdaFunction{â„­}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â¨…}\AgdaSpace{}%
\AgdaFunction{ğ”„s}\<%
\\
%
\>[1]\AgdaComment{-- Elements of â„­ are mappings from â„‘s to \{ğ”„s i : i âˆˆ â„‘s\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{ğ”¥â‚€}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{â„­}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[1]\AgdaFunction{ğ”¥â‚€}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fst}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ğ•}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ”„s}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{Ï•ğ” }\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hom}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ‘»}\AgdaSpace{}%
\AgdaBound{X}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{â„­}\<%
\\
%
\>[1]\AgdaFunction{Ï•ğ” }\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-hom}\AgdaSpace{}%
\AgdaFunction{â„­}\AgdaSpace{}%
\AgdaFunction{ğ”¥â‚€}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{ğ”¤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hom}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ‘»}\AgdaSpace{}%
\AgdaBound{X}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{ğ”‰}\<%
\\
%
\>[1]\AgdaFunction{ğ”¤}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift-hom}\AgdaSpace{}%
\AgdaFunction{ğ”‰}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Xâ†ªğ”‰}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{ğ”£}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hom}\AgdaSpace{}%
\AgdaFunction{ğ”‰}\AgdaSpace{}%
\AgdaFunction{â„­}\<%
\\
%
\>[1]\AgdaFunction{ğ”£}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ğ”‰-free-lift}\AgdaSpace{}%
\AgdaFunction{â„­}\AgdaSpace{}%
\AgdaFunction{ğ”¥â‚€}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{Î»}\AgdaSpace{}%
\AgdaBound{ğ‘“}\AgdaSpace{}%
\AgdaBound{ğ’‚}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaFunction{Ï•ğ” }\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ¥}}\AgdaSpace{}%
\AgdaBound{ğ‘“}\AgdaSpace{}%
\AgdaSymbol{(Î»}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŒœ}}\AgdaSpace{}%
\AgdaBound{ğ’‚}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŒ}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{ğ”¤-âŸ¦âŸ§}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{ğ”¤}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{â‰¡}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŸ¦}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âŸ§}}\<%
\\
%
\>[1]\AgdaFunction{ğ”¤-âŸ¦âŸ§}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Ï€ğ”‰-X-defined}\AgdaSpace{}%
\AgdaFunction{ğ”¤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ”‰-lift-agrees-on-X}\AgdaSpace{}%
\AgdaFunction{ğ”‰}\AgdaSpace{}%
\AgdaFunction{Xâ†ªğ”‰}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaComment{-- ğ”­ i is the projection out of the product â„­ onto the i-th factor.}\<%
\\
%
\>[1]\AgdaFunction{ğ”­}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â„‘s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{â„­}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{ğ”„s}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[1]\AgdaFunction{ğ”­}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{ğ’‚}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ğ’‚}\AgdaSpace{}%
\AgdaBound{i}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{ğ”­hom}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â„‘s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{hom}\AgdaSpace{}%
\AgdaFunction{â„­}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ”„s}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{ğ”­hom}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â¨…-projection-hom}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{I}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{â„‘s}\AgdaSymbol{\}\{}\AgdaArgument{ğ’œ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ğ”„s}\AgdaSymbol{\}}\<%
\\
%% %
%% \\[\AgdaEmptyExtraSkip]%
%% %
%% \>[1]\AgdaComment{--}\<%
%% \\
%% %
%% \>[1]\AgdaComment{--                             ğ”„1}\<%
%% \\
%% %
%% \>[1]\AgdaComment{--                            77}\<%
%% \\
%% %
%% \>[1]\AgdaComment{--                           /}\<%
%% \\
%% %
%% \>[1]\AgdaComment{--        ğ‘» -----Ï•â‰¡h --->>  â„­ -->> ğ”„2}\<%
%% \\
%% %
%% \>[1]\AgdaComment{--         \textbackslash{}             77        â‹®}\<%
%% \\
%% %
%% \>[1]\AgdaComment{--          \textbackslash{}           /}\<%
%% \\
%% %
%% \>[1]\AgdaComment{--           g         âˆƒf}\<%
%% \\
%% %
%% \>[1]\AgdaComment{--            \textbackslash{}       /}\<%
%% \\
%% %
%% \>[1]\AgdaComment{--             \textbackslash{}     /}\<%
%% \\
%% %
%% \>[1]\AgdaComment{--              V  l/}\<%
%% \\
%% %
%% \>[1]\AgdaComment{--             ğ”‰ = ğ‘»/Ïˆ}\<%
%% \\
%% %
%% \\[\AgdaEmptyExtraSkip]%
%% %
\>[1]\AgdaComment{-- ğ”­ğ”£ is the composition:  ğ”‰ -- ğ”£ -->  â„­ -- ğ”­ i --> ğ”„s i}\<%
\\
%
\>[1]\AgdaFunction{ğ”­ğ”£}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{âˆ€}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{ğ”‰}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{ğ”„s}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\>[1]\AgdaFunction{ğ”­ğ”£}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ”­}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ˜}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\AgdaSpace{}%
\AgdaFunction{ğ”£}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{âˆ£}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[1]\AgdaFunction{ğ”­ğ”£hom}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{â„‘s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{â†’}\AgdaSpace{}%
\AgdaFunction{hom}\AgdaSpace{}%
\AgdaFunction{ğ”‰}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ”„s}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaFunction{ğ”­ğ”£hom}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{HomComp}\AgdaSpace{}%
\AgdaFunction{ğ”‰}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ”„s}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{ğ”£}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ğ”­hom}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
