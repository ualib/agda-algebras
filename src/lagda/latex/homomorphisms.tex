\begin{code}%
\>[0]\AgdaComment{-- File: homomorphisms.agda}\<%
\\
\>[0]\AgdaComment{-- Author: William DeMeo and Siva Somayyajula}\<%
\\
\>[0]\AgdaComment{-- Date: 30 Jun 2020}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--without-K}\AgdaSpace{}%
\AgdaPragma{--exact-split}\AgdaSpace{}%
\AgdaPragma{--safe}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{basic}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{congruences}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{homomorphisms}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Signature}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{prelude}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{EpicInv}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong-app}\AgdaSymbol{;}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{EInvIsRInv}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{Image\AgdaUnderscore{}\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--intensional preservation of operations}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{op\AgdaUnderscore{}interpreted-in\AgdaUnderscore{}and\AgdaUnderscore{}commutes-intensionally-with}}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}%
\>[13]\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{op}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{interpreted-in}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{and}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{commutes-intensionally-with}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{}}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)(}\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{all-ops-in\AgdaUnderscore{}and\AgdaUnderscore{}commute-partially-intensionally-with}}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}%
\>[13]\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{all-ops-in}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{and}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{commute-partially-intensionally-with}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{op}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{interpreted-in}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{and}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{commutes-intensionally-with}}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{intensional-hom}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[18]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{intensional-hom}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaOperator{\AgdaFunction{all-ops-in}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{and}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{commute-partially-intensionally-with}}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{Hom}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}%
\>[33]\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{Hom}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{危}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaOperator{\AgdaFunction{all-ops-in}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{and}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{commute-partially-intensionally-with}}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- intensional with respect to both f and a)}\<%
\\
\>[0]\AgdaFunction{preserves-ops}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[16]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}%
\>[24]\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{preserves-ops}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{贯船}\AgdaSymbol{)(}\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{贯串}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{贯船}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{))}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaDatatype{}}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{)}%
\>[40]\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{贯串}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{all-ops-in\AgdaUnderscore{}and\AgdaUnderscore{}commute-intensionally-with}}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[1]\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}%
\>[13]\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{all-ops-in}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{and}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{commute-intensionally-with}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{preserves-ops}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--the type of (intensional) homomorphisms}\<%
\\
\>[0]\AgdaFunction{HOM}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}%
\>[33]\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{HOM}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[319I]\AgdaFunction{危}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\<%
\\
\>[319I][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaOperator{\AgdaFunction{all-ops-in}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{and}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{commute-intensionally-with}}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{op\AgdaUnderscore{}interpreted-in\AgdaUnderscore{}and\AgdaUnderscore{}commutes-extensionally-with}}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\>[3]\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}%
\>[15]\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{op}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{interpreted-in}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{and}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{commutes-extensionally-with}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{all-ops-in\AgdaUnderscore{}and\AgdaUnderscore{}commute-extensionally-with}}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[5]\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[5]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}%
\>[13]\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{all-ops-in}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{and}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{commute-extensionally-with}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{op}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{interpreted-in}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{and}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{commutes-extensionally-with}}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{is-homomorphism}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[18]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{is-homomorphism}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaOperator{\AgdaFunction{all-ops-in}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{and}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{commute-extensionally-with}}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{hom}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}%
\>[33]\AgdaSymbol{}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
\>[0]\AgdaFunction{hom}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{危}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\AgdaSpace{}%
\AgdaFunction{is-homomorphism}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{攫}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[6]\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{hom}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
\>[0]\AgdaFunction{攫}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaInductiveConstructor{火}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{HCompClosed}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[533I]\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[533I]%
\>[14]\AgdaSymbol{\{}\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[14]\AgdaFunction{hom}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}%
\>[23]\AgdaSymbol{}%
\>[26]\AgdaFunction{hom}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\<%
\\
%
\>[14]\AgdaComment{--------------------}\<%
\\
%
\>[1]\AgdaSymbol{}%
\>[14]\AgdaFunction{hom}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{C}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{HCompClosed}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{FA}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{B}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{FB}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{C}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{FC}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ghom}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{hhom}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{纬}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)(}\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}%
\>[32]\AgdaSymbol{}%
\>[35]\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)(}\AgdaBound{FA}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{}}\AgdaSpace{}%
\AgdaBound{FC}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{a}%
\>[606I]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{FA}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{♀}}\AgdaSpace{}%
\AgdaFunction{ap}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{ghom}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
\>[606I][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{FB}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{♀}}\AgdaSpace{}%
\AgdaBound{hhom}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[10]\AgdaBound{FC}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--Alternative notation for hom composition}\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}%
\>[644I]\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[644I]%
\>[9]\AgdaSymbol{\{}\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\<%
\\
%
\>[9]\AgdaSymbol{\{}\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}>>>\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hom}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}%
\>[19]\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{hom}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{hom}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{C}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ghom}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>>}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{hhom}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{纬}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{纬}%
\>[681I]\AgdaSymbol{:}%
\>[15]\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\<%
\\
\>[681I][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaComment{-------------------------------------------}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[7]\AgdaSymbol{}%
\>[12]\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}%
\>[33]\AgdaOperator{\AgdaDatatype{}}%
\>[36]\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[6]\AgdaFunction{纬}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[7]\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{♀}}\AgdaSpace{}%
\AgdaFunction{ap}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{-}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{-}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ghom}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[7]\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{♀}}\AgdaSpace{}%
\AgdaBound{hhom}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[7]\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{homFactor}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[758I]\AgdaFunction{funext}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[758I]%
\>[12]\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hom}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hom}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[12]\AgdaFunction{ker-pred}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{ker-pred}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}%
\>[45]\AgdaSymbol{}%
\>[49]\AgdaFunction{Epic}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaComment{---------------------------------------------}\<%
\\
%
\>[1]\AgdaSymbol{}%
\>[13]\AgdaFunction{危}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hom}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{homFactor}\AgdaSpace{}%
\AgdaBound{fe}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{FA}\AgdaSymbol{\}\{}\AgdaArgument{B}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{FB}\AgdaSymbol{\}\{}\AgdaArgument{C}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{FC}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ghom}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{hhom}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{KhKg}\AgdaSpace{}%
\AgdaBound{hEpic}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{IsHomCB}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{g∠h}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\>[3]\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{EpicInv}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{hEpic}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{c}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{B}\<%
\\
%
\>[3]\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{尉}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{ker-pred}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\<%
\\
%
\>[3]\AgdaFunction{尉}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[10]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{cong-app}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{EInvIsRInv}\AgdaSpace{}%
\AgdaBound{fe}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{hEpic}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaOperator{\AgdaFunction{宦}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{g∠h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{}}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{h}\<%
\\
%
\>[3]\AgdaFunction{g∠h}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{fe}%
\>[15]\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{KhKg}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{尉}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{味}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)(}\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\<%
\\
\>[3][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{}%
\>[7]\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{hInv}\AgdaSymbol{)(}\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{味}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong-app}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{EInvIsRInv}\AgdaSpace{}%
\AgdaBound{fe}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{hEpic}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\AgdaOperator{\AgdaFunction{宦}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{喂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)(}\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\<%
\\
\>[3][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{}%
\>[7]\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{}}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{喂}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ap}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{-}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{-}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{)(}\AgdaFunction{EInvIsRInv}\AgdaSpace{}%
\AgdaBound{fe}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{hEpic}\AgdaSymbol{)}\AgdaOperator{\AgdaFunction{宦}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{useker}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}%
\>[25]\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\<%
\\
\>[3][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{FA}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{))))}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{(}\AgdaBound{FA}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{useker}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{c}\<%
\\
\>[3][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{KhKg}%
\>[1000I]\AgdaSymbol{(}\AgdaFunction{cong-app}\<%
\\
\>[1000I][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaSymbol{(}\AgdaFunction{EInvIsRInv}\AgdaSpace{}%
\AgdaBound{fe}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{hEpic}\AgdaSymbol{)}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaBound{h}\AgdaSymbol{(}\AgdaBound{FA}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{)))}\<%
\\
\>[.][@{}l@{}]\<[1000I]%
\>[12]\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{IsHomCB}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)(}\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\<%
\\
\>[3][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{}%
\>[14]\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{FC}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}%
\>[26]\AgdaOperator{\AgdaDatatype{}}%
\>[29]\AgdaBound{FB}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[3]\AgdaFunction{IsHomCB}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[3][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{FC}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{))}%
\>[37]\AgdaOperator{\AgdaFunction{♀}}\AgdaSpace{}%
\AgdaFunction{i}%
\>[44]\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[4]\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{FC}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{))))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{♀}}\AgdaSpace{}%
\AgdaFunction{ii}%
\>[44]\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[4]\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{FA}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{))))}%
\>[37]\AgdaOperator{\AgdaFunction{♀}}\AgdaSpace{}%
\AgdaFunction{iii}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[4]\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{FA}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{))}%
\>[37]\AgdaOperator{\AgdaFunction{♀}}\AgdaSpace{}%
\AgdaFunction{iv}%
\>[44]\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[4]\AgdaBound{FB}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)))}%
\>[37]\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\>[4]\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[5]\AgdaFunction{i}%
\>[9]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{hInv}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ap}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{FC}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{喂}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{))}\<%
\\
%
\>[5]\AgdaFunction{ii}%
\>[9]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ap}\AgdaSpace{}%
\AgdaSymbol{(位}\AgdaSpace{}%
\AgdaBound{-}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaBound{-}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{hhom}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{))}\AgdaOperator{\AgdaFunction{宦}}\<%
\\
%
\>[5]\AgdaFunction{iii}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{useker}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{c}\<%
\\
%
\>[5]\AgdaFunction{iv}%
\>[9]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ghom}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hInv}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--Isomorphism}\<%
\\
\>[0]\AgdaComment{--For algebras, isomorphisms are simply homs with 0 kernel.}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- module \AgdaUnderscore{} \{ : Universe\} where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
\>[0]\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[9]\AgdaFunction{危}%
\>[1116I]\AgdaBound{f}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hom}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\AgdaSpace{}%
\AgdaFunction{危}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{hom}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\<%
\\
\>[1116I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{攫}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{攫}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- is-algebra-iso : \{  : Algebra  \} (f : hom  )    }\<%
\\
\>[0]\AgdaComment{-- is-algebra-iso \{\} f = ker  f    \{A =   \}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- AlgebraIsos : (  : Algebra  )        }\<%
\\
\>[0]\AgdaComment{-- AlgebraIsos   = 危 f  (hom  ) , is-algebra-iso \{\}\{\} f}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- \AgdaUnderscore{}\AgdaUnderscore{} : Rel (Algebra  ) (     )}\<%
\\
\>[0]\AgdaComment{--    = is-singleton (AlgebraIsos  )}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- The following seems to be the most useful definition (for our}\<%
\\
\>[0]\AgdaComment{-- purposes) of the class of homomomrphic images of an algebra.}\<%
\\
\>[0]\AgdaFunction{HomImage}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}(}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)(}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{hom}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
\>[0]\AgdaFunction{HomImage}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{Image}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{}}\AgdaSpace{}%
\AgdaBound{b}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{HomImagesOf}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
\>[0]\AgdaFunction{HomImagesOf}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{危}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaFunction{}%
\>[1208I]\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\AgdaSpace{}%
\AgdaFunction{危}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\<%
\\
\>[1208I][@{}l@{\AgdaIndent{0}}]%
\>[33]\AgdaFunction{is-homomorphism}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaFunction{Epic}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}is-hom-image-of\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{}%
\>[19]\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{is-hom-image-of}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{危}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{HomImagesOf}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}is-hom-image-of-class\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{}%
\>[26]\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[2]\AgdaSymbol{}%
\>[26]\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{}%
\>[26]\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}is-hom-image-of-class\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{}\AgdaSymbol{\}}%
\>[1279I]\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{危}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\<%
\\
\>[1279I][@{}l@{\AgdaIndent{0}}]%
\>[29]\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{is-hom-image-of}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{HomImagesOfClass}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{HomImagesOfClass}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[1312I]\AgdaFunction{危}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaFunction{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{,}\<%
\\
\>[.][@{}l@{}]\<[1312I]%
\>[21]\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{is-hom-image-of-class}}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{H}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaGeneralizable{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
\>[0]\AgdaFunction{H}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{HomImagesOfClass}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- Here  represents a (universe-indexed) collection of classes.}\<%
\\
\>[0]\AgdaFunction{H-closed}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Pred}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSymbol{))}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaSymbol{}%
\>[11]\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Universe}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaFunction{Algebra}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\<%
\\
%
\>[1]\AgdaSymbol{}%
\>[12]\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{H-closed}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{位}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}is-hom-image-of-class\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{}\AgdaSpace{}%
\AgdaBound{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{}\AgdaSpace{}%
\AgdaBound{}\AgdaSymbol{)}\<%
\\
\>[0]\<%
\end{code}
